(function(){"use strict";var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(V){return V&&V.__esModule&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var V=Symbol.for("react.transitional.element"),j=Symbol.for("react.fragment");function U(F,B,q){var z=null;if(q!==void 0&&(z=""+q),B.key!==void 0&&(z=""+B.key),"key"in B){q={};for(var G in B)G!=="key"&&(q[G]=B[G])}else q=B;return B=q.ref,{$$typeof:V,type:F,key:z,ref:B!==void 0?B:null,props:q}}return reactJsxRuntime_production.Fragment=j,reactJsxRuntime_production.jsx=U,reactJsxRuntime_production.jsxs=U,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(V){function j(Te,Oe){var Ue=Te.length;Te.push(Oe);e:for(;0<Ue;){var Ye=Ue-1>>>1,le=Te[Ye];if(0<B(le,Oe))Te[Ye]=Oe,Te[Ue]=le,Ue=Ye;else break e}}function U(Te){return Te.length===0?null:Te[0]}function F(Te){if(Te.length===0)return null;var Oe=Te[0],Ue=Te.pop();if(Ue!==Oe){Te[0]=Ue;e:for(var Ye=0,le=Te.length,we=le>>>1;Ye<we;){var He=2*(Ye+1)-1,ge=Te[He],We=He+1,at=Te[We];if(0>B(ge,Ue))We<le&&0>B(at,ge)?(Te[Ye]=at,Te[We]=Ue,Ye=We):(Te[Ye]=ge,Te[He]=Ue,Ye=He);else if(We<le&&0>B(at,Ue))Te[Ye]=at,Te[We]=Ue,Ye=We;else break e}}return Oe}function B(Te,Oe){var Ue=Te.sortIndex-Oe.sortIndex;return Ue!==0?Ue:Te.id-Oe.id}if(V.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var q=performance;V.unstable_now=function(){return q.now()}}else{var z=Date,G=z.now();V.unstable_now=function(){return z.now()-G}}var Y=[],Q=[],W=1,Z=null,ee=3,ne=!1,ae=!1,se=!1,de=!1,oe=typeof setTimeout=="function"?setTimeout:null,ue=typeof clearTimeout=="function"?clearTimeout:null,he=typeof setImmediate<"u"?setImmediate:null;function ye(Te){for(var Oe=U(Q);Oe!==null;){if(Oe.callback===null)F(Q);else if(Oe.startTime<=Te)F(Q),Oe.sortIndex=Oe.expirationTime,j(Y,Oe);else break;Oe=U(Q)}}function fe(Te){if(se=!1,ye(Te),!ae)if(U(Y)!==null)ae=!0,pe||(pe=!0,Le());else{var Oe=U(Q);Oe!==null&&Ve(fe,Oe.startTime-Te)}}var pe=!1,xe=-1,Ee=5,ke=-1;function Ae(){return de?!0:!(V.unstable_now()-ke<Ee)}function be(){if(de=!1,pe){var Te=V.unstable_now();ke=Te;var Oe=!0;try{e:{ae=!1,se&&(se=!1,ue(xe),xe=-1),ne=!0;var Ue=ee;try{t:{for(ye(Te),Z=U(Y);Z!==null&&!(Z.expirationTime>Te&&Ae());){var Ye=Z.callback;if(typeof Ye=="function"){Z.callback=null,ee=Z.priorityLevel;var le=Ye(Z.expirationTime<=Te);if(Te=V.unstable_now(),typeof le=="function"){Z.callback=le,ye(Te),Oe=!0;break t}Z===U(Y)&&F(Y),ye(Te)}else F(Y);Z=U(Y)}if(Z!==null)Oe=!0;else{var we=U(Q);we!==null&&Ve(fe,we.startTime-Te),Oe=!1}}break e}finally{Z=null,ee=Ue,ne=!1}Oe=void 0}}finally{Oe?Le():pe=!1}}}var Le;if(typeof he=="function")Le=function(){he(be)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,Ne=Fe.port2;Fe.port1.onmessage=be,Le=function(){Ne.postMessage(null)}}else Le=function(){oe(be,0)};function Ve(Te,Oe){xe=oe(function(){Te(V.unstable_now())},Oe)}V.unstable_IdlePriority=5,V.unstable_ImmediatePriority=1,V.unstable_LowPriority=4,V.unstable_NormalPriority=3,V.unstable_Profiling=null,V.unstable_UserBlockingPriority=2,V.unstable_cancelCallback=function(Te){Te.callback=null},V.unstable_forceFrameRate=function(Te){0>Te||125<Te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ee=0<Te?Math.floor(1e3/Te):5},V.unstable_getCurrentPriorityLevel=function(){return ee},V.unstable_next=function(Te){switch(ee){case 1:case 2:case 3:var Oe=3;break;default:Oe=ee}var Ue=ee;ee=Oe;try{return Te()}finally{ee=Ue}},V.unstable_requestPaint=function(){de=!0},V.unstable_runWithPriority=function(Te,Oe){switch(Te){case 1:case 2:case 3:case 4:case 5:break;default:Te=3}var Ue=ee;ee=Te;try{return Oe()}finally{ee=Ue}},V.unstable_scheduleCallback=function(Te,Oe,Ue){var Ye=V.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?Ye+Ue:Ye):Ue=Ye,Te){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Ue+le,Te={id:W++,callback:Oe,priorityLevel:Te,startTime:Ue,expirationTime:le,sortIndex:-1},Ue>Ye?(Te.sortIndex=Ue,j(Q,Te),U(Y)===null&&Te===U(Q)&&(se?(ue(xe),xe=-1):se=!0,Ve(fe,Ue-Ye))):(Te.sortIndex=le,j(Y,Te),ae||ne||(ae=!0,pe||(pe=!0,Le()))),Te},V.unstable_shouldYield=Ae,V.unstable_wrapCallback=function(Te){var Oe=ee;return function(){var Ue=ee;ee=Oe;try{return Te.apply(this,arguments)}finally{ee=Ue}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var V=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),z=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),Q=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),Z=Symbol.iterator;function ee(le){return le===null||typeof le!="object"?null:(le=Z&&le[Z]||le["@@iterator"],typeof le=="function"?le:null)}var ne={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ae=Object.assign,se={};function de(le,we,He){this.props=le,this.context=we,this.refs=se,this.updater=He||ne}de.prototype.isReactComponent={},de.prototype.setState=function(le,we){if(typeof le!="object"&&typeof le!="function"&&le!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,le,we,"setState")},de.prototype.forceUpdate=function(le){this.updater.enqueueForceUpdate(this,le,"forceUpdate")};function oe(){}oe.prototype=de.prototype;function ue(le,we,He){this.props=le,this.context=we,this.refs=se,this.updater=He||ne}var he=ue.prototype=new oe;he.constructor=ue,ae(he,de.prototype),he.isPureReactComponent=!0;var ye=Array.isArray,fe={H:null,A:null,T:null,S:null,V:null},pe=Object.prototype.hasOwnProperty;function xe(le,we,He,ge,We,at){return He=at.ref,{$$typeof:V,type:le,key:we,ref:He!==void 0?He:null,props:at}}function Ee(le,we){return xe(le.type,we,void 0,void 0,void 0,le.props)}function ke(le){return typeof le=="object"&&le!==null&&le.$$typeof===V}function Ae(le){var we={"=":"=0",":":"=2"};return"$"+le.replace(/[=:]/g,function(He){return we[He]})}var be=/\/+/g;function Le(le,we){return typeof le=="object"&&le!==null&&le.key!=null?Ae(""+le.key):we.toString(36)}function Fe(){}function Ne(le){switch(le.status){case"fulfilled":return le.value;case"rejected":throw le.reason;default:switch(typeof le.status=="string"?le.then(Fe,Fe):(le.status="pending",le.then(function(we){le.status==="pending"&&(le.status="fulfilled",le.value=we)},function(we){le.status==="pending"&&(le.status="rejected",le.reason=we)})),le.status){case"fulfilled":return le.value;case"rejected":throw le.reason}}throw le}function Ve(le,we,He,ge,We){var at=typeof le;(at==="undefined"||at==="boolean")&&(le=null);var $e=!1;if(le===null)$e=!0;else switch(at){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(le.$$typeof){case V:case j:$e=!0;break;case W:return $e=le._init,Ve($e(le._payload),we,He,ge,We)}}if($e)return We=We(le),$e=ge===""?"."+Le(le,0):ge,ye(We)?(He="",$e!=null&&(He=$e.replace(be,"$&/")+"/"),Ve(We,we,He,"",function(ft){return ft})):We!=null&&(ke(We)&&(We=Ee(We,He+(We.key==null||le&&le.key===We.key?"":(""+We.key).replace(be,"$&/")+"/")+$e)),we.push(We)),1;$e=0;var ht=ge===""?".":ge+":";if(ye(le))for(var ut=0;ut<le.length;ut++)ge=le[ut],at=ht+Le(ge,ut),$e+=Ve(ge,we,He,at,We);else if(ut=ee(le),typeof ut=="function")for(le=ut.call(le),ut=0;!(ge=le.next()).done;)ge=ge.value,at=ht+Le(ge,ut++),$e+=Ve(ge,we,He,at,We);else if(at==="object"){if(typeof le.then=="function")return Ve(Ne(le),we,He,ge,We);throw we=String(le),Error("Objects are not valid as a React child (found: "+(we==="[object Object]"?"object with keys {"+Object.keys(le).join(", ")+"}":we)+"). If you meant to render a collection of children, use an array instead.")}return $e}function Te(le,we,He){if(le==null)return le;var ge=[],We=0;return Ve(le,ge,"","",function(at){return we.call(He,at,We++)}),ge}function Oe(le){if(le._status===-1){var we=le._result;we=we(),we.then(function(He){(le._status===0||le._status===-1)&&(le._status=1,le._result=He)},function(He){(le._status===0||le._status===-1)&&(le._status=2,le._result=He)}),le._status===-1&&(le._status=0,le._result=we)}if(le._status===1)return le._result.default;throw le._result}var Ue=typeof reportError=="function"?reportError:function(le){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var we=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof le=="object"&&le!==null&&typeof le.message=="string"?String(le.message):String(le),error:le});if(!window.dispatchEvent(we))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",le);return}console.error(le)};function Ye(){}return react_production.Children={map:Te,forEach:function(le,we,He){Te(le,function(){we.apply(this,arguments)},He)},count:function(le){var we=0;return Te(le,function(){we++}),we},toArray:function(le){return Te(le,function(we){return we})||[]},only:function(le){if(!ke(le))throw Error("React.Children.only expected to receive a single React element child.");return le}},react_production.Component=de,react_production.Fragment=U,react_production.Profiler=B,react_production.PureComponent=ue,react_production.StrictMode=F,react_production.Suspense=Y,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=fe,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(le){return fe.H.useMemoCache(le)}},react_production.cache=function(le){return function(){return le.apply(null,arguments)}},react_production.cloneElement=function(le,we,He){if(le==null)throw Error("The argument must be a React element, but you passed "+le+".");var ge=ae({},le.props),We=le.key,at=void 0;if(we!=null)for($e in we.ref!==void 0&&(at=void 0),we.key!==void 0&&(We=""+we.key),we)!pe.call(we,$e)||$e==="key"||$e==="__self"||$e==="__source"||$e==="ref"&&we.ref===void 0||(ge[$e]=we[$e]);var $e=arguments.length-2;if($e===1)ge.children=He;else if(1<$e){for(var ht=Array($e),ut=0;ut<$e;ut++)ht[ut]=arguments[ut+2];ge.children=ht}return xe(le.type,We,void 0,void 0,at,ge)},react_production.createContext=function(le){return le={$$typeof:z,_currentValue:le,_currentValue2:le,_threadCount:0,Provider:null,Consumer:null},le.Provider=le,le.Consumer={$$typeof:q,_context:le},le},react_production.createElement=function(le,we,He){var ge,We={},at=null;if(we!=null)for(ge in we.key!==void 0&&(at=""+we.key),we)pe.call(we,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(We[ge]=we[ge]);var $e=arguments.length-2;if($e===1)We.children=He;else if(1<$e){for(var ht=Array($e),ut=0;ut<$e;ut++)ht[ut]=arguments[ut+2];We.children=ht}if(le&&le.defaultProps)for(ge in $e=le.defaultProps,$e)We[ge]===void 0&&(We[ge]=$e[ge]);return xe(le,at,void 0,void 0,null,We)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(le){return{$$typeof:G,render:le}},react_production.isValidElement=ke,react_production.lazy=function(le){return{$$typeof:W,_payload:{_status:-1,_result:le},_init:Oe}},react_production.memo=function(le,we){return{$$typeof:Q,type:le,compare:we===void 0?null:we}},react_production.startTransition=function(le){var we=fe.T,He={};fe.T=He;try{var ge=le(),We=fe.S;We!==null&&We(He,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(Ye,Ue)}catch(at){Ue(at)}finally{fe.T=we}},react_production.unstable_useCacheRefresh=function(){return fe.H.useCacheRefresh()},react_production.use=function(le){return fe.H.use(le)},react_production.useActionState=function(le,we,He){return fe.H.useActionState(le,we,He)},react_production.useCallback=function(le,we){return fe.H.useCallback(le,we)},react_production.useContext=function(le){return fe.H.useContext(le)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(le,we){return fe.H.useDeferredValue(le,we)},react_production.useEffect=function(le,we,He){var ge=fe.H;if(typeof He=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ge.useEffect(le,we)},react_production.useId=function(){return fe.H.useId()},react_production.useImperativeHandle=function(le,we,He){return fe.H.useImperativeHandle(le,we,He)},react_production.useInsertionEffect=function(le,we){return fe.H.useInsertionEffect(le,we)},react_production.useLayoutEffect=function(le,we){return fe.H.useLayoutEffect(le,we)},react_production.useMemo=function(le,we){return fe.H.useMemo(le,we)},react_production.useOptimistic=function(le,we){return fe.H.useOptimistic(le,we)},react_production.useReducer=function(le,we,He){return fe.H.useReducer(le,we,He)},react_production.useRef=function(le){return fe.H.useRef(le)},react_production.useState=function(le){return fe.H.useState(le)},react_production.useSyncExternalStore=function(le,we,He){return fe.H.useSyncExternalStore(le,we,He)},react_production.useTransition=function(){return fe.H.useTransition()},react_production.version="19.1.1",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var V=requireReact();function j(Y){var Q="https://react.dev/errors/"+Y;if(1<arguments.length){Q+="?args[]="+encodeURIComponent(arguments[1]);for(var W=2;W<arguments.length;W++)Q+="&args[]="+encodeURIComponent(arguments[W])}return"Minified React error #"+Y+"; visit "+Q+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function U(){}var F={d:{f:U,r:function(){throw Error(j(522))},D:U,C:U,L:U,m:U,X:U,S:U,M:U},p:0,findDOMNode:null},B=Symbol.for("react.portal");function q(Y,Q,W){var Z=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:Z==null?null:""+Z,children:Y,containerInfo:Q,implementation:W}}var z=V.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function G(Y,Q){if(Y==="font")return"";if(typeof Q=="string")return Q==="use-credentials"?Q:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,reactDom_production.createPortal=function(Y,Q){var W=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q||Q.nodeType!==1&&Q.nodeType!==9&&Q.nodeType!==11)throw Error(j(299));return q(Y,Q,null,W)},reactDom_production.flushSync=function(Y){var Q=z.T,W=F.p;try{if(z.T=null,F.p=2,Y)return Y()}finally{z.T=Q,F.p=W,F.d.f()}},reactDom_production.preconnect=function(Y,Q){typeof Y=="string"&&(Q?(Q=Q.crossOrigin,Q=typeof Q=="string"?Q==="use-credentials"?Q:"":void 0):Q=null,F.d.C(Y,Q))},reactDom_production.prefetchDNS=function(Y){typeof Y=="string"&&F.d.D(Y)},reactDom_production.preinit=function(Y,Q){if(typeof Y=="string"&&Q&&typeof Q.as=="string"){var W=Q.as,Z=G(W,Q.crossOrigin),ee=typeof Q.integrity=="string"?Q.integrity:void 0,ne=typeof Q.fetchPriority=="string"?Q.fetchPriority:void 0;W==="style"?F.d.S(Y,typeof Q.precedence=="string"?Q.precedence:void 0,{crossOrigin:Z,integrity:ee,fetchPriority:ne}):W==="script"&&F.d.X(Y,{crossOrigin:Z,integrity:ee,fetchPriority:ne,nonce:typeof Q.nonce=="string"?Q.nonce:void 0})}},reactDom_production.preinitModule=function(Y,Q){if(typeof Y=="string")if(typeof Q=="object"&&Q!==null){if(Q.as==null||Q.as==="script"){var W=G(Q.as,Q.crossOrigin);F.d.M(Y,{crossOrigin:W,integrity:typeof Q.integrity=="string"?Q.integrity:void 0,nonce:typeof Q.nonce=="string"?Q.nonce:void 0})}}else Q==null&&F.d.M(Y)},reactDom_production.preload=function(Y,Q){if(typeof Y=="string"&&typeof Q=="object"&&Q!==null&&typeof Q.as=="string"){var W=Q.as,Z=G(W,Q.crossOrigin);F.d.L(Y,W,{crossOrigin:Z,integrity:typeof Q.integrity=="string"?Q.integrity:void 0,nonce:typeof Q.nonce=="string"?Q.nonce:void 0,type:typeof Q.type=="string"?Q.type:void 0,fetchPriority:typeof Q.fetchPriority=="string"?Q.fetchPriority:void 0,referrerPolicy:typeof Q.referrerPolicy=="string"?Q.referrerPolicy:void 0,imageSrcSet:typeof Q.imageSrcSet=="string"?Q.imageSrcSet:void 0,imageSizes:typeof Q.imageSizes=="string"?Q.imageSizes:void 0,media:typeof Q.media=="string"?Q.media:void 0})}},reactDom_production.preloadModule=function(Y,Q){if(typeof Y=="string")if(Q){var W=G(Q.as,Q.crossOrigin);F.d.m(Y,{as:typeof Q.as=="string"&&Q.as!=="script"?Q.as:void 0,crossOrigin:W,integrity:typeof Q.integrity=="string"?Q.integrity:void 0})}else F.d.m(Y)},reactDom_production.requestFormReset=function(Y){F.d.r(Y)},reactDom_production.unstable_batchedUpdates=function(Y,Q){return Y(Q)},reactDom_production.useFormState=function(Y,Q,W){return z.H.useFormState(Y,Q,W)},reactDom_production.useFormStatus=function(){return z.H.useHostTransitionStatus()},reactDom_production.version="19.1.1",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function V(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V)}catch(j){console.error(j)}}return V(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var V=requireScheduler(),j=requireReact(),U=requireReactDom();function F($){var H="https://react.dev/errors/"+$;if(1<arguments.length){H+="?args[]="+encodeURIComponent(arguments[1]);for(var K=2;K<arguments.length;K++)H+="&args[]="+encodeURIComponent(arguments[K])}return"Minified React error #"+$+"; visit "+H+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function B($){return!(!$||$.nodeType!==1&&$.nodeType!==9&&$.nodeType!==11)}function q($){var H=$,K=$;if($.alternate)for(;H.return;)H=H.return;else{$=H;do H=$,(H.flags&4098)!==0&&(K=H.return),$=H.return;while($)}return H.tag===3?K:null}function z($){if($.tag===13){var H=$.memoizedState;if(H===null&&($=$.alternate,$!==null&&(H=$.memoizedState)),H!==null)return H.dehydrated}return null}function G($){if(q($)!==$)throw Error(F(188))}function Y($){var H=$.alternate;if(!H){if(H=q($),H===null)throw Error(F(188));return H!==$?null:$}for(var K=$,X=H;;){var te=K.return;if(te===null)break;var ie=te.alternate;if(ie===null){if(X=te.return,X!==null){K=X;continue}break}if(te.child===ie.child){for(ie=te.child;ie;){if(ie===K)return G(te),$;if(ie===X)return G(te),H;ie=ie.sibling}throw Error(F(188))}if(K.return!==X.return)K=te,X=ie;else{for(var ce=!1,me=te.child;me;){if(me===K){ce=!0,K=te,X=ie;break}if(me===X){ce=!0,X=te,K=ie;break}me=me.sibling}if(!ce){for(me=ie.child;me;){if(me===K){ce=!0,K=ie,X=te;break}if(me===X){ce=!0,X=ie,K=te;break}me=me.sibling}if(!ce)throw Error(F(189))}}if(K.alternate!==X)throw Error(F(190))}if(K.tag!==3)throw Error(F(188));return K.stateNode.current===K?$:H}function Q($){var H=$.tag;if(H===5||H===26||H===27||H===6)return $;for($=$.child;$!==null;){if(H=Q($),H!==null)return H;$=$.sibling}return null}var W=Object.assign,Z=Symbol.for("react.element"),ee=Symbol.for("react.transitional.element"),ne=Symbol.for("react.portal"),ae=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),de=Symbol.for("react.profiler"),oe=Symbol.for("react.provider"),ue=Symbol.for("react.consumer"),he=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),Ee=Symbol.for("react.lazy"),ke=Symbol.for("react.activity"),Ae=Symbol.for("react.memo_cache_sentinel"),be=Symbol.iterator;function Le($){return $===null||typeof $!="object"?null:($=be&&$[be]||$["@@iterator"],typeof $=="function"?$:null)}var Fe=Symbol.for("react.client.reference");function Ne($){if($==null)return null;if(typeof $=="function")return $.$$typeof===Fe?null:$.displayName||$.name||null;if(typeof $=="string")return $;switch($){case ae:return"Fragment";case de:return"Profiler";case se:return"StrictMode";case fe:return"Suspense";case pe:return"SuspenseList";case ke:return"Activity"}if(typeof $=="object")switch($.$$typeof){case ne:return"Portal";case he:return($.displayName||"Context")+".Provider";case ue:return($._context.displayName||"Context")+".Consumer";case ye:var H=$.render;return $=$.displayName,$||($=H.displayName||H.name||"",$=$!==""?"ForwardRef("+$+")":"ForwardRef"),$;case xe:return H=$.displayName||null,H!==null?H:Ne($.type)||"Memo";case Ee:H=$._payload,$=$._init;try{return Ne($(H))}catch{}}return null}var Ve=Array.isArray,Te=j.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Oe=U.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ue={pending:!1,data:null,method:null,action:null},Ye=[],le=-1;function we($){return{current:$}}function He($){0>le||($.current=Ye[le],Ye[le]=null,le--)}function ge($,H){le++,Ye[le]=$.current,$.current=H}var We=we(null),at=we(null),$e=we(null),ht=we(null);function ut($,H){switch(ge($e,H),ge(at,$),ge(We,null),H.nodeType){case 9:case 11:$=($=H.documentElement)&&($=$.namespaceURI)?oh($):0;break;default:if($=H.tagName,H=H.namespaceURI)H=oh(H),$=lh(H,$);else switch($){case"svg":$=1;break;case"math":$=2;break;default:$=0}}He(We),ge(We,$)}function ft(){He(We),He(at),He($e)}function $t($){$.memoizedState!==null&&ge(ht,$);var H=We.current,K=lh(H,$.type);H!==K&&(ge(at,$),ge(We,K))}function Mt($){at.current===$&&(He(We),He(at)),ht.current===$&&(He(ht),ba._currentValue=Ue)}var Nn=Object.prototype.hasOwnProperty,Qt=V.unstable_scheduleCallback,tn=V.unstable_cancelCallback,Gt=V.unstable_shouldYield,cn=V.unstable_requestPaint,bt=V.unstable_now,dn=V.unstable_getCurrentPriorityLevel,At=V.unstable_ImmediatePriority,Wt=V.unstable_UserBlockingPriority,nn=V.unstable_NormalPriority,De=V.unstable_LowPriority,Xe=V.unstable_IdlePriority,et=V.log,tt=V.unstable_setDisableYieldValue,_e=null,je=null;function nt($){if(typeof et=="function"&&tt($),je&&typeof je.setStrictMode=="function")try{je.setStrictMode(_e,$)}catch{}}var it=Math.clz32?Math.clz32:yn,pt=Math.log,Vt=Math.LN2;function yn($){return $>>>=0,$===0?32:31-(pt($)/Vt|0)|0}var xt=256,ze=4194304;function Be($){var H=$&42;if(H!==0)return H;switch($&-$){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return $&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return $&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return $}}function Ge($,H,K){var X=$.pendingLanes;if(X===0)return 0;var te=0,ie=$.suspendedLanes,ce=$.pingedLanes;$=$.warmLanes;var me=X&134217727;return me!==0?(X=me&~ie,X!==0?te=Be(X):(ce&=me,ce!==0?te=Be(ce):K||(K=me&~$,K!==0&&(te=Be(K))))):(me=X&~ie,me!==0?te=Be(me):ce!==0?te=Be(ce):K||(K=X&~$,K!==0&&(te=Be(K)))),te===0?0:H!==0&&H!==te&&(H&ie)===0&&(ie=te&-te,K=H&-H,ie>=K||ie===32&&(K&4194048)!==0)?H:te}function Je($,H){return($.pendingLanes&~($.suspendedLanes&~$.pingedLanes)&H)===0}function Ze($,H){switch($){case 1:case 2:case 4:case 8:case 64:return H+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return H+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dt(){var $=xt;return xt<<=1,(xt&4194048)===0&&(xt=256),$}function Pt(){var $=ze;return ze<<=1,(ze&62914560)===0&&(ze=4194304),$}function qt($){for(var H=[],K=0;31>K;K++)H.push($);return H}function Ut($,H){$.pendingLanes|=H,H!==268435456&&($.suspendedLanes=0,$.pingedLanes=0,$.warmLanes=0)}function zi($,H,K,X,te,ie){var ce=$.pendingLanes;$.pendingLanes=K,$.suspendedLanes=0,$.pingedLanes=0,$.warmLanes=0,$.expiredLanes&=K,$.entangledLanes&=K,$.errorRecoveryDisabledLanes&=K,$.shellSuspendCounter=0;var me=$.entanglements,ve=$.expirationTimes,Pe=$.hiddenUpdates;for(K=ce&~K;0<K;){var qe=31-it(K),Qe=1<<qe;me[qe]=0,ve[qe]=-1;var Me=Pe[qe];if(Me!==null)for(Pe[qe]=null,qe=0;qe<Me.length;qe++){var Ie=Me[qe];Ie!==null&&(Ie.lane&=-536870913)}K&=~Qe}X!==0&&Is($,X,0),ie!==0&&te===0&&$.tag!==0&&($.suspendedLanes|=ie&~(ce&~H))}function Is($,H,K){$.pendingLanes|=H,$.suspendedLanes&=~H;var X=31-it(H);$.entangledLanes|=H,$.entanglements[X]=$.entanglements[X]|1073741824|K&4194090}function Hi($,H){var K=$.entangledLanes|=H;for($=$.entanglements;K;){var X=31-it(K),te=1<<X;te&H|$[X]&H&&($[X]|=H),K&=~te}}function Ls($){switch($){case 2:$=1;break;case 8:$=4;break;case 32:$=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:$=128;break;case 268435456:$=134217728;break;default:$=0}return $}function js($){return $&=-$,2<$?8<$?($&134217727)!==0?32:268435456:8:2}function Kl(){var $=Oe.p;return $!==0?$:($=window.event,$===void 0?32:Rh($.type))}function Nh($,H){var K=Oe.p;try{return Oe.p=$,H()}finally{Oe.p=K}}var ri=Math.random().toString(36).slice(2),on="__reactFiber$"+ri,hn="__reactProps$"+ri,Gi="__reactContainer$"+ri,Vs="__reactEvents$"+ri,Ih="__reactListeners$"+ri,Lh="__reactHandles$"+ri,Yl="__reactResources$"+ri,Or="__reactMarker$"+ri;function Us($){delete $[on],delete $[hn],delete $[Vs],delete $[Ih],delete $[Lh]}function Ki($){var H=$[on];if(H)return H;for(var K=$.parentNode;K;){if(H=K[Gi]||K[on]){if(K=H.alternate,H.child!==null||K!==null&&K.child!==null)for($=hh($);$!==null;){if(K=$[on])return K;$=hh($)}return H}$=K,K=$.parentNode}return null}function Yi($){if($=$[on]||$[Gi]){var H=$.tag;if(H===5||H===6||H===13||H===26||H===27||H===3)return $}return null}function Dr($){var H=$.tag;if(H===5||H===26||H===27||H===6)return $.stateNode;throw Error(F(33))}function Qi($){var H=$[Yl];return H||(H=$[Yl]={hoistableStyles:new Map,hoistableScripts:new Map}),H}function Xt($){$[Or]=!0}var Ql=new Set,Wl={};function _i($,H){Wi($,H),Wi($+"Capture",H)}function Wi($,H){for(Wl[$]=H,$=0;$<H.length;$++)Ql.add(H[$])}var jh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xl={},Jl={};function Vh($){return Nn.call(Jl,$)?!0:Nn.call(Xl,$)?!1:jh.test($)?Jl[$]=!0:(Xl[$]=!0,!1)}function Ca($,H,K){if(Vh(H))if(K===null)$.removeAttribute(H);else{switch(typeof K){case"undefined":case"function":case"symbol":$.removeAttribute(H);return;case"boolean":var X=H.toLowerCase().slice(0,5);if(X!=="data-"&&X!=="aria-"){$.removeAttribute(H);return}}$.setAttribute(H,""+K)}}function wa($,H,K){if(K===null)$.removeAttribute(H);else{switch(typeof K){case"undefined":case"function":case"symbol":case"boolean":$.removeAttribute(H);return}$.setAttribute(H,""+K)}}function qn($,H,K,X){if(X===null)$.removeAttribute(K);else{switch(typeof X){case"undefined":case"function":case"symbol":case"boolean":$.removeAttribute(K);return}$.setAttributeNS(H,K,""+X)}}var Fs,Zl;function Xi($){if(Fs===void 0)try{throw Error()}catch(K){var H=K.stack.trim().match(/\n( *(at )?)/);Fs=H&&H[1]||"",Zl=-1<K.stack.indexOf(`
    at`)?" (<anonymous>)":-1<K.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fs+$+Zl}var Bs=!1;function $s($,H){if(!$||Bs)return"";Bs=!0;var K=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var X={DetermineComponentFrameRoot:function(){try{if(H){var Qe=function(){throw Error()};if(Object.defineProperty(Qe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qe,[])}catch(Ie){var Me=Ie}Reflect.construct($,[],Qe)}else{try{Qe.call()}catch(Ie){Me=Ie}$.call(Qe.prototype)}}else{try{throw Error()}catch(Ie){Me=Ie}(Qe=$())&&typeof Qe.catch=="function"&&Qe.catch(function(){})}}catch(Ie){if(Ie&&Me&&typeof Ie.stack=="string")return[Ie.stack,Me.stack]}return[null,null]}};X.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var te=Object.getOwnPropertyDescriptor(X.DetermineComponentFrameRoot,"name");te&&te.configurable&&Object.defineProperty(X.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ie=X.DetermineComponentFrameRoot(),ce=ie[0],me=ie[1];if(ce&&me){var ve=ce.split(`
`),Pe=me.split(`
`);for(te=X=0;X<ve.length&&!ve[X].includes("DetermineComponentFrameRoot");)X++;for(;te<Pe.length&&!Pe[te].includes("DetermineComponentFrameRoot");)te++;if(X===ve.length||te===Pe.length)for(X=ve.length-1,te=Pe.length-1;1<=X&&0<=te&&ve[X]!==Pe[te];)te--;for(;1<=X&&0<=te;X--,te--)if(ve[X]!==Pe[te]){if(X!==1||te!==1)do if(X--,te--,0>te||ve[X]!==Pe[te]){var qe=`
`+ve[X].replace(" at new "," at ");return $.displayName&&qe.includes("<anonymous>")&&(qe=qe.replace("<anonymous>",$.displayName)),qe}while(1<=X&&0<=te);break}}}finally{Bs=!1,Error.prepareStackTrace=K}return(K=$?$.displayName||$.name:"")?Xi(K):""}function Uh($){switch($.tag){case 26:case 27:case 5:return Xi($.type);case 16:return Xi("Lazy");case 13:return Xi("Suspense");case 19:return Xi("SuspenseList");case 0:case 15:return $s($.type,!1);case 11:return $s($.type.render,!1);case 1:return $s($.type,!0);case 31:return Xi("Activity");default:return""}}function ec($){try{var H="";do H+=Uh($),$=$.return;while($);return H}catch(K){return`
Error generating stack: `+K.message+`
`+K.stack}}function Cn($){switch(typeof $){case"bigint":case"boolean":case"number":case"string":case"undefined":return $;case"object":return $;default:return""}}function tc($){var H=$.type;return($=$.nodeName)&&$.toLowerCase()==="input"&&(H==="checkbox"||H==="radio")}function Fh($){var H=tc($)?"checked":"value",K=Object.getOwnPropertyDescriptor($.constructor.prototype,H),X=""+$[H];if(!$.hasOwnProperty(H)&&typeof K<"u"&&typeof K.get=="function"&&typeof K.set=="function"){var te=K.get,ie=K.set;return Object.defineProperty($,H,{configurable:!0,get:function(){return te.call(this)},set:function(ce){X=""+ce,ie.call(this,ce)}}),Object.defineProperty($,H,{enumerable:K.enumerable}),{getValue:function(){return X},setValue:function(ce){X=""+ce},stopTracking:function(){$._valueTracker=null,delete $[H]}}}}function _a($){$._valueTracker||($._valueTracker=Fh($))}function nc($){if(!$)return!1;var H=$._valueTracker;if(!H)return!0;var K=H.getValue(),X="";return $&&(X=tc($)?$.checked?"true":"false":$.value),$=X,$!==K?(H.setValue($),!0):!1}function Ra($){if($=$||(typeof document<"u"?document:void 0),typeof $>"u")return null;try{return $.activeElement||$.body}catch{return $.body}}var Bh=/[\n"\\]/g;function wn($){return $.replace(Bh,function(H){return"\\"+H.charCodeAt(0).toString(16)+" "})}function qs($,H,K,X,te,ie,ce,me){$.name="",ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?$.type=ce:$.removeAttribute("type"),H!=null?ce==="number"?(H===0&&$.value===""||$.value!=H)&&($.value=""+Cn(H)):$.value!==""+Cn(H)&&($.value=""+Cn(H)):ce!=="submit"&&ce!=="reset"||$.removeAttribute("value"),H!=null?zs($,ce,Cn(H)):K!=null?zs($,ce,Cn(K)):X!=null&&$.removeAttribute("value"),te==null&&ie!=null&&($.defaultChecked=!!ie),te!=null&&($.checked=te&&typeof te!="function"&&typeof te!="symbol"),me!=null&&typeof me!="function"&&typeof me!="symbol"&&typeof me!="boolean"?$.name=""+Cn(me):$.removeAttribute("name")}function ic($,H,K,X,te,ie,ce,me){if(ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"&&($.type=ie),H!=null||K!=null){if(!(ie!=="submit"&&ie!=="reset"||H!=null))return;K=K!=null?""+Cn(K):"",H=H!=null?""+Cn(H):K,me||H===$.value||($.value=H),$.defaultValue=H}X=X??te,X=typeof X!="function"&&typeof X!="symbol"&&!!X,$.checked=me?$.checked:!!X,$.defaultChecked=!!X,ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"&&($.name=ce)}function zs($,H,K){H==="number"&&Ra($.ownerDocument)===$||$.defaultValue===""+K||($.defaultValue=""+K)}function Ji($,H,K,X){if($=$.options,H){H={};for(var te=0;te<K.length;te++)H["$"+K[te]]=!0;for(K=0;K<$.length;K++)te=H.hasOwnProperty("$"+$[K].value),$[K].selected!==te&&($[K].selected=te),te&&X&&($[K].defaultSelected=!0)}else{for(K=""+Cn(K),H=null,te=0;te<$.length;te++){if($[te].value===K){$[te].selected=!0,X&&($[te].defaultSelected=!0);return}H!==null||$[te].disabled||(H=$[te])}H!==null&&(H.selected=!0)}}function rc($,H,K){if(H!=null&&(H=""+Cn(H),H!==$.value&&($.value=H),K==null)){$.defaultValue!==H&&($.defaultValue=H);return}$.defaultValue=K!=null?""+Cn(K):""}function ac($,H,K,X){if(H==null){if(X!=null){if(K!=null)throw Error(F(92));if(Ve(X)){if(1<X.length)throw Error(F(93));X=X[0]}K=X}K==null&&(K=""),H=K}K=Cn(H),$.defaultValue=K,X=$.textContent,X===K&&X!==""&&X!==null&&($.value=X)}function Zi($,H){if(H){var K=$.firstChild;if(K&&K===$.lastChild&&K.nodeType===3){K.nodeValue=H;return}}$.textContent=H}var $h=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sc($,H,K){var X=H.indexOf("--")===0;K==null||typeof K=="boolean"||K===""?X?$.setProperty(H,""):H==="float"?$.cssFloat="":$[H]="":X?$.setProperty(H,K):typeof K!="number"||K===0||$h.has(H)?H==="float"?$.cssFloat=K:$[H]=(""+K).trim():$[H]=K+"px"}function oc($,H,K){if(H!=null&&typeof H!="object")throw Error(F(62));if($=$.style,K!=null){for(var X in K)!K.hasOwnProperty(X)||H!=null&&H.hasOwnProperty(X)||(X.indexOf("--")===0?$.setProperty(X,""):X==="float"?$.cssFloat="":$[X]="");for(var te in H)X=H[te],H.hasOwnProperty(te)&&K[te]!==X&&sc($,te,X)}else for(var ie in H)H.hasOwnProperty(ie)&&sc($,ie,H[ie])}function Hs($){if($.indexOf("-")===-1)return!1;switch($){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Aa($){return zh.test(""+$)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":$}var Gs=null;function Ks($){return $=$.target||$.srcElement||window,$.correspondingUseElement&&($=$.correspondingUseElement),$.nodeType===3?$.parentNode:$}var er=null,tr=null;function lc($){var H=Yi($);if(H&&($=H.stateNode)){var K=$[hn]||null;e:switch($=H.stateNode,H.type){case"input":if(qs($,K.value,K.defaultValue,K.defaultValue,K.checked,K.defaultChecked,K.type,K.name),H=K.name,K.type==="radio"&&H!=null){for(K=$;K.parentNode;)K=K.parentNode;for(K=K.querySelectorAll('input[name="'+wn(""+H)+'"][type="radio"]'),H=0;H<K.length;H++){var X=K[H];if(X!==$&&X.form===$.form){var te=X[hn]||null;if(!te)throw Error(F(90));qs(X,te.value,te.defaultValue,te.defaultValue,te.checked,te.defaultChecked,te.type,te.name)}}for(H=0;H<K.length;H++)X=K[H],X.form===$.form&&nc(X)}break e;case"textarea":rc($,K.value,K.defaultValue);break e;case"select":H=K.value,H!=null&&Ji($,!!K.multiple,H,!1)}}}var Ys=!1;function cc($,H,K){if(Ys)return $(H,K);Ys=!0;try{var X=$(H);return X}finally{if(Ys=!1,(er!==null||tr!==null)&&(ps(),er&&(H=er,$=tr,tr=er=null,lc(H),$)))for(H=0;H<$.length;H++)lc($[H])}}function Mr($,H){var K=$.stateNode;if(K===null)return null;var X=K[hn]||null;if(X===null)return null;K=X[H];e:switch(H){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(X=!X.disabled)||($=$.type,X=!($==="button"||$==="input"||$==="select"||$==="textarea")),$=!X;break e;default:$=!1}if($)return null;if(K&&typeof K!="function")throw Error(F(231,H,typeof K));return K}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qs=!1;if(zn)try{var Nr={};Object.defineProperty(Nr,"passive",{get:function(){Qs=!0}}),window.addEventListener("test",Nr,Nr),window.removeEventListener("test",Nr,Nr)}catch{Qs=!1}var ai=null,Ws=null,Pa=null;function uc(){if(Pa)return Pa;var $,H=Ws,K=H.length,X,te="value"in ai?ai.value:ai.textContent,ie=te.length;for($=0;$<K&&H[$]===te[$];$++);var ce=K-$;for(X=1;X<=ce&&H[K-X]===te[ie-X];X++);return Pa=te.slice($,1<X?1-X:void 0)}function Oa($){var H=$.keyCode;return"charCode"in $?($=$.charCode,$===0&&H===13&&($=13)):$=H,$===10&&($=13),32<=$||$===13?$:0}function Da(){return!0}function dc(){return!1}function fn($){function H(K,X,te,ie,ce){this._reactName=K,this._targetInst=te,this.type=X,this.nativeEvent=ie,this.target=ce,this.currentTarget=null;for(var me in $)$.hasOwnProperty(me)&&(K=$[me],this[me]=K?K(ie):ie[me]);return this.isDefaultPrevented=(ie.defaultPrevented!=null?ie.defaultPrevented:ie.returnValue===!1)?Da:dc,this.isPropagationStopped=dc,this}return W(H.prototype,{preventDefault:function(){this.defaultPrevented=!0;var K=this.nativeEvent;K&&(K.preventDefault?K.preventDefault():typeof K.returnValue!="unknown"&&(K.returnValue=!1),this.isDefaultPrevented=Da)},stopPropagation:function(){var K=this.nativeEvent;K&&(K.stopPropagation?K.stopPropagation():typeof K.cancelBubble!="unknown"&&(K.cancelBubble=!0),this.isPropagationStopped=Da)},persist:function(){},isPersistent:Da}),H}var Ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function($){return $.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ma=fn(Ri),Ir=W({},Ri,{view:0,detail:0}),Hh=fn(Ir),Xs,Js,Lr,Na=W({},Ir,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eo,button:0,buttons:0,relatedTarget:function($){return $.relatedTarget===void 0?$.fromElement===$.srcElement?$.toElement:$.fromElement:$.relatedTarget},movementX:function($){return"movementX"in $?$.movementX:($!==Lr&&(Lr&&$.type==="mousemove"?(Xs=$.screenX-Lr.screenX,Js=$.screenY-Lr.screenY):Js=Xs=0,Lr=$),Xs)},movementY:function($){return"movementY"in $?$.movementY:Js}}),hc=fn(Na),Gh=W({},Na,{dataTransfer:0}),Kh=fn(Gh),Yh=W({},Ir,{relatedTarget:0}),Zs=fn(Yh),Qh=W({},Ri,{animationName:0,elapsedTime:0,pseudoElement:0}),Wh=fn(Qh),Xh=W({},Ri,{clipboardData:function($){return"clipboardData"in $?$.clipboardData:window.clipboardData}}),Jh=fn(Xh),Zh=W({},Ri,{data:0}),fc=fn(Zh),ef={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rf($){var H=this.nativeEvent;return H.getModifierState?H.getModifierState($):($=nf[$])?!!H[$]:!1}function eo(){return rf}var af=W({},Ir,{key:function($){if($.key){var H=ef[$.key]||$.key;if(H!=="Unidentified")return H}return $.type==="keypress"?($=Oa($),$===13?"Enter":String.fromCharCode($)):$.type==="keydown"||$.type==="keyup"?tf[$.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eo,charCode:function($){return $.type==="keypress"?Oa($):0},keyCode:function($){return $.type==="keydown"||$.type==="keyup"?$.keyCode:0},which:function($){return $.type==="keypress"?Oa($):$.type==="keydown"||$.type==="keyup"?$.keyCode:0}}),sf=fn(af),of=W({},Na,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pc=fn(of),lf=W({},Ir,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eo}),cf=fn(lf),uf=W({},Ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),df=fn(uf),hf=W({},Na,{deltaX:function($){return"deltaX"in $?$.deltaX:"wheelDeltaX"in $?-$.wheelDeltaX:0},deltaY:function($){return"deltaY"in $?$.deltaY:"wheelDeltaY"in $?-$.wheelDeltaY:"wheelDelta"in $?-$.wheelDelta:0},deltaZ:0,deltaMode:0}),ff=fn(hf),pf=W({},Ri,{newState:0,oldState:0}),mf=fn(pf),gf=[9,13,27,32],to=zn&&"CompositionEvent"in window,jr=null;zn&&"documentMode"in document&&(jr=document.documentMode);var yf=zn&&"TextEvent"in window&&!jr,mc=zn&&(!to||jr&&8<jr&&11>=jr),gc=" ",yc=!1;function vc($,H){switch($){case"keyup":return gf.indexOf(H.keyCode)!==-1;case"keydown":return H.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xc($){return $=$.detail,typeof $=="object"&&"data"in $?$.data:null}var nr=!1;function vf($,H){switch($){case"compositionend":return xc(H);case"keypress":return H.which!==32?null:(yc=!0,gc);case"textInput":return $=H.data,$===gc&&yc?null:$;default:return null}}function xf($,H){if(nr)return $==="compositionend"||!to&&vc($,H)?($=uc(),Pa=Ws=ai=null,nr=!1,$):null;switch($){case"paste":return null;case"keypress":if(!(H.ctrlKey||H.altKey||H.metaKey)||H.ctrlKey&&H.altKey){if(H.char&&1<H.char.length)return H.char;if(H.which)return String.fromCharCode(H.which)}return null;case"compositionend":return mc&&H.locale!=="ko"?null:H.data;default:return null}}var bf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bc($){var H=$&&$.nodeName&&$.nodeName.toLowerCase();return H==="input"?!!bf[$.type]:H==="textarea"}function Sc($,H,K,X){er?tr?tr.push(X):tr=[X]:er=X,H=bs(H,"onChange"),0<H.length&&(K=new Ma("onChange","change",null,K,X),$.push({event:K,listeners:H}))}var Vr=null,Ur=null;function Sf($){nh($,0)}function Ia($){var H=Dr($);if(nc(H))return $}function Tc($,H){if($==="change")return H}var kc=!1;if(zn){var no;if(zn){var io="oninput"in document;if(!io){var Ec=document.createElement("div");Ec.setAttribute("oninput","return;"),io=typeof Ec.oninput=="function"}no=io}else no=!1;kc=no&&(!document.documentMode||9<document.documentMode)}function Cc(){Vr&&(Vr.detachEvent("onpropertychange",wc),Ur=Vr=null)}function wc($){if($.propertyName==="value"&&Ia(Ur)){var H=[];Sc(H,Ur,$,Ks($)),cc(Sf,H)}}function Tf($,H,K){$==="focusin"?(Cc(),Vr=H,Ur=K,Vr.attachEvent("onpropertychange",wc)):$==="focusout"&&Cc()}function kf($){if($==="selectionchange"||$==="keyup"||$==="keydown")return Ia(Ur)}function Ef($,H){if($==="click")return Ia(H)}function Cf($,H){if($==="input"||$==="change")return Ia(H)}function wf($,H){return $===H&&($!==0||1/$===1/H)||$!==$&&H!==H}var vn=typeof Object.is=="function"?Object.is:wf;function Fr($,H){if(vn($,H))return!0;if(typeof $!="object"||$===null||typeof H!="object"||H===null)return!1;var K=Object.keys($),X=Object.keys(H);if(K.length!==X.length)return!1;for(X=0;X<K.length;X++){var te=K[X];if(!Nn.call(H,te)||!vn($[te],H[te]))return!1}return!0}function _c($){for(;$&&$.firstChild;)$=$.firstChild;return $}function Rc($,H){var K=_c($);$=0;for(var X;K;){if(K.nodeType===3){if(X=$+K.textContent.length,$<=H&&X>=H)return{node:K,offset:H-$};$=X}e:{for(;K;){if(K.nextSibling){K=K.nextSibling;break e}K=K.parentNode}K=void 0}K=_c(K)}}function Ac($,H){return $&&H?$===H?!0:$&&$.nodeType===3?!1:H&&H.nodeType===3?Ac($,H.parentNode):"contains"in $?$.contains(H):$.compareDocumentPosition?!!($.compareDocumentPosition(H)&16):!1:!1}function Pc($){$=$!=null&&$.ownerDocument!=null&&$.ownerDocument.defaultView!=null?$.ownerDocument.defaultView:window;for(var H=Ra($.document);H instanceof $.HTMLIFrameElement;){try{var K=typeof H.contentWindow.location.href=="string"}catch{K=!1}if(K)$=H.contentWindow;else break;H=Ra($.document)}return H}function ro($){var H=$&&$.nodeName&&$.nodeName.toLowerCase();return H&&(H==="input"&&($.type==="text"||$.type==="search"||$.type==="tel"||$.type==="url"||$.type==="password")||H==="textarea"||$.contentEditable==="true")}var _f=zn&&"documentMode"in document&&11>=document.documentMode,ir=null,ao=null,Br=null,so=!1;function Oc($,H,K){var X=K.window===K?K.document:K.nodeType===9?K:K.ownerDocument;so||ir==null||ir!==Ra(X)||(X=ir,"selectionStart"in X&&ro(X)?X={start:X.selectionStart,end:X.selectionEnd}:(X=(X.ownerDocument&&X.ownerDocument.defaultView||window).getSelection(),X={anchorNode:X.anchorNode,anchorOffset:X.anchorOffset,focusNode:X.focusNode,focusOffset:X.focusOffset}),Br&&Fr(Br,X)||(Br=X,X=bs(ao,"onSelect"),0<X.length&&(H=new Ma("onSelect","select",null,H,K),$.push({event:H,listeners:X}),H.target=ir)))}function Ai($,H){var K={};return K[$.toLowerCase()]=H.toLowerCase(),K["Webkit"+$]="webkit"+H,K["Moz"+$]="moz"+H,K}var rr={animationend:Ai("Animation","AnimationEnd"),animationiteration:Ai("Animation","AnimationIteration"),animationstart:Ai("Animation","AnimationStart"),transitionrun:Ai("Transition","TransitionRun"),transitionstart:Ai("Transition","TransitionStart"),transitioncancel:Ai("Transition","TransitionCancel"),transitionend:Ai("Transition","TransitionEnd")},oo={},Dc={};zn&&(Dc=document.createElement("div").style,"AnimationEvent"in window||(delete rr.animationend.animation,delete rr.animationiteration.animation,delete rr.animationstart.animation),"TransitionEvent"in window||delete rr.transitionend.transition);function Pi($){if(oo[$])return oo[$];if(!rr[$])return $;var H=rr[$],K;for(K in H)if(H.hasOwnProperty(K)&&K in Dc)return oo[$]=H[K];return $}var Mc=Pi("animationend"),Nc=Pi("animationiteration"),Ic=Pi("animationstart"),Rf=Pi("transitionrun"),Af=Pi("transitionstart"),Pf=Pi("transitioncancel"),Lc=Pi("transitionend"),jc=new Map,lo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lo.push("scrollEnd");function In($,H){jc.set($,H),_i(H,[$])}var Vc=new WeakMap;function _n($,H){if(typeof $=="object"&&$!==null){var K=Vc.get($);return K!==void 0?K:(H={value:$,source:H,stack:ec(H)},Vc.set($,H),H)}return{value:$,source:H,stack:ec(H)}}var Rn=[],ar=0,co=0;function La(){for(var $=ar,H=co=ar=0;H<$;){var K=Rn[H];Rn[H++]=null;var X=Rn[H];Rn[H++]=null;var te=Rn[H];Rn[H++]=null;var ie=Rn[H];if(Rn[H++]=null,X!==null&&te!==null){var ce=X.pending;ce===null?te.next=te:(te.next=ce.next,ce.next=te),X.pending=te}ie!==0&&Uc(K,te,ie)}}function ja($,H,K,X){Rn[ar++]=$,Rn[ar++]=H,Rn[ar++]=K,Rn[ar++]=X,co|=X,$.lanes|=X,$=$.alternate,$!==null&&($.lanes|=X)}function uo($,H,K,X){return ja($,H,K,X),Va($)}function sr($,H){return ja($,null,null,H),Va($)}function Uc($,H,K){$.lanes|=K;var X=$.alternate;X!==null&&(X.lanes|=K);for(var te=!1,ie=$.return;ie!==null;)ie.childLanes|=K,X=ie.alternate,X!==null&&(X.childLanes|=K),ie.tag===22&&($=ie.stateNode,$===null||$._visibility&1||(te=!0)),$=ie,ie=ie.return;return $.tag===3?(ie=$.stateNode,te&&H!==null&&(te=31-it(K),$=ie.hiddenUpdates,X=$[te],X===null?$[te]=[H]:X.push(H),H.lane=K|536870912),ie):null}function Va($){if(50<ha)throw ha=0,yl=null,Error(F(185));for(var H=$.return;H!==null;)$=H,H=$.return;return $.tag===3?$.stateNode:null}var or={};function Of($,H,K,X){this.tag=$,this.key=K,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=H,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=X,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn($,H,K,X){return new Of($,H,K,X)}function ho($){return $=$.prototype,!(!$||!$.isReactComponent)}function Hn($,H){var K=$.alternate;return K===null?(K=xn($.tag,H,$.key,$.mode),K.elementType=$.elementType,K.type=$.type,K.stateNode=$.stateNode,K.alternate=$,$.alternate=K):(K.pendingProps=H,K.type=$.type,K.flags=0,K.subtreeFlags=0,K.deletions=null),K.flags=$.flags&65011712,K.childLanes=$.childLanes,K.lanes=$.lanes,K.child=$.child,K.memoizedProps=$.memoizedProps,K.memoizedState=$.memoizedState,K.updateQueue=$.updateQueue,H=$.dependencies,K.dependencies=H===null?null:{lanes:H.lanes,firstContext:H.firstContext},K.sibling=$.sibling,K.index=$.index,K.ref=$.ref,K.refCleanup=$.refCleanup,K}function Fc($,H){$.flags&=65011714;var K=$.alternate;return K===null?($.childLanes=0,$.lanes=H,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=K.childLanes,$.lanes=K.lanes,$.child=K.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=K.memoizedProps,$.memoizedState=K.memoizedState,$.updateQueue=K.updateQueue,$.type=K.type,H=K.dependencies,$.dependencies=H===null?null:{lanes:H.lanes,firstContext:H.firstContext}),$}function Ua($,H,K,X,te,ie){var ce=0;if(X=$,typeof $=="function")ho($)&&(ce=1);else if(typeof $=="string")ce=Mp($,K,We.current)?26:$==="html"||$==="head"||$==="body"?27:5;else e:switch($){case ke:return $=xn(31,K,H,te),$.elementType=ke,$.lanes=ie,$;case ae:return Oi(K.children,te,ie,H);case se:ce=8,te|=24;break;case de:return $=xn(12,K,H,te|2),$.elementType=de,$.lanes=ie,$;case fe:return $=xn(13,K,H,te),$.elementType=fe,$.lanes=ie,$;case pe:return $=xn(19,K,H,te),$.elementType=pe,$.lanes=ie,$;default:if(typeof $=="object"&&$!==null)switch($.$$typeof){case oe:case he:ce=10;break e;case ue:ce=9;break e;case ye:ce=11;break e;case xe:ce=14;break e;case Ee:ce=16,X=null;break e}ce=29,K=Error(F(130,$===null?"null":typeof $,"")),X=null}return H=xn(ce,K,H,te),H.elementType=$,H.type=X,H.lanes=ie,H}function Oi($,H,K,X){return $=xn(7,$,X,H),$.lanes=K,$}function fo($,H,K){return $=xn(6,$,null,H),$.lanes=K,$}function po($,H,K){return H=xn(4,$.children!==null?$.children:[],$.key,H),H.lanes=K,H.stateNode={containerInfo:$.containerInfo,pendingChildren:null,implementation:$.implementation},H}var lr=[],cr=0,Fa=null,Ba=0,An=[],Pn=0,Di=null,Gn=1,Kn="";function Mi($,H){lr[cr++]=Ba,lr[cr++]=Fa,Fa=$,Ba=H}function Bc($,H,K){An[Pn++]=Gn,An[Pn++]=Kn,An[Pn++]=Di,Di=$;var X=Gn;$=Kn;var te=32-it(X)-1;X&=~(1<<te),K+=1;var ie=32-it(H)+te;if(30<ie){var ce=te-te%5;ie=(X&(1<<ce)-1).toString(32),X>>=ce,te-=ce,Gn=1<<32-it(H)+te|K<<te|X,Kn=ie+$}else Gn=1<<ie|K<<te|X,Kn=$}function mo($){$.return!==null&&(Mi($,1),Bc($,1,0))}function go($){for(;$===Fa;)Fa=lr[--cr],lr[cr]=null,Ba=lr[--cr],lr[cr]=null;for(;$===Di;)Di=An[--Pn],An[Pn]=null,Kn=An[--Pn],An[Pn]=null,Gn=An[--Pn],An[Pn]=null}var un=null,Lt=null,kt=!1,Ni=null,Vn=!1,yo=Error(F(519));function Ii($){var H=Error(F(418,""));throw zr(_n(H,$)),yo}function $c($){var H=$.stateNode,K=$.type,X=$.memoizedProps;switch(H[on]=$,H[hn]=X,K){case"dialog":vt("cancel",H),vt("close",H);break;case"iframe":case"object":case"embed":vt("load",H);break;case"video":case"audio":for(K=0;K<pa.length;K++)vt(pa[K],H);break;case"source":vt("error",H);break;case"img":case"image":case"link":vt("error",H),vt("load",H);break;case"details":vt("toggle",H);break;case"input":vt("invalid",H),ic(H,X.value,X.defaultValue,X.checked,X.defaultChecked,X.type,X.name,!0),_a(H);break;case"select":vt("invalid",H);break;case"textarea":vt("invalid",H),ac(H,X.value,X.defaultValue,X.children),_a(H)}K=X.children,typeof K!="string"&&typeof K!="number"&&typeof K!="bigint"||H.textContent===""+K||X.suppressHydrationWarning===!0||sh(H.textContent,K)?(X.popover!=null&&(vt("beforetoggle",H),vt("toggle",H)),X.onScroll!=null&&vt("scroll",H),X.onScrollEnd!=null&&vt("scrollend",H),X.onClick!=null&&(H.onclick=Ss),H=!0):H=!1,H||Ii($)}function qc($){for(un=$.return;un;)switch(un.tag){case 5:case 13:Vn=!1;return;case 27:case 3:Vn=!0;return;default:un=un.return}}function $r($){if($!==un)return!1;if(!kt)return qc($),kt=!0,!1;var H=$.tag,K;if((K=H!==3&&H!==27)&&((K=H===5)&&(K=$.type,K=!(K!=="form"&&K!=="button")||Ml($.type,$.memoizedProps)),K=!K),K&&Lt&&Ii($),qc($),H===13){if($=$.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(F(317));e:{for($=$.nextSibling,H=0;$;){if($.nodeType===8)if(K=$.data,K==="/$"){if(H===0){Lt=jn($.nextSibling);break e}H--}else K!=="$"&&K!=="$!"&&K!=="$?"||H++;$=$.nextSibling}Lt=null}}else H===27?(H=Lt,Si($.type)?($=jl,jl=null,Lt=$):Lt=H):Lt=un?jn($.stateNode.nextSibling):null;return!0}function qr(){Lt=un=null,kt=!1}function zc(){var $=Ni;return $!==null&&(gn===null?gn=$:gn.push.apply(gn,$),Ni=null),$}function zr($){Ni===null?Ni=[$]:Ni.push($)}var vo=we(null),Li=null,Yn=null;function si($,H,K){ge(vo,H._currentValue),H._currentValue=K}function Qn($){$._currentValue=vo.current,He(vo)}function xo($,H,K){for(;$!==null;){var X=$.alternate;if(($.childLanes&H)!==H?($.childLanes|=H,X!==null&&(X.childLanes|=H)):X!==null&&(X.childLanes&H)!==H&&(X.childLanes|=H),$===K)break;$=$.return}}function bo($,H,K,X){var te=$.child;for(te!==null&&(te.return=$);te!==null;){var ie=te.dependencies;if(ie!==null){var ce=te.child;ie=ie.firstContext;e:for(;ie!==null;){var me=ie;ie=te;for(var ve=0;ve<H.length;ve++)if(me.context===H[ve]){ie.lanes|=K,me=ie.alternate,me!==null&&(me.lanes|=K),xo(ie.return,K,$),X||(ce=null);break e}ie=me.next}}else if(te.tag===18){if(ce=te.return,ce===null)throw Error(F(341));ce.lanes|=K,ie=ce.alternate,ie!==null&&(ie.lanes|=K),xo(ce,K,$),ce=null}else ce=te.child;if(ce!==null)ce.return=te;else for(ce=te;ce!==null;){if(ce===$){ce=null;break}if(te=ce.sibling,te!==null){te.return=ce.return,ce=te;break}ce=ce.return}te=ce}}function Hr($,H,K,X){$=null;for(var te=H,ie=!1;te!==null;){if(!ie){if((te.flags&524288)!==0)ie=!0;else if((te.flags&262144)!==0)break}if(te.tag===10){var ce=te.alternate;if(ce===null)throw Error(F(387));if(ce=ce.memoizedProps,ce!==null){var me=te.type;vn(te.pendingProps.value,ce.value)||($!==null?$.push(me):$=[me])}}else if(te===ht.current){if(ce=te.alternate,ce===null)throw Error(F(387));ce.memoizedState.memoizedState!==te.memoizedState.memoizedState&&($!==null?$.push(ba):$=[ba])}te=te.return}$!==null&&bo(H,$,K,X),H.flags|=262144}function $a($){for($=$.firstContext;$!==null;){if(!vn($.context._currentValue,$.memoizedValue))return!0;$=$.next}return!1}function ji($){Li=$,Yn=null,$=$.dependencies,$!==null&&($.firstContext=null)}function ln($){return Hc(Li,$)}function qa($,H){return Li===null&&ji($),Hc($,H)}function Hc($,H){var K=H._currentValue;if(H={context:H,memoizedValue:K,next:null},Yn===null){if($===null)throw Error(F(308));Yn=H,$.dependencies={lanes:0,firstContext:H},$.flags|=524288}else Yn=Yn.next=H;return K}var Df=typeof AbortController<"u"?AbortController:function(){var $=[],H=this.signal={aborted:!1,addEventListener:function(K,X){$.push(X)}};this.abort=function(){H.aborted=!0,$.forEach(function(K){return K()})}},Mf=V.unstable_scheduleCallback,Nf=V.unstable_NormalPriority,Kt={$$typeof:he,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function So(){return{controller:new Df,data:new Map,refCount:0}}function Gr($){$.refCount--,$.refCount===0&&Mf(Nf,function(){$.controller.abort()})}var Kr=null,To=0,ur=0,dr=null;function If($,H){if(Kr===null){var K=Kr=[];To=0,ur=El(),dr={status:"pending",value:void 0,then:function(X){K.push(X)}}}return To++,H.then(Gc,Gc),H}function Gc(){if(--To===0&&Kr!==null){dr!==null&&(dr.status="fulfilled");var $=Kr;Kr=null,ur=0,dr=null;for(var H=0;H<$.length;H++)(0,$[H])()}}function Lf($,H){var K=[],X={status:"pending",value:null,reason:null,then:function(te){K.push(te)}};return $.then(function(){X.status="fulfilled",X.value=H;for(var te=0;te<K.length;te++)(0,K[te])(H)},function(te){for(X.status="rejected",X.reason=te,te=0;te<K.length;te++)(0,K[te])(void 0)}),X}var Kc=Te.S;Te.S=function($,H){typeof H=="object"&&H!==null&&typeof H.then=="function"&&If($,H),Kc!==null&&Kc($,H)};var Vi=we(null);function ko(){var $=Vi.current;return $!==null?$:Dt.pooledCache}function za($,H){H===null?ge(Vi,Vi.current):ge(Vi,H.pool)}function Yc(){var $=ko();return $===null?null:{parent:Kt._currentValue,pool:$}}var Yr=Error(F(460)),Qc=Error(F(474)),Ha=Error(F(542)),Eo={then:function(){}};function Wc($){return $=$.status,$==="fulfilled"||$==="rejected"}function Ga(){}function Xc($,H,K){switch(K=$[K],K===void 0?$.push(H):K!==H&&(H.then(Ga,Ga),H=K),H.status){case"fulfilled":return H.value;case"rejected":throw $=H.reason,Zc($),$;default:if(typeof H.status=="string")H.then(Ga,Ga);else{if($=Dt,$!==null&&100<$.shellSuspendCounter)throw Error(F(482));$=H,$.status="pending",$.then(function(X){if(H.status==="pending"){var te=H;te.status="fulfilled",te.value=X}},function(X){if(H.status==="pending"){var te=H;te.status="rejected",te.reason=X}})}switch(H.status){case"fulfilled":return H.value;case"rejected":throw $=H.reason,Zc($),$}throw Qr=H,Yr}}var Qr=null;function Jc(){if(Qr===null)throw Error(F(459));var $=Qr;return Qr=null,$}function Zc($){if($===Yr||$===Ha)throw Error(F(483))}var oi=!1;function Co($){$.updateQueue={baseState:$.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wo($,H){$=$.updateQueue,H.updateQueue===$&&(H.updateQueue={baseState:$.baseState,firstBaseUpdate:$.firstBaseUpdate,lastBaseUpdate:$.lastBaseUpdate,shared:$.shared,callbacks:null})}function li($){return{lane:$,tag:0,payload:null,callback:null,next:null}}function ci($,H,K){var X=$.updateQueue;if(X===null)return null;if(X=X.shared,(Et&2)!==0){var te=X.pending;return te===null?H.next=H:(H.next=te.next,te.next=H),X.pending=H,H=Va($),Uc($,null,K),H}return ja($,X,H,K),Va($)}function Wr($,H,K){if(H=H.updateQueue,H!==null&&(H=H.shared,(K&4194048)!==0)){var X=H.lanes;X&=$.pendingLanes,K|=X,H.lanes=K,Hi($,K)}}function _o($,H){var K=$.updateQueue,X=$.alternate;if(X!==null&&(X=X.updateQueue,K===X)){var te=null,ie=null;if(K=K.firstBaseUpdate,K!==null){do{var ce={lane:K.lane,tag:K.tag,payload:K.payload,callback:null,next:null};ie===null?te=ie=ce:ie=ie.next=ce,K=K.next}while(K!==null);ie===null?te=ie=H:ie=ie.next=H}else te=ie=H;K={baseState:X.baseState,firstBaseUpdate:te,lastBaseUpdate:ie,shared:X.shared,callbacks:X.callbacks},$.updateQueue=K;return}$=K.lastBaseUpdate,$===null?K.firstBaseUpdate=H:$.next=H,K.lastBaseUpdate=H}var Ro=!1;function Xr(){if(Ro){var $=dr;if($!==null)throw $}}function Jr($,H,K,X){Ro=!1;var te=$.updateQueue;oi=!1;var ie=te.firstBaseUpdate,ce=te.lastBaseUpdate,me=te.shared.pending;if(me!==null){te.shared.pending=null;var ve=me,Pe=ve.next;ve.next=null,ce===null?ie=Pe:ce.next=Pe,ce=ve;var qe=$.alternate;qe!==null&&(qe=qe.updateQueue,me=qe.lastBaseUpdate,me!==ce&&(me===null?qe.firstBaseUpdate=Pe:me.next=Pe,qe.lastBaseUpdate=ve))}if(ie!==null){var Qe=te.baseState;ce=0,qe=Pe=ve=null,me=ie;do{var Me=me.lane&-536870913,Ie=Me!==me.lane;if(Ie?(St&Me)===Me:(X&Me)===Me){Me!==0&&Me===ur&&(Ro=!0),qe!==null&&(qe=qe.next={lane:0,tag:me.tag,payload:me.payload,callback:null,next:null});e:{var ct=$,ot=me;Me=H;var Rt=K;switch(ot.tag){case 1:if(ct=ot.payload,typeof ct=="function"){Qe=ct.call(Rt,Qe,Me);break e}Qe=ct;break e;case 3:ct.flags=ct.flags&-65537|128;case 0:if(ct=ot.payload,Me=typeof ct=="function"?ct.call(Rt,Qe,Me):ct,Me==null)break e;Qe=W({},Qe,Me);break e;case 2:oi=!0}}Me=me.callback,Me!==null&&($.flags|=64,Ie&&($.flags|=8192),Ie=te.callbacks,Ie===null?te.callbacks=[Me]:Ie.push(Me))}else Ie={lane:Me,tag:me.tag,payload:me.payload,callback:me.callback,next:null},qe===null?(Pe=qe=Ie,ve=Qe):qe=qe.next=Ie,ce|=Me;if(me=me.next,me===null){if(me=te.shared.pending,me===null)break;Ie=me,me=Ie.next,Ie.next=null,te.lastBaseUpdate=Ie,te.shared.pending=null}}while(!0);qe===null&&(ve=Qe),te.baseState=ve,te.firstBaseUpdate=Pe,te.lastBaseUpdate=qe,ie===null&&(te.shared.lanes=0),yi|=ce,$.lanes=ce,$.memoizedState=Qe}}function eu($,H){if(typeof $!="function")throw Error(F(191,$));$.call(H)}function tu($,H){var K=$.callbacks;if(K!==null)for($.callbacks=null,$=0;$<K.length;$++)eu(K[$],H)}var hr=we(null),Ka=we(0);function nu($,H){$=ni,ge(Ka,$),ge(hr,H),ni=$|H.baseLanes}function Ao(){ge(Ka,ni),ge(hr,hr.current)}function Po(){ni=Ka.current,He(hr),He(Ka)}var ui=0,mt=null,wt=null,zt=null,Ya=!1,fr=!1,Ui=!1,Qa=0,Zr=0,pr=null,jf=0;function Ft(){throw Error(F(321))}function Oo($,H){if(H===null)return!1;for(var K=0;K<H.length&&K<$.length;K++)if(!vn($[K],H[K]))return!1;return!0}function Do($,H,K,X,te,ie){return ui=ie,mt=H,H.memoizedState=null,H.updateQueue=null,H.lanes=0,Te.H=$===null||$.memoizedState===null?Uu:Fu,Ui=!1,ie=K(X,te),Ui=!1,fr&&(ie=ru(H,K,X,te)),iu($),ie}function iu($){Te.H=ts;var H=wt!==null&&wt.next!==null;if(ui=0,zt=wt=mt=null,Ya=!1,Zr=0,pr=null,H)throw Error(F(300));$===null||Jt||($=$.dependencies,$!==null&&$a($)&&(Jt=!0))}function ru($,H,K,X){mt=$;var te=0;do{if(fr&&(pr=null),Zr=0,fr=!1,25<=te)throw Error(F(301));if(te+=1,zt=wt=null,$.updateQueue!=null){var ie=$.updateQueue;ie.lastEffect=null,ie.events=null,ie.stores=null,ie.memoCache!=null&&(ie.memoCache.index=0)}Te.H=zf,ie=H(K,X)}while(fr);return ie}function Vf(){var $=Te.H,H=$.useState()[0];return H=typeof H.then=="function"?ea(H):H,$=$.useState()[0],(wt!==null?wt.memoizedState:null)!==$&&(mt.flags|=1024),H}function Mo(){var $=Qa!==0;return Qa=0,$}function No($,H,K){H.updateQueue=$.updateQueue,H.flags&=-2053,$.lanes&=~K}function Io($){if(Ya){for($=$.memoizedState;$!==null;){var H=$.queue;H!==null&&(H.pending=null),$=$.next}Ya=!1}ui=0,zt=wt=mt=null,fr=!1,Zr=Qa=0,pr=null}function pn(){var $={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?mt.memoizedState=zt=$:zt=zt.next=$,zt}function Ht(){if(wt===null){var $=mt.alternate;$=$!==null?$.memoizedState:null}else $=wt.next;var H=zt===null?mt.memoizedState:zt.next;if(H!==null)zt=H,wt=$;else{if($===null)throw mt.alternate===null?Error(F(467)):Error(F(310));wt=$,$={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},zt===null?mt.memoizedState=zt=$:zt=zt.next=$}return zt}function Lo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ea($){var H=Zr;return Zr+=1,pr===null&&(pr=[]),$=Xc(pr,$,H),H=mt,(zt===null?H.memoizedState:zt.next)===null&&(H=H.alternate,Te.H=H===null||H.memoizedState===null?Uu:Fu),$}function Wa($){if($!==null&&typeof $=="object"){if(typeof $.then=="function")return ea($);if($.$$typeof===he)return ln($)}throw Error(F(438,String($)))}function jo($){var H=null,K=mt.updateQueue;if(K!==null&&(H=K.memoCache),H==null){var X=mt.alternate;X!==null&&(X=X.updateQueue,X!==null&&(X=X.memoCache,X!=null&&(H={data:X.data.map(function(te){return te.slice()}),index:0})))}if(H==null&&(H={data:[],index:0}),K===null&&(K=Lo(),mt.updateQueue=K),K.memoCache=H,K=H.data[H.index],K===void 0)for(K=H.data[H.index]=Array($),X=0;X<$;X++)K[X]=Ae;return H.index++,K}function Wn($,H){return typeof H=="function"?H($):H}function Xa($){var H=Ht();return Vo(H,wt,$)}function Vo($,H,K){var X=$.queue;if(X===null)throw Error(F(311));X.lastRenderedReducer=K;var te=$.baseQueue,ie=X.pending;if(ie!==null){if(te!==null){var ce=te.next;te.next=ie.next,ie.next=ce}H.baseQueue=te=ie,X.pending=null}if(ie=$.baseState,te===null)$.memoizedState=ie;else{H=te.next;var me=ce=null,ve=null,Pe=H,qe=!1;do{var Qe=Pe.lane&-536870913;if(Qe!==Pe.lane?(St&Qe)===Qe:(ui&Qe)===Qe){var Me=Pe.revertLane;if(Me===0)ve!==null&&(ve=ve.next={lane:0,revertLane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),Qe===ur&&(qe=!0);else if((ui&Me)===Me){Pe=Pe.next,Me===ur&&(qe=!0);continue}else Qe={lane:0,revertLane:Pe.revertLane,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null},ve===null?(me=ve=Qe,ce=ie):ve=ve.next=Qe,mt.lanes|=Me,yi|=Me;Qe=Pe.action,Ui&&K(ie,Qe),ie=Pe.hasEagerState?Pe.eagerState:K(ie,Qe)}else Me={lane:Qe,revertLane:Pe.revertLane,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null},ve===null?(me=ve=Me,ce=ie):ve=ve.next=Me,mt.lanes|=Qe,yi|=Qe;Pe=Pe.next}while(Pe!==null&&Pe!==H);if(ve===null?ce=ie:ve.next=me,!vn(ie,$.memoizedState)&&(Jt=!0,qe&&(K=dr,K!==null)))throw K;$.memoizedState=ie,$.baseState=ce,$.baseQueue=ve,X.lastRenderedState=ie}return te===null&&(X.lanes=0),[$.memoizedState,X.dispatch]}function Uo($){var H=Ht(),K=H.queue;if(K===null)throw Error(F(311));K.lastRenderedReducer=$;var X=K.dispatch,te=K.pending,ie=H.memoizedState;if(te!==null){K.pending=null;var ce=te=te.next;do ie=$(ie,ce.action),ce=ce.next;while(ce!==te);vn(ie,H.memoizedState)||(Jt=!0),H.memoizedState=ie,H.baseQueue===null&&(H.baseState=ie),K.lastRenderedState=ie}return[ie,X]}function au($,H,K){var X=mt,te=Ht(),ie=kt;if(ie){if(K===void 0)throw Error(F(407));K=K()}else K=H();var ce=!vn((wt||te).memoizedState,K);ce&&(te.memoizedState=K,Jt=!0),te=te.queue;var me=lu.bind(null,X,te,$);if(ta(2048,8,me,[$]),te.getSnapshot!==H||ce||zt!==null&&zt.memoizedState.tag&1){if(X.flags|=2048,mr(9,Ja(),ou.bind(null,X,te,K,H),null),Dt===null)throw Error(F(349));ie||(ui&124)!==0||su(X,H,K)}return K}function su($,H,K){$.flags|=16384,$={getSnapshot:H,value:K},H=mt.updateQueue,H===null?(H=Lo(),mt.updateQueue=H,H.stores=[$]):(K=H.stores,K===null?H.stores=[$]:K.push($))}function ou($,H,K,X){H.value=K,H.getSnapshot=X,cu(H)&&uu($)}function lu($,H,K){return K(function(){cu(H)&&uu($)})}function cu($){var H=$.getSnapshot;$=$.value;try{var K=H();return!vn($,K)}catch{return!0}}function uu($){var H=sr($,2);H!==null&&En(H,$,2)}function Fo($){var H=pn();if(typeof $=="function"){var K=$;if($=K(),Ui){nt(!0);try{K()}finally{nt(!1)}}}return H.memoizedState=H.baseState=$,H.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:$},H}function du($,H,K,X){return $.baseState=K,Vo($,wt,typeof X=="function"?X:Wn)}function Uf($,H,K,X,te){if(es($))throw Error(F(485));if($=H.action,$!==null){var ie={payload:te,action:$,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ce){ie.listeners.push(ce)}};Te.T!==null?K(!0):ie.isTransition=!1,X(ie),K=H.pending,K===null?(ie.next=H.pending=ie,hu(H,ie)):(ie.next=K.next,H.pending=K.next=ie)}}function hu($,H){var K=H.action,X=H.payload,te=$.state;if(H.isTransition){var ie=Te.T,ce={};Te.T=ce;try{var me=K(te,X),ve=Te.S;ve!==null&&ve(ce,me),fu($,H,me)}catch(Pe){Bo($,H,Pe)}finally{Te.T=ie}}else try{ie=K(te,X),fu($,H,ie)}catch(Pe){Bo($,H,Pe)}}function fu($,H,K){K!==null&&typeof K=="object"&&typeof K.then=="function"?K.then(function(X){pu($,H,X)},function(X){return Bo($,H,X)}):pu($,H,K)}function pu($,H,K){H.status="fulfilled",H.value=K,mu(H),$.state=K,H=$.pending,H!==null&&(K=H.next,K===H?$.pending=null:(K=K.next,H.next=K,hu($,K)))}function Bo($,H,K){var X=$.pending;if($.pending=null,X!==null){X=X.next;do H.status="rejected",H.reason=K,mu(H),H=H.next;while(H!==X)}$.action=null}function mu($){$=$.listeners;for(var H=0;H<$.length;H++)(0,$[H])()}function gu($,H){return H}function yu($,H){if(kt){var K=Dt.formState;if(K!==null){e:{var X=mt;if(kt){if(Lt){t:{for(var te=Lt,ie=Vn;te.nodeType!==8;){if(!ie){te=null;break t}if(te=jn(te.nextSibling),te===null){te=null;break t}}ie=te.data,te=ie==="F!"||ie==="F"?te:null}if(te){Lt=jn(te.nextSibling),X=te.data==="F!";break e}}Ii(X)}X=!1}X&&(H=K[0])}}return K=pn(),K.memoizedState=K.baseState=H,X={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gu,lastRenderedState:H},K.queue=X,K=Lu.bind(null,mt,X),X.dispatch=K,X=Fo(!1),ie=Go.bind(null,mt,!1,X.queue),X=pn(),te={state:H,dispatch:null,action:$,pending:null},X.queue=te,K=Uf.bind(null,mt,te,ie,K),te.dispatch=K,X.memoizedState=$,[H,K,!1]}function vu($){var H=Ht();return xu(H,wt,$)}function xu($,H,K){if(H=Vo($,H,gu)[0],$=Xa(Wn)[0],typeof H=="object"&&H!==null&&typeof H.then=="function")try{var X=ea(H)}catch(ce){throw ce===Yr?Ha:ce}else X=H;H=Ht();var te=H.queue,ie=te.dispatch;return K!==H.memoizedState&&(mt.flags|=2048,mr(9,Ja(),Ff.bind(null,te,K),null)),[X,ie,$]}function Ff($,H){$.action=H}function bu($){var H=Ht(),K=wt;if(K!==null)return xu(H,K,$);Ht(),H=H.memoizedState,K=Ht();var X=K.queue.dispatch;return K.memoizedState=$,[H,X,!1]}function mr($,H,K,X){return $={tag:$,create:K,deps:X,inst:H,next:null},H=mt.updateQueue,H===null&&(H=Lo(),mt.updateQueue=H),K=H.lastEffect,K===null?H.lastEffect=$.next=$:(X=K.next,K.next=$,$.next=X,H.lastEffect=$),$}function Ja(){return{destroy:void 0,resource:void 0}}function Su(){return Ht().memoizedState}function Za($,H,K,X){var te=pn();X=X===void 0?null:X,mt.flags|=$,te.memoizedState=mr(1|H,Ja(),K,X)}function ta($,H,K,X){var te=Ht();X=X===void 0?null:X;var ie=te.memoizedState.inst;wt!==null&&X!==null&&Oo(X,wt.memoizedState.deps)?te.memoizedState=mr(H,ie,K,X):(mt.flags|=$,te.memoizedState=mr(1|H,ie,K,X))}function Tu($,H){Za(8390656,8,$,H)}function ku($,H){ta(2048,8,$,H)}function Eu($,H){return ta(4,2,$,H)}function Cu($,H){return ta(4,4,$,H)}function wu($,H){if(typeof H=="function"){$=$();var K=H($);return function(){typeof K=="function"?K():H(null)}}if(H!=null)return $=$(),H.current=$,function(){H.current=null}}function _u($,H,K){K=K!=null?K.concat([$]):null,ta(4,4,wu.bind(null,H,$),K)}function $o(){}function Ru($,H){var K=Ht();H=H===void 0?null:H;var X=K.memoizedState;return H!==null&&Oo(H,X[1])?X[0]:(K.memoizedState=[$,H],$)}function Au($,H){var K=Ht();H=H===void 0?null:H;var X=K.memoizedState;if(H!==null&&Oo(H,X[1]))return X[0];if(X=$(),Ui){nt(!0);try{$()}finally{nt(!1)}}return K.memoizedState=[X,H],X}function qo($,H,K){return K===void 0||(ui&1073741824)!==0?$.memoizedState=H:($.memoizedState=K,$=Md(),mt.lanes|=$,yi|=$,K)}function Pu($,H,K,X){return vn(K,H)?K:hr.current!==null?($=qo($,K,X),vn($,H)||(Jt=!0),$):(ui&42)===0?(Jt=!0,$.memoizedState=K):($=Md(),mt.lanes|=$,yi|=$,H)}function Ou($,H,K,X,te){var ie=Oe.p;Oe.p=ie!==0&&8>ie?ie:8;var ce=Te.T,me={};Te.T=me,Go($,!1,H,K);try{var ve=te(),Pe=Te.S;if(Pe!==null&&Pe(me,ve),ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var qe=Lf(ve,X);na($,H,qe,kn($))}else na($,H,X,kn($))}catch(Qe){na($,H,{then:function(){},status:"rejected",reason:Qe},kn())}finally{Oe.p=ie,Te.T=ce}}function Bf(){}function zo($,H,K,X){if($.tag!==5)throw Error(F(476));var te=Du($).queue;Ou($,te,H,Ue,K===null?Bf:function(){return Mu($),K(X)})}function Du($){var H=$.memoizedState;if(H!==null)return H;H={memoizedState:Ue,baseState:Ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:Ue},next:null};var K={};return H.next={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:K},next:null},$.memoizedState=H,$=$.alternate,$!==null&&($.memoizedState=H),H}function Mu($){var H=Du($).next.queue;na($,H,{},kn())}function Ho(){return ln(ba)}function Nu(){return Ht().memoizedState}function Iu(){return Ht().memoizedState}function $f($){for(var H=$.return;H!==null;){switch(H.tag){case 24:case 3:var K=kn();$=li(K);var X=ci(H,$,K);X!==null&&(En(X,H,K),Wr(X,H,K)),H={cache:So()},$.payload=H;return}H=H.return}}function qf($,H,K){var X=kn();K={lane:X,revertLane:0,action:K,hasEagerState:!1,eagerState:null,next:null},es($)?ju(H,K):(K=uo($,H,K,X),K!==null&&(En(K,$,X),Vu(K,H,X)))}function Lu($,H,K){var X=kn();na($,H,K,X)}function na($,H,K,X){var te={lane:X,revertLane:0,action:K,hasEagerState:!1,eagerState:null,next:null};if(es($))ju(H,te);else{var ie=$.alternate;if($.lanes===0&&(ie===null||ie.lanes===0)&&(ie=H.lastRenderedReducer,ie!==null))try{var ce=H.lastRenderedState,me=ie(ce,K);if(te.hasEagerState=!0,te.eagerState=me,vn(me,ce))return ja($,H,te,0),Dt===null&&La(),!1}catch{}finally{}if(K=uo($,H,te,X),K!==null)return En(K,$,X),Vu(K,H,X),!0}return!1}function Go($,H,K,X){if(X={lane:2,revertLane:El(),action:X,hasEagerState:!1,eagerState:null,next:null},es($)){if(H)throw Error(F(479))}else H=uo($,K,X,2),H!==null&&En(H,$,2)}function es($){var H=$.alternate;return $===mt||H!==null&&H===mt}function ju($,H){fr=Ya=!0;var K=$.pending;K===null?H.next=H:(H.next=K.next,K.next=H),$.pending=H}function Vu($,H,K){if((K&4194048)!==0){var X=H.lanes;X&=$.pendingLanes,K|=X,H.lanes=K,Hi($,K)}}var ts={readContext:ln,use:Wa,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useLayoutEffect:Ft,useInsertionEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useSyncExternalStore:Ft,useId:Ft,useHostTransitionStatus:Ft,useFormState:Ft,useActionState:Ft,useOptimistic:Ft,useMemoCache:Ft,useCacheRefresh:Ft},Uu={readContext:ln,use:Wa,useCallback:function($,H){return pn().memoizedState=[$,H===void 0?null:H],$},useContext:ln,useEffect:Tu,useImperativeHandle:function($,H,K){K=K!=null?K.concat([$]):null,Za(4194308,4,wu.bind(null,H,$),K)},useLayoutEffect:function($,H){return Za(4194308,4,$,H)},useInsertionEffect:function($,H){Za(4,2,$,H)},useMemo:function($,H){var K=pn();H=H===void 0?null:H;var X=$();if(Ui){nt(!0);try{$()}finally{nt(!1)}}return K.memoizedState=[X,H],X},useReducer:function($,H,K){var X=pn();if(K!==void 0){var te=K(H);if(Ui){nt(!0);try{K(H)}finally{nt(!1)}}}else te=H;return X.memoizedState=X.baseState=te,$={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$,lastRenderedState:te},X.queue=$,$=$.dispatch=qf.bind(null,mt,$),[X.memoizedState,$]},useRef:function($){var H=pn();return $={current:$},H.memoizedState=$},useState:function($){$=Fo($);var H=$.queue,K=Lu.bind(null,mt,H);return H.dispatch=K,[$.memoizedState,K]},useDebugValue:$o,useDeferredValue:function($,H){var K=pn();return qo(K,$,H)},useTransition:function(){var $=Fo(!1);return $=Ou.bind(null,mt,$.queue,!0,!1),pn().memoizedState=$,[!1,$]},useSyncExternalStore:function($,H,K){var X=mt,te=pn();if(kt){if(K===void 0)throw Error(F(407));K=K()}else{if(K=H(),Dt===null)throw Error(F(349));(St&124)!==0||su(X,H,K)}te.memoizedState=K;var ie={value:K,getSnapshot:H};return te.queue=ie,Tu(lu.bind(null,X,ie,$),[$]),X.flags|=2048,mr(9,Ja(),ou.bind(null,X,ie,K,H),null),K},useId:function(){var $=pn(),H=Dt.identifierPrefix;if(kt){var K=Kn,X=Gn;K=(X&~(1<<32-it(X)-1)).toString(32)+K,H=""+H+"R"+K,K=Qa++,0<K&&(H+="H"+K.toString(32)),H+=""}else K=jf++,H=""+H+"r"+K.toString(32)+"";return $.memoizedState=H},useHostTransitionStatus:Ho,useFormState:yu,useActionState:yu,useOptimistic:function($){var H=pn();H.memoizedState=H.baseState=$;var K={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return H.queue=K,H=Go.bind(null,mt,!0,K),K.dispatch=H,[$,H]},useMemoCache:jo,useCacheRefresh:function(){return pn().memoizedState=$f.bind(null,mt)}},Fu={readContext:ln,use:Wa,useCallback:Ru,useContext:ln,useEffect:ku,useImperativeHandle:_u,useInsertionEffect:Eu,useLayoutEffect:Cu,useMemo:Au,useReducer:Xa,useRef:Su,useState:function(){return Xa(Wn)},useDebugValue:$o,useDeferredValue:function($,H){var K=Ht();return Pu(K,wt.memoizedState,$,H)},useTransition:function(){var $=Xa(Wn)[0],H=Ht().memoizedState;return[typeof $=="boolean"?$:ea($),H]},useSyncExternalStore:au,useId:Nu,useHostTransitionStatus:Ho,useFormState:vu,useActionState:vu,useOptimistic:function($,H){var K=Ht();return du(K,wt,$,H)},useMemoCache:jo,useCacheRefresh:Iu},zf={readContext:ln,use:Wa,useCallback:Ru,useContext:ln,useEffect:ku,useImperativeHandle:_u,useInsertionEffect:Eu,useLayoutEffect:Cu,useMemo:Au,useReducer:Uo,useRef:Su,useState:function(){return Uo(Wn)},useDebugValue:$o,useDeferredValue:function($,H){var K=Ht();return wt===null?qo(K,$,H):Pu(K,wt.memoizedState,$,H)},useTransition:function(){var $=Uo(Wn)[0],H=Ht().memoizedState;return[typeof $=="boolean"?$:ea($),H]},useSyncExternalStore:au,useId:Nu,useHostTransitionStatus:Ho,useFormState:bu,useActionState:bu,useOptimistic:function($,H){var K=Ht();return wt!==null?du(K,wt,$,H):(K.baseState=$,[$,K.queue.dispatch])},useMemoCache:jo,useCacheRefresh:Iu},gr=null,ia=0;function ns($){var H=ia;return ia+=1,gr===null&&(gr=[]),Xc(gr,$,H)}function ra($,H){H=H.props.ref,$.ref=H!==void 0?H:null}function is($,H){throw H.$$typeof===Z?Error(F(525)):($=Object.prototype.toString.call(H),Error(F(31,$==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":$)))}function Bu($){var H=$._init;return H($._payload)}function $u($){function H(Ce,Se){if($){var Re=Ce.deletions;Re===null?(Ce.deletions=[Se],Ce.flags|=16):Re.push(Se)}}function K(Ce,Se){if(!$)return null;for(;Se!==null;)H(Ce,Se),Se=Se.sibling;return null}function X(Ce){for(var Se=new Map;Ce!==null;)Ce.key!==null?Se.set(Ce.key,Ce):Se.set(Ce.index,Ce),Ce=Ce.sibling;return Se}function te(Ce,Se){return Ce=Hn(Ce,Se),Ce.index=0,Ce.sibling=null,Ce}function ie(Ce,Se,Re){return Ce.index=Re,$?(Re=Ce.alternate,Re!==null?(Re=Re.index,Re<Se?(Ce.flags|=67108866,Se):Re):(Ce.flags|=67108866,Se)):(Ce.flags|=1048576,Se)}function ce(Ce){return $&&Ce.alternate===null&&(Ce.flags|=67108866),Ce}function me(Ce,Se,Re,Ke){return Se===null||Se.tag!==6?(Se=fo(Re,Ce.mode,Ke),Se.return=Ce,Se):(Se=te(Se,Re),Se.return=Ce,Se)}function ve(Ce,Se,Re,Ke){var rt=Re.type;return rt===ae?qe(Ce,Se,Re.props.children,Ke,Re.key):Se!==null&&(Se.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===Ee&&Bu(rt)===Se.type)?(Se=te(Se,Re.props),ra(Se,Re),Se.return=Ce,Se):(Se=Ua(Re.type,Re.key,Re.props,null,Ce.mode,Ke),ra(Se,Re),Se.return=Ce,Se)}function Pe(Ce,Se,Re,Ke){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==Re.containerInfo||Se.stateNode.implementation!==Re.implementation?(Se=po(Re,Ce.mode,Ke),Se.return=Ce,Se):(Se=te(Se,Re.children||[]),Se.return=Ce,Se)}function qe(Ce,Se,Re,Ke,rt){return Se===null||Se.tag!==7?(Se=Oi(Re,Ce.mode,Ke,rt),Se.return=Ce,Se):(Se=te(Se,Re),Se.return=Ce,Se)}function Qe(Ce,Se,Re){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=fo(""+Se,Ce.mode,Re),Se.return=Ce,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case ee:return Re=Ua(Se.type,Se.key,Se.props,null,Ce.mode,Re),ra(Re,Se),Re.return=Ce,Re;case ne:return Se=po(Se,Ce.mode,Re),Se.return=Ce,Se;case Ee:var Ke=Se._init;return Se=Ke(Se._payload),Qe(Ce,Se,Re)}if(Ve(Se)||Le(Se))return Se=Oi(Se,Ce.mode,Re,null),Se.return=Ce,Se;if(typeof Se.then=="function")return Qe(Ce,ns(Se),Re);if(Se.$$typeof===he)return Qe(Ce,qa(Ce,Se),Re);is(Ce,Se)}return null}function Me(Ce,Se,Re,Ke){var rt=Se!==null?Se.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return rt!==null?null:me(Ce,Se,""+Re,Ke);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case ee:return Re.key===rt?ve(Ce,Se,Re,Ke):null;case ne:return Re.key===rt?Pe(Ce,Se,Re,Ke):null;case Ee:return rt=Re._init,Re=rt(Re._payload),Me(Ce,Se,Re,Ke)}if(Ve(Re)||Le(Re))return rt!==null?null:qe(Ce,Se,Re,Ke,null);if(typeof Re.then=="function")return Me(Ce,Se,ns(Re),Ke);if(Re.$$typeof===he)return Me(Ce,Se,qa(Ce,Re),Ke);is(Ce,Re)}return null}function Ie(Ce,Se,Re,Ke,rt){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return Ce=Ce.get(Re)||null,me(Se,Ce,""+Ke,rt);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case ee:return Ce=Ce.get(Ke.key===null?Re:Ke.key)||null,ve(Se,Ce,Ke,rt);case ne:return Ce=Ce.get(Ke.key===null?Re:Ke.key)||null,Pe(Se,Ce,Ke,rt);case Ee:var gt=Ke._init;return Ke=gt(Ke._payload),Ie(Ce,Se,Re,Ke,rt)}if(Ve(Ke)||Le(Ke))return Ce=Ce.get(Re)||null,qe(Se,Ce,Ke,rt,null);if(typeof Ke.then=="function")return Ie(Ce,Se,Re,ns(Ke),rt);if(Ke.$$typeof===he)return Ie(Ce,Se,Re,qa(Se,Ke),rt);is(Se,Ke)}return null}function ct(Ce,Se,Re,Ke){for(var rt=null,gt=null,st=Se,lt=Se=0,en=null;st!==null&&lt<Re.length;lt++){st.index>lt?(en=st,st=null):en=st.sibling;var Tt=Me(Ce,st,Re[lt],Ke);if(Tt===null){st===null&&(st=en);break}$&&st&&Tt.alternate===null&&H(Ce,st),Se=ie(Tt,Se,lt),gt===null?rt=Tt:gt.sibling=Tt,gt=Tt,st=en}if(lt===Re.length)return K(Ce,st),kt&&Mi(Ce,lt),rt;if(st===null){for(;lt<Re.length;lt++)st=Qe(Ce,Re[lt],Ke),st!==null&&(Se=ie(st,Se,lt),gt===null?rt=st:gt.sibling=st,gt=st);return kt&&Mi(Ce,lt),rt}for(st=X(st);lt<Re.length;lt++)en=Ie(st,Ce,lt,Re[lt],Ke),en!==null&&($&&en.alternate!==null&&st.delete(en.key===null?lt:en.key),Se=ie(en,Se,lt),gt===null?rt=en:gt.sibling=en,gt=en);return $&&st.forEach(function(wi){return H(Ce,wi)}),kt&&Mi(Ce,lt),rt}function ot(Ce,Se,Re,Ke){if(Re==null)throw Error(F(151));for(var rt=null,gt=null,st=Se,lt=Se=0,en=null,Tt=Re.next();st!==null&&!Tt.done;lt++,Tt=Re.next()){st.index>lt?(en=st,st=null):en=st.sibling;var wi=Me(Ce,st,Tt.value,Ke);if(wi===null){st===null&&(st=en);break}$&&st&&wi.alternate===null&&H(Ce,st),Se=ie(wi,Se,lt),gt===null?rt=wi:gt.sibling=wi,gt=wi,st=en}if(Tt.done)return K(Ce,st),kt&&Mi(Ce,lt),rt;if(st===null){for(;!Tt.done;lt++,Tt=Re.next())Tt=Qe(Ce,Tt.value,Ke),Tt!==null&&(Se=ie(Tt,Se,lt),gt===null?rt=Tt:gt.sibling=Tt,gt=Tt);return kt&&Mi(Ce,lt),rt}for(st=X(st);!Tt.done;lt++,Tt=Re.next())Tt=Ie(st,Ce,lt,Tt.value,Ke),Tt!==null&&($&&Tt.alternate!==null&&st.delete(Tt.key===null?lt:Tt.key),Se=ie(Tt,Se,lt),gt===null?rt=Tt:gt.sibling=Tt,gt=Tt);return $&&st.forEach(function(Hp){return H(Ce,Hp)}),kt&&Mi(Ce,lt),rt}function Rt(Ce,Se,Re,Ke){if(typeof Re=="object"&&Re!==null&&Re.type===ae&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case ee:e:{for(var rt=Re.key;Se!==null;){if(Se.key===rt){if(rt=Re.type,rt===ae){if(Se.tag===7){K(Ce,Se.sibling),Ke=te(Se,Re.props.children),Ke.return=Ce,Ce=Ke;break e}}else if(Se.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===Ee&&Bu(rt)===Se.type){K(Ce,Se.sibling),Ke=te(Se,Re.props),ra(Ke,Re),Ke.return=Ce,Ce=Ke;break e}K(Ce,Se);break}else H(Ce,Se);Se=Se.sibling}Re.type===ae?(Ke=Oi(Re.props.children,Ce.mode,Ke,Re.key),Ke.return=Ce,Ce=Ke):(Ke=Ua(Re.type,Re.key,Re.props,null,Ce.mode,Ke),ra(Ke,Re),Ke.return=Ce,Ce=Ke)}return ce(Ce);case ne:e:{for(rt=Re.key;Se!==null;){if(Se.key===rt)if(Se.tag===4&&Se.stateNode.containerInfo===Re.containerInfo&&Se.stateNode.implementation===Re.implementation){K(Ce,Se.sibling),Ke=te(Se,Re.children||[]),Ke.return=Ce,Ce=Ke;break e}else{K(Ce,Se);break}else H(Ce,Se);Se=Se.sibling}Ke=po(Re,Ce.mode,Ke),Ke.return=Ce,Ce=Ke}return ce(Ce);case Ee:return rt=Re._init,Re=rt(Re._payload),Rt(Ce,Se,Re,Ke)}if(Ve(Re))return ct(Ce,Se,Re,Ke);if(Le(Re)){if(rt=Le(Re),typeof rt!="function")throw Error(F(150));return Re=rt.call(Re),ot(Ce,Se,Re,Ke)}if(typeof Re.then=="function")return Rt(Ce,Se,ns(Re),Ke);if(Re.$$typeof===he)return Rt(Ce,Se,qa(Ce,Re),Ke);is(Ce,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint"?(Re=""+Re,Se!==null&&Se.tag===6?(K(Ce,Se.sibling),Ke=te(Se,Re),Ke.return=Ce,Ce=Ke):(K(Ce,Se),Ke=fo(Re,Ce.mode,Ke),Ke.return=Ce,Ce=Ke),ce(Ce)):K(Ce,Se)}return function(Ce,Se,Re,Ke){try{ia=0;var rt=Rt(Ce,Se,Re,Ke);return gr=null,rt}catch(st){if(st===Yr||st===Ha)throw st;var gt=xn(29,st,null,Ce.mode);return gt.lanes=Ke,gt.return=Ce,gt}finally{}}}var yr=$u(!0),qu=$u(!1),On=we(null),Un=null;function di($){var H=$.alternate;ge(Yt,Yt.current&1),ge(On,$),Un===null&&(H===null||hr.current!==null||H.memoizedState!==null)&&(Un=$)}function zu($){if($.tag===22){if(ge(Yt,Yt.current),ge(On,$),Un===null){var H=$.alternate;H!==null&&H.memoizedState!==null&&(Un=$)}}else hi()}function hi(){ge(Yt,Yt.current),ge(On,On.current)}function Xn($){He(On),Un===$&&(Un=null),He(Yt)}var Yt=we(0);function rs($){for(var H=$;H!==null;){if(H.tag===13){var K=H.memoizedState;if(K!==null&&(K=K.dehydrated,K===null||K.data==="$?"||Ll(K)))return H}else if(H.tag===19&&H.memoizedProps.revealOrder!==void 0){if((H.flags&128)!==0)return H}else if(H.child!==null){H.child.return=H,H=H.child;continue}if(H===$)break;for(;H.sibling===null;){if(H.return===null||H.return===$)return null;H=H.return}H.sibling.return=H.return,H=H.sibling}return null}function Ko($,H,K,X){H=$.memoizedState,K=K(X,H),K=K==null?H:W({},H,K),$.memoizedState=K,$.lanes===0&&($.updateQueue.baseState=K)}var Yo={enqueueSetState:function($,H,K){$=$._reactInternals;var X=kn(),te=li(X);te.payload=H,K!=null&&(te.callback=K),H=ci($,te,X),H!==null&&(En(H,$,X),Wr(H,$,X))},enqueueReplaceState:function($,H,K){$=$._reactInternals;var X=kn(),te=li(X);te.tag=1,te.payload=H,K!=null&&(te.callback=K),H=ci($,te,X),H!==null&&(En(H,$,X),Wr(H,$,X))},enqueueForceUpdate:function($,H){$=$._reactInternals;var K=kn(),X=li(K);X.tag=2,H!=null&&(X.callback=H),H=ci($,X,K),H!==null&&(En(H,$,K),Wr(H,$,K))}};function Hu($,H,K,X,te,ie,ce){return $=$.stateNode,typeof $.shouldComponentUpdate=="function"?$.shouldComponentUpdate(X,ie,ce):H.prototype&&H.prototype.isPureReactComponent?!Fr(K,X)||!Fr(te,ie):!0}function Gu($,H,K,X){$=H.state,typeof H.componentWillReceiveProps=="function"&&H.componentWillReceiveProps(K,X),typeof H.UNSAFE_componentWillReceiveProps=="function"&&H.UNSAFE_componentWillReceiveProps(K,X),H.state!==$&&Yo.enqueueReplaceState(H,H.state,null)}function Fi($,H){var K=H;if("ref"in H){K={};for(var X in H)X!=="ref"&&(K[X]=H[X])}if($=$.defaultProps){K===H&&(K=W({},K));for(var te in $)K[te]===void 0&&(K[te]=$[te])}return K}var as=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)};function Ku($){as($)}function Yu($){console.error($)}function Qu($){as($)}function ss($,H){try{var K=$.onUncaughtError;K(H.value,{componentStack:H.stack})}catch(X){setTimeout(function(){throw X})}}function Wu($,H,K){try{var X=$.onCaughtError;X(K.value,{componentStack:K.stack,errorBoundary:H.tag===1?H.stateNode:null})}catch(te){setTimeout(function(){throw te})}}function Qo($,H,K){return K=li(K),K.tag=3,K.payload={element:null},K.callback=function(){ss($,H)},K}function Xu($){return $=li($),$.tag=3,$}function Ju($,H,K,X){var te=K.type.getDerivedStateFromError;if(typeof te=="function"){var ie=X.value;$.payload=function(){return te(ie)},$.callback=function(){Wu(H,K,X)}}var ce=K.stateNode;ce!==null&&typeof ce.componentDidCatch=="function"&&($.callback=function(){Wu(H,K,X),typeof te!="function"&&(vi===null?vi=new Set([this]):vi.add(this));var me=X.stack;this.componentDidCatch(X.value,{componentStack:me!==null?me:""})})}function Hf($,H,K,X,te){if(K.flags|=32768,X!==null&&typeof X=="object"&&typeof X.then=="function"){if(H=K.alternate,H!==null&&Hr(H,K,te,!0),K=On.current,K!==null){switch(K.tag){case 13:return Un===null?xl():K.alternate===null&&jt===0&&(jt=3),K.flags&=-257,K.flags|=65536,K.lanes=te,X===Eo?K.flags|=16384:(H=K.updateQueue,H===null?K.updateQueue=new Set([X]):H.add(X),Sl($,X,te)),!1;case 22:return K.flags|=65536,X===Eo?K.flags|=16384:(H=K.updateQueue,H===null?(H={transitions:null,markerInstances:null,retryQueue:new Set([X])},K.updateQueue=H):(K=H.retryQueue,K===null?H.retryQueue=new Set([X]):K.add(X)),Sl($,X,te)),!1}throw Error(F(435,K.tag))}return Sl($,X,te),xl(),!1}if(kt)return H=On.current,H!==null?((H.flags&65536)===0&&(H.flags|=256),H.flags|=65536,H.lanes=te,X!==yo&&($=Error(F(422),{cause:X}),zr(_n($,K)))):(X!==yo&&(H=Error(F(423),{cause:X}),zr(_n(H,K))),$=$.current.alternate,$.flags|=65536,te&=-te,$.lanes|=te,X=_n(X,K),te=Qo($.stateNode,X,te),_o($,te),jt!==4&&(jt=2)),!1;var ie=Error(F(520),{cause:X});if(ie=_n(ie,K),da===null?da=[ie]:da.push(ie),jt!==4&&(jt=2),H===null)return!0;X=_n(X,K),K=H;do{switch(K.tag){case 3:return K.flags|=65536,$=te&-te,K.lanes|=$,$=Qo(K.stateNode,X,$),_o(K,$),!1;case 1:if(H=K.type,ie=K.stateNode,(K.flags&128)===0&&(typeof H.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(vi===null||!vi.has(ie))))return K.flags|=65536,te&=-te,K.lanes|=te,te=Xu(te),Ju(te,$,K,X),_o(K,te),!1}K=K.return}while(K!==null);return!1}var Zu=Error(F(461)),Jt=!1;function rn($,H,K,X){H.child=$===null?qu(H,null,K,X):yr(H,$.child,K,X)}function ed($,H,K,X,te){K=K.render;var ie=H.ref;if("ref"in X){var ce={};for(var me in X)me!=="ref"&&(ce[me]=X[me])}else ce=X;return ji(H),X=Do($,H,K,ce,ie,te),me=Mo(),$!==null&&!Jt?(No($,H,te),Jn($,H,te)):(kt&&me&&mo(H),H.flags|=1,rn($,H,X,te),H.child)}function td($,H,K,X,te){if($===null){var ie=K.type;return typeof ie=="function"&&!ho(ie)&&ie.defaultProps===void 0&&K.compare===null?(H.tag=15,H.type=ie,nd($,H,ie,X,te)):($=Ua(K.type,null,X,H,H.mode,te),$.ref=H.ref,$.return=H,H.child=$)}if(ie=$.child,!il($,te)){var ce=ie.memoizedProps;if(K=K.compare,K=K!==null?K:Fr,K(ce,X)&&$.ref===H.ref)return Jn($,H,te)}return H.flags|=1,$=Hn(ie,X),$.ref=H.ref,$.return=H,H.child=$}function nd($,H,K,X,te){if($!==null){var ie=$.memoizedProps;if(Fr(ie,X)&&$.ref===H.ref)if(Jt=!1,H.pendingProps=X=ie,il($,te))($.flags&131072)!==0&&(Jt=!0);else return H.lanes=$.lanes,Jn($,H,te)}return Wo($,H,K,X,te)}function rd($,H,K){var X=H.pendingProps,te=X.children,ie=$!==null?$.memoizedState:null;if(X.mode==="hidden"){if((H.flags&128)!==0){if(X=ie!==null?ie.baseLanes|K:K,$!==null){for(te=H.child=$.child,ie=0;te!==null;)ie=ie|te.lanes|te.childLanes,te=te.sibling;H.childLanes=ie&~X}else H.childLanes=0,H.child=null;return ad($,H,X,K)}if((K&536870912)!==0)H.memoizedState={baseLanes:0,cachePool:null},$!==null&&za(H,ie!==null?ie.cachePool:null),ie!==null?nu(H,ie):Ao(),zu(H);else return H.lanes=H.childLanes=536870912,ad($,H,ie!==null?ie.baseLanes|K:K,K)}else ie!==null?(za(H,ie.cachePool),nu(H,ie),hi(),H.memoizedState=null):($!==null&&za(H,null),Ao(),hi());return rn($,H,te,K),H.child}function ad($,H,K,X){var te=ko();return te=te===null?null:{parent:Kt._currentValue,pool:te},H.memoizedState={baseLanes:K,cachePool:te},$!==null&&za(H,null),Ao(),zu(H),$!==null&&Hr($,H,X,!0),null}function os($,H){var K=H.ref;if(K===null)$!==null&&$.ref!==null&&(H.flags|=4194816);else{if(typeof K!="function"&&typeof K!="object")throw Error(F(284));($===null||$.ref!==K)&&(H.flags|=4194816)}}function Wo($,H,K,X,te){return ji(H),K=Do($,H,K,X,void 0,te),X=Mo(),$!==null&&!Jt?(No($,H,te),Jn($,H,te)):(kt&&X&&mo(H),H.flags|=1,rn($,H,K,te),H.child)}function sd($,H,K,X,te,ie){return ji(H),H.updateQueue=null,K=ru(H,X,K,te),iu($),X=Mo(),$!==null&&!Jt?(No($,H,ie),Jn($,H,ie)):(kt&&X&&mo(H),H.flags|=1,rn($,H,K,ie),H.child)}function od($,H,K,X,te){if(ji(H),H.stateNode===null){var ie=or,ce=K.contextType;typeof ce=="object"&&ce!==null&&(ie=ln(ce)),ie=new K(X,ie),H.memoizedState=ie.state!==null&&ie.state!==void 0?ie.state:null,ie.updater=Yo,H.stateNode=ie,ie._reactInternals=H,ie=H.stateNode,ie.props=X,ie.state=H.memoizedState,ie.refs={},Co(H),ce=K.contextType,ie.context=typeof ce=="object"&&ce!==null?ln(ce):or,ie.state=H.memoizedState,ce=K.getDerivedStateFromProps,typeof ce=="function"&&(Ko(H,K,ce,X),ie.state=H.memoizedState),typeof K.getDerivedStateFromProps=="function"||typeof ie.getSnapshotBeforeUpdate=="function"||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(ce=ie.state,typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount(),ce!==ie.state&&Yo.enqueueReplaceState(ie,ie.state,null),Jr(H,X,ie,te),Xr(),ie.state=H.memoizedState),typeof ie.componentDidMount=="function"&&(H.flags|=4194308),X=!0}else if($===null){ie=H.stateNode;var me=H.memoizedProps,ve=Fi(K,me);ie.props=ve;var Pe=ie.context,qe=K.contextType;ce=or,typeof qe=="object"&&qe!==null&&(ce=ln(qe));var Qe=K.getDerivedStateFromProps;qe=typeof Qe=="function"||typeof ie.getSnapshotBeforeUpdate=="function",me=H.pendingProps!==me,qe||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(me||Pe!==ce)&&Gu(H,ie,X,ce),oi=!1;var Me=H.memoizedState;ie.state=Me,Jr(H,X,ie,te),Xr(),Pe=H.memoizedState,me||Me!==Pe||oi?(typeof Qe=="function"&&(Ko(H,K,Qe,X),Pe=H.memoizedState),(ve=oi||Hu(H,K,ve,X,Me,Pe,ce))?(qe||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(H.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(H.flags|=4194308),H.memoizedProps=X,H.memoizedState=Pe),ie.props=X,ie.state=Pe,ie.context=ce,X=ve):(typeof ie.componentDidMount=="function"&&(H.flags|=4194308),X=!1)}else{ie=H.stateNode,wo($,H),ce=H.memoizedProps,qe=Fi(K,ce),ie.props=qe,Qe=H.pendingProps,Me=ie.context,Pe=K.contextType,ve=or,typeof Pe=="object"&&Pe!==null&&(ve=ln(Pe)),me=K.getDerivedStateFromProps,(Pe=typeof me=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(ce!==Qe||Me!==ve)&&Gu(H,ie,X,ve),oi=!1,Me=H.memoizedState,ie.state=Me,Jr(H,X,ie,te),Xr();var Ie=H.memoizedState;ce!==Qe||Me!==Ie||oi||$!==null&&$.dependencies!==null&&$a($.dependencies)?(typeof me=="function"&&(Ko(H,K,me,X),Ie=H.memoizedState),(qe=oi||Hu(H,K,qe,X,Me,Ie,ve)||$!==null&&$.dependencies!==null&&$a($.dependencies))?(Pe||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(X,Ie,ve),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(X,Ie,ve)),typeof ie.componentDidUpdate=="function"&&(H.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(H.flags|=1024)):(typeof ie.componentDidUpdate!="function"||ce===$.memoizedProps&&Me===$.memoizedState||(H.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||ce===$.memoizedProps&&Me===$.memoizedState||(H.flags|=1024),H.memoizedProps=X,H.memoizedState=Ie),ie.props=X,ie.state=Ie,ie.context=ve,X=qe):(typeof ie.componentDidUpdate!="function"||ce===$.memoizedProps&&Me===$.memoizedState||(H.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||ce===$.memoizedProps&&Me===$.memoizedState||(H.flags|=1024),X=!1)}return ie=X,os($,H),X=(H.flags&128)!==0,ie||X?(ie=H.stateNode,K=X&&typeof K.getDerivedStateFromError!="function"?null:ie.render(),H.flags|=1,$!==null&&X?(H.child=yr(H,$.child,null,te),H.child=yr(H,null,K,te)):rn($,H,K,te),H.memoizedState=ie.state,$=H.child):$=Jn($,H,te),$}function ld($,H,K,X){return qr(),H.flags|=256,rn($,H,K,X),H.child}var Xo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jo($){return{baseLanes:$,cachePool:Yc()}}function Zo($,H,K){return $=$!==null?$.childLanes&~K:0,H&&($|=Dn),$}function cd($,H,K){var X=H.pendingProps,te=!1,ie=(H.flags&128)!==0,ce;if((ce=ie)||(ce=$!==null&&$.memoizedState===null?!1:(Yt.current&2)!==0),ce&&(te=!0,H.flags&=-129),ce=(H.flags&32)!==0,H.flags&=-33,$===null){if(kt){if(te?di(H):hi(),kt){var me=Lt,ve;if(ve=me){e:{for(ve=me,me=Vn;ve.nodeType!==8;){if(!me){me=null;break e}if(ve=jn(ve.nextSibling),ve===null){me=null;break e}}me=ve}me!==null?(H.memoizedState={dehydrated:me,treeContext:Di!==null?{id:Gn,overflow:Kn}:null,retryLane:536870912,hydrationErrors:null},ve=xn(18,null,null,0),ve.stateNode=me,ve.return=H,H.child=ve,un=H,Lt=null,ve=!0):ve=!1}ve||Ii(H)}if(me=H.memoizedState,me!==null&&(me=me.dehydrated,me!==null))return Ll(me)?H.lanes=32:H.lanes=536870912,null;Xn(H)}return me=X.children,X=X.fallback,te?(hi(),te=H.mode,me=ls({mode:"hidden",children:me},te),X=Oi(X,te,K,null),me.return=H,X.return=H,me.sibling=X,H.child=me,te=H.child,te.memoizedState=Jo(K),te.childLanes=Zo($,ce,K),H.memoizedState=Xo,X):(di(H),el(H,me))}if(ve=$.memoizedState,ve!==null&&(me=ve.dehydrated,me!==null)){if(ie)H.flags&256?(di(H),H.flags&=-257,H=tl($,H,K)):H.memoizedState!==null?(hi(),H.child=$.child,H.flags|=128,H=null):(hi(),te=X.fallback,me=H.mode,X=ls({mode:"visible",children:X.children},me),te=Oi(te,me,K,null),te.flags|=2,X.return=H,te.return=H,X.sibling=te,H.child=X,yr(H,$.child,null,K),X=H.child,X.memoizedState=Jo(K),X.childLanes=Zo($,ce,K),H.memoizedState=Xo,H=te);else if(di(H),Ll(me)){if(ce=me.nextSibling&&me.nextSibling.dataset,ce)var Pe=ce.dgst;ce=Pe,X=Error(F(419)),X.stack="",X.digest=ce,zr({value:X,source:null,stack:null}),H=tl($,H,K)}else if(Jt||Hr($,H,K,!1),ce=(K&$.childLanes)!==0,Jt||ce){if(ce=Dt,ce!==null&&(X=K&-K,X=(X&42)!==0?1:Ls(X),X=(X&(ce.suspendedLanes|K))!==0?0:X,X!==0&&X!==ve.retryLane))throw ve.retryLane=X,sr($,X),En(ce,$,X),Zu;me.data==="$?"||xl(),H=tl($,H,K)}else me.data==="$?"?(H.flags|=192,H.child=$.child,H=null):($=ve.treeContext,Lt=jn(me.nextSibling),un=H,kt=!0,Ni=null,Vn=!1,$!==null&&(An[Pn++]=Gn,An[Pn++]=Kn,An[Pn++]=Di,Gn=$.id,Kn=$.overflow,Di=H),H=el(H,X.children),H.flags|=4096);return H}return te?(hi(),te=X.fallback,me=H.mode,ve=$.child,Pe=ve.sibling,X=Hn(ve,{mode:"hidden",children:X.children}),X.subtreeFlags=ve.subtreeFlags&65011712,Pe!==null?te=Hn(Pe,te):(te=Oi(te,me,K,null),te.flags|=2),te.return=H,X.return=H,X.sibling=te,H.child=X,X=te,te=H.child,me=$.child.memoizedState,me===null?me=Jo(K):(ve=me.cachePool,ve!==null?(Pe=Kt._currentValue,ve=ve.parent!==Pe?{parent:Pe,pool:Pe}:ve):ve=Yc(),me={baseLanes:me.baseLanes|K,cachePool:ve}),te.memoizedState=me,te.childLanes=Zo($,ce,K),H.memoizedState=Xo,X):(di(H),K=$.child,$=K.sibling,K=Hn(K,{mode:"visible",children:X.children}),K.return=H,K.sibling=null,$!==null&&(ce=H.deletions,ce===null?(H.deletions=[$],H.flags|=16):ce.push($)),H.child=K,H.memoizedState=null,K)}function el($,H){return H=ls({mode:"visible",children:H},$.mode),H.return=$,$.child=H}function ls($,H){return $=xn(22,$,null,H),$.lanes=0,$.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},$}function tl($,H,K){return yr(H,$.child,null,K),$=el(H,H.pendingProps.children),$.flags|=2,H.memoizedState=null,$}function ud($,H,K){$.lanes|=H;var X=$.alternate;X!==null&&(X.lanes|=H),xo($.return,H,K)}function nl($,H,K,X,te){var ie=$.memoizedState;ie===null?$.memoizedState={isBackwards:H,rendering:null,renderingStartTime:0,last:X,tail:K,tailMode:te}:(ie.isBackwards=H,ie.rendering=null,ie.renderingStartTime=0,ie.last=X,ie.tail=K,ie.tailMode=te)}function dd($,H,K){var X=H.pendingProps,te=X.revealOrder,ie=X.tail;if(rn($,H,X.children,K),X=Yt.current,(X&2)!==0)X=X&1|2,H.flags|=128;else{if($!==null&&($.flags&128)!==0)e:for($=H.child;$!==null;){if($.tag===13)$.memoizedState!==null&&ud($,K,H);else if($.tag===19)ud($,K,H);else if($.child!==null){$.child.return=$,$=$.child;continue}if($===H)break e;for(;$.sibling===null;){if($.return===null||$.return===H)break e;$=$.return}$.sibling.return=$.return,$=$.sibling}X&=1}switch(ge(Yt,X),te){case"forwards":for(K=H.child,te=null;K!==null;)$=K.alternate,$!==null&&rs($)===null&&(te=K),K=K.sibling;K=te,K===null?(te=H.child,H.child=null):(te=K.sibling,K.sibling=null),nl(H,!1,te,K,ie);break;case"backwards":for(K=null,te=H.child,H.child=null;te!==null;){if($=te.alternate,$!==null&&rs($)===null){H.child=te;break}$=te.sibling,te.sibling=K,K=te,te=$}nl(H,!0,K,null,ie);break;case"together":nl(H,!1,null,null,void 0);break;default:H.memoizedState=null}return H.child}function Jn($,H,K){if($!==null&&(H.dependencies=$.dependencies),yi|=H.lanes,(K&H.childLanes)===0)if($!==null){if(Hr($,H,K,!1),(K&H.childLanes)===0)return null}else return null;if($!==null&&H.child!==$.child)throw Error(F(153));if(H.child!==null){for($=H.child,K=Hn($,$.pendingProps),H.child=K,K.return=H;$.sibling!==null;)$=$.sibling,K=K.sibling=Hn($,$.pendingProps),K.return=H;K.sibling=null}return H.child}function il($,H){return($.lanes&H)!==0?!0:($=$.dependencies,!!($!==null&&$a($)))}function Gf($,H,K){switch(H.tag){case 3:ut(H,H.stateNode.containerInfo),si(H,Kt,$.memoizedState.cache),qr();break;case 27:case 5:$t(H);break;case 4:ut(H,H.stateNode.containerInfo);break;case 10:si(H,H.type,H.memoizedProps.value);break;case 13:var X=H.memoizedState;if(X!==null)return X.dehydrated!==null?(di(H),H.flags|=128,null):(K&H.child.childLanes)!==0?cd($,H,K):(di(H),$=Jn($,H,K),$!==null?$.sibling:null);di(H);break;case 19:var te=($.flags&128)!==0;if(X=(K&H.childLanes)!==0,X||(Hr($,H,K,!1),X=(K&H.childLanes)!==0),te){if(X)return dd($,H,K);H.flags|=128}if(te=H.memoizedState,te!==null&&(te.rendering=null,te.tail=null,te.lastEffect=null),ge(Yt,Yt.current),X)break;return null;case 22:case 23:return H.lanes=0,rd($,H,K);case 24:si(H,Kt,$.memoizedState.cache)}return Jn($,H,K)}function hd($,H,K){if($!==null)if($.memoizedProps!==H.pendingProps)Jt=!0;else{if(!il($,K)&&(H.flags&128)===0)return Jt=!1,Gf($,H,K);Jt=($.flags&131072)!==0}else Jt=!1,kt&&(H.flags&1048576)!==0&&Bc(H,Ba,H.index);switch(H.lanes=0,H.tag){case 16:e:{$=H.pendingProps;var X=H.elementType,te=X._init;if(X=te(X._payload),H.type=X,typeof X=="function")ho(X)?($=Fi(X,$),H.tag=1,H=od(null,H,X,$,K)):(H.tag=0,H=Wo(null,H,X,$,K));else{if(X!=null){if(te=X.$$typeof,te===ye){H.tag=11,H=ed(null,H,X,$,K);break e}else if(te===xe){H.tag=14,H=td(null,H,X,$,K);break e}}throw H=Ne(X)||X,Error(F(306,H,""))}}return H;case 0:return Wo($,H,H.type,H.pendingProps,K);case 1:return X=H.type,te=Fi(X,H.pendingProps),od($,H,X,te,K);case 3:e:{if(ut(H,H.stateNode.containerInfo),$===null)throw Error(F(387));X=H.pendingProps;var ie=H.memoizedState;te=ie.element,wo($,H),Jr(H,X,null,K);var ce=H.memoizedState;if(X=ce.cache,si(H,Kt,X),X!==ie.cache&&bo(H,[Kt],K,!0),Xr(),X=ce.element,ie.isDehydrated)if(ie={element:X,isDehydrated:!1,cache:ce.cache},H.updateQueue.baseState=ie,H.memoizedState=ie,H.flags&256){H=ld($,H,X,K);break e}else if(X!==te){te=_n(Error(F(424)),H),zr(te),H=ld($,H,X,K);break e}else{switch($=H.stateNode.containerInfo,$.nodeType){case 9:$=$.body;break;default:$=$.nodeName==="HTML"?$.ownerDocument.body:$}for(Lt=jn($.firstChild),un=H,kt=!0,Ni=null,Vn=!0,K=qu(H,null,X,K),H.child=K;K;)K.flags=K.flags&-3|4096,K=K.sibling}else{if(qr(),X===te){H=Jn($,H,K);break e}rn($,H,X,K)}H=H.child}return H;case 26:return os($,H),$===null?(K=gh(H.type,null,H.pendingProps,null))?H.memoizedState=K:kt||(K=H.type,$=H.pendingProps,X=Ts($e.current).createElement(K),X[on]=H,X[hn]=$,sn(X,K,$),Xt(X),H.stateNode=X):H.memoizedState=gh(H.type,$.memoizedProps,H.pendingProps,$.memoizedState),null;case 27:return $t(H),$===null&&kt&&(X=H.stateNode=fh(H.type,H.pendingProps,$e.current),un=H,Vn=!0,te=Lt,Si(H.type)?(jl=te,Lt=jn(X.firstChild)):Lt=te),rn($,H,H.pendingProps.children,K),os($,H),$===null&&(H.flags|=4194304),H.child;case 5:return $===null&&kt&&((te=X=Lt)&&(X=bp(X,H.type,H.pendingProps,Vn),X!==null?(H.stateNode=X,un=H,Lt=jn(X.firstChild),Vn=!1,te=!0):te=!1),te||Ii(H)),$t(H),te=H.type,ie=H.pendingProps,ce=$!==null?$.memoizedProps:null,X=ie.children,Ml(te,ie)?X=null:ce!==null&&Ml(te,ce)&&(H.flags|=32),H.memoizedState!==null&&(te=Do($,H,Vf,null,null,K),ba._currentValue=te),os($,H),rn($,H,X,K),H.child;case 6:return $===null&&kt&&(($=K=Lt)&&(K=Sp(K,H.pendingProps,Vn),K!==null?(H.stateNode=K,un=H,Lt=null,$=!0):$=!1),$||Ii(H)),null;case 13:return cd($,H,K);case 4:return ut(H,H.stateNode.containerInfo),X=H.pendingProps,$===null?H.child=yr(H,null,X,K):rn($,H,X,K),H.child;case 11:return ed($,H,H.type,H.pendingProps,K);case 7:return rn($,H,H.pendingProps,K),H.child;case 8:return rn($,H,H.pendingProps.children,K),H.child;case 12:return rn($,H,H.pendingProps.children,K),H.child;case 10:return X=H.pendingProps,si(H,H.type,X.value),rn($,H,X.children,K),H.child;case 9:return te=H.type._context,X=H.pendingProps.children,ji(H),te=ln(te),X=X(te),H.flags|=1,rn($,H,X,K),H.child;case 14:return td($,H,H.type,H.pendingProps,K);case 15:return nd($,H,H.type,H.pendingProps,K);case 19:return dd($,H,K);case 31:return X=H.pendingProps,K=H.mode,X={mode:X.mode,children:X.children},$===null?(K=ls(X,K),K.ref=H.ref,H.child=K,K.return=H,H=K):(K=Hn($.child,X),K.ref=H.ref,H.child=K,K.return=H,H=K),H;case 22:return rd($,H,K);case 24:return ji(H),X=ln(Kt),$===null?(te=ko(),te===null&&(te=Dt,ie=So(),te.pooledCache=ie,ie.refCount++,ie!==null&&(te.pooledCacheLanes|=K),te=ie),H.memoizedState={parent:X,cache:te},Co(H),si(H,Kt,te)):(($.lanes&K)!==0&&(wo($,H),Jr(H,null,null,K),Xr()),te=$.memoizedState,ie=H.memoizedState,te.parent!==X?(te={parent:X,cache:X},H.memoizedState=te,H.lanes===0&&(H.memoizedState=H.updateQueue.baseState=te),si(H,Kt,X)):(X=ie.cache,si(H,Kt,X),X!==te.cache&&bo(H,[Kt],K,!0))),rn($,H,H.pendingProps.children,K),H.child;case 29:throw H.pendingProps}throw Error(F(156,H.tag))}function Zn($){$.flags|=4}function fd($,H){if(H.type!=="stylesheet"||(H.state.loading&4)!==0)$.flags&=-16777217;else if($.flags|=16777216,!Th(H)){if(H=On.current,H!==null&&((St&4194048)===St?Un!==null:(St&62914560)!==St&&(St&536870912)===0||H!==Un))throw Qr=Eo,Qc;$.flags|=8192}}function cs($,H){H!==null&&($.flags|=4),$.flags&16384&&(H=$.tag!==22?Pt():536870912,$.lanes|=H,Sr|=H)}function aa($,H){if(!kt)switch($.tailMode){case"hidden":H=$.tail;for(var K=null;H!==null;)H.alternate!==null&&(K=H),H=H.sibling;K===null?$.tail=null:K.sibling=null;break;case"collapsed":K=$.tail;for(var X=null;K!==null;)K.alternate!==null&&(X=K),K=K.sibling;X===null?H||$.tail===null?$.tail=null:$.tail.sibling=null:X.sibling=null}}function It($){var H=$.alternate!==null&&$.alternate.child===$.child,K=0,X=0;if(H)for(var te=$.child;te!==null;)K|=te.lanes|te.childLanes,X|=te.subtreeFlags&65011712,X|=te.flags&65011712,te.return=$,te=te.sibling;else for(te=$.child;te!==null;)K|=te.lanes|te.childLanes,X|=te.subtreeFlags,X|=te.flags,te.return=$,te=te.sibling;return $.subtreeFlags|=X,$.childLanes=K,H}function Kf($,H,K){var X=H.pendingProps;switch(go(H),H.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(H),null;case 1:return It(H),null;case 3:return K=H.stateNode,X=null,$!==null&&(X=$.memoizedState.cache),H.memoizedState.cache!==X&&(H.flags|=2048),Qn(Kt),ft(),K.pendingContext&&(K.context=K.pendingContext,K.pendingContext=null),($===null||$.child===null)&&($r(H)?Zn(H):$===null||$.memoizedState.isDehydrated&&(H.flags&256)===0||(H.flags|=1024,zc())),It(H),null;case 26:return K=H.memoizedState,$===null?(Zn(H),K!==null?(It(H),fd(H,K)):(It(H),H.flags&=-16777217)):K?K!==$.memoizedState?(Zn(H),It(H),fd(H,K)):(It(H),H.flags&=-16777217):($.memoizedProps!==X&&Zn(H),It(H),H.flags&=-16777217),null;case 27:Mt(H),K=$e.current;var te=H.type;if($!==null&&H.stateNode!=null)$.memoizedProps!==X&&Zn(H);else{if(!X){if(H.stateNode===null)throw Error(F(166));return It(H),null}$=We.current,$r(H)?$c(H):($=fh(te,X,K),H.stateNode=$,Zn(H))}return It(H),null;case 5:if(Mt(H),K=H.type,$!==null&&H.stateNode!=null)$.memoizedProps!==X&&Zn(H);else{if(!X){if(H.stateNode===null)throw Error(F(166));return It(H),null}if($=We.current,$r(H))$c(H);else{switch(te=Ts($e.current),$){case 1:$=te.createElementNS("http://www.w3.org/2000/svg",K);break;case 2:$=te.createElementNS("http://www.w3.org/1998/Math/MathML",K);break;default:switch(K){case"svg":$=te.createElementNS("http://www.w3.org/2000/svg",K);break;case"math":$=te.createElementNS("http://www.w3.org/1998/Math/MathML",K);break;case"script":$=te.createElement("div"),$.innerHTML="<script><\/script>",$=$.removeChild($.firstChild);break;case"select":$=typeof X.is=="string"?te.createElement("select",{is:X.is}):te.createElement("select"),X.multiple?$.multiple=!0:X.size&&($.size=X.size);break;default:$=typeof X.is=="string"?te.createElement(K,{is:X.is}):te.createElement(K)}}$[on]=H,$[hn]=X;e:for(te=H.child;te!==null;){if(te.tag===5||te.tag===6)$.appendChild(te.stateNode);else if(te.tag!==4&&te.tag!==27&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===H)break e;for(;te.sibling===null;){if(te.return===null||te.return===H)break e;te=te.return}te.sibling.return=te.return,te=te.sibling}H.stateNode=$;e:switch(sn($,K,X),K){case"button":case"input":case"select":case"textarea":$=!!X.autoFocus;break e;case"img":$=!0;break e;default:$=!1}$&&Zn(H)}}return It(H),H.flags&=-16777217,null;case 6:if($&&H.stateNode!=null)$.memoizedProps!==X&&Zn(H);else{if(typeof X!="string"&&H.stateNode===null)throw Error(F(166));if($=$e.current,$r(H)){if($=H.stateNode,K=H.memoizedProps,X=null,te=un,te!==null)switch(te.tag){case 27:case 5:X=te.memoizedProps}$[on]=H,$=!!($.nodeValue===K||X!==null&&X.suppressHydrationWarning===!0||sh($.nodeValue,K)),$||Ii(H)}else $=Ts($).createTextNode(X),$[on]=H,H.stateNode=$}return It(H),null;case 13:if(X=H.memoizedState,$===null||$.memoizedState!==null&&$.memoizedState.dehydrated!==null){if(te=$r(H),X!==null&&X.dehydrated!==null){if($===null){if(!te)throw Error(F(318));if(te=H.memoizedState,te=te!==null?te.dehydrated:null,!te)throw Error(F(317));te[on]=H}else qr(),(H.flags&128)===0&&(H.memoizedState=null),H.flags|=4;It(H),te=!1}else te=zc(),$!==null&&$.memoizedState!==null&&($.memoizedState.hydrationErrors=te),te=!0;if(!te)return H.flags&256?(Xn(H),H):(Xn(H),null)}if(Xn(H),(H.flags&128)!==0)return H.lanes=K,H;if(K=X!==null,$=$!==null&&$.memoizedState!==null,K){X=H.child,te=null,X.alternate!==null&&X.alternate.memoizedState!==null&&X.alternate.memoizedState.cachePool!==null&&(te=X.alternate.memoizedState.cachePool.pool);var ie=null;X.memoizedState!==null&&X.memoizedState.cachePool!==null&&(ie=X.memoizedState.cachePool.pool),ie!==te&&(X.flags|=2048)}return K!==$&&K&&(H.child.flags|=8192),cs(H,H.updateQueue),It(H),null;case 4:return ft(),$===null&&Rl(H.stateNode.containerInfo),It(H),null;case 10:return Qn(H.type),It(H),null;case 19:if(He(Yt),te=H.memoizedState,te===null)return It(H),null;if(X=(H.flags&128)!==0,ie=te.rendering,ie===null)if(X)aa(te,!1);else{if(jt!==0||$!==null&&($.flags&128)!==0)for($=H.child;$!==null;){if(ie=rs($),ie!==null){for(H.flags|=128,aa(te,!1),$=ie.updateQueue,H.updateQueue=$,cs(H,$),H.subtreeFlags=0,$=K,K=H.child;K!==null;)Fc(K,$),K=K.sibling;return ge(Yt,Yt.current&1|2),H.child}$=$.sibling}te.tail!==null&&bt()>hs&&(H.flags|=128,X=!0,aa(te,!1),H.lanes=4194304)}else{if(!X)if($=rs(ie),$!==null){if(H.flags|=128,X=!0,$=$.updateQueue,H.updateQueue=$,cs(H,$),aa(te,!0),te.tail===null&&te.tailMode==="hidden"&&!ie.alternate&&!kt)return It(H),null}else 2*bt()-te.renderingStartTime>hs&&K!==536870912&&(H.flags|=128,X=!0,aa(te,!1),H.lanes=4194304);te.isBackwards?(ie.sibling=H.child,H.child=ie):($=te.last,$!==null?$.sibling=ie:H.child=ie,te.last=ie)}return te.tail!==null?(H=te.tail,te.rendering=H,te.tail=H.sibling,te.renderingStartTime=bt(),H.sibling=null,$=Yt.current,ge(Yt,X?$&1|2:$&1),H):(It(H),null);case 22:case 23:return Xn(H),Po(),X=H.memoizedState!==null,$!==null?$.memoizedState!==null!==X&&(H.flags|=8192):X&&(H.flags|=8192),X?(K&536870912)!==0&&(H.flags&128)===0&&(It(H),H.subtreeFlags&6&&(H.flags|=8192)):It(H),K=H.updateQueue,K!==null&&cs(H,K.retryQueue),K=null,$!==null&&$.memoizedState!==null&&$.memoizedState.cachePool!==null&&(K=$.memoizedState.cachePool.pool),X=null,H.memoizedState!==null&&H.memoizedState.cachePool!==null&&(X=H.memoizedState.cachePool.pool),X!==K&&(H.flags|=2048),$!==null&&He(Vi),null;case 24:return K=null,$!==null&&(K=$.memoizedState.cache),H.memoizedState.cache!==K&&(H.flags|=2048),Qn(Kt),It(H),null;case 25:return null;case 30:return null}throw Error(F(156,H.tag))}function Yf($,H){switch(go(H),H.tag){case 1:return $=H.flags,$&65536?(H.flags=$&-65537|128,H):null;case 3:return Qn(Kt),ft(),$=H.flags,($&65536)!==0&&($&128)===0?(H.flags=$&-65537|128,H):null;case 26:case 27:case 5:return Mt(H),null;case 13:if(Xn(H),$=H.memoizedState,$!==null&&$.dehydrated!==null){if(H.alternate===null)throw Error(F(340));qr()}return $=H.flags,$&65536?(H.flags=$&-65537|128,H):null;case 19:return He(Yt),null;case 4:return ft(),null;case 10:return Qn(H.type),null;case 22:case 23:return Xn(H),Po(),$!==null&&He(Vi),$=H.flags,$&65536?(H.flags=$&-65537|128,H):null;case 24:return Qn(Kt),null;case 25:return null;default:return null}}function pd($,H){switch(go(H),H.tag){case 3:Qn(Kt),ft();break;case 26:case 27:case 5:Mt(H);break;case 4:ft();break;case 13:Xn(H);break;case 19:He(Yt);break;case 10:Qn(H.type);break;case 22:case 23:Xn(H),Po(),$!==null&&He(Vi);break;case 24:Qn(Kt)}}function sa($,H){try{var K=H.updateQueue,X=K!==null?K.lastEffect:null;if(X!==null){var te=X.next;K=te;do{if((K.tag&$)===$){X=void 0;var ie=K.create,ce=K.inst;X=ie(),ce.destroy=X}K=K.next}while(K!==te)}}catch(me){Ot(H,H.return,me)}}function fi($,H,K){try{var X=H.updateQueue,te=X!==null?X.lastEffect:null;if(te!==null){var ie=te.next;X=ie;do{if((X.tag&$)===$){var ce=X.inst,me=ce.destroy;if(me!==void 0){ce.destroy=void 0,te=H;var ve=K,Pe=me;try{Pe()}catch(qe){Ot(te,ve,qe)}}}X=X.next}while(X!==ie)}}catch(qe){Ot(H,H.return,qe)}}function md($){var H=$.updateQueue;if(H!==null){var K=$.stateNode;try{tu(H,K)}catch(X){Ot($,$.return,X)}}}function gd($,H,K){K.props=Fi($.type,$.memoizedProps),K.state=$.memoizedState;try{K.componentWillUnmount()}catch(X){Ot($,H,X)}}function oa($,H){try{var K=$.ref;if(K!==null){switch($.tag){case 26:case 27:case 5:var X=$.stateNode;break;case 30:X=$.stateNode;break;default:X=$.stateNode}typeof K=="function"?$.refCleanup=K(X):K.current=X}}catch(te){Ot($,H,te)}}function Fn($,H){var K=$.ref,X=$.refCleanup;if(K!==null)if(typeof X=="function")try{X()}catch(te){Ot($,H,te)}finally{$.refCleanup=null,$=$.alternate,$!=null&&($.refCleanup=null)}else if(typeof K=="function")try{K(null)}catch(te){Ot($,H,te)}else K.current=null}function yd($){var H=$.type,K=$.memoizedProps,X=$.stateNode;try{e:switch(H){case"button":case"input":case"select":case"textarea":K.autoFocus&&X.focus();break e;case"img":K.src?X.src=K.src:K.srcSet&&(X.srcset=K.srcSet)}}catch(te){Ot($,$.return,te)}}function rl($,H,K){try{var X=$.stateNode;mp(X,$.type,K,H),X[hn]=H}catch(te){Ot($,$.return,te)}}function vd($){return $.tag===5||$.tag===3||$.tag===26||$.tag===27&&Si($.type)||$.tag===4}function al($){e:for(;;){for(;$.sibling===null;){if($.return===null||vd($.return))return null;$=$.return}for($.sibling.return=$.return,$=$.sibling;$.tag!==5&&$.tag!==6&&$.tag!==18;){if($.tag===27&&Si($.type)||$.flags&2||$.child===null||$.tag===4)continue e;$.child.return=$,$=$.child}if(!($.flags&2))return $.stateNode}}function sl($,H,K){var X=$.tag;if(X===5||X===6)$=$.stateNode,H?(K.nodeType===9?K.body:K.nodeName==="HTML"?K.ownerDocument.body:K).insertBefore($,H):(H=K.nodeType===9?K.body:K.nodeName==="HTML"?K.ownerDocument.body:K,H.appendChild($),K=K._reactRootContainer,K!=null||H.onclick!==null||(H.onclick=Ss));else if(X!==4&&(X===27&&Si($.type)&&(K=$.stateNode,H=null),$=$.child,$!==null))for(sl($,H,K),$=$.sibling;$!==null;)sl($,H,K),$=$.sibling}function us($,H,K){var X=$.tag;if(X===5||X===6)$=$.stateNode,H?K.insertBefore($,H):K.appendChild($);else if(X!==4&&(X===27&&Si($.type)&&(K=$.stateNode),$=$.child,$!==null))for(us($,H,K),$=$.sibling;$!==null;)us($,H,K),$=$.sibling}function xd($){var H=$.stateNode,K=$.memoizedProps;try{for(var X=$.type,te=H.attributes;te.length;)H.removeAttributeNode(te[0]);sn(H,X,K),H[on]=$,H[hn]=K}catch(ie){Ot($,$.return,ie)}}var ei=!1,Bt=!1,ol=!1,bd=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function Qf($,H){if($=$.containerInfo,Ol=Rs,$=Pc($),ro($)){if("selectionStart"in $)var K={start:$.selectionStart,end:$.selectionEnd};else e:{K=(K=$.ownerDocument)&&K.defaultView||window;var X=K.getSelection&&K.getSelection();if(X&&X.rangeCount!==0){K=X.anchorNode;var te=X.anchorOffset,ie=X.focusNode;X=X.focusOffset;try{K.nodeType,ie.nodeType}catch{K=null;break e}var ce=0,me=-1,ve=-1,Pe=0,qe=0,Qe=$,Me=null;t:for(;;){for(var Ie;Qe!==K||te!==0&&Qe.nodeType!==3||(me=ce+te),Qe!==ie||X!==0&&Qe.nodeType!==3||(ve=ce+X),Qe.nodeType===3&&(ce+=Qe.nodeValue.length),(Ie=Qe.firstChild)!==null;)Me=Qe,Qe=Ie;for(;;){if(Qe===$)break t;if(Me===K&&++Pe===te&&(me=ce),Me===ie&&++qe===X&&(ve=ce),(Ie=Qe.nextSibling)!==null)break;Qe=Me,Me=Qe.parentNode}Qe=Ie}K=me===-1||ve===-1?null:{start:me,end:ve}}else K=null}K=K||{start:0,end:0}}else K=null;for(Dl={focusedElem:$,selectionRange:K},Rs=!1,Zt=H;Zt!==null;)if(H=Zt,$=H.child,(H.subtreeFlags&1024)!==0&&$!==null)$.return=H,Zt=$;else for(;Zt!==null;){switch(H=Zt,ie=H.alternate,$=H.flags,H.tag){case 0:break;case 11:case 15:break;case 1:if(($&1024)!==0&&ie!==null){$=void 0,K=H,te=ie.memoizedProps,ie=ie.memoizedState,X=K.stateNode;try{var ct=Fi(K.type,te,K.elementType===K.type);$=X.getSnapshotBeforeUpdate(ct,ie),X.__reactInternalSnapshotBeforeUpdate=$}catch(ot){Ot(K,K.return,ot)}}break;case 3:if(($&1024)!==0){if($=H.stateNode.containerInfo,K=$.nodeType,K===9)Il($);else if(K===1)switch($.nodeName){case"HEAD":case"HTML":case"BODY":Il($);break;default:$.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(($&1024)!==0)throw Error(F(163))}if($=H.sibling,$!==null){$.return=H.return,Zt=$;break}Zt=H.return}}function Sd($,H,K){var X=K.flags;switch(K.tag){case 0:case 11:case 15:pi($,K),X&4&&sa(5,K);break;case 1:if(pi($,K),X&4)if($=K.stateNode,H===null)try{$.componentDidMount()}catch(ce){Ot(K,K.return,ce)}else{var te=Fi(K.type,H.memoizedProps);H=H.memoizedState;try{$.componentDidUpdate(te,H,$.__reactInternalSnapshotBeforeUpdate)}catch(ce){Ot(K,K.return,ce)}}X&64&&md(K),X&512&&oa(K,K.return);break;case 3:if(pi($,K),X&64&&($=K.updateQueue,$!==null)){if(H=null,K.child!==null)switch(K.child.tag){case 27:case 5:H=K.child.stateNode;break;case 1:H=K.child.stateNode}try{tu($,H)}catch(ce){Ot(K,K.return,ce)}}break;case 27:H===null&&X&4&&xd(K);case 26:case 5:pi($,K),H===null&&X&4&&yd(K),X&512&&oa(K,K.return);break;case 12:pi($,K);break;case 13:pi($,K),X&4&&Ed($,K),X&64&&($=K.memoizedState,$!==null&&($=$.dehydrated,$!==null&&(K=rp.bind(null,K),Tp($,K))));break;case 22:if(X=K.memoizedState!==null||ei,!X){H=H!==null&&H.memoizedState!==null||Bt,te=ei;var ie=Bt;ei=X,(Bt=H)&&!ie?mi($,K,(K.subtreeFlags&8772)!==0):pi($,K),ei=te,Bt=ie}break;case 30:break;default:pi($,K)}}function Td($){var H=$.alternate;H!==null&&($.alternate=null,Td(H)),$.child=null,$.deletions=null,$.sibling=null,$.tag===5&&(H=$.stateNode,H!==null&&Us(H)),$.stateNode=null,$.return=null,$.dependencies=null,$.memoizedProps=null,$.memoizedState=null,$.pendingProps=null,$.stateNode=null,$.updateQueue=null}var Nt=null,mn=!1;function ti($,H,K){for(K=K.child;K!==null;)kd($,H,K),K=K.sibling}function kd($,H,K){if(je&&typeof je.onCommitFiberUnmount=="function")try{je.onCommitFiberUnmount(_e,K)}catch{}switch(K.tag){case 26:Bt||Fn(K,H),ti($,H,K),K.memoizedState?K.memoizedState.count--:K.stateNode&&(K=K.stateNode,K.parentNode.removeChild(K));break;case 27:Bt||Fn(K,H);var X=Nt,te=mn;Si(K.type)&&(Nt=K.stateNode,mn=!1),ti($,H,K),ga(K.stateNode),Nt=X,mn=te;break;case 5:Bt||Fn(K,H);case 6:if(X=Nt,te=mn,Nt=null,ti($,H,K),Nt=X,mn=te,Nt!==null)if(mn)try{(Nt.nodeType===9?Nt.body:Nt.nodeName==="HTML"?Nt.ownerDocument.body:Nt).removeChild(K.stateNode)}catch(ie){Ot(K,H,ie)}else try{Nt.removeChild(K.stateNode)}catch(ie){Ot(K,H,ie)}break;case 18:Nt!==null&&(mn?($=Nt,dh($.nodeType===9?$.body:$.nodeName==="HTML"?$.ownerDocument.body:$,K.stateNode),Ea($)):dh(Nt,K.stateNode));break;case 4:X=Nt,te=mn,Nt=K.stateNode.containerInfo,mn=!0,ti($,H,K),Nt=X,mn=te;break;case 0:case 11:case 14:case 15:Bt||fi(2,K,H),Bt||fi(4,K,H),ti($,H,K);break;case 1:Bt||(Fn(K,H),X=K.stateNode,typeof X.componentWillUnmount=="function"&&gd(K,H,X)),ti($,H,K);break;case 21:ti($,H,K);break;case 22:Bt=(X=Bt)||K.memoizedState!==null,ti($,H,K),Bt=X;break;default:ti($,H,K)}}function Ed($,H){if(H.memoizedState===null&&($=H.alternate,$!==null&&($=$.memoizedState,$!==null&&($=$.dehydrated,$!==null))))try{Ea($)}catch(K){Ot(H,H.return,K)}}function Wf($){switch($.tag){case 13:case 19:var H=$.stateNode;return H===null&&(H=$.stateNode=new bd),H;case 22:return $=$.stateNode,H=$._retryCache,H===null&&(H=$._retryCache=new bd),H;default:throw Error(F(435,$.tag))}}function ll($,H){var K=Wf($);H.forEach(function(X){var te=ap.bind(null,$,X);K.has(X)||(K.add(X),X.then(te,te))})}function bn($,H){var K=H.deletions;if(K!==null)for(var X=0;X<K.length;X++){var te=K[X],ie=$,ce=H,me=ce;e:for(;me!==null;){switch(me.tag){case 27:if(Si(me.type)){Nt=me.stateNode,mn=!1;break e}break;case 5:Nt=me.stateNode,mn=!1;break e;case 3:case 4:Nt=me.stateNode.containerInfo,mn=!0;break e}me=me.return}if(Nt===null)throw Error(F(160));kd(ie,ce,te),Nt=null,mn=!1,ie=te.alternate,ie!==null&&(ie.return=null),te.return=null}if(H.subtreeFlags&13878)for(H=H.child;H!==null;)Cd(H,$),H=H.sibling}var Ln=null;function Cd($,H){var K=$.alternate,X=$.flags;switch($.tag){case 0:case 11:case 14:case 15:bn(H,$),Sn($),X&4&&(fi(3,$,$.return),sa(3,$),fi(5,$,$.return));break;case 1:bn(H,$),Sn($),X&512&&(Bt||K===null||Fn(K,K.return)),X&64&&ei&&($=$.updateQueue,$!==null&&(X=$.callbacks,X!==null&&(K=$.shared.hiddenCallbacks,$.shared.hiddenCallbacks=K===null?X:K.concat(X))));break;case 26:var te=Ln;if(bn(H,$),Sn($),X&512&&(Bt||K===null||Fn(K,K.return)),X&4){var ie=K!==null?K.memoizedState:null;if(X=$.memoizedState,K===null)if(X===null)if($.stateNode===null){e:{X=$.type,K=$.memoizedProps,te=te.ownerDocument||te;t:switch(X){case"title":ie=te.getElementsByTagName("title")[0],(!ie||ie[Or]||ie[on]||ie.namespaceURI==="http://www.w3.org/2000/svg"||ie.hasAttribute("itemprop"))&&(ie=te.createElement(X),te.head.insertBefore(ie,te.querySelector("head > title"))),sn(ie,X,K),ie[on]=$,Xt(ie),X=ie;break e;case"link":var ce=bh("link","href",te).get(X+(K.href||""));if(ce){for(var me=0;me<ce.length;me++)if(ie=ce[me],ie.getAttribute("href")===(K.href==null||K.href===""?null:K.href)&&ie.getAttribute("rel")===(K.rel==null?null:K.rel)&&ie.getAttribute("title")===(K.title==null?null:K.title)&&ie.getAttribute("crossorigin")===(K.crossOrigin==null?null:K.crossOrigin)){ce.splice(me,1);break t}}ie=te.createElement(X),sn(ie,X,K),te.head.appendChild(ie);break;case"meta":if(ce=bh("meta","content",te).get(X+(K.content||""))){for(me=0;me<ce.length;me++)if(ie=ce[me],ie.getAttribute("content")===(K.content==null?null:""+K.content)&&ie.getAttribute("name")===(K.name==null?null:K.name)&&ie.getAttribute("property")===(K.property==null?null:K.property)&&ie.getAttribute("http-equiv")===(K.httpEquiv==null?null:K.httpEquiv)&&ie.getAttribute("charset")===(K.charSet==null?null:K.charSet)){ce.splice(me,1);break t}}ie=te.createElement(X),sn(ie,X,K),te.head.appendChild(ie);break;default:throw Error(F(468,X))}ie[on]=$,Xt(ie),X=ie}$.stateNode=X}else Sh(te,$.type,$.stateNode);else $.stateNode=xh(te,X,$.memoizedProps);else ie!==X?(ie===null?K.stateNode!==null&&(K=K.stateNode,K.parentNode.removeChild(K)):ie.count--,X===null?Sh(te,$.type,$.stateNode):xh(te,X,$.memoizedProps)):X===null&&$.stateNode!==null&&rl($,$.memoizedProps,K.memoizedProps)}break;case 27:bn(H,$),Sn($),X&512&&(Bt||K===null||Fn(K,K.return)),K!==null&&X&4&&rl($,$.memoizedProps,K.memoizedProps);break;case 5:if(bn(H,$),Sn($),X&512&&(Bt||K===null||Fn(K,K.return)),$.flags&32){te=$.stateNode;try{Zi(te,"")}catch(Ie){Ot($,$.return,Ie)}}X&4&&$.stateNode!=null&&(te=$.memoizedProps,rl($,te,K!==null?K.memoizedProps:te)),X&1024&&(ol=!0);break;case 6:if(bn(H,$),Sn($),X&4){if($.stateNode===null)throw Error(F(162));X=$.memoizedProps,K=$.stateNode;try{K.nodeValue=X}catch(Ie){Ot($,$.return,Ie)}}break;case 3:if(Cs=null,te=Ln,Ln=ks(H.containerInfo),bn(H,$),Ln=te,Sn($),X&4&&K!==null&&K.memoizedState.isDehydrated)try{Ea(H.containerInfo)}catch(Ie){Ot($,$.return,Ie)}ol&&(ol=!1,wd($));break;case 4:X=Ln,Ln=ks($.stateNode.containerInfo),bn(H,$),Sn($),Ln=X;break;case 12:bn(H,$),Sn($);break;case 13:bn(H,$),Sn($),$.child.flags&8192&&$.memoizedState!==null!=(K!==null&&K.memoizedState!==null)&&(pl=bt()),X&4&&(X=$.updateQueue,X!==null&&($.updateQueue=null,ll($,X)));break;case 22:te=$.memoizedState!==null;var ve=K!==null&&K.memoizedState!==null,Pe=ei,qe=Bt;if(ei=Pe||te,Bt=qe||ve,bn(H,$),Bt=qe,ei=Pe,Sn($),X&8192)e:for(H=$.stateNode,H._visibility=te?H._visibility&-2:H._visibility|1,te&&(K===null||ve||ei||Bt||Bi($)),K=null,H=$;;){if(H.tag===5||H.tag===26){if(K===null){ve=K=H;try{if(ie=ve.stateNode,te)ce=ie.style,typeof ce.setProperty=="function"?ce.setProperty("display","none","important"):ce.display="none";else{me=ve.stateNode;var Qe=ve.memoizedProps.style,Me=Qe!=null&&Qe.hasOwnProperty("display")?Qe.display:null;me.style.display=Me==null||typeof Me=="boolean"?"":(""+Me).trim()}}catch(Ie){Ot(ve,ve.return,Ie)}}}else if(H.tag===6){if(K===null){ve=H;try{ve.stateNode.nodeValue=te?"":ve.memoizedProps}catch(Ie){Ot(ve,ve.return,Ie)}}}else if((H.tag!==22&&H.tag!==23||H.memoizedState===null||H===$)&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===$)break e;for(;H.sibling===null;){if(H.return===null||H.return===$)break e;K===H&&(K=null),H=H.return}K===H&&(K=null),H.sibling.return=H.return,H=H.sibling}X&4&&(X=$.updateQueue,X!==null&&(K=X.retryQueue,K!==null&&(X.retryQueue=null,ll($,K))));break;case 19:bn(H,$),Sn($),X&4&&(X=$.updateQueue,X!==null&&($.updateQueue=null,ll($,X)));break;case 30:break;case 21:break;default:bn(H,$),Sn($)}}function Sn($){var H=$.flags;if(H&2){try{for(var K,X=$.return;X!==null;){if(vd(X)){K=X;break}X=X.return}if(K==null)throw Error(F(160));switch(K.tag){case 27:var te=K.stateNode,ie=al($);us($,ie,te);break;case 5:var ce=K.stateNode;K.flags&32&&(Zi(ce,""),K.flags&=-33);var me=al($);us($,me,ce);break;case 3:case 4:var ve=K.stateNode.containerInfo,Pe=al($);sl($,Pe,ve);break;default:throw Error(F(161))}}catch(qe){Ot($,$.return,qe)}$.flags&=-3}H&4096&&($.flags&=-4097)}function wd($){if($.subtreeFlags&1024)for($=$.child;$!==null;){var H=$;wd(H),H.tag===5&&H.flags&1024&&H.stateNode.reset(),$=$.sibling}}function pi($,H){if(H.subtreeFlags&8772)for(H=H.child;H!==null;)Sd($,H.alternate,H),H=H.sibling}function Bi($){for($=$.child;$!==null;){var H=$;switch(H.tag){case 0:case 11:case 14:case 15:fi(4,H,H.return),Bi(H);break;case 1:Fn(H,H.return);var K=H.stateNode;typeof K.componentWillUnmount=="function"&&gd(H,H.return,K),Bi(H);break;case 27:ga(H.stateNode);case 26:case 5:Fn(H,H.return),Bi(H);break;case 22:H.memoizedState===null&&Bi(H);break;case 30:Bi(H);break;default:Bi(H)}$=$.sibling}}function mi($,H,K){for(K=K&&(H.subtreeFlags&8772)!==0,H=H.child;H!==null;){var X=H.alternate,te=$,ie=H,ce=ie.flags;switch(ie.tag){case 0:case 11:case 15:mi(te,ie,K),sa(4,ie);break;case 1:if(mi(te,ie,K),X=ie,te=X.stateNode,typeof te.componentDidMount=="function")try{te.componentDidMount()}catch(Pe){Ot(X,X.return,Pe)}if(X=ie,te=X.updateQueue,te!==null){var me=X.stateNode;try{var ve=te.shared.hiddenCallbacks;if(ve!==null)for(te.shared.hiddenCallbacks=null,te=0;te<ve.length;te++)eu(ve[te],me)}catch(Pe){Ot(X,X.return,Pe)}}K&&ce&64&&md(ie),oa(ie,ie.return);break;case 27:xd(ie);case 26:case 5:mi(te,ie,K),K&&X===null&&ce&4&&yd(ie),oa(ie,ie.return);break;case 12:mi(te,ie,K);break;case 13:mi(te,ie,K),K&&ce&4&&Ed(te,ie);break;case 22:ie.memoizedState===null&&mi(te,ie,K),oa(ie,ie.return);break;case 30:break;default:mi(te,ie,K)}H=H.sibling}}function cl($,H){var K=null;$!==null&&$.memoizedState!==null&&$.memoizedState.cachePool!==null&&(K=$.memoizedState.cachePool.pool),$=null,H.memoizedState!==null&&H.memoizedState.cachePool!==null&&($=H.memoizedState.cachePool.pool),$!==K&&($!=null&&$.refCount++,K!=null&&Gr(K))}function ul($,H){$=null,H.alternate!==null&&($=H.alternate.memoizedState.cache),H=H.memoizedState.cache,H!==$&&(H.refCount++,$!=null&&Gr($))}function Bn($,H,K,X){if(H.subtreeFlags&10256)for(H=H.child;H!==null;)_d($,H,K,X),H=H.sibling}function _d($,H,K,X){var te=H.flags;switch(H.tag){case 0:case 11:case 15:Bn($,H,K,X),te&2048&&sa(9,H);break;case 1:Bn($,H,K,X);break;case 3:Bn($,H,K,X),te&2048&&($=null,H.alternate!==null&&($=H.alternate.memoizedState.cache),H=H.memoizedState.cache,H!==$&&(H.refCount++,$!=null&&Gr($)));break;case 12:if(te&2048){Bn($,H,K,X),$=H.stateNode;try{var ie=H.memoizedProps,ce=ie.id,me=ie.onPostCommit;typeof me=="function"&&me(ce,H.alternate===null?"mount":"update",$.passiveEffectDuration,-0)}catch(ve){Ot(H,H.return,ve)}}else Bn($,H,K,X);break;case 13:Bn($,H,K,X);break;case 23:break;case 22:ie=H.stateNode,ce=H.alternate,H.memoizedState!==null?ie._visibility&2?Bn($,H,K,X):la($,H):ie._visibility&2?Bn($,H,K,X):(ie._visibility|=2,vr($,H,K,X,(H.subtreeFlags&10256)!==0)),te&2048&&cl(ce,H);break;case 24:Bn($,H,K,X),te&2048&&ul(H.alternate,H);break;default:Bn($,H,K,X)}}function vr($,H,K,X,te){for(te=te&&(H.subtreeFlags&10256)!==0,H=H.child;H!==null;){var ie=$,ce=H,me=K,ve=X,Pe=ce.flags;switch(ce.tag){case 0:case 11:case 15:vr(ie,ce,me,ve,te),sa(8,ce);break;case 23:break;case 22:var qe=ce.stateNode;ce.memoizedState!==null?qe._visibility&2?vr(ie,ce,me,ve,te):la(ie,ce):(qe._visibility|=2,vr(ie,ce,me,ve,te)),te&&Pe&2048&&cl(ce.alternate,ce);break;case 24:vr(ie,ce,me,ve,te),te&&Pe&2048&&ul(ce.alternate,ce);break;default:vr(ie,ce,me,ve,te)}H=H.sibling}}function la($,H){if(H.subtreeFlags&10256)for(H=H.child;H!==null;){var K=$,X=H,te=X.flags;switch(X.tag){case 22:la(K,X),te&2048&&cl(X.alternate,X);break;case 24:la(K,X),te&2048&&ul(X.alternate,X);break;default:la(K,X)}H=H.sibling}}var ca=8192;function xr($){if($.subtreeFlags&ca)for($=$.child;$!==null;)Rd($),$=$.sibling}function Rd($){switch($.tag){case 26:xr($),$.flags&ca&&$.memoizedState!==null&&Ip(Ln,$.memoizedState,$.memoizedProps);break;case 5:xr($);break;case 3:case 4:var H=Ln;Ln=ks($.stateNode.containerInfo),xr($),Ln=H;break;case 22:$.memoizedState===null&&(H=$.alternate,H!==null&&H.memoizedState!==null?(H=ca,ca=16777216,xr($),ca=H):xr($));break;default:xr($)}}function Ad($){var H=$.alternate;if(H!==null&&($=H.child,$!==null)){H.child=null;do H=$.sibling,$.sibling=null,$=H;while($!==null)}}function ua($){var H=$.deletions;if(($.flags&16)!==0){if(H!==null)for(var K=0;K<H.length;K++){var X=H[K];Zt=X,Od(X,$)}Ad($)}if($.subtreeFlags&10256)for($=$.child;$!==null;)Pd($),$=$.sibling}function Pd($){switch($.tag){case 0:case 11:case 15:ua($),$.flags&2048&&fi(9,$,$.return);break;case 3:ua($);break;case 12:ua($);break;case 22:var H=$.stateNode;$.memoizedState!==null&&H._visibility&2&&($.return===null||$.return.tag!==13)?(H._visibility&=-3,ds($)):ua($);break;default:ua($)}}function ds($){var H=$.deletions;if(($.flags&16)!==0){if(H!==null)for(var K=0;K<H.length;K++){var X=H[K];Zt=X,Od(X,$)}Ad($)}for($=$.child;$!==null;){switch(H=$,H.tag){case 0:case 11:case 15:fi(8,H,H.return),ds(H);break;case 22:K=H.stateNode,K._visibility&2&&(K._visibility&=-3,ds(H));break;default:ds(H)}$=$.sibling}}function Od($,H){for(;Zt!==null;){var K=Zt;switch(K.tag){case 0:case 11:case 15:fi(8,K,H);break;case 23:case 22:if(K.memoizedState!==null&&K.memoizedState.cachePool!==null){var X=K.memoizedState.cachePool.pool;X!=null&&X.refCount++}break;case 24:Gr(K.memoizedState.cache)}if(X=K.child,X!==null)X.return=K,Zt=X;else e:for(K=$;Zt!==null;){X=Zt;var te=X.sibling,ie=X.return;if(Td(X),X===K){Zt=null;break e}if(te!==null){te.return=ie,Zt=te;break e}Zt=ie}}}var Xf={getCacheForType:function($){var H=ln(Kt),K=H.data.get($);return K===void 0&&(K=$(),H.data.set($,K)),K}},Jf=typeof WeakMap=="function"?WeakMap:Map,Et=0,Dt=null,yt=null,St=0,Ct=0,Tn=null,gi=!1,br=!1,dl=!1,ni=0,jt=0,yi=0,$i=0,hl=0,Dn=0,Sr=0,da=null,gn=null,fl=!1,pl=0,hs=1/0,fs=null,vi=null,an=0,xi=null,Tr=null,kr=0,ml=0,gl=null,Dd=null,ha=0,yl=null;function kn(){if((Et&2)!==0&&St!==0)return St&-St;if(Te.T!==null){var $=ur;return $!==0?$:El()}return Kl()}function Md(){Dn===0&&(Dn=(St&536870912)===0||kt?dt():536870912);var $=On.current;return $!==null&&($.flags|=32),Dn}function En($,H,K){($===Dt&&(Ct===2||Ct===9)||$.cancelPendingCommit!==null)&&(Er($,0),bi($,St,Dn,!1)),Ut($,K),((Et&2)===0||$!==Dt)&&($===Dt&&((Et&2)===0&&($i|=K),jt===4&&bi($,St,Dn,!1)),$n($))}function Nd($,H,K){if((Et&6)!==0)throw Error(F(327));var X=!K&&(H&124)===0&&(H&$.expiredLanes)===0||Je($,H),te=X?tp($,H):bl($,H,!0),ie=X;do{if(te===0){br&&!X&&bi($,H,0,!1);break}else{if(K=$.current.alternate,ie&&!Zf(K)){te=bl($,H,!1),ie=!1;continue}if(te===2){if(ie=H,$.errorRecoveryDisabledLanes&ie)var ce=0;else ce=$.pendingLanes&-536870913,ce=ce!==0?ce:ce&536870912?536870912:0;if(ce!==0){H=ce;e:{var me=$;te=da;var ve=me.current.memoizedState.isDehydrated;if(ve&&(Er(me,ce).flags|=256),ce=bl(me,ce,!1),ce!==2){if(dl&&!ve){me.errorRecoveryDisabledLanes|=ie,$i|=ie,te=4;break e}ie=gn,gn=te,ie!==null&&(gn===null?gn=ie:gn.push.apply(gn,ie))}te=ce}if(ie=!1,te!==2)continue}}if(te===1){Er($,0),bi($,H,0,!0);break}e:{switch(X=$,ie=te,ie){case 0:case 1:throw Error(F(345));case 4:if((H&4194048)!==H)break;case 6:bi(X,H,Dn,!gi);break e;case 2:gn=null;break;case 3:case 5:break;default:throw Error(F(329))}if((H&62914560)===H&&(te=pl+300-bt(),10<te)){if(bi(X,H,Dn,!gi),Ge(X,0,!0)!==0)break e;X.timeoutHandle=ch(Id.bind(null,X,K,gn,fs,fl,H,Dn,$i,Sr,gi,ie,2,-0,0),te);break e}Id(X,K,gn,fs,fl,H,Dn,$i,Sr,gi,ie,0,-0,0)}}break}while(!0);$n($)}function Id($,H,K,X,te,ie,ce,me,ve,Pe,qe,Qe,Me,Ie){if($.timeoutHandle=-1,Qe=H.subtreeFlags,(Qe&8192||(Qe&16785408)===16785408)&&(xa={stylesheets:null,count:0,unsuspend:Np},Rd(H),Qe=Lp(),Qe!==null)){$.cancelPendingCommit=Qe($d.bind(null,$,H,ie,K,X,te,ce,me,ve,qe,1,Me,Ie)),bi($,ie,ce,!Pe);return}$d($,H,ie,K,X,te,ce,me,ve)}function Zf($){for(var H=$;;){var K=H.tag;if((K===0||K===11||K===15)&&H.flags&16384&&(K=H.updateQueue,K!==null&&(K=K.stores,K!==null)))for(var X=0;X<K.length;X++){var te=K[X],ie=te.getSnapshot;te=te.value;try{if(!vn(ie(),te))return!1}catch{return!1}}if(K=H.child,H.subtreeFlags&16384&&K!==null)K.return=H,H=K;else{if(H===$)break;for(;H.sibling===null;){if(H.return===null||H.return===$)return!0;H=H.return}H.sibling.return=H.return,H=H.sibling}}return!0}function bi($,H,K,X){H&=~hl,H&=~$i,$.suspendedLanes|=H,$.pingedLanes&=~H,X&&($.warmLanes|=H),X=$.expirationTimes;for(var te=H;0<te;){var ie=31-it(te),ce=1<<ie;X[ie]=-1,te&=~ce}K!==0&&Is($,K,H)}function ps(){return(Et&6)===0?(fa(0),!1):!0}function vl(){if(yt!==null){if(Ct===0)var $=yt.return;else $=yt,Yn=Li=null,Io($),gr=null,ia=0,$=yt;for(;$!==null;)pd($.alternate,$),$=$.return;yt=null}}function Er($,H){var K=$.timeoutHandle;K!==-1&&($.timeoutHandle=-1,yp(K)),K=$.cancelPendingCommit,K!==null&&($.cancelPendingCommit=null,K()),vl(),Dt=$,yt=K=Hn($.current,null),St=H,Ct=0,Tn=null,gi=!1,br=Je($,H),dl=!1,Sr=Dn=hl=$i=yi=jt=0,gn=da=null,fl=!1,(H&8)!==0&&(H|=H&32);var X=$.entangledLanes;if(X!==0)for($=$.entanglements,X&=H;0<X;){var te=31-it(X),ie=1<<te;H|=$[te],X&=~ie}return ni=H,La(),K}function Ld($,H){mt=null,Te.H=ts,H===Yr||H===Ha?(H=Jc(),Ct=3):H===Qc?(H=Jc(),Ct=4):Ct=H===Zu?8:H!==null&&typeof H=="object"&&typeof H.then=="function"?6:1,Tn=H,yt===null&&(jt=1,ss($,_n(H,$.current)))}function jd(){var $=Te.H;return Te.H=ts,$===null?ts:$}function Vd(){var $=Te.A;return Te.A=Xf,$}function xl(){jt=4,gi||(St&4194048)!==St&&On.current!==null||(br=!0),(yi&134217727)===0&&($i&134217727)===0||Dt===null||bi(Dt,St,Dn,!1)}function bl($,H,K){var X=Et;Et|=2;var te=jd(),ie=Vd();(Dt!==$||St!==H)&&(fs=null,Er($,H)),H=!1;var ce=jt;e:do try{if(Ct!==0&&yt!==null){var me=yt,ve=Tn;switch(Ct){case 8:vl(),ce=6;break e;case 3:case 2:case 9:case 6:On.current===null&&(H=!0);var Pe=Ct;if(Ct=0,Tn=null,Cr($,me,ve,Pe),K&&br){ce=0;break e}break;default:Pe=Ct,Ct=0,Tn=null,Cr($,me,ve,Pe)}}ep(),ce=jt;break}catch(qe){Ld($,qe)}while(!0);return H&&$.shellSuspendCounter++,Yn=Li=null,Et=X,Te.H=te,Te.A=ie,yt===null&&(Dt=null,St=0,La()),ce}function ep(){for(;yt!==null;)Ud(yt)}function tp($,H){var K=Et;Et|=2;var X=jd(),te=Vd();Dt!==$||St!==H?(fs=null,hs=bt()+500,Er($,H)):br=Je($,H);e:do try{if(Ct!==0&&yt!==null){H=yt;var ie=Tn;t:switch(Ct){case 1:Ct=0,Tn=null,Cr($,H,ie,1);break;case 2:case 9:if(Wc(ie)){Ct=0,Tn=null,Fd(H);break}H=function(){Ct!==2&&Ct!==9||Dt!==$||(Ct=7),$n($)},ie.then(H,H);break e;case 3:Ct=7;break e;case 4:Ct=5;break e;case 7:Wc(ie)?(Ct=0,Tn=null,Fd(H)):(Ct=0,Tn=null,Cr($,H,ie,7));break;case 5:var ce=null;switch(yt.tag){case 26:ce=yt.memoizedState;case 5:case 27:var me=yt;if(!ce||Th(ce)){Ct=0,Tn=null;var ve=me.sibling;if(ve!==null)yt=ve;else{var Pe=me.return;Pe!==null?(yt=Pe,ms(Pe)):yt=null}break t}}Ct=0,Tn=null,Cr($,H,ie,5);break;case 6:Ct=0,Tn=null,Cr($,H,ie,6);break;case 8:vl(),jt=6;break e;default:throw Error(F(462))}}np();break}catch(qe){Ld($,qe)}while(!0);return Yn=Li=null,Te.H=X,Te.A=te,Et=K,yt!==null?0:(Dt=null,St=0,La(),jt)}function np(){for(;yt!==null&&!Gt();)Ud(yt)}function Ud($){var H=hd($.alternate,$,ni);$.memoizedProps=$.pendingProps,H===null?ms($):yt=H}function Fd($){var H=$,K=H.alternate;switch(H.tag){case 15:case 0:H=sd(K,H,H.pendingProps,H.type,void 0,St);break;case 11:H=sd(K,H,H.pendingProps,H.type.render,H.ref,St);break;case 5:Io(H);default:pd(K,H),H=yt=Fc(H,ni),H=hd(K,H,ni)}$.memoizedProps=$.pendingProps,H===null?ms($):yt=H}function Cr($,H,K,X){Yn=Li=null,Io(H),gr=null,ia=0;var te=H.return;try{if(Hf($,te,H,K,St)){jt=1,ss($,_n(K,$.current)),yt=null;return}}catch(ie){if(te!==null)throw yt=te,ie;jt=1,ss($,_n(K,$.current)),yt=null;return}H.flags&32768?(kt||X===1?$=!0:br||(St&536870912)!==0?$=!1:(gi=$=!0,(X===2||X===9||X===3||X===6)&&(X=On.current,X!==null&&X.tag===13&&(X.flags|=16384))),Bd(H,$)):ms(H)}function ms($){var H=$;do{if((H.flags&32768)!==0){Bd(H,gi);return}$=H.return;var K=Kf(H.alternate,H,ni);if(K!==null){yt=K;return}if(H=H.sibling,H!==null){yt=H;return}yt=H=$}while(H!==null);jt===0&&(jt=5)}function Bd($,H){do{var K=Yf($.alternate,$);if(K!==null){K.flags&=32767,yt=K;return}if(K=$.return,K!==null&&(K.flags|=32768,K.subtreeFlags=0,K.deletions=null),!H&&($=$.sibling,$!==null)){yt=$;return}yt=$=K}while($!==null);jt=6,yt=null}function $d($,H,K,X,te,ie,ce,me,ve){$.cancelPendingCommit=null;do gs();while(an!==0);if((Et&6)!==0)throw Error(F(327));if(H!==null){if(H===$.current)throw Error(F(177));if(ie=H.lanes|H.childLanes,ie|=co,zi($,K,ie,ce,me,ve),$===Dt&&(yt=Dt=null,St=0),Tr=H,xi=$,kr=K,ml=ie,gl=te,Dd=X,(H.subtreeFlags&10256)!==0||(H.flags&10256)!==0?($.callbackNode=null,$.callbackPriority=0,sp(nn,function(){return Kd(),null})):($.callbackNode=null,$.callbackPriority=0),X=(H.flags&13878)!==0,(H.subtreeFlags&13878)!==0||X){X=Te.T,Te.T=null,te=Oe.p,Oe.p=2,ce=Et,Et|=4;try{Qf($,H,K)}finally{Et=ce,Oe.p=te,Te.T=X}}an=1,qd(),zd(),Hd()}}function qd(){if(an===1){an=0;var $=xi,H=Tr,K=(H.flags&13878)!==0;if((H.subtreeFlags&13878)!==0||K){K=Te.T,Te.T=null;var X=Oe.p;Oe.p=2;var te=Et;Et|=4;try{Cd(H,$);var ie=Dl,ce=Pc($.containerInfo),me=ie.focusedElem,ve=ie.selectionRange;if(ce!==me&&me&&me.ownerDocument&&Ac(me.ownerDocument.documentElement,me)){if(ve!==null&&ro(me)){var Pe=ve.start,qe=ve.end;if(qe===void 0&&(qe=Pe),"selectionStart"in me)me.selectionStart=Pe,me.selectionEnd=Math.min(qe,me.value.length);else{var Qe=me.ownerDocument||document,Me=Qe&&Qe.defaultView||window;if(Me.getSelection){var Ie=Me.getSelection(),ct=me.textContent.length,ot=Math.min(ve.start,ct),Rt=ve.end===void 0?ot:Math.min(ve.end,ct);!Ie.extend&&ot>Rt&&(ce=Rt,Rt=ot,ot=ce);var Ce=Rc(me,ot),Se=Rc(me,Rt);if(Ce&&Se&&(Ie.rangeCount!==1||Ie.anchorNode!==Ce.node||Ie.anchorOffset!==Ce.offset||Ie.focusNode!==Se.node||Ie.focusOffset!==Se.offset)){var Re=Qe.createRange();Re.setStart(Ce.node,Ce.offset),Ie.removeAllRanges(),ot>Rt?(Ie.addRange(Re),Ie.extend(Se.node,Se.offset)):(Re.setEnd(Se.node,Se.offset),Ie.addRange(Re))}}}}for(Qe=[],Ie=me;Ie=Ie.parentNode;)Ie.nodeType===1&&Qe.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof me.focus=="function"&&me.focus(),me=0;me<Qe.length;me++){var Ke=Qe[me];Ke.element.scrollLeft=Ke.left,Ke.element.scrollTop=Ke.top}}Rs=!!Ol,Dl=Ol=null}finally{Et=te,Oe.p=X,Te.T=K}}$.current=H,an=2}}function zd(){if(an===2){an=0;var $=xi,H=Tr,K=(H.flags&8772)!==0;if((H.subtreeFlags&8772)!==0||K){K=Te.T,Te.T=null;var X=Oe.p;Oe.p=2;var te=Et;Et|=4;try{Sd($,H.alternate,H)}finally{Et=te,Oe.p=X,Te.T=K}}an=3}}function Hd(){if(an===4||an===3){an=0,cn();var $=xi,H=Tr,K=kr,X=Dd;(H.subtreeFlags&10256)!==0||(H.flags&10256)!==0?an=5:(an=0,Tr=xi=null,Gd($,$.pendingLanes));var te=$.pendingLanes;if(te===0&&(vi=null),js(K),H=H.stateNode,je&&typeof je.onCommitFiberRoot=="function")try{je.onCommitFiberRoot(_e,H,void 0,(H.current.flags&128)===128)}catch{}if(X!==null){H=Te.T,te=Oe.p,Oe.p=2,Te.T=null;try{for(var ie=$.onRecoverableError,ce=0;ce<X.length;ce++){var me=X[ce];ie(me.value,{componentStack:me.stack})}}finally{Te.T=H,Oe.p=te}}(kr&3)!==0&&gs(),$n($),te=$.pendingLanes,(K&4194090)!==0&&(te&42)!==0?$===yl?ha++:(ha=0,yl=$):ha=0,fa(0)}}function Gd($,H){($.pooledCacheLanes&=H)===0&&(H=$.pooledCache,H!=null&&($.pooledCache=null,Gr(H)))}function gs($){return qd(),zd(),Hd(),Kd()}function Kd(){if(an!==5)return!1;var $=xi,H=ml;ml=0;var K=js(kr),X=Te.T,te=Oe.p;try{Oe.p=32>K?32:K,Te.T=null,K=gl,gl=null;var ie=xi,ce=kr;if(an=0,Tr=xi=null,kr=0,(Et&6)!==0)throw Error(F(331));var me=Et;if(Et|=4,Pd(ie.current),_d(ie,ie.current,ce,K),Et=me,fa(0,!1),je&&typeof je.onPostCommitFiberRoot=="function")try{je.onPostCommitFiberRoot(_e,ie)}catch{}return!0}finally{Oe.p=te,Te.T=X,Gd($,H)}}function Yd($,H,K){H=_n(K,H),H=Qo($.stateNode,H,2),$=ci($,H,2),$!==null&&(Ut($,2),$n($))}function Ot($,H,K){if($.tag===3)Yd($,$,K);else for(;H!==null;){if(H.tag===3){Yd(H,$,K);break}else if(H.tag===1){var X=H.stateNode;if(typeof H.type.getDerivedStateFromError=="function"||typeof X.componentDidCatch=="function"&&(vi===null||!vi.has(X))){$=_n(K,$),K=Xu(2),X=ci(H,K,2),X!==null&&(Ju(K,X,H,$),Ut(X,2),$n(X));break}}H=H.return}}function Sl($,H,K){var X=$.pingCache;if(X===null){X=$.pingCache=new Jf;var te=new Set;X.set(H,te)}else te=X.get(H),te===void 0&&(te=new Set,X.set(H,te));te.has(K)||(dl=!0,te.add(K),$=ip.bind(null,$,H,K),H.then($,$))}function ip($,H,K){var X=$.pingCache;X!==null&&X.delete(H),$.pingedLanes|=$.suspendedLanes&K,$.warmLanes&=~K,Dt===$&&(St&K)===K&&(jt===4||jt===3&&(St&62914560)===St&&300>bt()-pl?(Et&2)===0&&Er($,0):hl|=K,Sr===St&&(Sr=0)),$n($)}function Qd($,H){H===0&&(H=Pt()),$=sr($,H),$!==null&&(Ut($,H),$n($))}function rp($){var H=$.memoizedState,K=0;H!==null&&(K=H.retryLane),Qd($,K)}function ap($,H){var K=0;switch($.tag){case 13:var X=$.stateNode,te=$.memoizedState;te!==null&&(K=te.retryLane);break;case 19:X=$.stateNode;break;case 22:X=$.stateNode._retryCache;break;default:throw Error(F(314))}X!==null&&X.delete(H),Qd($,K)}function sp($,H){return Qt($,H)}var ys=null,wr=null,Tl=!1,vs=!1,kl=!1,qi=0;function $n($){$!==wr&&$.next===null&&(wr===null?ys=wr=$:wr=wr.next=$),vs=!0,Tl||(Tl=!0,lp())}function fa($,H){if(!kl&&vs){kl=!0;do for(var K=!1,X=ys;X!==null;){if($!==0){var te=X.pendingLanes;if(te===0)var ie=0;else{var ce=X.suspendedLanes,me=X.pingedLanes;ie=(1<<31-it(42|$)+1)-1,ie&=te&~(ce&~me),ie=ie&201326741?ie&201326741|1:ie?ie|2:0}ie!==0&&(K=!0,Zd(X,ie))}else ie=St,ie=Ge(X,X===Dt?ie:0,X.cancelPendingCommit!==null||X.timeoutHandle!==-1),(ie&3)===0||Je(X,ie)||(K=!0,Zd(X,ie));X=X.next}while(K);kl=!1}}function op(){Wd()}function Wd(){vs=Tl=!1;var $=0;qi!==0&&(gp()&&($=qi),qi=0);for(var H=bt(),K=null,X=ys;X!==null;){var te=X.next,ie=Xd(X,H);ie===0?(X.next=null,K===null?ys=te:K.next=te,te===null&&(wr=K)):(K=X,($!==0||(ie&3)!==0)&&(vs=!0)),X=te}fa($)}function Xd($,H){for(var K=$.suspendedLanes,X=$.pingedLanes,te=$.expirationTimes,ie=$.pendingLanes&-62914561;0<ie;){var ce=31-it(ie),me=1<<ce,ve=te[ce];ve===-1?((me&K)===0||(me&X)!==0)&&(te[ce]=Ze(me,H)):ve<=H&&($.expiredLanes|=me),ie&=~me}if(H=Dt,K=St,K=Ge($,$===H?K:0,$.cancelPendingCommit!==null||$.timeoutHandle!==-1),X=$.callbackNode,K===0||$===H&&(Ct===2||Ct===9)||$.cancelPendingCommit!==null)return X!==null&&X!==null&&tn(X),$.callbackNode=null,$.callbackPriority=0;if((K&3)===0||Je($,K)){if(H=K&-K,H===$.callbackPriority)return H;switch(X!==null&&tn(X),js(K)){case 2:case 8:K=Wt;break;case 32:K=nn;break;case 268435456:K=Xe;break;default:K=nn}return X=Jd.bind(null,$),K=Qt(K,X),$.callbackPriority=H,$.callbackNode=K,H}return X!==null&&X!==null&&tn(X),$.callbackPriority=2,$.callbackNode=null,2}function Jd($,H){if(an!==0&&an!==5)return $.callbackNode=null,$.callbackPriority=0,null;var K=$.callbackNode;if(gs()&&$.callbackNode!==K)return null;var X=St;return X=Ge($,$===Dt?X:0,$.cancelPendingCommit!==null||$.timeoutHandle!==-1),X===0?null:(Nd($,X,H),Xd($,bt()),$.callbackNode!=null&&$.callbackNode===K?Jd.bind(null,$):null)}function Zd($,H){if(gs())return null;Nd($,H,!0)}function lp(){vp(function(){(Et&6)!==0?Qt(At,op):Wd()})}function El(){return qi===0&&(qi=dt()),qi}function eh($){return $==null||typeof $=="symbol"||typeof $=="boolean"?null:typeof $=="function"?$:Aa(""+$)}function th($,H){var K=H.ownerDocument.createElement("input");return K.name=H.name,K.value=H.value,$.id&&K.setAttribute("form",$.id),H.parentNode.insertBefore(K,H),$=new FormData($),K.parentNode.removeChild(K),$}function cp($,H,K,X,te){if(H==="submit"&&K&&K.stateNode===te){var ie=eh((te[hn]||null).action),ce=X.submitter;ce&&(H=(H=ce[hn]||null)?eh(H.formAction):ce.getAttribute("formAction"),H!==null&&(ie=H,ce=null));var me=new Ma("action","action",null,X,te);$.push({event:me,listeners:[{instance:null,listener:function(){if(X.defaultPrevented){if(qi!==0){var ve=ce?th(te,ce):new FormData(te);zo(K,{pending:!0,data:ve,method:te.method,action:ie},null,ve)}}else typeof ie=="function"&&(me.preventDefault(),ve=ce?th(te,ce):new FormData(te),zo(K,{pending:!0,data:ve,method:te.method,action:ie},ie,ve))},currentTarget:te}]})}}for(var Cl=0;Cl<lo.length;Cl++){var wl=lo[Cl],up=wl.toLowerCase(),dp=wl[0].toUpperCase()+wl.slice(1);In(up,"on"+dp)}In(Mc,"onAnimationEnd"),In(Nc,"onAnimationIteration"),In(Ic,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(Rf,"onTransitionRun"),In(Af,"onTransitionStart"),In(Pf,"onTransitionCancel"),In(Lc,"onTransitionEnd"),Wi("onMouseEnter",["mouseout","mouseover"]),Wi("onMouseLeave",["mouseout","mouseover"]),Wi("onPointerEnter",["pointerout","pointerover"]),Wi("onPointerLeave",["pointerout","pointerover"]),_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_i("onBeforeInput",["compositionend","keypress","textInput","paste"]),_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pa));function nh($,H){H=(H&4)!==0;for(var K=0;K<$.length;K++){var X=$[K],te=X.event;X=X.listeners;e:{var ie=void 0;if(H)for(var ce=X.length-1;0<=ce;ce--){var me=X[ce],ve=me.instance,Pe=me.currentTarget;if(me=me.listener,ve!==ie&&te.isPropagationStopped())break e;ie=me,te.currentTarget=Pe;try{ie(te)}catch(qe){as(qe)}te.currentTarget=null,ie=ve}else for(ce=0;ce<X.length;ce++){if(me=X[ce],ve=me.instance,Pe=me.currentTarget,me=me.listener,ve!==ie&&te.isPropagationStopped())break e;ie=me,te.currentTarget=Pe;try{ie(te)}catch(qe){as(qe)}te.currentTarget=null,ie=ve}}}}function vt($,H){var K=H[Vs];K===void 0&&(K=H[Vs]=new Set);var X=$+"__bubble";K.has(X)||(ih(H,$,2,!1),K.add(X))}function _l($,H,K){var X=0;H&&(X|=4),ih(K,$,X,H)}var xs="_reactListening"+Math.random().toString(36).slice(2);function Rl($){if(!$[xs]){$[xs]=!0,Ql.forEach(function(K){K!=="selectionchange"&&(hp.has(K)||_l(K,!1,$),_l(K,!0,$))});var H=$.nodeType===9?$:$.ownerDocument;H===null||H[xs]||(H[xs]=!0,_l("selectionchange",!1,H))}}function ih($,H,K,X){switch(Rh(H)){case 2:var te=Up;break;case 8:te=Fp;break;default:te=$l}K=te.bind(null,H,K,$),te=void 0,!Qs||H!=="touchstart"&&H!=="touchmove"&&H!=="wheel"||(te=!0),X?te!==void 0?$.addEventListener(H,K,{capture:!0,passive:te}):$.addEventListener(H,K,!0):te!==void 0?$.addEventListener(H,K,{passive:te}):$.addEventListener(H,K,!1)}function Al($,H,K,X,te){var ie=X;if((H&1)===0&&(H&2)===0&&X!==null)e:for(;;){if(X===null)return;var ce=X.tag;if(ce===3||ce===4){var me=X.stateNode.containerInfo;if(me===te)break;if(ce===4)for(ce=X.return;ce!==null;){var ve=ce.tag;if((ve===3||ve===4)&&ce.stateNode.containerInfo===te)return;ce=ce.return}for(;me!==null;){if(ce=Ki(me),ce===null)return;if(ve=ce.tag,ve===5||ve===6||ve===26||ve===27){X=ie=ce;continue e}me=me.parentNode}}X=X.return}cc(function(){var Pe=ie,qe=Ks(K),Qe=[];e:{var Me=jc.get($);if(Me!==void 0){var Ie=Ma,ct=$;switch($){case"keypress":if(Oa(K)===0)break e;case"keydown":case"keyup":Ie=sf;break;case"focusin":ct="focus",Ie=Zs;break;case"focusout":ct="blur",Ie=Zs;break;case"beforeblur":case"afterblur":Ie=Zs;break;case"click":if(K.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=Kh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=cf;break;case Mc:case Nc:case Ic:Ie=Wh;break;case Lc:Ie=df;break;case"scroll":case"scrollend":Ie=Hh;break;case"wheel":Ie=ff;break;case"copy":case"cut":case"paste":Ie=Jh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=pc;break;case"toggle":case"beforetoggle":Ie=mf}var ot=(H&4)!==0,Rt=!ot&&($==="scroll"||$==="scrollend"),Ce=ot?Me!==null?Me+"Capture":null:Me;ot=[];for(var Se=Pe,Re;Se!==null;){var Ke=Se;if(Re=Ke.stateNode,Ke=Ke.tag,Ke!==5&&Ke!==26&&Ke!==27||Re===null||Ce===null||(Ke=Mr(Se,Ce),Ke!=null&&ot.push(ma(Se,Ke,Re))),Rt)break;Se=Se.return}0<ot.length&&(Me=new Ie(Me,ct,null,K,qe),Qe.push({event:Me,listeners:ot}))}}if((H&7)===0){e:{if(Me=$==="mouseover"||$==="pointerover",Ie=$==="mouseout"||$==="pointerout",Me&&K!==Gs&&(ct=K.relatedTarget||K.fromElement)&&(Ki(ct)||ct[Gi]))break e;if((Ie||Me)&&(Me=qe.window===qe?qe:(Me=qe.ownerDocument)?Me.defaultView||Me.parentWindow:window,Ie?(ct=K.relatedTarget||K.toElement,Ie=Pe,ct=ct?Ki(ct):null,ct!==null&&(Rt=q(ct),ot=ct.tag,ct!==Rt||ot!==5&&ot!==27&&ot!==6)&&(ct=null)):(Ie=null,ct=Pe),Ie!==ct)){if(ot=hc,Ke="onMouseLeave",Ce="onMouseEnter",Se="mouse",($==="pointerout"||$==="pointerover")&&(ot=pc,Ke="onPointerLeave",Ce="onPointerEnter",Se="pointer"),Rt=Ie==null?Me:Dr(Ie),Re=ct==null?Me:Dr(ct),Me=new ot(Ke,Se+"leave",Ie,K,qe),Me.target=Rt,Me.relatedTarget=Re,Ke=null,Ki(qe)===Pe&&(ot=new ot(Ce,Se+"enter",ct,K,qe),ot.target=Re,ot.relatedTarget=Rt,Ke=ot),Rt=Ke,Ie&&ct)t:{for(ot=Ie,Ce=ct,Se=0,Re=ot;Re;Re=_r(Re))Se++;for(Re=0,Ke=Ce;Ke;Ke=_r(Ke))Re++;for(;0<Se-Re;)ot=_r(ot),Se--;for(;0<Re-Se;)Ce=_r(Ce),Re--;for(;Se--;){if(ot===Ce||Ce!==null&&ot===Ce.alternate)break t;ot=_r(ot),Ce=_r(Ce)}ot=null}else ot=null;Ie!==null&&rh(Qe,Me,Ie,ot,!1),ct!==null&&Rt!==null&&rh(Qe,Rt,ct,ot,!0)}}e:{if(Me=Pe?Dr(Pe):window,Ie=Me.nodeName&&Me.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&Me.type==="file")var rt=Tc;else if(bc(Me))if(kc)rt=Cf;else{rt=kf;var gt=Tf}else Ie=Me.nodeName,!Ie||Ie.toLowerCase()!=="input"||Me.type!=="checkbox"&&Me.type!=="radio"?Pe&&Hs(Pe.elementType)&&(rt=Tc):rt=Ef;if(rt&&(rt=rt($,Pe))){Sc(Qe,rt,K,qe);break e}gt&&gt($,Me,Pe),$==="focusout"&&Pe&&Me.type==="number"&&Pe.memoizedProps.value!=null&&zs(Me,"number",Me.value)}switch(gt=Pe?Dr(Pe):window,$){case"focusin":(bc(gt)||gt.contentEditable==="true")&&(ir=gt,ao=Pe,Br=null);break;case"focusout":Br=ao=ir=null;break;case"mousedown":so=!0;break;case"contextmenu":case"mouseup":case"dragend":so=!1,Oc(Qe,K,qe);break;case"selectionchange":if(_f)break;case"keydown":case"keyup":Oc(Qe,K,qe)}var st;if(to)e:{switch($){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else nr?vc($,K)&&(lt="onCompositionEnd"):$==="keydown"&&K.keyCode===229&&(lt="onCompositionStart");lt&&(mc&&K.locale!=="ko"&&(nr||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&nr&&(st=uc()):(ai=qe,Ws="value"in ai?ai.value:ai.textContent,nr=!0)),gt=bs(Pe,lt),0<gt.length&&(lt=new fc(lt,$,null,K,qe),Qe.push({event:lt,listeners:gt}),st?lt.data=st:(st=xc(K),st!==null&&(lt.data=st)))),(st=yf?vf($,K):xf($,K))&&(lt=bs(Pe,"onBeforeInput"),0<lt.length&&(gt=new fc("onBeforeInput","beforeinput",null,K,qe),Qe.push({event:gt,listeners:lt}),gt.data=st)),cp(Qe,$,Pe,K,qe)}nh(Qe,H)})}function ma($,H,K){return{instance:$,listener:H,currentTarget:K}}function bs($,H){for(var K=H+"Capture",X=[];$!==null;){var te=$,ie=te.stateNode;if(te=te.tag,te!==5&&te!==26&&te!==27||ie===null||(te=Mr($,K),te!=null&&X.unshift(ma($,te,ie)),te=Mr($,H),te!=null&&X.push(ma($,te,ie))),$.tag===3)return X;$=$.return}return[]}function _r($){if($===null)return null;do $=$.return;while($&&$.tag!==5&&$.tag!==27);return $||null}function rh($,H,K,X,te){for(var ie=H._reactName,ce=[];K!==null&&K!==X;){var me=K,ve=me.alternate,Pe=me.stateNode;if(me=me.tag,ve!==null&&ve===X)break;me!==5&&me!==26&&me!==27||Pe===null||(ve=Pe,te?(Pe=Mr(K,ie),Pe!=null&&ce.unshift(ma(K,Pe,ve))):te||(Pe=Mr(K,ie),Pe!=null&&ce.push(ma(K,Pe,ve)))),K=K.return}ce.length!==0&&$.push({event:H,listeners:ce})}var fp=/\r\n?/g,pp=/\u0000|\uFFFD/g;function ah($){return(typeof $=="string"?$:""+$).replace(fp,`
`).replace(pp,"")}function sh($,H){return H=ah(H),ah($)===H}function Ss(){}function _t($,H,K,X,te,ie){switch(K){case"children":typeof X=="string"?H==="body"||H==="textarea"&&X===""||Zi($,X):(typeof X=="number"||typeof X=="bigint")&&H!=="body"&&Zi($,""+X);break;case"className":wa($,"class",X);break;case"tabIndex":wa($,"tabindex",X);break;case"dir":case"role":case"viewBox":case"width":case"height":wa($,K,X);break;case"style":oc($,X,ie);break;case"data":if(H!=="object"){wa($,"data",X);break}case"src":case"href":if(X===""&&(H!=="a"||K!=="href")){$.removeAttribute(K);break}if(X==null||typeof X=="function"||typeof X=="symbol"||typeof X=="boolean"){$.removeAttribute(K);break}X=Aa(""+X),$.setAttribute(K,X);break;case"action":case"formAction":if(typeof X=="function"){$.setAttribute(K,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ie=="function"&&(K==="formAction"?(H!=="input"&&_t($,H,"name",te.name,te,null),_t($,H,"formEncType",te.formEncType,te,null),_t($,H,"formMethod",te.formMethod,te,null),_t($,H,"formTarget",te.formTarget,te,null)):(_t($,H,"encType",te.encType,te,null),_t($,H,"method",te.method,te,null),_t($,H,"target",te.target,te,null)));if(X==null||typeof X=="symbol"||typeof X=="boolean"){$.removeAttribute(K);break}X=Aa(""+X),$.setAttribute(K,X);break;case"onClick":X!=null&&($.onclick=Ss);break;case"onScroll":X!=null&&vt("scroll",$);break;case"onScrollEnd":X!=null&&vt("scrollend",$);break;case"dangerouslySetInnerHTML":if(X!=null){if(typeof X!="object"||!("__html"in X))throw Error(F(61));if(K=X.__html,K!=null){if(te.children!=null)throw Error(F(60));$.innerHTML=K}}break;case"multiple":$.multiple=X&&typeof X!="function"&&typeof X!="symbol";break;case"muted":$.muted=X&&typeof X!="function"&&typeof X!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(X==null||typeof X=="function"||typeof X=="boolean"||typeof X=="symbol"){$.removeAttribute("xlink:href");break}K=Aa(""+X),$.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",K);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":X!=null&&typeof X!="function"&&typeof X!="symbol"?$.setAttribute(K,""+X):$.removeAttribute(K);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":X&&typeof X!="function"&&typeof X!="symbol"?$.setAttribute(K,""):$.removeAttribute(K);break;case"capture":case"download":X===!0?$.setAttribute(K,""):X!==!1&&X!=null&&typeof X!="function"&&typeof X!="symbol"?$.setAttribute(K,X):$.removeAttribute(K);break;case"cols":case"rows":case"size":case"span":X!=null&&typeof X!="function"&&typeof X!="symbol"&&!isNaN(X)&&1<=X?$.setAttribute(K,X):$.removeAttribute(K);break;case"rowSpan":case"start":X==null||typeof X=="function"||typeof X=="symbol"||isNaN(X)?$.removeAttribute(K):$.setAttribute(K,X);break;case"popover":vt("beforetoggle",$),vt("toggle",$),Ca($,"popover",X);break;case"xlinkActuate":qn($,"http://www.w3.org/1999/xlink","xlink:actuate",X);break;case"xlinkArcrole":qn($,"http://www.w3.org/1999/xlink","xlink:arcrole",X);break;case"xlinkRole":qn($,"http://www.w3.org/1999/xlink","xlink:role",X);break;case"xlinkShow":qn($,"http://www.w3.org/1999/xlink","xlink:show",X);break;case"xlinkTitle":qn($,"http://www.w3.org/1999/xlink","xlink:title",X);break;case"xlinkType":qn($,"http://www.w3.org/1999/xlink","xlink:type",X);break;case"xmlBase":qn($,"http://www.w3.org/XML/1998/namespace","xml:base",X);break;case"xmlLang":qn($,"http://www.w3.org/XML/1998/namespace","xml:lang",X);break;case"xmlSpace":qn($,"http://www.w3.org/XML/1998/namespace","xml:space",X);break;case"is":Ca($,"is",X);break;case"innerText":case"textContent":break;default:(!(2<K.length)||K[0]!=="o"&&K[0]!=="O"||K[1]!=="n"&&K[1]!=="N")&&(K=qh.get(K)||K,Ca($,K,X))}}function Pl($,H,K,X,te,ie){switch(K){case"style":oc($,X,ie);break;case"dangerouslySetInnerHTML":if(X!=null){if(typeof X!="object"||!("__html"in X))throw Error(F(61));if(K=X.__html,K!=null){if(te.children!=null)throw Error(F(60));$.innerHTML=K}}break;case"children":typeof X=="string"?Zi($,X):(typeof X=="number"||typeof X=="bigint")&&Zi($,""+X);break;case"onScroll":X!=null&&vt("scroll",$);break;case"onScrollEnd":X!=null&&vt("scrollend",$);break;case"onClick":X!=null&&($.onclick=Ss);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wl.hasOwnProperty(K))e:{if(K[0]==="o"&&K[1]==="n"&&(te=K.endsWith("Capture"),H=K.slice(2,te?K.length-7:void 0),ie=$[hn]||null,ie=ie!=null?ie[K]:null,typeof ie=="function"&&$.removeEventListener(H,ie,te),typeof X=="function")){typeof ie!="function"&&ie!==null&&(K in $?$[K]=null:$.hasAttribute(K)&&$.removeAttribute(K)),$.addEventListener(H,X,te);break e}K in $?$[K]=X:X===!0?$.setAttribute(K,""):Ca($,K,X)}}}function sn($,H,K){switch(H){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vt("error",$),vt("load",$);var X=!1,te=!1,ie;for(ie in K)if(K.hasOwnProperty(ie)){var ce=K[ie];if(ce!=null)switch(ie){case"src":X=!0;break;case"srcSet":te=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(F(137,H));default:_t($,H,ie,ce,K,null)}}te&&_t($,H,"srcSet",K.srcSet,K,null),X&&_t($,H,"src",K.src,K,null);return;case"input":vt("invalid",$);var me=ie=ce=te=null,ve=null,Pe=null;for(X in K)if(K.hasOwnProperty(X)){var qe=K[X];if(qe!=null)switch(X){case"name":te=qe;break;case"type":ce=qe;break;case"checked":ve=qe;break;case"defaultChecked":Pe=qe;break;case"value":ie=qe;break;case"defaultValue":me=qe;break;case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(F(137,H));break;default:_t($,H,X,qe,K,null)}}ic($,ie,me,ve,Pe,ce,te,!1),_a($);return;case"select":vt("invalid",$),X=ce=ie=null;for(te in K)if(K.hasOwnProperty(te)&&(me=K[te],me!=null))switch(te){case"value":ie=me;break;case"defaultValue":ce=me;break;case"multiple":X=me;default:_t($,H,te,me,K,null)}H=ie,K=ce,$.multiple=!!X,H!=null?Ji($,!!X,H,!1):K!=null&&Ji($,!!X,K,!0);return;case"textarea":vt("invalid",$),ie=te=X=null;for(ce in K)if(K.hasOwnProperty(ce)&&(me=K[ce],me!=null))switch(ce){case"value":X=me;break;case"defaultValue":te=me;break;case"children":ie=me;break;case"dangerouslySetInnerHTML":if(me!=null)throw Error(F(91));break;default:_t($,H,ce,me,K,null)}ac($,X,te,ie),_a($);return;case"option":for(ve in K)if(K.hasOwnProperty(ve)&&(X=K[ve],X!=null))switch(ve){case"selected":$.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:_t($,H,ve,X,K,null)}return;case"dialog":vt("beforetoggle",$),vt("toggle",$),vt("cancel",$),vt("close",$);break;case"iframe":case"object":vt("load",$);break;case"video":case"audio":for(X=0;X<pa.length;X++)vt(pa[X],$);break;case"image":vt("error",$),vt("load",$);break;case"details":vt("toggle",$);break;case"embed":case"source":case"link":vt("error",$),vt("load",$);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Pe in K)if(K.hasOwnProperty(Pe)&&(X=K[Pe],X!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":throw Error(F(137,H));default:_t($,H,Pe,X,K,null)}return;default:if(Hs(H)){for(qe in K)K.hasOwnProperty(qe)&&(X=K[qe],X!==void 0&&Pl($,H,qe,X,K,void 0));return}}for(me in K)K.hasOwnProperty(me)&&(X=K[me],X!=null&&_t($,H,me,X,K,null))}function mp($,H,K,X){switch(H){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var te=null,ie=null,ce=null,me=null,ve=null,Pe=null,qe=null;for(Ie in K){var Qe=K[Ie];if(K.hasOwnProperty(Ie)&&Qe!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":ve=Qe;default:X.hasOwnProperty(Ie)||_t($,H,Ie,null,X,Qe)}}for(var Me in X){var Ie=X[Me];if(Qe=K[Me],X.hasOwnProperty(Me)&&(Ie!=null||Qe!=null))switch(Me){case"type":ie=Ie;break;case"name":te=Ie;break;case"checked":Pe=Ie;break;case"defaultChecked":qe=Ie;break;case"value":ce=Ie;break;case"defaultValue":me=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(F(137,H));break;default:Ie!==Qe&&_t($,H,Me,Ie,X,Qe)}}qs($,ce,me,ve,Pe,qe,ie,te);return;case"select":Ie=ce=me=Me=null;for(ie in K)if(ve=K[ie],K.hasOwnProperty(ie)&&ve!=null)switch(ie){case"value":break;case"multiple":Ie=ve;default:X.hasOwnProperty(ie)||_t($,H,ie,null,X,ve)}for(te in X)if(ie=X[te],ve=K[te],X.hasOwnProperty(te)&&(ie!=null||ve!=null))switch(te){case"value":Me=ie;break;case"defaultValue":me=ie;break;case"multiple":ce=ie;default:ie!==ve&&_t($,H,te,ie,X,ve)}H=me,K=ce,X=Ie,Me!=null?Ji($,!!K,Me,!1):!!X!=!!K&&(H!=null?Ji($,!!K,H,!0):Ji($,!!K,K?[]:"",!1));return;case"textarea":Ie=Me=null;for(me in K)if(te=K[me],K.hasOwnProperty(me)&&te!=null&&!X.hasOwnProperty(me))switch(me){case"value":break;case"children":break;default:_t($,H,me,null,X,te)}for(ce in X)if(te=X[ce],ie=K[ce],X.hasOwnProperty(ce)&&(te!=null||ie!=null))switch(ce){case"value":Me=te;break;case"defaultValue":Ie=te;break;case"children":break;case"dangerouslySetInnerHTML":if(te!=null)throw Error(F(91));break;default:te!==ie&&_t($,H,ce,te,X,ie)}rc($,Me,Ie);return;case"option":for(var ct in K)if(Me=K[ct],K.hasOwnProperty(ct)&&Me!=null&&!X.hasOwnProperty(ct))switch(ct){case"selected":$.selected=!1;break;default:_t($,H,ct,null,X,Me)}for(ve in X)if(Me=X[ve],Ie=K[ve],X.hasOwnProperty(ve)&&Me!==Ie&&(Me!=null||Ie!=null))switch(ve){case"selected":$.selected=Me&&typeof Me!="function"&&typeof Me!="symbol";break;default:_t($,H,ve,Me,X,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in K)Me=K[ot],K.hasOwnProperty(ot)&&Me!=null&&!X.hasOwnProperty(ot)&&_t($,H,ot,null,X,Me);for(Pe in X)if(Me=X[Pe],Ie=K[Pe],X.hasOwnProperty(Pe)&&Me!==Ie&&(Me!=null||Ie!=null))switch(Pe){case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(F(137,H));break;default:_t($,H,Pe,Me,X,Ie)}return;default:if(Hs(H)){for(var Rt in K)Me=K[Rt],K.hasOwnProperty(Rt)&&Me!==void 0&&!X.hasOwnProperty(Rt)&&Pl($,H,Rt,void 0,X,Me);for(qe in X)Me=X[qe],Ie=K[qe],!X.hasOwnProperty(qe)||Me===Ie||Me===void 0&&Ie===void 0||Pl($,H,qe,Me,X,Ie);return}}for(var Ce in K)Me=K[Ce],K.hasOwnProperty(Ce)&&Me!=null&&!X.hasOwnProperty(Ce)&&_t($,H,Ce,null,X,Me);for(Qe in X)Me=X[Qe],Ie=K[Qe],!X.hasOwnProperty(Qe)||Me===Ie||Me==null&&Ie==null||_t($,H,Qe,Me,X,Ie)}var Ol=null,Dl=null;function Ts($){return $.nodeType===9?$:$.ownerDocument}function oh($){switch($){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lh($,H){if($===0)switch(H){case"svg":return 1;case"math":return 2;default:return 0}return $===1&&H==="foreignObject"?0:$}function Ml($,H){return $==="textarea"||$==="noscript"||typeof H.children=="string"||typeof H.children=="number"||typeof H.children=="bigint"||typeof H.dangerouslySetInnerHTML=="object"&&H.dangerouslySetInnerHTML!==null&&H.dangerouslySetInnerHTML.__html!=null}var Nl=null;function gp(){var $=window.event;return $&&$.type==="popstate"?$===Nl?!1:(Nl=$,!0):(Nl=null,!1)}var ch=typeof setTimeout=="function"?setTimeout:void 0,yp=typeof clearTimeout=="function"?clearTimeout:void 0,uh=typeof Promise=="function"?Promise:void 0,vp=typeof queueMicrotask=="function"?queueMicrotask:typeof uh<"u"?function($){return uh.resolve(null).then($).catch(xp)}:ch;function xp($){setTimeout(function(){throw $})}function Si($){return $==="head"}function dh($,H){var K=H,X=0,te=0;do{var ie=K.nextSibling;if($.removeChild(K),ie&&ie.nodeType===8)if(K=ie.data,K==="/$"){if(0<X&&8>X){K=X;var ce=$.ownerDocument;if(K&1&&ga(ce.documentElement),K&2&&ga(ce.body),K&4)for(K=ce.head,ga(K),ce=K.firstChild;ce;){var me=ce.nextSibling,ve=ce.nodeName;ce[Or]||ve==="SCRIPT"||ve==="STYLE"||ve==="LINK"&&ce.rel.toLowerCase()==="stylesheet"||K.removeChild(ce),ce=me}}if(te===0){$.removeChild(ie),Ea(H);return}te--}else K==="$"||K==="$?"||K==="$!"?te++:X=K.charCodeAt(0)-48;else X=0;K=ie}while(K);Ea(H)}function Il($){var H=$.firstChild;for(H&&H.nodeType===10&&(H=H.nextSibling);H;){var K=H;switch(H=H.nextSibling,K.nodeName){case"HTML":case"HEAD":case"BODY":Il(K),Us(K);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(K.rel.toLowerCase()==="stylesheet")continue}$.removeChild(K)}}function bp($,H,K,X){for(;$.nodeType===1;){var te=K;if($.nodeName.toLowerCase()!==H.toLowerCase()){if(!X&&($.nodeName!=="INPUT"||$.type!=="hidden"))break}else if(X){if(!$[Or])switch(H){case"meta":if(!$.hasAttribute("itemprop"))break;return $;case"link":if(ie=$.getAttribute("rel"),ie==="stylesheet"&&$.hasAttribute("data-precedence"))break;if(ie!==te.rel||$.getAttribute("href")!==(te.href==null||te.href===""?null:te.href)||$.getAttribute("crossorigin")!==(te.crossOrigin==null?null:te.crossOrigin)||$.getAttribute("title")!==(te.title==null?null:te.title))break;return $;case"style":if($.hasAttribute("data-precedence"))break;return $;case"script":if(ie=$.getAttribute("src"),(ie!==(te.src==null?null:te.src)||$.getAttribute("type")!==(te.type==null?null:te.type)||$.getAttribute("crossorigin")!==(te.crossOrigin==null?null:te.crossOrigin))&&ie&&$.hasAttribute("async")&&!$.hasAttribute("itemprop"))break;return $;default:return $}}else if(H==="input"&&$.type==="hidden"){var ie=te.name==null?null:""+te.name;if(te.type==="hidden"&&$.getAttribute("name")===ie)return $}else return $;if($=jn($.nextSibling),$===null)break}return null}function Sp($,H,K){if(H==="")return null;for(;$.nodeType!==3;)if(($.nodeType!==1||$.nodeName!=="INPUT"||$.type!=="hidden")&&!K||($=jn($.nextSibling),$===null))return null;return $}function Ll($){return $.data==="$!"||$.data==="$?"&&$.ownerDocument.readyState==="complete"}function Tp($,H){var K=$.ownerDocument;if($.data!=="$?"||K.readyState==="complete")H();else{var X=function(){H(),K.removeEventListener("DOMContentLoaded",X)};K.addEventListener("DOMContentLoaded",X),$._reactRetry=X}}function jn($){for(;$!=null;$=$.nextSibling){var H=$.nodeType;if(H===1||H===3)break;if(H===8){if(H=$.data,H==="$"||H==="$!"||H==="$?"||H==="F!"||H==="F")break;if(H==="/$")return null}}return $}var jl=null;function hh($){$=$.previousSibling;for(var H=0;$;){if($.nodeType===8){var K=$.data;if(K==="$"||K==="$!"||K==="$?"){if(H===0)return $;H--}else K==="/$"&&H++}$=$.previousSibling}return null}function fh($,H,K){switch(H=Ts(K),$){case"html":if($=H.documentElement,!$)throw Error(F(452));return $;case"head":if($=H.head,!$)throw Error(F(453));return $;case"body":if($=H.body,!$)throw Error(F(454));return $;default:throw Error(F(451))}}function ga($){for(var H=$.attributes;H.length;)$.removeAttributeNode(H[0]);Us($)}var Mn=new Map,ph=new Set;function ks($){return typeof $.getRootNode=="function"?$.getRootNode():$.nodeType===9?$:$.ownerDocument}var ii=Oe.d;Oe.d={f:kp,r:Ep,D:Cp,C:wp,L:_p,m:Rp,X:Pp,S:Ap,M:Op};function kp(){var $=ii.f(),H=ps();return $||H}function Ep($){var H=Yi($);H!==null&&H.tag===5&&H.type==="form"?Mu(H):ii.r($)}var Rr=typeof document>"u"?null:document;function mh($,H,K){var X=Rr;if(X&&typeof H=="string"&&H){var te=wn(H);te='link[rel="'+$+'"][href="'+te+'"]',typeof K=="string"&&(te+='[crossorigin="'+K+'"]'),ph.has(te)||(ph.add(te),$={rel:$,crossOrigin:K,href:H},X.querySelector(te)===null&&(H=X.createElement("link"),sn(H,"link",$),Xt(H),X.head.appendChild(H)))}}function Cp($){ii.D($),mh("dns-prefetch",$,null)}function wp($,H){ii.C($,H),mh("preconnect",$,H)}function _p($,H,K){ii.L($,H,K);var X=Rr;if(X&&$&&H){var te='link[rel="preload"][as="'+wn(H)+'"]';H==="image"&&K&&K.imageSrcSet?(te+='[imagesrcset="'+wn(K.imageSrcSet)+'"]',typeof K.imageSizes=="string"&&(te+='[imagesizes="'+wn(K.imageSizes)+'"]')):te+='[href="'+wn($)+'"]';var ie=te;switch(H){case"style":ie=Ar($);break;case"script":ie=Pr($)}Mn.has(ie)||($=W({rel:"preload",href:H==="image"&&K&&K.imageSrcSet?void 0:$,as:H},K),Mn.set(ie,$),X.querySelector(te)!==null||H==="style"&&X.querySelector(ya(ie))||H==="script"&&X.querySelector(va(ie))||(H=X.createElement("link"),sn(H,"link",$),Xt(H),X.head.appendChild(H)))}}function Rp($,H){ii.m($,H);var K=Rr;if(K&&$){var X=H&&typeof H.as=="string"?H.as:"script",te='link[rel="modulepreload"][as="'+wn(X)+'"][href="'+wn($)+'"]',ie=te;switch(X){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ie=Pr($)}if(!Mn.has(ie)&&($=W({rel:"modulepreload",href:$},H),Mn.set(ie,$),K.querySelector(te)===null)){switch(X){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(K.querySelector(va(ie)))return}X=K.createElement("link"),sn(X,"link",$),Xt(X),K.head.appendChild(X)}}}function Ap($,H,K){ii.S($,H,K);var X=Rr;if(X&&$){var te=Qi(X).hoistableStyles,ie=Ar($);H=H||"default";var ce=te.get(ie);if(!ce){var me={loading:0,preload:null};if(ce=X.querySelector(ya(ie)))me.loading=5;else{$=W({rel:"stylesheet",href:$,"data-precedence":H},K),(K=Mn.get(ie))&&Vl($,K);var ve=ce=X.createElement("link");Xt(ve),sn(ve,"link",$),ve._p=new Promise(function(Pe,qe){ve.onload=Pe,ve.onerror=qe}),ve.addEventListener("load",function(){me.loading|=1}),ve.addEventListener("error",function(){me.loading|=2}),me.loading|=4,Es(ce,H,X)}ce={type:"stylesheet",instance:ce,count:1,state:me},te.set(ie,ce)}}}function Pp($,H){ii.X($,H);var K=Rr;if(K&&$){var X=Qi(K).hoistableScripts,te=Pr($),ie=X.get(te);ie||(ie=K.querySelector(va(te)),ie||($=W({src:$,async:!0},H),(H=Mn.get(te))&&Ul($,H),ie=K.createElement("script"),Xt(ie),sn(ie,"link",$),K.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},X.set(te,ie))}}function Op($,H){ii.M($,H);var K=Rr;if(K&&$){var X=Qi(K).hoistableScripts,te=Pr($),ie=X.get(te);ie||(ie=K.querySelector(va(te)),ie||($=W({src:$,async:!0,type:"module"},H),(H=Mn.get(te))&&Ul($,H),ie=K.createElement("script"),Xt(ie),sn(ie,"link",$),K.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},X.set(te,ie))}}function gh($,H,K,X){var te=(te=$e.current)?ks(te):null;if(!te)throw Error(F(446));switch($){case"meta":case"title":return null;case"style":return typeof K.precedence=="string"&&typeof K.href=="string"?(H=Ar(K.href),K=Qi(te).hoistableStyles,X=K.get(H),X||(X={type:"style",instance:null,count:0,state:null},K.set(H,X)),X):{type:"void",instance:null,count:0,state:null};case"link":if(K.rel==="stylesheet"&&typeof K.href=="string"&&typeof K.precedence=="string"){$=Ar(K.href);var ie=Qi(te).hoistableStyles,ce=ie.get($);if(ce||(te=te.ownerDocument||te,ce={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ie.set($,ce),(ie=te.querySelector(ya($)))&&!ie._p&&(ce.instance=ie,ce.state.loading=5),Mn.has($)||(K={rel:"preload",as:"style",href:K.href,crossOrigin:K.crossOrigin,integrity:K.integrity,media:K.media,hrefLang:K.hrefLang,referrerPolicy:K.referrerPolicy},Mn.set($,K),ie||Dp(te,$,K,ce.state))),H&&X===null)throw Error(F(528,""));return ce}if(H&&X!==null)throw Error(F(529,""));return null;case"script":return H=K.async,K=K.src,typeof K=="string"&&H&&typeof H!="function"&&typeof H!="symbol"?(H=Pr(K),K=Qi(te).hoistableScripts,X=K.get(H),X||(X={type:"script",instance:null,count:0,state:null},K.set(H,X)),X):{type:"void",instance:null,count:0,state:null};default:throw Error(F(444,$))}}function Ar($){return'href="'+wn($)+'"'}function ya($){return'link[rel="stylesheet"]['+$+"]"}function yh($){return W({},$,{"data-precedence":$.precedence,precedence:null})}function Dp($,H,K,X){$.querySelector('link[rel="preload"][as="style"]['+H+"]")?X.loading=1:(H=$.createElement("link"),X.preload=H,H.addEventListener("load",function(){return X.loading|=1}),H.addEventListener("error",function(){return X.loading|=2}),sn(H,"link",K),Xt(H),$.head.appendChild(H))}function Pr($){return'[src="'+wn($)+'"]'}function va($){return"script[async]"+$}function xh($,H,K){if(H.count++,H.instance===null)switch(H.type){case"style":var X=$.querySelector('style[data-href~="'+wn(K.href)+'"]');if(X)return H.instance=X,Xt(X),X;var te=W({},K,{"data-href":K.href,"data-precedence":K.precedence,href:null,precedence:null});return X=($.ownerDocument||$).createElement("style"),Xt(X),sn(X,"style",te),Es(X,K.precedence,$),H.instance=X;case"stylesheet":te=Ar(K.href);var ie=$.querySelector(ya(te));if(ie)return H.state.loading|=4,H.instance=ie,Xt(ie),ie;X=yh(K),(te=Mn.get(te))&&Vl(X,te),ie=($.ownerDocument||$).createElement("link"),Xt(ie);var ce=ie;return ce._p=new Promise(function(me,ve){ce.onload=me,ce.onerror=ve}),sn(ie,"link",X),H.state.loading|=4,Es(ie,K.precedence,$),H.instance=ie;case"script":return ie=Pr(K.src),(te=$.querySelector(va(ie)))?(H.instance=te,Xt(te),te):(X=K,(te=Mn.get(ie))&&(X=W({},K),Ul(X,te)),$=$.ownerDocument||$,te=$.createElement("script"),Xt(te),sn(te,"link",X),$.head.appendChild(te),H.instance=te);case"void":return null;default:throw Error(F(443,H.type))}else H.type==="stylesheet"&&(H.state.loading&4)===0&&(X=H.instance,H.state.loading|=4,Es(X,K.precedence,$));return H.instance}function Es($,H,K){for(var X=K.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),te=X.length?X[X.length-1]:null,ie=te,ce=0;ce<X.length;ce++){var me=X[ce];if(me.dataset.precedence===H)ie=me;else if(ie!==te)break}ie?ie.parentNode.insertBefore($,ie.nextSibling):(H=K.nodeType===9?K.head:K,H.insertBefore($,H.firstChild))}function Vl($,H){$.crossOrigin==null&&($.crossOrigin=H.crossOrigin),$.referrerPolicy==null&&($.referrerPolicy=H.referrerPolicy),$.title==null&&($.title=H.title)}function Ul($,H){$.crossOrigin==null&&($.crossOrigin=H.crossOrigin),$.referrerPolicy==null&&($.referrerPolicy=H.referrerPolicy),$.integrity==null&&($.integrity=H.integrity)}var Cs=null;function bh($,H,K){if(Cs===null){var X=new Map,te=Cs=new Map;te.set(K,X)}else te=Cs,X=te.get(K),X||(X=new Map,te.set(K,X));if(X.has($))return X;for(X.set($,null),K=K.getElementsByTagName($),te=0;te<K.length;te++){var ie=K[te];if(!(ie[Or]||ie[on]||$==="link"&&ie.getAttribute("rel")==="stylesheet")&&ie.namespaceURI!=="http://www.w3.org/2000/svg"){var ce=ie.getAttribute(H)||"";ce=$+ce;var me=X.get(ce);me?me.push(ie):X.set(ce,[ie])}}return X}function Sh($,H,K){$=$.ownerDocument||$,$.head.insertBefore(K,H==="title"?$.querySelector("head > title"):null)}function Mp($,H,K){if(K===1||H.itemProp!=null)return!1;switch($){case"meta":case"title":return!0;case"style":if(typeof H.precedence!="string"||typeof H.href!="string"||H.href==="")break;return!0;case"link":if(typeof H.rel!="string"||typeof H.href!="string"||H.href===""||H.onLoad||H.onError)break;switch(H.rel){case"stylesheet":return $=H.disabled,typeof H.precedence=="string"&&$==null;default:return!0}case"script":if(H.async&&typeof H.async!="function"&&typeof H.async!="symbol"&&!H.onLoad&&!H.onError&&H.src&&typeof H.src=="string")return!0}return!1}function Th($){return!($.type==="stylesheet"&&($.state.loading&3)===0)}var xa=null;function Np(){}function Ip($,H,K){if(xa===null)throw Error(F(475));var X=xa;if(H.type==="stylesheet"&&(typeof K.media!="string"||matchMedia(K.media).matches!==!1)&&(H.state.loading&4)===0){if(H.instance===null){var te=Ar(K.href),ie=$.querySelector(ya(te));if(ie){$=ie._p,$!==null&&typeof $=="object"&&typeof $.then=="function"&&(X.count++,X=ws.bind(X),$.then(X,X)),H.state.loading|=4,H.instance=ie,Xt(ie);return}ie=$.ownerDocument||$,K=yh(K),(te=Mn.get(te))&&Vl(K,te),ie=ie.createElement("link"),Xt(ie);var ce=ie;ce._p=new Promise(function(me,ve){ce.onload=me,ce.onerror=ve}),sn(ie,"link",K),H.instance=ie}X.stylesheets===null&&(X.stylesheets=new Map),X.stylesheets.set(H,$),($=H.state.preload)&&(H.state.loading&3)===0&&(X.count++,H=ws.bind(X),$.addEventListener("load",H),$.addEventListener("error",H))}}function Lp(){if(xa===null)throw Error(F(475));var $=xa;return $.stylesheets&&$.count===0&&Fl($,$.stylesheets),0<$.count?function(H){var K=setTimeout(function(){if($.stylesheets&&Fl($,$.stylesheets),$.unsuspend){var X=$.unsuspend;$.unsuspend=null,X()}},6e4);return $.unsuspend=H,function(){$.unsuspend=null,clearTimeout(K)}}:null}function ws(){if(this.count--,this.count===0){if(this.stylesheets)Fl(this,this.stylesheets);else if(this.unsuspend){var $=this.unsuspend;this.unsuspend=null,$()}}}var _s=null;function Fl($,H){$.stylesheets=null,$.unsuspend!==null&&($.count++,_s=new Map,H.forEach(jp,$),_s=null,ws.call($))}function jp($,H){if(!(H.state.loading&4)){var K=_s.get($);if(K)var X=K.get(null);else{K=new Map,_s.set($,K);for(var te=$.querySelectorAll("link[data-precedence],style[data-precedence]"),ie=0;ie<te.length;ie++){var ce=te[ie];(ce.nodeName==="LINK"||ce.getAttribute("media")!=="not all")&&(K.set(ce.dataset.precedence,ce),X=ce)}X&&K.set(null,X)}te=H.instance,ce=te.getAttribute("data-precedence"),ie=K.get(ce)||X,ie===X&&K.set(null,te),K.set(ce,te),this.count++,X=ws.bind(this),te.addEventListener("load",X),te.addEventListener("error",X),ie?ie.parentNode.insertBefore(te,ie.nextSibling):($=$.nodeType===9?$.head:$,$.insertBefore(te,$.firstChild)),H.state.loading|=4}}var ba={$$typeof:he,Provider:null,Consumer:null,_currentValue:Ue,_currentValue2:Ue,_threadCount:0};function Vp($,H,K,X,te,ie,ce,me){this.tag=1,this.containerInfo=$,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qt(0),this.hiddenUpdates=qt(null),this.identifierPrefix=X,this.onUncaughtError=te,this.onCaughtError=ie,this.onRecoverableError=ce,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function kh($,H,K,X,te,ie,ce,me,ve,Pe,qe,Qe){return $=new Vp($,H,K,ce,me,ve,Pe,Qe),H=1,ie===!0&&(H|=24),ie=xn(3,null,null,H),$.current=ie,ie.stateNode=$,H=So(),H.refCount++,$.pooledCache=H,H.refCount++,ie.memoizedState={element:X,isDehydrated:K,cache:H},Co(ie),$}function Eh($){return $?($=or,$):or}function Ch($,H,K,X,te,ie){te=Eh(te),X.context===null?X.context=te:X.pendingContext=te,X=li(H),X.payload={element:K},ie=ie===void 0?null:ie,ie!==null&&(X.callback=ie),K=ci($,X,H),K!==null&&(En(K,$,H),Wr(K,$,H))}function wh($,H){if($=$.memoizedState,$!==null&&$.dehydrated!==null){var K=$.retryLane;$.retryLane=K!==0&&K<H?K:H}}function Bl($,H){wh($,H),($=$.alternate)&&wh($,H)}function _h($){if($.tag===13){var H=sr($,67108864);H!==null&&En(H,$,67108864),Bl($,67108864)}}var Rs=!0;function Up($,H,K,X){var te=Te.T;Te.T=null;var ie=Oe.p;try{Oe.p=2,$l($,H,K,X)}finally{Oe.p=ie,Te.T=te}}function Fp($,H,K,X){var te=Te.T;Te.T=null;var ie=Oe.p;try{Oe.p=8,$l($,H,K,X)}finally{Oe.p=ie,Te.T=te}}function $l($,H,K,X){if(Rs){var te=ql(X);if(te===null)Al($,H,X,As,K),Ah($,X);else if($p(te,$,H,K,X))X.stopPropagation();else if(Ah($,X),H&4&&-1<Bp.indexOf($)){for(;te!==null;){var ie=Yi(te);if(ie!==null)switch(ie.tag){case 3:if(ie=ie.stateNode,ie.current.memoizedState.isDehydrated){var ce=Be(ie.pendingLanes);if(ce!==0){var me=ie;for(me.pendingLanes|=2,me.entangledLanes|=2;ce;){var ve=1<<31-it(ce);me.entanglements[1]|=ve,ce&=~ve}$n(ie),(Et&6)===0&&(hs=bt()+500,fa(0))}}break;case 13:me=sr(ie,2),me!==null&&En(me,ie,2),ps(),Bl(ie,2)}if(ie=ql(X),ie===null&&Al($,H,X,As,K),ie===te)break;te=ie}te!==null&&X.stopPropagation()}else Al($,H,X,null,K)}}function ql($){return $=Ks($),zl($)}var As=null;function zl($){if(As=null,$=Ki($),$!==null){var H=q($);if(H===null)$=null;else{var K=H.tag;if(K===13){if($=z(H),$!==null)return $;$=null}else if(K===3){if(H.stateNode.current.memoizedState.isDehydrated)return H.tag===3?H.stateNode.containerInfo:null;$=null}else H!==$&&($=null)}}return As=$,null}function Rh($){switch($){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(dn()){case At:return 2;case Wt:return 8;case nn:case De:return 32;case Xe:return 268435456;default:return 32}default:return 32}}var Hl=!1,Ti=null,ki=null,Ei=null,Sa=new Map,Ta=new Map,Ci=[],Bp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ah($,H){switch($){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":Sa.delete(H.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ta.delete(H.pointerId)}}function ka($,H,K,X,te,ie){return $===null||$.nativeEvent!==ie?($={blockedOn:H,domEventName:K,eventSystemFlags:X,nativeEvent:ie,targetContainers:[te]},H!==null&&(H=Yi(H),H!==null&&_h(H)),$):($.eventSystemFlags|=X,H=$.targetContainers,te!==null&&H.indexOf(te)===-1&&H.push(te),$)}function $p($,H,K,X,te){switch(H){case"focusin":return Ti=ka(Ti,$,H,K,X,te),!0;case"dragenter":return ki=ka(ki,$,H,K,X,te),!0;case"mouseover":return Ei=ka(Ei,$,H,K,X,te),!0;case"pointerover":var ie=te.pointerId;return Sa.set(ie,ka(Sa.get(ie)||null,$,H,K,X,te)),!0;case"gotpointercapture":return ie=te.pointerId,Ta.set(ie,ka(Ta.get(ie)||null,$,H,K,X,te)),!0}return!1}function Ph($){var H=Ki($.target);if(H!==null){var K=q(H);if(K!==null){if(H=K.tag,H===13){if(H=z(K),H!==null){$.blockedOn=H,Nh($.priority,function(){if(K.tag===13){var X=kn();X=Ls(X);var te=sr(K,X);te!==null&&En(te,K,X),Bl(K,X)}});return}}else if(H===3&&K.stateNode.current.memoizedState.isDehydrated){$.blockedOn=K.tag===3?K.stateNode.containerInfo:null;return}}}$.blockedOn=null}function Ps($){if($.blockedOn!==null)return!1;for(var H=$.targetContainers;0<H.length;){var K=ql($.nativeEvent);if(K===null){K=$.nativeEvent;var X=new K.constructor(K.type,K);Gs=X,K.target.dispatchEvent(X),Gs=null}else return H=Yi(K),H!==null&&_h(H),$.blockedOn=K,!1;H.shift()}return!0}function Oh($,H,K){Ps($)&&K.delete(H)}function qp(){Hl=!1,Ti!==null&&Ps(Ti)&&(Ti=null),ki!==null&&Ps(ki)&&(ki=null),Ei!==null&&Ps(Ei)&&(Ei=null),Sa.forEach(Oh),Ta.forEach(Oh)}function Os($,H){$.blockedOn===H&&($.blockedOn=null,Hl||(Hl=!0,V.unstable_scheduleCallback(V.unstable_NormalPriority,qp)))}var Ds=null;function Dh($){Ds!==$&&(Ds=$,V.unstable_scheduleCallback(V.unstable_NormalPriority,function(){Ds===$&&(Ds=null);for(var H=0;H<$.length;H+=3){var K=$[H],X=$[H+1],te=$[H+2];if(typeof X!="function"){if(zl(X||K)===null)continue;break}var ie=Yi(K);ie!==null&&($.splice(H,3),H-=3,zo(ie,{pending:!0,data:te,method:K.method,action:X},X,te))}}))}function Ea($){function H(ve){return Os(ve,$)}Ti!==null&&Os(Ti,$),ki!==null&&Os(ki,$),Ei!==null&&Os(Ei,$),Sa.forEach(H),Ta.forEach(H);for(var K=0;K<Ci.length;K++){var X=Ci[K];X.blockedOn===$&&(X.blockedOn=null)}for(;0<Ci.length&&(K=Ci[0],K.blockedOn===null);)Ph(K),K.blockedOn===null&&Ci.shift();if(K=($.ownerDocument||$).$$reactFormReplay,K!=null)for(X=0;X<K.length;X+=3){var te=K[X],ie=K[X+1],ce=te[hn]||null;if(typeof ie=="function")ce||Dh(K);else if(ce){var me=null;if(ie&&ie.hasAttribute("formAction")){if(te=ie,ce=ie[hn]||null)me=ce.formAction;else if(zl(te)!==null)continue}else me=ce.action;typeof me=="function"?K[X+1]=me:(K.splice(X,3),X-=3),Dh(K)}}}function Gl($){this._internalRoot=$}Ms.prototype.render=Gl.prototype.render=function($){var H=this._internalRoot;if(H===null)throw Error(F(409));var K=H.current,X=kn();Ch(K,X,$,H,null,null)},Ms.prototype.unmount=Gl.prototype.unmount=function(){var $=this._internalRoot;if($!==null){this._internalRoot=null;var H=$.containerInfo;Ch($.current,2,null,$,null,null),ps(),H[Gi]=null}};function Ms($){this._internalRoot=$}Ms.prototype.unstable_scheduleHydration=function($){if($){var H=Kl();$={blockedOn:null,target:$,priority:H};for(var K=0;K<Ci.length&&H!==0&&H<Ci[K].priority;K++);Ci.splice(K,0,$),K===0&&Ph($)}};var Mh=j.version;if(Mh!=="19.1.1")throw Error(F(527,Mh,"19.1.1"));Oe.findDOMNode=function($){var H=$._reactInternals;if(H===void 0)throw typeof $.render=="function"?Error(F(188)):($=Object.keys($).join(","),Error(F(268,$)));return $=Y(H),$=$!==null?Q($):null,$=$===null?null:$.stateNode,$};var zp={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Te,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ns=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ns.isDisabled&&Ns.supportsFiber)try{_e=Ns.inject(zp),je=Ns}catch{}}return reactDomClient_production.createRoot=function($,H){if(!B($))throw Error(F(299));var K=!1,X="",te=Ku,ie=Yu,ce=Qu,me=null;return H!=null&&(H.unstable_strictMode===!0&&(K=!0),H.identifierPrefix!==void 0&&(X=H.identifierPrefix),H.onUncaughtError!==void 0&&(te=H.onUncaughtError),H.onCaughtError!==void 0&&(ie=H.onCaughtError),H.onRecoverableError!==void 0&&(ce=H.onRecoverableError),H.unstable_transitionCallbacks!==void 0&&(me=H.unstable_transitionCallbacks)),H=kh($,1,!1,null,null,K,X,te,ie,ce,me,null),$[Gi]=H.current,Rl($),new Gl(H)},reactDomClient_production.hydrateRoot=function($,H,K){if(!B($))throw Error(F(299));var X=!1,te="",ie=Ku,ce=Yu,me=Qu,ve=null,Pe=null;return K!=null&&(K.unstable_strictMode===!0&&(X=!0),K.identifierPrefix!==void 0&&(te=K.identifierPrefix),K.onUncaughtError!==void 0&&(ie=K.onUncaughtError),K.onCaughtError!==void 0&&(ce=K.onCaughtError),K.onRecoverableError!==void 0&&(me=K.onRecoverableError),K.unstable_transitionCallbacks!==void 0&&(ve=K.unstable_transitionCallbacks),K.formState!==void 0&&(Pe=K.formState)),H=kh($,1,!0,H,K??null,X,te,ie,ce,me,ve,Pe),H.context=Eh(null),K=H.current,X=kn(),X=Ls(X),te=li(X),te.callback=null,ci(K,te,X),K=X,H.current.lanes=K,Ut(H,K),$n(H),$[Gi]=H.current,Rl($),new Ms(H)},reactDomClient_production.version="19.1.1",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function V(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V)}catch(j){console.error(j)}}return V(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const widgetCSS='@import"https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap";*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.exthalpy-fixed{position:fixed}.exthalpy-absolute{position:absolute}.exthalpy-relative{position:relative}.exthalpy-inset-0{inset:0}.-exthalpy-bottom-10{bottom:-2.5rem}.-exthalpy-bottom-2{bottom:-.5rem}.-exthalpy-left-24{left:-6rem}.exthalpy-bottom-0{bottom:0}.exthalpy-bottom-16{bottom:4rem}.exthalpy-bottom-20{bottom:5rem}.exthalpy-bottom-24{bottom:6rem}.exthalpy-bottom-5{bottom:1.25rem}.exthalpy-bottom-64{bottom:16rem}.exthalpy-bottom-7{bottom:1.75rem}.exthalpy-left-1\\/2{left:50%}.exthalpy-left-10{left:2.5rem}.exthalpy-left-14{left:3.5rem}.exthalpy-left-20{left:5rem}.exthalpy-right-0{right:0}.exthalpy-right-2{right:.5rem}.exthalpy-right-4{right:1rem}.exthalpy-right-\\[24px\\]{right:24px}.exthalpy-z-10{z-index:10}.exthalpy-z-50{z-index:50}.exthalpy-m-0{margin:0}.exthalpy-mx-auto{margin-left:auto;margin-right:auto}.exthalpy-mb-1{margin-bottom:.25rem}.exthalpy-mt-1{margin-top:.25rem}.exthalpy-mt-2{margin-top:.5rem}.exthalpy-mt-auto{margin-top:auto}.exthalpy-block{display:block}.exthalpy-flex{display:flex}.exthalpy-h-10{height:2.5rem}.exthalpy-h-4{height:1rem}.exthalpy-h-\\[200px\\]{height:200px}.exthalpy-h-\\[250px\\]{height:250px}.exthalpy-h-\\[480px\\]{height:480px}.exthalpy-h-\\[600px\\]{height:600px}.exthalpy-h-\\[60px\\]{height:60px}.exthalpy-h-full{height:100%}.exthalpy-h-px{height:1px}.exthalpy-max-h-24{max-height:6rem}.exthalpy-w-10{width:2.5rem}.exthalpy-w-4{width:1rem}.exthalpy-w-48{width:12rem}.exthalpy-w-60{width:15rem}.exthalpy-w-\\[250px\\]{width:250px}.exthalpy-w-\\[300px\\]{width:300px}.exthalpy-w-\\[320px\\]{width:320px}.exthalpy-w-full{width:100%}.exthalpy-min-w-\\[80px\\]{min-width:80px}.exthalpy-max-w-4xl{max-width:56rem}.exthalpy-max-w-\\[16ch\\]{max-width:16ch}.exthalpy-max-w-\\[75\\%\\]{max-width:75%}.exthalpy-max-w-sm{max-width:24rem}.exthalpy-flex-1{flex:1 1 0%}.exthalpy-translate-x-1\\/2{--tw-translate-x: 50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.exthalpy-rotate-45{--tw-rotate: 45deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.exthalpy-scale-\\[0\\.9\\]{--tw-scale-x: .9;--tw-scale-y: .9;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes exthalpy-spin{to{transform:rotate(360deg)}}.exthalpy-animate-spin{animation:exthalpy-spin 1s linear infinite}.exthalpy-cursor-pointer{cursor:pointer}.exthalpy-resize-y{resize:vertical}.exthalpy-flex-col{flex-direction:column}.exthalpy-items-center{align-items:center}.exthalpy-justify-start{justify-content:flex-start}.exthalpy-justify-end{justify-content:flex-end}.exthalpy-justify-center{justify-content:center}.exthalpy-justify-between{justify-content:space-between}.exthalpy-gap-1{gap:.25rem}.exthalpy-gap-2{gap:.5rem}.exthalpy-gap-3{gap:.75rem}.exthalpy-gap-4{gap:1rem}.exthalpy-space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.exthalpy-overflow-hidden{overflow:hidden}.exthalpy-overflow-y-auto{overflow-y:auto}.exthalpy-truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.exthalpy-rounded{border-radius:.25rem}.exthalpy-rounded-2xl{border-radius:1rem}.exthalpy-rounded-\\[20px\\]{border-radius:20px}.exthalpy-rounded-full{border-radius:9999px}.exthalpy-rounded-lg{border-radius:.5rem}.exthalpy-rounded-md{border-radius:.375rem}.exthalpy-rounded-xl{border-radius:.75rem}.exthalpy-rounded-l-md{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.exthalpy-rounded-r-md{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.exthalpy-rounded-bl-none{border-bottom-left-radius:0}.exthalpy-rounded-br-none{border-bottom-right-radius:0}.exthalpy-border{border-width:1px}.exthalpy-border-0{border-width:0px}.exthalpy-border-b{border-bottom-width:1px}.exthalpy-border-r-0{border-right-width:0px}.exthalpy-border-t{border-top-width:1px}.exthalpy-border-solid{border-style:solid}.exthalpy-border-none{border-style:none}.exthalpy-border-black{--tw-border-opacity: 1;border-color:rgb(0 0 0 / var(--tw-border-opacity, 1))}.exthalpy-border-black\\/20{border-color:#0003}.exthalpy-border-black\\/70{border-color:#000000b3}.exthalpy-border-gray-200{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.exthalpy-border-gray-500{--tw-border-opacity: 1;border-color:rgb(107 114 128 / var(--tw-border-opacity, 1))}.exthalpy-border-white\\/30{border-color:#ffffff4d}.exthalpy-bg-\\[\\#1a1a1a\\]{--tw-bg-opacity: 1;background-color:rgb(26 26 26 / var(--tw-bg-opacity, 1))}.exthalpy-bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.exthalpy-bg-black\\/20{background-color:#0003}.exthalpy-bg-gray-200{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.exthalpy-bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.exthalpy-bg-gray-50{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.exthalpy-bg-slate-100{--tw-bg-opacity: 1;background-color:rgb(241 245 249 / var(--tw-bg-opacity, 1))}.exthalpy-bg-transparent{background-color:transparent}.exthalpy-bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.exthalpy-object-contain{-o-object-fit:contain;object-fit:contain}.exthalpy-object-cover{-o-object-fit:cover;object-fit:cover}.exthalpy-p-1{padding:.25rem}.exthalpy-p-2{padding:.5rem}.exthalpy-p-3{padding:.75rem}.exthalpy-p-4{padding:1rem}.exthalpy-p-6{padding:1.5rem}.exthalpy-px-1{padding-left:.25rem;padding-right:.25rem}.exthalpy-px-2{padding-left:.5rem;padding-right:.5rem}.exthalpy-px-3{padding-left:.75rem;padding-right:.75rem}.exthalpy-px-4{padding-left:1rem;padding-right:1rem}.exthalpy-py-1{padding-top:.25rem;padding-bottom:.25rem}.exthalpy-py-2{padding-top:.5rem;padding-bottom:.5rem}.exthalpy-py-3{padding-top:.75rem;padding-bottom:.75rem}.exthalpy-pb-0{padding-bottom:0}.exthalpy-pb-10{padding-bottom:2.5rem}.exthalpy-pb-3{padding-bottom:.75rem}.exthalpy-pb-4{padding-bottom:1rem}.exthalpy-pb-5{padding-bottom:1.25rem}.exthalpy-pr-2{padding-right:.5rem}.exthalpy-pt-1{padding-top:.25rem}.exthalpy-pt-32{padding-top:8rem}.exthalpy-pt-4{padding-top:1rem}.exthalpy-text-left{text-align:left}.exthalpy-text-center{text-align:center}.exthalpy-text-\\[10px\\]{font-size:10px}.exthalpy-text-base{font-size:1rem;line-height:1.5rem}.exthalpy-text-sm{font-size:.875rem;line-height:1.25rem}.exthalpy-text-xs{font-size:.75rem;line-height:1rem}.exthalpy-font-light{font-weight:300}.exthalpy-font-medium{font-weight:500}.exthalpy-font-semibold{font-weight:600}.exthalpy-uppercase{text-transform:uppercase}.exthalpy-tracking-wider{letter-spacing:.05em}.exthalpy-text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.exthalpy-text-black\\/30{color:#0000004d}.exthalpy-text-black\\/80{color:#000c}.exthalpy-text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.exthalpy-text-gray-500{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.exthalpy-text-gray-700{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.exthalpy-text-gray-800{--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.exthalpy-text-gray-900{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.exthalpy-text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.exthalpy-text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.exthalpy-text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.exthalpy-text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.exthalpy-text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.exthalpy-opacity-50{opacity:.5}.exthalpy-shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.exthalpy-shadow-\\[inset_-1px_-9px_21px_-7px_rgba\\(0\\,_0\\,_0\\,_0\\.1\\)\\]{--tw-shadow: inset -1px -9px 21px -7px rgba(0, 0, 0, .1);--tw-shadow-colored: inset -1px -9px 21px -7px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.exthalpy-shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.exthalpy-shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.exthalpy-blur-\\[2px\\]{--tw-blur: blur(2px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.exthalpy-filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.exthalpy-backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.exthalpy-transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.exthalpy-duration-200{transition-duration:.2s}.exthalpy-ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.exthalpy-scope{all:initial;font-family:Poppins,sans-serif!important;display:block!important;position:relative!important;z-index:2147483647!important;isolation:isolate!important;contain:layout style paint!important}.exthalpy-scope,.exthalpy-scope *{font-family:Poppins,sans-serif!important;box-sizing:border-box!important;-webkit-font-smoothing:antialiased!important;-moz-osx-font-smoothing:grayscale!important;text-rendering:optimizeLegibility!important}.exthalpy-scope::-webkit-scrollbar{width:4px!important}.exthalpy-scope::-webkit-scrollbar-thumb{background:#fff3!important;border-radius:2px!important}.exthalpy-scope::-webkit-scrollbar-thumb:hover{background:#ffffff4d!important}.exthalpy-glass{backdrop-filter:blur(16px)!important;-webkit-backdrop-filter:blur(16px)!important;background:#ffffff1a!important;border:1px solid rgba(255,255,255,.2)!important}.exthalpy-glass-dark{backdrop-filter:blur(16px)!important;-webkit-backdrop-filter:blur(16px)!important;background:#0000001a!important;border:1px solid rgba(255,255,255,.1)!important}.exthalpy-dashboard-glass-panel{-webkit-backdrop-filter:blur(18px)!important;border:1px solid #ffffff40!important;box-shadow:0 8px 32px #1f26871f!important;background-image:linear-gradient(#00000003,#0000001a)!important}.exthalpy-scope *:focus{outline:none!important}.exthalpy-scope *:focus-visible{outline:2px solid #3b82f6!important;outline-offset:2px!important}.hover\\:exthalpy-bg-gray-300:hover{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.hover\\:exthalpy-bg-gray-900:hover{--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.hover\\:exthalpy-underline:hover{text-decoration-line:underline}.hover\\:exthalpy-opacity-90:hover{opacity:.9}.focus\\:exthalpy-outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:exthalpy-ring-1:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\\:exthalpy-ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\\:exthalpy-ring-black:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(0 0 0 / var(--tw-ring-opacity, 1))}.focus\\:exthalpy-ring-black\\/20:focus{--tw-ring-color: rgb(0 0 0 / .2)}.focus\\:exthalpy-ring-offset-1:focus{--tw-ring-offset-width: 1px}.disabled\\:exthalpy-cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:exthalpy-opacity-60:disabled{opacity:.6}';var reactExports=requireReact();/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=V=>V.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=V=>V.replace(/^([A-Z])|[\s-_]+(\w)/g,(j,U,F)=>F?F.toUpperCase():U.toLowerCase()),toPascalCase=V=>{const j=toCamelCase(V);return j.charAt(0).toUpperCase()+j.slice(1)},mergeClasses=(...V)=>V.filter((j,U,F)=>!!j&&j.trim()!==""&&F.indexOf(j)===U).join(" ").trim(),hasA11yProp=V=>{for(const j in V)if(j.startsWith("aria-")||j==="role"||j==="title")return!0};/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:V="currentColor",size:j=24,strokeWidth:U=2,absoluteStrokeWidth:F,className:B="",children:q,iconNode:z,...G},Y)=>reactExports.createElement("svg",{ref:Y,...defaultAttributes,width:j,height:j,stroke:V,strokeWidth:F?Number(U)*24/Number(j):U,className:mergeClasses("lucide",B),...!q&&!hasA11yProp(G)&&{"aria-hidden":"true"},...G},[...z.map(([Q,W])=>reactExports.createElement(Q,W)),...Array.isArray(q)?q:[q]]));/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(V,j)=>{const U=reactExports.forwardRef(({className:F,...B},q)=>reactExports.createElement(Icon,{ref:q,iconNode:j,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(V))}`,`lucide-${V}`,F),...B}));return U.displayName=toPascalCase(V),U};/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$h=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ChevronDown=createLucideIcon("chevron-down",__iconNode$h);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$g=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$g);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$f=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$f);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],CircleX=createLucideIcon("circle-x",__iconNode$e);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$d=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],EllipsisVertical=createLucideIcon("ellipsis-vertical",__iconNode$d);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$c=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$c);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$b=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Mail=createLucideIcon("mail",__iconNode$b);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$a=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],MessageSquare=createLucideIcon("message-square",__iconNode$a);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$9=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],MicOff=createLucideIcon("mic-off",__iconNode$9);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$8=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Mic=createLucideIcon("mic",__iconNode$8);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$7=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Pen=createLucideIcon("pen",__iconNode$7);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$6=[["path",{d:"M13 2a9 9 0 0 1 9 9",key:"1itnx2"}],["path",{d:"M13 6a5 5 0 0 1 5 5",key:"11nki7"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],PhoneCall=createLucideIcon("phone-call",__iconNode$6);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$5=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],PhoneOff=createLucideIcon("phone-off",__iconNode$5);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$4=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Phone=createLucideIcon("phone",__iconNode$4);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Send=createLucideIcon("send",__iconNode$3);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],User=createLucideIcon("user",__iconNode$2);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],VideoOff=createLucideIcon("video-off",__iconNode$1);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Video=createLucideIcon("video",__iconNode),LayoutGroupContext=reactExports.createContext({});function useConstant(V){const j=reactExports.useRef(null);return j.current===null&&(j.current=V()),j.current}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect$1=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(V,j){V.indexOf(j)===-1&&V.push(j)}function removeItem(V,j){const U=V.indexOf(j);U>-1&&V.splice(U,1)}const clamp=(V,j,U)=>U>j?j:U<V?V:U;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=V=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(V);function isObject$4(V){return typeof V=="object"&&V!==null}const isZeroValueString=V=>/^0[^.\s]+$/u.test(V);function memo(V){let j;return()=>(j===void 0&&(j=V()),j)}const noop=V=>V,combineFunctions=(V,j)=>U=>j(V(U)),pipe=(...V)=>V.reduce(combineFunctions),progress=(V,j,U)=>{const F=j-V;return F===0?1:(U-V)/F};class SubscriptionManager{constructor(){this.subscriptions=[]}add(j){return addUniqueItem(this.subscriptions,j),()=>removeItem(this.subscriptions,j)}notify(j,U,F){const B=this.subscriptions.length;if(B)if(B===1)this.subscriptions[0](j,U,F);else for(let q=0;q<B;q++){const z=this.subscriptions[q];z&&z(j,U,F)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=V=>V*1e3,millisecondsToSeconds=V=>V/1e3;function velocityPerSecond(V,j){return j?V*(1e3/j):0}const calcBezier=(V,j,U)=>(((1-3*U+3*j)*V+(3*U-6*j))*V+3*j)*V,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(V,j,U,F,B){let q,z,G=0;do z=j+(U-j)/2,q=calcBezier(z,F,B)-V,q>0?U=z:j=z;while(Math.abs(q)>subdivisionPrecision&&++G<subdivisionMaxIterations);return z}function cubicBezier(V,j,U,F){if(V===j&&U===F)return noop;const B=q=>binarySubdivide(q,0,1,V,U);return q=>q===0||q===1?q:calcBezier(B(q),j,F)}const mirrorEasing=V=>j=>j<=.5?V(2*j)/2:(2-V(2*(1-j)))/2,reverseEasing=V=>j=>1-V(1-j),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=V=>(V*=2)<1?.5*backIn(V):.5*(2-Math.pow(2,-10*(V-1))),circIn=V=>1-Math.sin(Math.acos(V)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=V=>Array.isArray(V)&&typeof V[0]!="number",isBezierDefinition=V=>Array.isArray(V)&&typeof V[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=V=>typeof V=="string",easingDefinitionToFunction=V=>{if(isBezierDefinition(V)){invariant(V.length===4);const[j,U,F,B]=V;return cubicBezier(j,U,F,B)}else if(isValidEasing(V))return easingLookup[V];return V},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(V,j){let U=new Set,F=new Set,B=!1,q=!1;const z=new WeakSet;let G={delta:0,timestamp:0,isProcessing:!1};function Y(W){z.has(W)&&(Q.schedule(W),V()),W(G)}const Q={schedule:(W,Z=!1,ee=!1)=>{const ae=ee&&B?U:F;return Z&&z.add(W),ae.has(W)||ae.add(W),W},cancel:W=>{F.delete(W),z.delete(W)},process:W=>{if(G=W,B){q=!0;return}B=!0,[U,F]=[F,U],U.forEach(Y),U.clear(),B=!1,q&&(q=!1,Q.process(W))}};return Q}const maxElapsed=40;function createRenderBatcher(V,j){let U=!1,F=!0;const B={delta:0,timestamp:0,isProcessing:!1},q=()=>U=!0,z=stepsOrder.reduce((he,ye)=>(he[ye]=createRenderStep(q),he),{}),{setup:G,read:Y,resolveKeyframes:Q,preUpdate:W,update:Z,preRender:ee,render:ne,postRender:ae}=z,se=()=>{const he=MotionGlobalConfig.useManualTiming?B.timestamp:performance.now();U=!1,MotionGlobalConfig.useManualTiming||(B.delta=F?1e3/60:Math.max(Math.min(he-B.timestamp,maxElapsed),1)),B.timestamp=he,B.isProcessing=!0,G.process(B),Y.process(B),Q.process(B),W.process(B),Z.process(B),ee.process(B),ne.process(B),ae.process(B),B.isProcessing=!1,U&&j&&(F=!1,V(se))},de=()=>{U=!0,F=!0,B.isProcessing||V(se)};return{schedule:stepsOrder.reduce((he,ye)=>{const fe=z[ye];return he[ye]=(pe,xe=!1,Ee=!1)=>(U||de(),fe.schedule(pe,xe,Ee)),he},{}),cancel:he=>{for(let ye=0;ye<stepsOrder.length;ye++)z[stepsOrder[ye]].cancel(he)},state:B,steps:z}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:V=>{now=V,queueMicrotask(clearTime)}},checkStringStartsWith=V=>j=>typeof j=="string"&&j.startsWith(V),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=V=>startsAsVariableToken(V)?singleCssVariableRegex.test(V.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number$2={test:V=>typeof V=="number",parse:parseFloat,transform:V=>V},alpha={...number$2,transform:V=>clamp(0,1,V)},scale={...number$2,default:1},sanitize=V=>Math.round(V*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(V){return V==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(V,j)=>U=>!!(typeof U=="string"&&singleColorRegex.test(U)&&U.startsWith(V)||j&&!isNullish(U)&&Object.prototype.hasOwnProperty.call(U,j)),splitColor=(V,j,U)=>F=>{if(typeof F!="string")return F;const[B,q,z,G]=F.match(floatRegex);return{[V]:parseFloat(B),[j]:parseFloat(q),[U]:parseFloat(z),alpha:G!==void 0?parseFloat(G):1}},clampRgbUnit=V=>clamp(0,255,V),rgbUnit={...number$2,transform:V=>Math.round(clampRgbUnit(V))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:V,green:j,blue:U,alpha:F=1})=>"rgba("+rgbUnit.transform(V)+", "+rgbUnit.transform(j)+", "+rgbUnit.transform(U)+", "+sanitize(alpha.transform(F))+")"};function parseHex(V){let j="",U="",F="",B="";return V.length>5?(j=V.substring(1,3),U=V.substring(3,5),F=V.substring(5,7),B=V.substring(7,9)):(j=V.substring(1,2),U=V.substring(2,3),F=V.substring(3,4),B=V.substring(4,5),j+=j,U+=U,F+=F,B+=B),{red:parseInt(j,16),green:parseInt(U,16),blue:parseInt(F,16),alpha:B?parseInt(B,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=V=>({test:j=>typeof j=="string"&&j.endsWith(V)&&j.split(" ").length===1,parse:parseFloat,transform:j=>`${j}${V}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:V=>percent.parse(V)/100,transform:V=>percent.transform(V*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:V,saturation:j,lightness:U,alpha:F=1})=>"hsla("+Math.round(V)+", "+percent.transform(sanitize(j))+", "+percent.transform(sanitize(U))+", "+sanitize(alpha.transform(F))+")"},color$1={test:V=>rgba.test(V)||hex.test(V)||hsla.test(V),parse:V=>rgba.test(V)?rgba.parse(V):hsla.test(V)?hsla.parse(V):hex.parse(V),transform:V=>typeof V=="string"?V:V.hasOwnProperty("red")?rgba.transform(V):hsla.transform(V),getAnimatableNone:V=>{const j=color$1.parse(V);return j.alpha=0,color$1.transform(j)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(V){return isNaN(V)&&typeof V=="string"&&(V.match(floatRegex)?.length||0)+(V.match(colorRegex)?.length||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(V){const j=V.toString(),U=[],F={color:[],number:[],var:[]},B=[];let q=0;const G=j.replace(complexRegex,Y=>(color$1.test(Y)?(F.color.push(q),B.push(COLOR_TOKEN),U.push(color$1.parse(Y))):Y.startsWith(VAR_FUNCTION_TOKEN)?(F.var.push(q),B.push(VAR_TOKEN),U.push(Y)):(F.number.push(q),B.push(NUMBER_TOKEN),U.push(parseFloat(Y))),++q,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:U,split:G,indexes:F,types:B}}function parseComplexValue(V){return analyseComplexValue(V).values}function createTransformer(V){const{split:j,types:U}=analyseComplexValue(V),F=j.length;return B=>{let q="";for(let z=0;z<F;z++)if(q+=j[z],B[z]!==void 0){const G=U[z];G===NUMBER_TOKEN?q+=sanitize(B[z]):G===COLOR_TOKEN?q+=color$1.transform(B[z]):q+=B[z]}return q}}const convertNumbersToZero=V=>typeof V=="number"?0:color$1.test(V)?color$1.getAnimatableNone(V):V;function getAnimatableNone$1(V){const j=parseComplexValue(V);return createTransformer(V)(j.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(V,j,U){return U<0&&(U+=1),U>1&&(U-=1),U<1/6?V+(j-V)*6*U:U<1/2?j:U<2/3?V+(j-V)*(2/3-U)*6:V}function hslaToRgba({hue:V,saturation:j,lightness:U,alpha:F}){V/=360,j/=100,U/=100;let B=0,q=0,z=0;if(!j)B=q=z=U;else{const G=U<.5?U*(1+j):U+j-U*j,Y=2*U-G;B=hueToRgb(Y,G,V+1/3),q=hueToRgb(Y,G,V),z=hueToRgb(Y,G,V-1/3)}return{red:Math.round(B*255),green:Math.round(q*255),blue:Math.round(z*255),alpha:F}}function mixImmediate(V,j){return U=>U>0?j:V}const mixNumber$1=(V,j,U)=>V+(j-V)*U,mixLinearColor=(V,j,U)=>{const F=V*V,B=U*(j*j-F)+F;return B<0?0:Math.sqrt(B)},colorTypes=[hex,rgba,hsla],getColorType=V=>colorTypes.find(j=>j.test(V));function asRGBA(V){const j=getColorType(V);if(!j)return!1;let U=j.parse(V);return j===hsla&&(U=hslaToRgba(U)),U}const mixColor=(V,j)=>{const U=asRGBA(V),F=asRGBA(j);if(!U||!F)return mixImmediate(V,j);const B={...U};return q=>(B.red=mixLinearColor(U.red,F.red,q),B.green=mixLinearColor(U.green,F.green,q),B.blue=mixLinearColor(U.blue,F.blue,q),B.alpha=mixNumber$1(U.alpha,F.alpha,q),rgba.transform(B))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(V,j){return invisibleValues.has(V)?U=>U<=0?V:j:U=>U>=1?j:V}function mixNumber(V,j){return U=>mixNumber$1(V,j,U)}function getMixer(V){return typeof V=="number"?mixNumber:typeof V=="string"?isCSSVariableToken(V)?mixImmediate:color$1.test(V)?mixColor:mixComplex:Array.isArray(V)?mixArray:typeof V=="object"?color$1.test(V)?mixColor:mixObject:mixImmediate}function mixArray(V,j){const U=[...V],F=U.length,B=V.map((q,z)=>getMixer(q)(q,j[z]));return q=>{for(let z=0;z<F;z++)U[z]=B[z](q);return U}}function mixObject(V,j){const U={...V,...j},F={};for(const B in U)V[B]!==void 0&&j[B]!==void 0&&(F[B]=getMixer(V[B])(V[B],j[B]));return B=>{for(const q in F)U[q]=F[q](B);return U}}function matchOrder(V,j){const U=[],F={color:0,var:0,number:0};for(let B=0;B<j.values.length;B++){const q=j.types[B],z=V.indexes[q][F[q]],G=V.values[z]??0;U[B]=G,F[q]++}return U}const mixComplex=(V,j)=>{const U=complex.createTransformer(j),F=analyseComplexValue(V),B=analyseComplexValue(j);return F.indexes.var.length===B.indexes.var.length&&F.indexes.color.length===B.indexes.color.length&&F.indexes.number.length>=B.indexes.number.length?invisibleValues.has(V)&&!B.values.length||invisibleValues.has(j)&&!F.values.length?mixVisibility(V,j):pipe(mixArray(matchOrder(F,B),B.values),U):mixImmediate(V,j)};function mix(V,j,U){return typeof V=="number"&&typeof j=="number"&&typeof U=="number"?mixNumber$1(V,j,U):getMixer(V)(V,j)}const frameloopDriver=V=>{const j=({timestamp:U})=>V(U);return{start:(U=!0)=>frame.update(j,U),stop:()=>cancelFrame(j),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(V,j,U=10)=>{let F="";const B=Math.max(Math.round(j/U),2);for(let q=0;q<B;q++)F+=Math.round(V(q/(B-1))*1e4)/1e4+", ";return`linear(${F.substring(0,F.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(V){let j=0;const U=50;let F=V.next(j);for(;!F.done&&j<maxGeneratorDuration;)j+=U,F=V.next(j);return j>=maxGeneratorDuration?1/0:j}function createGeneratorEasing(V,j=100,U){const F=U({...V,keyframes:[0,j]}),B=Math.min(calcGeneratorDuration(F),maxGeneratorDuration);return{type:"keyframes",ease:q=>F.next(B*q).value/j,duration:millisecondsToSeconds(B)}}const velocitySampleDuration=5;function calcGeneratorVelocity(V,j,U){const F=Math.max(j-velocitySampleDuration,0);return velocityPerSecond(U-V(F),j-F)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:V=springDefaults.duration,bounce:j=springDefaults.bounce,velocity:U=springDefaults.velocity,mass:F=springDefaults.mass}){let B,q,z=1-j;z=clamp(springDefaults.minDamping,springDefaults.maxDamping,z),V=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(V)),z<1?(B=Q=>{const W=Q*z,Z=W*V,ee=W-U,ne=calcAngularFreq(Q,z),ae=Math.exp(-Z);return safeMin-ee/ne*ae},q=Q=>{const Z=Q*z*V,ee=Z*U+U,ne=Math.pow(z,2)*Math.pow(Q,2)*V,ae=Math.exp(-Z),se=calcAngularFreq(Math.pow(Q,2),z);return(-B(Q)+safeMin>0?-1:1)*((ee-ne)*ae)/se}):(B=Q=>{const W=Math.exp(-Q*V),Z=(Q-U)*V+1;return-safeMin+W*Z},q=Q=>{const W=Math.exp(-Q*V),Z=(U-Q)*(V*V);return W*Z});const G=5/V,Y=approximateRoot(B,q,G);if(V=secondsToMilliseconds(V),isNaN(Y))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:V};{const Q=Math.pow(Y,2)*F;return{stiffness:Q,damping:z*2*Math.sqrt(F*Q),duration:V}}}const rootIterations=12;function approximateRoot(V,j,U){let F=U;for(let B=1;B<rootIterations;B++)F=F-V(F)/j(F);return F}function calcAngularFreq(V,j){return V*Math.sqrt(1-j*j)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(V,j){return j.some(U=>V[U]!==void 0)}function getSpringOptions(V){let j={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...V};if(!isSpringType(V,physicsKeys)&&isSpringType(V,durationKeys))if(V.visualDuration){const U=V.visualDuration,F=2*Math.PI/(U*1.2),B=F*F,q=2*clamp(.05,1,1-(V.bounce||0))*Math.sqrt(B);j={...j,mass:springDefaults.mass,stiffness:B,damping:q}}else{const U=findSpring(V);j={...j,...U,mass:springDefaults.mass},j.isResolvedFromDuration=!0}return j}function spring(V=springDefaults.visualDuration,j=springDefaults.bounce){const U=typeof V!="object"?{visualDuration:V,keyframes:[0,1],bounce:j}:V;let{restSpeed:F,restDelta:B}=U;const q=U.keyframes[0],z=U.keyframes[U.keyframes.length-1],G={done:!1,value:q},{stiffness:Y,damping:Q,mass:W,duration:Z,velocity:ee,isResolvedFromDuration:ne}=getSpringOptions({...U,velocity:-millisecondsToSeconds(U.velocity||0)}),ae=ee||0,se=Q/(2*Math.sqrt(Y*W)),de=z-q,oe=millisecondsToSeconds(Math.sqrt(Y/W)),ue=Math.abs(de)<5;F||(F=ue?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),B||(B=ue?springDefaults.restDelta.granular:springDefaults.restDelta.default);let he;if(se<1){const fe=calcAngularFreq(oe,se);he=pe=>{const xe=Math.exp(-se*oe*pe);return z-xe*((ae+se*oe*de)/fe*Math.sin(fe*pe)+de*Math.cos(fe*pe))}}else if(se===1)he=fe=>z-Math.exp(-oe*fe)*(de+(ae+oe*de)*fe);else{const fe=oe*Math.sqrt(se*se-1);he=pe=>{const xe=Math.exp(-se*oe*pe),Ee=Math.min(fe*pe,300);return z-xe*((ae+se*oe*de)*Math.sinh(Ee)+fe*de*Math.cosh(Ee))/fe}}const ye={calculatedDuration:ne&&Z||null,next:fe=>{const pe=he(fe);if(ne)G.done=fe>=Z;else{let xe=fe===0?ae:0;se<1&&(xe=fe===0?secondsToMilliseconds(ae):calcGeneratorVelocity(he,fe,pe));const Ee=Math.abs(xe)<=F,ke=Math.abs(z-pe)<=B;G.done=Ee&&ke}return G.value=G.done?z:pe,G},toString:()=>{const fe=Math.min(calcGeneratorDuration(ye),maxGeneratorDuration),pe=generateLinearEasing(xe=>ye.next(fe*xe).value,fe,30);return fe+"ms "+pe},toTransition:()=>{}};return ye}spring.applyToOptions=V=>{const j=createGeneratorEasing(V,100,spring);return V.ease=j.ease,V.duration=secondsToMilliseconds(j.duration),V.type="keyframes",V};function inertia({keyframes:V,velocity:j=0,power:U=.8,timeConstant:F=325,bounceDamping:B=10,bounceStiffness:q=500,modifyTarget:z,min:G,max:Y,restDelta:Q=.5,restSpeed:W}){const Z=V[0],ee={done:!1,value:Z},ne=Ee=>G!==void 0&&Ee<G||Y!==void 0&&Ee>Y,ae=Ee=>G===void 0?Y:Y===void 0||Math.abs(G-Ee)<Math.abs(Y-Ee)?G:Y;let se=U*j;const de=Z+se,oe=z===void 0?de:z(de);oe!==de&&(se=oe-Z);const ue=Ee=>-se*Math.exp(-Ee/F),he=Ee=>oe+ue(Ee),ye=Ee=>{const ke=ue(Ee),Ae=he(Ee);ee.done=Math.abs(ke)<=Q,ee.value=ee.done?oe:Ae};let fe,pe;const xe=Ee=>{ne(ee.value)&&(fe=Ee,pe=spring({keyframes:[ee.value,ae(ee.value)],velocity:calcGeneratorVelocity(he,Ee,ee.value),damping:B,stiffness:q,restDelta:Q,restSpeed:W}))};return xe(0),{calculatedDuration:null,next:Ee=>{let ke=!1;return!pe&&fe===void 0&&(ke=!0,ye(Ee),xe(Ee)),fe!==void 0&&Ee>=fe?pe.next(Ee-fe):(!ke&&ye(Ee),ee)}}}function createMixers(V,j,U){const F=[],B=U||MotionGlobalConfig.mix||mix,q=V.length-1;for(let z=0;z<q;z++){let G=B(V[z],V[z+1]);if(j){const Y=Array.isArray(j)?j[z]||noop:j;G=pipe(Y,G)}F.push(G)}return F}function interpolate(V,j,{clamp:U=!0,ease:F,mixer:B}={}){const q=V.length;if(invariant(q===j.length),q===1)return()=>j[0];if(q===2&&j[0]===j[1])return()=>j[1];const z=V[0]===V[1];V[0]>V[q-1]&&(V=[...V].reverse(),j=[...j].reverse());const G=createMixers(j,F,B),Y=G.length,Q=W=>{if(z&&W<V[0])return j[0];let Z=0;if(Y>1)for(;Z<V.length-2&&!(W<V[Z+1]);Z++);const ee=progress(V[Z],V[Z+1],W);return G[Z](ee)};return U?W=>Q(clamp(V[0],V[q-1],W)):Q}function fillOffset(V,j){const U=V[V.length-1];for(let F=1;F<=j;F++){const B=progress(0,j,F);V.push(mixNumber$1(U,1,B))}}function defaultOffset(V){const j=[0];return fillOffset(j,V.length-1),j}function convertOffsetToTimes(V,j){return V.map(U=>U*j)}function defaultEasing(V,j){return V.map(()=>j||easeInOut).splice(0,V.length-1)}function keyframes({duration:V=300,keyframes:j,times:U,ease:F="easeInOut"}){const B=isEasingArray(F)?F.map(easingDefinitionToFunction):easingDefinitionToFunction(F),q={done:!1,value:j[0]},z=convertOffsetToTimes(U&&U.length===j.length?U:defaultOffset(j),V),G=interpolate(z,j,{ease:Array.isArray(B)?B:defaultEasing(j,B)});return{calculatedDuration:V,next:Y=>(q.value=G(Y),q.done=Y>=V,q)}}const isNotNull$1=V=>V!==null;function getFinalKeyframe$1(V,{repeat:j,repeatType:U="loop"},F,B=1){const q=V.filter(isNotNull$1),G=B<0||j&&U!=="loop"&&j%2===1?0:q.length-1;return!G||F===void 0?q[G]:F}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(V){typeof V.type=="string"&&(V.type=transitionTypeMap[V.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(j=>{this.resolve=j})}notifyFinished(){this.resolve()}then(j,U){return this.finished.then(j,U)}}const percentToProgress=V=>V/100;class JSAnimation extends WithPromise{constructor(j){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:U}=this.options;U&&U.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=j,this.initAnimation(),this.play(),j.autoplay===!1&&this.pause()}initAnimation(){const{options:j}=this;replaceTransitionType(j);const{type:U=keyframes,repeat:F=0,repeatDelay:B=0,repeatType:q,velocity:z=0}=j;let{keyframes:G}=j;const Y=U||keyframes;Y!==keyframes&&typeof G[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(G[0],G[1])),G=[0,100]);const Q=Y({...j,keyframes:G});q==="mirror"&&(this.mirroredGenerator=Y({...j,keyframes:[...G].reverse(),velocity:-z})),Q.calculatedDuration===null&&(Q.calculatedDuration=calcGeneratorDuration(Q));const{calculatedDuration:W}=Q;this.calculatedDuration=W,this.resolvedDuration=W+B,this.totalDuration=this.resolvedDuration*(F+1)-B,this.generator=Q}updateTime(j){const U=Math.round(j-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=U}tick(j,U=!1){const{generator:F,totalDuration:B,mixKeyframes:q,mirroredGenerator:z,resolvedDuration:G,calculatedDuration:Y}=this;if(this.startTime===null)return F.next(0);const{delay:Q=0,keyframes:W,repeat:Z,repeatType:ee,repeatDelay:ne,type:ae,onUpdate:se,finalKeyframe:de}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,j):this.speed<0&&(this.startTime=Math.min(j-B/this.speed,this.startTime)),U?this.currentTime=j:this.updateTime(j);const oe=this.currentTime-Q*(this.playbackSpeed>=0?1:-1),ue=this.playbackSpeed>=0?oe<0:oe>B;this.currentTime=Math.max(oe,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=B);let he=this.currentTime,ye=F;if(Z){const Ee=Math.min(this.currentTime,B)/G;let ke=Math.floor(Ee),Ae=Ee%1;!Ae&&Ee>=1&&(Ae=1),Ae===1&&ke--,ke=Math.min(ke,Z+1),!!(ke%2)&&(ee==="reverse"?(Ae=1-Ae,ne&&(Ae-=ne/G)):ee==="mirror"&&(ye=z)),he=clamp(0,1,Ae)*G}const fe=ue?{done:!1,value:W[0]}:ye.next(he);q&&(fe.value=q(fe.value));let{done:pe}=fe;!ue&&Y!==null&&(pe=this.playbackSpeed>=0?this.currentTime>=B:this.currentTime<=0);const xe=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&pe);return xe&&ae!==inertia&&(fe.value=getFinalKeyframe$1(W,this.options,de,this.speed)),se&&se(fe.value),xe&&this.finish(),fe}then(j,U){return this.finished.then(j,U)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get time(){return millisecondsToSeconds(this.currentTime)}set time(j){j=secondsToMilliseconds(j),this.currentTime=j,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=j:this.driver&&(this.startTime=this.driver.now()-j/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(j){this.updateTime(time.now());const U=this.playbackSpeed!==j;this.playbackSpeed=j,U&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.isStopped)return;const{driver:j=frameloopDriver,startTime:U}=this.options;this.driver||(this.driver=j(B=>this.tick(B))),this.options.onPlay?.();const F=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=F):this.holdTime!==null?this.startTime=F-this.holdTime:this.startTime||(this.startTime=U??F),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(j){return this.startTime=0,this.tick(j,!0)}attachTimeline(j){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),j.observe(this)}}function fillWildcards(V){for(let j=1;j<V.length;j++)V[j]??(V[j]=V[j-1])}const radToDeg=V=>V*180/Math.PI,rotate=V=>{const j=radToDeg(Math.atan2(V[1],V[0]));return rebaseAngle(j)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:V=>(Math.abs(V[0])+Math.abs(V[3]))/2,rotate,rotateZ:rotate,skewX:V=>radToDeg(Math.atan(V[1])),skewY:V=>radToDeg(Math.atan(V[2])),skew:V=>(Math.abs(V[1])+Math.abs(V[2]))/2},rebaseAngle=V=>(V=V%360,V<0&&(V+=360),V),rotateZ=rotate,scaleX=V=>Math.sqrt(V[0]*V[0]+V[1]*V[1]),scaleY=V=>Math.sqrt(V[4]*V[4]+V[5]*V[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:V=>(scaleX(V)+scaleY(V))/2,rotateX:V=>rebaseAngle(radToDeg(Math.atan2(V[6],V[5]))),rotateY:V=>rebaseAngle(radToDeg(Math.atan2(-V[2],V[0]))),rotateZ,rotate:rotateZ,skewX:V=>radToDeg(Math.atan(V[4])),skewY:V=>radToDeg(Math.atan(V[1])),skew:V=>(Math.abs(V[1])+Math.abs(V[4]))/2};function defaultTransformValue(V){return V.includes("scale")?1:0}function parseValueFromTransform(V,j){if(!V||V==="none")return defaultTransformValue(j);const U=V.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let F,B;if(U)F=matrix3dParsers,B=U;else{const G=V.match(/^matrix\(([-\d.e\s,]+)\)$/u);F=matrix2dParsers,B=G}if(!B)return defaultTransformValue(j);const q=F[j],z=B[1].split(",").map(convertTransformToNumber);return typeof q=="function"?q(z):z[q]}const readTransformValue=(V,j)=>{const{transform:U="none"}=getComputedStyle(V);return parseValueFromTransform(U,j)};function convertTransformToNumber(V){return parseFloat(V.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=V=>V===number$2||V===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(V=>!transformKeys.has(V));function removeNonTranslationalTransform(V){const j=[];return nonTranslationalTransformKeys.forEach(U=>{const F=V.getValue(U);F!==void 0&&(j.push([U,F.get()]),F.set(U.startsWith("scale")?1:0))}),j}const positionalValues={width:({x:V},{paddingLeft:j="0",paddingRight:U="0"})=>V.max-V.min-parseFloat(j)-parseFloat(U),height:({y:V},{paddingTop:j="0",paddingBottom:U="0"})=>V.max-V.min-parseFloat(j)-parseFloat(U),top:(V,{top:j})=>parseFloat(j),left:(V,{left:j})=>parseFloat(j),bottom:({y:V},{top:j})=>parseFloat(j)+(V.max-V.min),right:({x:V},{left:j})=>parseFloat(j)+(V.max-V.min),x:(V,{transform:j})=>parseValueFromTransform(j,"x"),y:(V,{transform:j})=>parseValueFromTransform(j,"y")};positionalValues.translateX=positionalValues.x,positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const V=Array.from(toResolve).filter(F=>F.needsMeasurement),j=new Set(V.map(F=>F.element)),U=new Map;j.forEach(F=>{const B=removeNonTranslationalTransform(F);B.length&&(U.set(F,B),F.render())}),V.forEach(F=>F.measureInitialState()),j.forEach(F=>{F.render();const B=U.get(F);B&&B.forEach(([q,z])=>{F.getValue(q)?.set(z)})}),V.forEach(F=>F.measureEndState()),V.forEach(F=>{F.suspendedScrollY!==void 0&&window.scrollTo(0,F.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(V=>V.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(V=>{V.readKeyframes(),V.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(j,U,F,B,q,z=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...j],this.onComplete=U,this.name=F,this.motionValue=B,this.element=q,this.isAsync=z}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:j,name:U,element:F,motionValue:B}=this;if(j[0]===null){const q=B?.get(),z=j[j.length-1];if(q!==void 0)j[0]=q;else if(F&&U){const G=F.readValue(U,z);G!=null&&(j[0]=G)}j[0]===void 0&&(j[0]=z),B&&q===void 0&&B.set(j[0])}fillWildcards(j)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(j=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,j),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=V=>V.startsWith("--");function setStyle(V,j,U){isCSSVar(j)?V.style.setProperty(j,U):V.style[j]=U}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(V,j){const U=memo(V);return()=>supportsFlags[j]??U()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([V,j,U,F])=>`cubic-bezier(${V}, ${j}, ${U}, ${F})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(V,j){if(V)return typeof V=="function"?supportsLinearEasing()?generateLinearEasing(V,j):"ease-out":isBezierDefinition(V)?cubicBezierAsString(V):Array.isArray(V)?V.map(U=>mapEasingToNativeEasing(U,j)||supportedWaapiEasing.easeOut):supportedWaapiEasing[V]}function startWaapiAnimation(V,j,U,{delay:F=0,duration:B=300,repeat:q=0,repeatType:z="loop",ease:G="easeOut",times:Y}={},Q=void 0){const W={[j]:U};Y&&(W.offset=Y);const Z=mapEasingToNativeEasing(G,B);Array.isArray(Z)&&(W.easing=Z);const ee={delay:F,duration:B,easing:Array.isArray(Z)?"linear":Z,fill:"both",iterations:q+1,direction:z==="reverse"?"alternate":"normal"};return Q&&(ee.pseudoElement=Q),V.animate(W,ee)}function isGenerator(V){return typeof V=="function"&&"applyToOptions"in V}function applyGeneratorOptions({type:V,...j}){return isGenerator(V)&&supportsLinearEasing()?V.applyToOptions(j):(j.duration??(j.duration=300),j.ease??(j.ease="easeOut"),j)}class NativeAnimation extends WithPromise{constructor(j){if(super(),this.finishedTime=null,this.isStopped=!1,!j)return;const{element:U,name:F,keyframes:B,pseudoElement:q,allowFlatten:z=!1,finalKeyframe:G,onComplete:Y}=j;this.isPseudoElement=!!q,this.allowFlatten=z,this.options=j,invariant(typeof j.type!="string");const Q=applyGeneratorOptions(j);this.animation=startWaapiAnimation(U,F,B,Q,q),Q.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!q){const W=getFinalKeyframe$1(B,this.options,G,this.speed);this.updateMotionValue?this.updateMotionValue(W):setStyle(U,F,W),this.animation.cancel()}Y?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:j}=this;j==="idle"||j==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const j=this.animation.effect?.getComputedTiming?.().duration||0;return millisecondsToSeconds(Number(j))}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(j){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(j)}get speed(){return this.animation.playbackRate}set speed(j){j<0&&(this.finishedTime=null),this.animation.playbackRate=j}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(j){this.animation.startTime=j}attachTimeline({timeline:j,observe:U}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,j&&supportsScrollTimeline()?(this.animation.timeline=j,noop):U(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(V){return V in unsupportedEasingFunctions}function replaceStringEasing(V){typeof V.ease=="string"&&isUnsupportedEase(V.ease)&&(V.ease=unsupportedEasingFunctions[V.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(j){replaceStringEasing(j),replaceTransitionType(j),super(j),j.startTime&&(this.startTime=j.startTime),this.options=j}updateMotionValue(j){const{motionValue:U,onUpdate:F,onComplete:B,element:q,...z}=this.options;if(!U)return;if(j!==void 0){U.set(j);return}const G=new JSAnimation({...z,autoplay:!1}),Y=secondsToMilliseconds(this.finishedTime??this.time);U.setWithVelocity(G.sample(Y-sampleDelta).value,G.sample(Y).value,sampleDelta),G.stop()}}const isAnimatable=(V,j)=>j==="zIndex"?!1:!!(typeof V=="number"||Array.isArray(V)||typeof V=="string"&&(complex.test(V)||V==="0")&&!V.startsWith("url("));function hasKeyframesChanged(V){const j=V[0];if(V.length===1)return!0;for(let U=0;U<V.length;U++)if(V[U]!==j)return!0}function canAnimate(V,j,U,F){const B=V[0];if(B===null)return!1;if(j==="display"||j==="visibility")return!0;const q=V[V.length-1],z=isAnimatable(B,j),G=isAnimatable(q,j);return!z||!G?!1:hasKeyframesChanged(V)||(U==="spring"||isGenerator(U))&&F}function makeAnimationInstant(V){V.duration=0,V.type}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(V){const{motionValue:j,name:U,repeatDelay:F,repeatType:B,damping:q,type:z}=V;if(!(j?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:Y,transformTemplate:Q}=j.owner.getProps();return supportsWaapi()&&U&&acceleratedValues.has(U)&&(U!=="transform"||!Q)&&!Y&&!F&&B!=="mirror"&&q!==0&&z!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:j=!0,delay:U=0,type:F="keyframes",repeat:B=0,repeatDelay:q=0,repeatType:z="loop",keyframes:G,name:Y,motionValue:Q,element:W,...Z}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=time.now();const ee={autoplay:j,delay:U,type:F,repeat:B,repeatDelay:q,repeatType:z,name:Y,motionValue:Q,element:W,...Z},ne=W?.KeyframeResolver||KeyframeResolver;this.keyframeResolver=new ne(G,(ae,se,de)=>this.onKeyframesResolved(ae,se,ee,!de),Y,Q,W),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(j,U,F,B){this.keyframeResolver=void 0;const{name:q,type:z,velocity:G,delay:Y,isHandoff:Q,onUpdate:W}=F;this.resolvedAt=time.now(),canAnimate(j,q,z,G)||((MotionGlobalConfig.instantAnimations||!Y)&&W?.(getFinalKeyframe$1(j,F,U)),j[0]=j[j.length-1],makeAnimationInstant(F),F.repeat=0);const ee={startTime:B?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:U,...F,keyframes:j},ne=!Q&&supportsBrowserAnimation(ee)?new NativeAnimationExtended({...ee,element:ee.motionValue.owner.current}):new JSAnimation(ee);ne.finished.then(()=>this.notifyFinished()).catch(noop),this.pendingTimeline&&(this.stopTimeline=ne.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=ne}get finished(){return this._animation?this.animation.finished:this._finished}then(j,U){return this.finished.finally(j).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(j){this.animation.time=j}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(j){this.animation.speed=j}get startTime(){return this.animation.startTime}attachTimeline(j){return this._animation?this.stopTimeline=this.animation.attachTimeline(j):this.pendingTimeline=j,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(V){const j=splitCSSVariableRegex.exec(V);if(!j)return[,];const[,U,F,B]=j;return[`--${U??F}`,B]}function getVariableValue(V,j,U=1){const[F,B]=parseCSSVariable(V);if(!F)return;const q=window.getComputedStyle(j).getPropertyValue(F);if(q){const z=q.trim();return isNumericalString(z)?parseFloat(z):z}return isCSSVariableToken(B)?getVariableValue(B,j,U+1):B}function getValueTransition(V,j){return V?.[j]??V?.default??V}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto={test:V=>V==="auto",parse:V=>V},testValueType=V=>j=>j.test(V),dimensionValueTypes=[number$2,px,percent,degrees,vw,vh,auto],findDimensionValueType=V=>dimensionValueTypes.find(testValueType(V));function isNone(V){return typeof V=="number"?V===0:V!==null?V==="none"||V==="0"||isZeroValueString(V):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(V){const[j,U]=V.slice(0,-1).split("(");if(j==="drop-shadow")return V;const[F]=U.match(floatRegex)||[];if(!F)return V;const B=U.replace(F,"");let q=maxDefaults.has(j)?1:0;return F!==U&&(q*=100),j+"("+q+B+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:V=>{const j=V.match(functionRegex);return j?j.map(applyDefaultFilter).join(" "):V}},int={...number$2,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color:color$1,backgroundColor:color$1,outlineColor:color$1,fill:color$1,stroke:color$1,borderColor:color$1,borderTopColor:color$1,borderRightColor:color$1,borderBottomColor:color$1,borderLeftColor:color$1,filter,WebkitFilter:filter},getDefaultValueType=V=>defaultValueTypes[V];function getAnimatableNone(V,j){let U=getDefaultValueType(V);return U!==filter&&(U=complex),U.getAnimatableNone?U.getAnimatableNone(j):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(V,j,U){let F=0,B;for(;F<V.length&&!B;){const q=V[F];typeof q=="string"&&!invalidTemplates.has(q)&&analyseComplexValue(q).values.length&&(B=V[F]),F++}if(B&&U)for(const q of j)V[q]=getAnimatableNone(U,B)}class DOMKeyframesResolver extends KeyframeResolver{constructor(j,U,F,B,q){super(j,U,F,B,q,!0)}readKeyframes(){const{unresolvedKeyframes:j,element:U,name:F}=this;if(!U||!U.current)return;super.readKeyframes();for(let Y=0;Y<j.length;Y++){let Q=j[Y];if(typeof Q=="string"&&(Q=Q.trim(),isCSSVariableToken(Q))){const W=getVariableValue(Q,U.current);W!==void 0&&(j[Y]=W),Y===j.length-1&&(this.finalKeyframe=Q)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(F)||j.length!==2)return;const[B,q]=j,z=findDimensionValueType(B),G=findDimensionValueType(q);if(z!==G)if(isNumOrPxType(z)&&isNumOrPxType(G))for(let Y=0;Y<j.length;Y++){const Q=j[Y];typeof Q=="string"&&(j[Y]=parseFloat(Q))}else positionalValues[F]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:j,name:U}=this,F=[];for(let B=0;B<j.length;B++)(j[B]===null||isNone(j[B]))&&F.push(B);F.length&&makeNoneKeyframesAnimatable(j,F,U)}measureInitialState(){const{element:j,unresolvedKeyframes:U,name:F}=this;if(!j||!j.current)return;F==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[F](j.measureViewportBox(),window.getComputedStyle(j.current)),U[0]=this.measuredOrigin;const B=U[U.length-1];B!==void 0&&j.getValue(F,B).jump(B,!1)}measureEndState(){const{element:j,name:U,unresolvedKeyframes:F}=this;if(!j||!j.current)return;const B=j.getValue(U);B&&B.jump(this.measuredOrigin,!1);const q=F.length-1,z=F[q];F[q]=positionalValues[U](j.measureViewportBox(),window.getComputedStyle(j.current)),z!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=z),this.removedTransforms?.length&&this.removedTransforms.forEach(([G,Y])=>{j.getValue(G).set(Y)}),this.resolveNoneKeyframes()}}function resolveElements(V,j,U){if(V instanceof EventTarget)return[V];if(typeof V=="string"){let F=document;const B=U?.[V]??F.querySelectorAll(V);return B?Array.from(B):[]}return Array.from(V)}const getValueAsType=(V,j)=>j&&typeof V=="number"?j.transform(V):V;function isHTMLElement(V){return isObject$4(V)&&"offsetHeight"in V}const MAX_VELOCITY_DELTA=30,isFloat=V=>!isNaN(parseFloat(V));class MotionValue{constructor(j,U={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=F=>{const B=time.now();if(this.updatedAt!==B&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(F),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const q of this.dependents)q.dirty()},this.hasAnimated=!1,this.setCurrent(j),this.owner=U.owner}setCurrent(j){this.current=j,this.updatedAt=time.now(),this.canTrackVelocity===null&&j!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(j=this.current){this.prevFrameValue=j,this.prevUpdatedAt=this.updatedAt}onChange(j){return this.on("change",j)}on(j,U){this.events[j]||(this.events[j]=new SubscriptionManager);const F=this.events[j].add(U);return j==="change"?()=>{F(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:F}clearListeners(){for(const j in this.events)this.events[j].clear()}attach(j,U){this.passiveEffect=j,this.stopPassiveEffect=U}set(j){this.passiveEffect?this.passiveEffect(j,this.updateAndNotify):this.updateAndNotify(j)}setWithVelocity(j,U,F){this.set(U),this.prev=void 0,this.prevFrameValue=j,this.prevUpdatedAt=this.updatedAt-F}jump(j,U=!0){this.updateAndNotify(j),this.prev=j,this.prevUpdatedAt=this.prevFrameValue=void 0,U&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(j){this.dependents||(this.dependents=new Set),this.dependents.add(j)}removeDependent(j){this.dependents&&this.dependents.delete(j)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const j=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||j-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const U=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),U)}start(j){return this.stop(),new Promise(U=>{this.hasAnimated=!0,this.animation=j(U),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(V,j){return new MotionValue(V,j)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(V){return V==="x"||V==="y"?isDragging[V]?null:(isDragging[V]=!0,()=>{isDragging[V]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(V,j){const U=resolveElements(V),F=new AbortController,B={passive:!0,...j,signal:F.signal};return[U,B,()=>F.abort()]}function isValidHover(V){return!(V.pointerType==="touch"||isDragActive())}function hover(V,j,U={}){const[F,B,q]=setupGesture(V,U),z=G=>{if(!isValidHover(G))return;const{target:Y}=G,Q=j(Y,G);if(typeof Q!="function"||!Y)return;const W=Z=>{isValidHover(Z)&&(Q(Z),Y.removeEventListener("pointerleave",W))};Y.addEventListener("pointerleave",W,B)};return F.forEach(G=>{G.addEventListener("pointerenter",z,B)}),q}const isNodeOrChild=(V,j)=>j?V===j?!0:isNodeOrChild(V,j.parentElement):!1,isPrimaryPointer=V=>V.pointerType==="mouse"?typeof V.button!="number"||V.button<=0:V.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(V){return focusableElements.has(V.tagName)||V.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(V){return j=>{j.key==="Enter"&&V(j)}}function firePointerEvent(V,j){V.dispatchEvent(new PointerEvent("pointer"+j,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(V,j)=>{const U=V.currentTarget;if(!U)return;const F=filterEvents(()=>{if(isPressing.has(U))return;firePointerEvent(U,"down");const B=filterEvents(()=>{firePointerEvent(U,"up")}),q=()=>firePointerEvent(U,"cancel");U.addEventListener("keyup",B,j),U.addEventListener("blur",q,j)});U.addEventListener("keydown",F,j),U.addEventListener("blur",()=>U.removeEventListener("keydown",F),j)};function isValidPressEvent(V){return isPrimaryPointer(V)&&!isDragActive()}function press(V,j,U={}){const[F,B,q]=setupGesture(V,U),z=G=>{const Y=G.currentTarget;if(!isValidPressEvent(G))return;isPressing.add(Y);const Q=j(Y,G),W=(ne,ae)=>{window.removeEventListener("pointerup",Z),window.removeEventListener("pointercancel",ee),isPressing.has(Y)&&isPressing.delete(Y),isValidPressEvent(ne)&&typeof Q=="function"&&Q(ne,{success:ae})},Z=ne=>{W(ne,Y===window||Y===document||U.useGlobalTarget||isNodeOrChild(Y,ne.target))},ee=ne=>{W(ne,!1)};window.addEventListener("pointerup",Z,B),window.addEventListener("pointercancel",ee,B)};return F.forEach(G=>{(U.useGlobalTarget?window:G).addEventListener("pointerdown",z,B),isHTMLElement(G)&&(G.addEventListener("focus",Q=>enableKeyboardPress(Q,B)),!isElementKeyboardAccessible(G)&&!G.hasAttribute("tabindex")&&(G.tabIndex=0))}),q}function isSVGElement(V){return isObject$4(V)&&"ownerSVGElement"in V}function isSVGSVGElement(V){return isSVGElement(V)&&V.tagName==="svg"}const isMotionValue=V=>!!(V&&V.getVelocity),valueTypes=[...dimensionValueTypes,color$1,complex],findValueType=V=>valueTypes.find(testValueType(V)),MotionConfigContext=reactExports.createContext({transformPagePoint:V=>V,isStatic:!1,reducedMotion:"never"});class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(j){const U=this.props.childRef.current;if(U&&j.isPresent&&!this.props.isPresent){const F=U.offsetParent,B=isHTMLElement(F)&&F.offsetWidth||0,q=this.props.sizeRef.current;q.height=U.offsetHeight||0,q.width=U.offsetWidth||0,q.top=U.offsetTop,q.left=U.offsetLeft,q.right=B-q.width-q.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:V,isPresent:j,anchorX:U,root:F}){const B=reactExports.useId(),q=reactExports.useRef(null),z=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:G}=reactExports.useContext(MotionConfigContext);return reactExports.useInsertionEffect(()=>{const{width:Y,height:Q,top:W,left:Z,right:ee}=z.current;if(j||!q.current||!Y||!Q)return;const ne=U==="left"?`left: ${Z}`:`right: ${ee}`;q.current.dataset.motionPopId=B;const ae=document.createElement("style");G&&(ae.nonce=G);const se=F??document.head;return se.appendChild(ae),ae.sheet&&ae.sheet.insertRule(`
          [data-motion-pop-id="${B}"] {
            position: absolute !important;
            width: ${Y}px !important;
            height: ${Q}px !important;
            ${ne}px !important;
            top: ${W}px !important;
          }
        `),()=>{se.contains(ae)&&se.removeChild(ae)}},[j]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:j,childRef:q,sizeRef:z,children:reactExports.cloneElement(V,{ref:q})})}const PresenceChild=({children:V,initial:j,isPresent:U,onExitComplete:F,custom:B,presenceAffectsLayout:q,mode:z,anchorX:G,root:Y})=>{const Q=useConstant(newChildrenMap),W=reactExports.useId();let Z=!0,ee=reactExports.useMemo(()=>(Z=!1,{id:W,initial:j,isPresent:U,custom:B,onExitComplete:ne=>{Q.set(ne,!0);for(const ae of Q.values())if(!ae)return;F&&F()},register:ne=>(Q.set(ne,!1),()=>Q.delete(ne))}),[U,Q,F]);return q&&Z&&(ee={...ee}),reactExports.useMemo(()=>{Q.forEach((ne,ae)=>Q.set(ae,!1))},[U]),reactExports.useEffect(()=>{!U&&!Q.size&&F&&F()},[U]),z==="popLayout"&&(V=jsxRuntimeExports.jsx(PopChild,{isPresent:U,anchorX:G,root:Y,children:V})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:ee,children:V})};function newChildrenMap(){return new Map}function usePresence(V=!0){const j=reactExports.useContext(PresenceContext);if(j===null)return[!0,null];const{isPresent:U,onExitComplete:F,register:B}=j,q=reactExports.useId();reactExports.useEffect(()=>{if(V)return B(q)},[V]);const z=reactExports.useCallback(()=>V&&F&&F(q),[q,F,V]);return!U&&F?[!1,z]:[!0]}const getChildKey=V=>V.key||"";function onlyElements(V){const j=[];return reactExports.Children.forEach(V,U=>{reactExports.isValidElement(U)&&j.push(U)}),j}const AnimatePresence=({children:V,custom:j,initial:U=!0,onExitComplete:F,presenceAffectsLayout:B=!0,mode:q="sync",propagate:z=!1,anchorX:G="left",root:Y})=>{const[Q,W]=usePresence(z),Z=reactExports.useMemo(()=>onlyElements(V),[V]),ee=z&&!Q?[]:Z.map(getChildKey),ne=reactExports.useRef(!0),ae=reactExports.useRef(Z),se=useConstant(()=>new Map),[de,oe]=reactExports.useState(Z),[ue,he]=reactExports.useState(Z);useIsomorphicLayoutEffect$1(()=>{ne.current=!1,ae.current=Z;for(let pe=0;pe<ue.length;pe++){const xe=getChildKey(ue[pe]);ee.includes(xe)?se.delete(xe):se.get(xe)!==!0&&se.set(xe,!1)}},[ue,ee.length,ee.join("-")]);const ye=[];if(Z!==de){let pe=[...Z];for(let xe=0;xe<ue.length;xe++){const Ee=ue[xe],ke=getChildKey(Ee);ee.includes(ke)||(pe.splice(xe,0,Ee),ye.push(Ee))}return q==="wait"&&ye.length&&(pe=ye),he(onlyElements(pe)),oe(Z),null}const{forceRender:fe}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:ue.map(pe=>{const xe=getChildKey(pe),Ee=z&&!Q?!1:Z===ue||ee.includes(xe),ke=()=>{if(se.has(xe))se.set(xe,!0);else return;let Ae=!0;se.forEach(be=>{be||(Ae=!1)}),Ae&&(fe?.(),he(ae.current),z&&W?.(),F&&F())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:Ee,initial:!ne.current||U?void 0:!1,custom:j,presenceAffectsLayout:B,mode:q,root:Y,onExitComplete:Ee?void 0:ke,anchorX:G,children:pe},xe)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const V in featureProps)featureDefinitions[V]={isEnabled:j=>featureProps[V].some(U=>!!j[U])};function loadFeatures(V){for(const j in V)featureDefinitions[j]={...featureDefinitions[j],...V[j]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(V){return V.startsWith("while")||V.startsWith("drag")&&V!=="draggable"||V.startsWith("layout")||V.startsWith("onTap")||V.startsWith("onPan")||V.startsWith("onLayout")||validMotionProps.has(V)}let shouldForward=V=>!isValidMotionProp(V);function loadExternalIsValidProp(V){typeof V=="function"&&(shouldForward=j=>j.startsWith("on")?!isValidMotionProp(j):V(j))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(V,j,U){const F={};for(const B in V)B==="values"&&typeof V.values=="object"||(shouldForward(B)||U===!0&&isValidMotionProp(B)||!j&&!isValidMotionProp(B)||V.draggable&&B.startsWith("onDrag"))&&(F[B]=V[B]);return F}const MotionContext=reactExports.createContext({});function isAnimationControls(V){return V!==null&&typeof V=="object"&&typeof V.start=="function"}function isVariantLabel(V){return typeof V=="string"||Array.isArray(V)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(V){return isAnimationControls(V.animate)||variantProps.some(j=>isVariantLabel(V[j]))}function isVariantNode(V){return!!(isControllingVariants(V)||V.variants)}function getCurrentTreeVariants(V,j){if(isControllingVariants(V)){const{initial:U,animate:F}=V;return{initial:U===!1||isVariantLabel(U)?U:void 0,animate:isVariantLabel(F)?F:void 0}}return V.inherit!==!1?j:{}}function useCreateMotionContext(V){const{initial:j,animate:U}=getCurrentTreeVariants(V,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:j,animate:U}),[variantLabelsAsDependency(j),variantLabelsAsDependency(U)])}function variantLabelsAsDependency(V){return Array.isArray(V)?V.join(" "):V}const scaleCorrectors={};function addScaleCorrector(V){for(const j in V)scaleCorrectors[j]=V[j],isCSSVariableName(j)&&(scaleCorrectors[j].isCSSVariable=!0)}function isForcedMotionValue(V,{layout:j,layoutId:U}){return transformProps.has(V)||V.startsWith("origin")||(j||U!==void 0)&&(!!scaleCorrectors[V]||V==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(V,j,U){let F="",B=!0;for(let q=0;q<numTransforms;q++){const z=transformPropOrder[q],G=V[z];if(G===void 0)continue;let Y=!0;if(typeof G=="number"?Y=G===(z.startsWith("scale")?1:0):Y=parseFloat(G)===0,!Y||U){const Q=getValueAsType(G,numberValueTypes[z]);if(!Y){B=!1;const W=translateAlias[z]||z;F+=`${W}(${Q}) `}U&&(j[z]=Q)}}return F=F.trim(),U?F=U(j,B?"":F):B&&(F="none"),F}function buildHTMLStyles(V,j,U){const{style:F,vars:B,transformOrigin:q}=V;let z=!1,G=!1;for(const Y in j){const Q=j[Y];if(transformProps.has(Y)){z=!0;continue}else if(isCSSVariableName(Y)){B[Y]=Q;continue}else{const W=getValueAsType(Q,numberValueTypes[Y]);Y.startsWith("origin")?(G=!0,q[Y]=W):F[Y]=W}}if(j.transform||(z||U?F.transform=buildTransform(j,V.transform,U):F.transform&&(F.transform="none")),G){const{originX:Y="50%",originY:Q="50%",originZ:W=0}=q;F.transformOrigin=`${Y} ${Q} ${W}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(V,j,U){for(const F in j)!isMotionValue(j[F])&&!isForcedMotionValue(F,U)&&(V[F]=j[F])}function useInitialMotionValues({transformTemplate:V},j){return reactExports.useMemo(()=>{const U=createHtmlRenderState();return buildHTMLStyles(U,j,V),Object.assign({},U.vars,U.style)},[j])}function useStyle(V,j){const U=V.style||{},F={};return copyRawValuesOnly(F,U,V),Object.assign(F,useInitialMotionValues(V,j)),F}function useHTMLProps(V,j){const U={},F=useStyle(V,j);return V.drag&&V.dragListener!==!1&&(U.draggable=!1,F.userSelect=F.WebkitUserSelect=F.WebkitTouchCallout="none",F.touchAction=V.drag===!0?"none":`pan-${V.drag==="x"?"y":"x"}`),V.tabIndex===void 0&&(V.onTap||V.onTapStart||V.whileTap)&&(U.tabIndex=0),U.style=F,U}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(V,j,U=1,F=0,B=!0){V.pathLength=1;const q=B?dashKeys:camelKeys;V[q.offset]=px.transform(-F);const z=px.transform(j),G=px.transform(U);V[q.array]=`${z} ${G}`}function buildSVGAttrs(V,{attrX:j,attrY:U,attrScale:F,pathLength:B,pathSpacing:q=1,pathOffset:z=0,...G},Y,Q,W){if(buildHTMLStyles(V,G,Q),Y){V.style.viewBox&&(V.attrs.viewBox=V.style.viewBox);return}V.attrs=V.style,V.style={};const{attrs:Z,style:ee}=V;Z.transform&&(ee.transform=Z.transform,delete Z.transform),(ee.transform||Z.transformOrigin)&&(ee.transformOrigin=Z.transformOrigin??"50% 50%",delete Z.transformOrigin),ee.transform&&(ee.transformBox=W?.transformBox??"fill-box",delete Z.transformBox),j!==void 0&&(Z.x=j),U!==void 0&&(Z.y=U),F!==void 0&&(Z.scale=F),B!==void 0&&buildSVGPath(Z,B,q,z,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=V=>typeof V=="string"&&V.toLowerCase()==="svg";function useSVGProps(V,j,U,F){const B=reactExports.useMemo(()=>{const q=createSvgRenderState();return buildSVGAttrs(q,j,isSVGTag(F),V.transformTemplate,V.style),{...q.attrs,style:{...q.style}}},[j]);if(V.style){const q={};copyRawValuesOnly(q,V.style,V),B.style={...q,...B.style}}return B}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(V){return typeof V!="string"||V.includes("-")?!1:!!(lowercaseSVGElements.indexOf(V)>-1||/[A-Z]/u.test(V))}function useRender(V,j,U,{latestValues:F},B,q=!1){const G=(isSVGComponent(V)?useSVGProps:useHTMLProps)(j,F,B,V),Y=filterProps(j,typeof V=="string",q),Q=V!==reactExports.Fragment?{...Y,...G,ref:U}:{},{children:W}=j,Z=reactExports.useMemo(()=>isMotionValue(W)?W.get():W,[W]);return reactExports.createElement(V,{...Q,children:Z})}function getValueState(V){const j=[{},{}];return V?.values.forEach((U,F)=>{j[0][F]=U.get(),j[1][F]=U.getVelocity()}),j}function resolveVariantFromProps(V,j,U,F){if(typeof j=="function"){const[B,q]=getValueState(F);j=j(U!==void 0?U:V.custom,B,q)}if(typeof j=="string"&&(j=V.variants&&V.variants[j]),typeof j=="function"){const[B,q]=getValueState(F);j=j(U!==void 0?U:V.custom,B,q)}return j}function resolveMotionValue(V){return isMotionValue(V)?V.get():V}function makeState({scrapeMotionValuesFromProps:V,createRenderState:j},U,F,B){return{latestValues:makeLatestValues(U,F,B,V),renderState:j()}}function makeLatestValues(V,j,U,F){const B={},q=F(V,{});for(const ee in q)B[ee]=resolveMotionValue(q[ee]);let{initial:z,animate:G}=V;const Y=isControllingVariants(V),Q=isVariantNode(V);j&&Q&&!Y&&V.inherit!==!1&&(z===void 0&&(z=j.initial),G===void 0&&(G=j.animate));let W=U?U.initial===!1:!1;W=W||z===!1;const Z=W?G:z;if(Z&&typeof Z!="boolean"&&!isAnimationControls(Z)){const ee=Array.isArray(Z)?Z:[Z];for(let ne=0;ne<ee.length;ne++){const ae=resolveVariantFromProps(V,ee[ne]);if(ae){const{transitionEnd:se,transition:de,...oe}=ae;for(const ue in oe){let he=oe[ue];if(Array.isArray(he)){const ye=W?he.length-1:0;he=he[ye]}he!==null&&(B[ue]=he)}for(const ue in se)B[ue]=se[ue]}}}return B}const makeUseVisualState=V=>(j,U)=>{const F=reactExports.useContext(MotionContext),B=reactExports.useContext(PresenceContext),q=()=>makeState(V,j,F,B);return U?q():useConstant(q)};function scrapeMotionValuesFromProps$1(V,j,U){const{style:F}=V,B={};for(const q in F)(isMotionValue(F[q])||j.style&&isMotionValue(j.style[q])||isForcedMotionValue(q,V)||U?.getValue(q)?.liveStyle!==void 0)&&(B[q]=F[q]);return B}const useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState});function scrapeMotionValuesFromProps(V,j,U){const F=scrapeMotionValuesFromProps$1(V,j,U);for(const B in V)if(isMotionValue(V[B])||isMotionValue(j[B])){const q=transformPropOrder.indexOf(B)!==-1?"attr"+B.charAt(0).toUpperCase()+B.substring(1):B;F[q]=V[B]}return F}const useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(V){return V&&typeof V=="object"&&Object.prototype.hasOwnProperty.call(V,"current")}function useMotionRef(V,j,U){return reactExports.useCallback(F=>{F&&V.onMount&&V.onMount(F),j&&(F?j.mount(F):j.unmount()),U&&(typeof U=="function"?U(F):isRefObject(U)&&(U.current=F))},[j])}const camelToDash=V=>V.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(V,j,U,F,B){const{visualElement:q}=reactExports.useContext(MotionContext),z=reactExports.useContext(LazyContext),G=reactExports.useContext(PresenceContext),Y=reactExports.useContext(MotionConfigContext).reducedMotion,Q=reactExports.useRef(null);F=F||z.renderer,!Q.current&&F&&(Q.current=F(V,{visualState:j,parent:q,props:U,presenceContext:G,blockInitialAnimation:G?G.initial===!1:!1,reducedMotionConfig:Y}));const W=Q.current,Z=reactExports.useContext(SwitchLayoutGroupContext);W&&!W.projection&&B&&(W.type==="html"||W.type==="svg")&&createProjectionNode$1(Q.current,U,B,Z);const ee=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{W&&ee.current&&W.update(U,G)});const ne=U[optimizedAppearDataAttribute],ae=reactExports.useRef(!!ne&&!window.MotionHandoffIsComplete?.(ne)&&window.MotionHasOptimisedAnimation?.(ne));return useIsomorphicLayoutEffect$1(()=>{W&&(ee.current=!0,window.MotionIsMounted=!0,W.updateFeatures(),W.scheduleRenderMicrotask(),ae.current&&W.animationState&&W.animationState.animateChanges())}),reactExports.useEffect(()=>{W&&(!ae.current&&W.animationState&&W.animationState.animateChanges(),ae.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(ne)}),ae.current=!1),W.enteringChildren=void 0)}),W}function createProjectionNode$1(V,j,U,F){const{layoutId:B,layout:q,drag:z,dragConstraints:G,layoutScroll:Y,layoutRoot:Q,layoutCrossfade:W}=j;V.projection=new U(V.latestValues,j["data-framer-portal-id"]?void 0:getClosestProjectingNode(V.parent)),V.projection.setOptions({layoutId:B,layout:q,alwaysMeasureLayout:!!z||G&&isRefObject(G),visualElement:V,animationType:typeof q=="string"?q:"both",initialPromotionConfig:F,crossfade:W,layoutScroll:Y,layoutRoot:Q})}function getClosestProjectingNode(V){if(V)return V.options.allowProjection!==!1?V.projection:getClosestProjectingNode(V.parent)}function createMotionComponent(V,{forwardMotionProps:j=!1}={},U,F){U&&loadFeatures(U);const B=isSVGComponent(V)?useSVGVisualState:useHTMLVisualState;function q(G,Y){let Q;const W={...reactExports.useContext(MotionConfigContext),...G,layoutId:useLayoutId(G)},{isStatic:Z}=W,ee=useCreateMotionContext(G),ne=B(G,Z);if(!Z&&isBrowser){useStrictMode();const ae=getProjectionFunctionality(W);Q=ae.MeasureLayout,ee.visualElement=useVisualElement(V,ne,W,F,ae.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:ee,children:[Q&&ee.visualElement?jsxRuntimeExports.jsx(Q,{visualElement:ee.visualElement,...W}):null,useRender(V,G,useMotionRef(ne,ee.visualElement,Y),ne,Z,j)]})}q.displayName=`motion.${typeof V=="string"?V:`create(${V.displayName??V.name??""})`}`;const z=reactExports.forwardRef(q);return z[motionComponentSymbol]=V,z}function useLayoutId({layoutId:V}){const j=reactExports.useContext(LayoutGroupContext).id;return j&&V!==void 0?j+"-"+V:V}function useStrictMode(V,j){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(V){const{drag:j,layout:U}=featureDefinitions;if(!j&&!U)return{};const F={...j,...U};return{MeasureLayout:j?.isEnabled(V)||U?.isEnabled(V)?F.MeasureLayout:void 0,ProjectionNode:F.ProjectionNode}}function createMotionProxy(V,j){if(typeof Proxy>"u")return createMotionComponent;const U=new Map,F=(q,z)=>createMotionComponent(q,z,V,j),B=(q,z)=>F(q,z);return new Proxy(B,{get:(q,z)=>z==="create"?F:(U.has(z)||U.set(z,createMotionComponent(z,void 0,V,j)),U.get(z))})}function convertBoundingBoxToBox({top:V,left:j,right:U,bottom:F}){return{x:{min:j,max:U},y:{min:V,max:F}}}function convertBoxToBoundingBox({x:V,y:j}){return{top:j.min,right:V.max,bottom:j.max,left:V.min}}function transformBoxPoints(V,j){if(!j)return V;const U=j({x:V.left,y:V.top}),F=j({x:V.right,y:V.bottom});return{top:U.y,left:U.x,bottom:F.y,right:F.x}}function isIdentityScale(V){return V===void 0||V===1}function hasScale({scale:V,scaleX:j,scaleY:U}){return!isIdentityScale(V)||!isIdentityScale(j)||!isIdentityScale(U)}function hasTransform(V){return hasScale(V)||has2DTranslate(V)||V.z||V.rotate||V.rotateX||V.rotateY||V.skewX||V.skewY}function has2DTranslate(V){return is2DTranslate(V.x)||is2DTranslate(V.y)}function is2DTranslate(V){return V&&V!=="0%"}function scalePoint(V,j,U){const F=V-U,B=j*F;return U+B}function applyPointDelta(V,j,U,F,B){return B!==void 0&&(V=scalePoint(V,B,F)),scalePoint(V,U,F)+j}function applyAxisDelta(V,j=0,U=1,F,B){V.min=applyPointDelta(V.min,j,U,F,B),V.max=applyPointDelta(V.max,j,U,F,B)}function applyBoxDelta(V,{x:j,y:U}){applyAxisDelta(V.x,j.translate,j.scale,j.originPoint),applyAxisDelta(V.y,U.translate,U.scale,U.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(V,j,U,F=!1){const B=U.length;if(!B)return;j.x=j.y=1;let q,z;for(let G=0;G<B;G++){q=U[G],z=q.projectionDelta;const{visualElement:Y}=q.options;Y&&Y.props.style&&Y.props.style.display==="contents"||(F&&q.options.layoutScroll&&q.scroll&&q!==q.root&&transformBox(V,{x:-q.scroll.offset.x,y:-q.scroll.offset.y}),z&&(j.x*=z.x.scale,j.y*=z.y.scale,applyBoxDelta(V,z)),F&&hasTransform(q.latestValues)&&transformBox(V,q.latestValues))}j.x<TREE_SCALE_SNAP_MAX&&j.x>TREE_SCALE_SNAP_MIN&&(j.x=1),j.y<TREE_SCALE_SNAP_MAX&&j.y>TREE_SCALE_SNAP_MIN&&(j.y=1)}function translateAxis(V,j){V.min=V.min+j,V.max=V.max+j}function transformAxis(V,j,U,F,B=.5){const q=mixNumber$1(V.min,V.max,B);applyAxisDelta(V,j,U,q,F)}function transformBox(V,j){transformAxis(V.x,j.x,j.scaleX,j.scale,j.originX),transformAxis(V.y,j.y,j.scaleY,j.scale,j.originY)}function measureViewportBox(V,j){return convertBoundingBoxToBox(transformBoxPoints(V.getBoundingClientRect(),j))}function measurePageBox(V,j,U){const F=measureViewportBox(V,U),{scroll:B}=j;return B&&(translateAxis(F.x,B.offset.x),translateAxis(F.y,B.offset.y)),F}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const V=window.matchMedia("(prefers-reduced-motion)"),j=()=>prefersReducedMotion.current=V.matches;V.addEventListener("change",j),j()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(V,j,U){for(const F in j){const B=j[F],q=U[F];if(isMotionValue(B))V.addValue(F,B);else if(isMotionValue(q))V.addValue(F,motionValue(B,{owner:V}));else if(q!==B)if(V.hasValue(F)){const z=V.getValue(F);z.liveStyle===!0?z.jump(B):z.hasAnimated||z.set(B)}else{const z=V.getStaticValue(F);V.addValue(F,motionValue(z!==void 0?z:B,{owner:V}))}}for(const F in U)j[F]===void 0&&V.removeValue(F);return j}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(j,U,F){return{}}constructor({parent:j,props:U,presenceContext:F,reducedMotionConfig:B,blockInitialAnimation:q,visualState:z},G={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const ee=time.now();this.renderScheduledAt<ee&&(this.renderScheduledAt=ee,frame.render(this.render,!1,!0))};const{latestValues:Y,renderState:Q}=z;this.latestValues=Y,this.baseTarget={...Y},this.initialValues=U.initial?{...Y}:{},this.renderState=Q,this.parent=j,this.props=U,this.presenceContext=F,this.depth=j?j.depth+1:0,this.reducedMotionConfig=B,this.options=G,this.blockInitialAnimation=!!q,this.isControllingVariants=isControllingVariants(U),this.isVariantNode=isVariantNode(U),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(j&&j.current);const{willChange:W,...Z}=this.scrapeMotionValuesFromProps(U,{},this);for(const ee in Z){const ne=Z[ee];Y[ee]!==void 0&&isMotionValue(ne)&&ne.set(Y[ee])}}mount(j){this.current=j,visualElementStore.set(j,this),this.projection&&!this.projection.instance&&this.projection.mount(j),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((U,F)=>this.bindToMotionValue(F,U)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(j=>j()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const j in this.events)this.events[j].clear();for(const j in this.features){const U=this.features[j];U&&(U.unmount(),U.isMounted=!1)}this.current=null}addChild(j){this.children.add(j),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(j)}removeChild(j){this.children.delete(j),this.enteringChildren&&this.enteringChildren.delete(j)}bindToMotionValue(j,U){this.valueSubscriptions.has(j)&&this.valueSubscriptions.get(j)();const F=transformProps.has(j);F&&this.onBindTransform&&this.onBindTransform();const B=U.on("change",z=>{this.latestValues[j]=z,this.props.onUpdate&&frame.preRender(this.notifyUpdate),F&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let q;window.MotionCheckAppearSync&&(q=window.MotionCheckAppearSync(this,j,U)),this.valueSubscriptions.set(j,()=>{B(),q&&q(),U.owner&&U.stop()})}sortNodePosition(j){return!this.current||!this.sortInstanceNodePosition||this.type!==j.type?0:this.sortInstanceNodePosition(this.current,j.current)}updateFeatures(){let j="animation";for(j in featureDefinitions){const U=featureDefinitions[j];if(!U)continue;const{isEnabled:F,Feature:B}=U;if(!this.features[j]&&B&&F(this.props)&&(this.features[j]=new B(this)),this.features[j]){const q=this.features[j];q.isMounted?q.update():(q.mount(),q.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(j){return this.latestValues[j]}setStaticValue(j,U){this.latestValues[j]=U}update(j,U){(j.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=j,this.prevPresenceContext=this.presenceContext,this.presenceContext=U;for(let F=0;F<propEventHandlers.length;F++){const B=propEventHandlers[F];this.propEventSubscriptions[B]&&(this.propEventSubscriptions[B](),delete this.propEventSubscriptions[B]);const q="on"+B,z=j[q];z&&(this.propEventSubscriptions[B]=this.on(B,z))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(j,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(j){return this.props.variants?this.props.variants[j]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(j){const U=this.getClosestVariantNode();if(U)return U.variantChildren&&U.variantChildren.add(j),()=>U.variantChildren.delete(j)}addValue(j,U){const F=this.values.get(j);U!==F&&(F&&this.removeValue(j),this.bindToMotionValue(j,U),this.values.set(j,U),this.latestValues[j]=U.get())}removeValue(j){this.values.delete(j);const U=this.valueSubscriptions.get(j);U&&(U(),this.valueSubscriptions.delete(j)),delete this.latestValues[j],this.removeValueFromRenderState(j,this.renderState)}hasValue(j){return this.values.has(j)}getValue(j,U){if(this.props.values&&this.props.values[j])return this.props.values[j];let F=this.values.get(j);return F===void 0&&U!==void 0&&(F=motionValue(U===null?void 0:U,{owner:this}),this.addValue(j,F)),F}readValue(j,U){let F=this.latestValues[j]!==void 0||!this.current?this.latestValues[j]:this.getBaseTargetFromProps(this.props,j)??this.readValueFromInstance(this.current,j,this.options);return F!=null&&(typeof F=="string"&&(isNumericalString(F)||isZeroValueString(F))?F=parseFloat(F):!findValueType(F)&&complex.test(U)&&(F=getAnimatableNone(j,U)),this.setBaseTarget(j,isMotionValue(F)?F.get():F)),isMotionValue(F)?F.get():F}setBaseTarget(j,U){this.baseTarget[j]=U}getBaseTarget(j){const{initial:U}=this.props;let F;if(typeof U=="string"||typeof U=="object"){const q=resolveVariantFromProps(this.props,U,this.presenceContext?.custom);q&&(F=q[j])}if(U&&F!==void 0)return F;const B=this.getBaseTargetFromProps(this.props,j);return B!==void 0&&!isMotionValue(B)?B:this.initialValues[j]!==void 0&&F===void 0?void 0:this.baseTarget[j]}on(j,U){return this.events[j]||(this.events[j]=new SubscriptionManager),this.events[j].add(U)}notify(j,...U){this.events[j]&&this.events[j].notify(...U)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(j,U){return j.compareDocumentPosition(U)&2?1:-1}getBaseTargetFromProps(j,U){return j.style?j.style[U]:void 0}removeValueFromRenderState(j,{vars:U,style:F}){delete U[j],delete F[j]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:j}=this.props;isMotionValue(j)&&(this.childSubscription=j.on("change",U=>{this.current&&(this.current.textContent=`${U}`)}))}}function renderHTML(V,{style:j,vars:U},F,B){const q=V.style;let z;for(z in j)q[z]=j[z];B?.applyProjectionStyles(q,F);for(z in U)q.setProperty(z,U[z])}function getComputedStyle$1(V){return window.getComputedStyle(V)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(j,U){if(transformProps.has(U))return this.projection?.isProjecting?defaultTransformValue(U):readTransformValue(j,U);{const F=getComputedStyle$1(j),B=(isCSSVariableName(U)?F.getPropertyValue(U):F[U])||0;return typeof B=="string"?B.trim():B}}measureInstanceViewportBox(j,{transformPagePoint:U}){return measureViewportBox(j,U)}build(j,U,F){buildHTMLStyles(j,U,F.transformTemplate)}scrapeMotionValuesFromProps(j,U,F){return scrapeMotionValuesFromProps$1(j,U,F)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(V,j,U,F){renderHTML(V,j,void 0,F);for(const B in j.attrs)V.setAttribute(camelCaseAttributes.has(B)?B:camelToDash(B),j.attrs[B])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(j,U){return j[U]}readValueFromInstance(j,U){if(transformProps.has(U)){const F=getDefaultValueType(U);return F&&F.default||0}return U=camelCaseAttributes.has(U)?U:camelToDash(U),j.getAttribute(U)}scrapeMotionValuesFromProps(j,U,F){return scrapeMotionValuesFromProps(j,U,F)}build(j,U,F){buildSVGAttrs(j,U,this.isSVGTag,F.transformTemplate,F.style)}renderInstance(j,U,F,B){renderSVG(j,U,F,B)}mount(j){this.isSVGTag=isSVGTag(j.tagName),super.mount(j)}}const createDomVisualElement=(V,j)=>isSVGComponent(V)?new SVGVisualElement(j):new HTMLVisualElement(j,{allowProjection:V!==reactExports.Fragment});function resolveVariant(V,j,U){const F=V.getProps();return resolveVariantFromProps(F,j,U!==void 0?U:F.custom,V)}const isKeyframesTarget=V=>Array.isArray(V);function setMotionValue(V,j,U){V.hasValue(j)?V.getValue(j).set(U):V.addValue(j,motionValue(U))}function resolveFinalValueInKeyframes(V){return isKeyframesTarget(V)?V[V.length-1]||0:V}function setTarget(V,j){const U=resolveVariant(V,j);let{transitionEnd:F={},transition:B={},...q}=U||{};q={...q,...F};for(const z in q){const G=resolveFinalValueInKeyframes(q[z]);setMotionValue(V,z,G)}}function isWillChangeMotionValue(V){return!!(isMotionValue(V)&&V.add)}function addValueToWillChange(V,j){const U=V.getValue("willChange");if(isWillChangeMotionValue(U))return U.add(j);if(!U&&MotionGlobalConfig.WillChange){const F=new MotionGlobalConfig.WillChange("auto");V.addValue("willChange",F),F.add(j)}}function getOptimisedAppearId(V){return V.props[optimizedAppearDataAttribute]}const isNotNull=V=>V!==null;function getFinalKeyframe(V,{repeat:j,repeatType:U="loop"},F){const B=V.filter(isNotNull),q=j&&U!=="loop"&&j%2===1?0:B.length-1;return B[q]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=V=>({type:"spring",stiffness:550,damping:V===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(V,{keyframes:j})=>j.length>2?keyframesTransition:transformProps.has(V)?V.startsWith("scale")?criticallyDampedSpring(j[1]):underDampedSpring:ease;function isTransitionDefined({when:V,delay:j,delayChildren:U,staggerChildren:F,staggerDirection:B,repeat:q,repeatType:z,repeatDelay:G,from:Y,elapsed:Q,...W}){return!!Object.keys(W).length}const animateMotionValue=(V,j,U,F={},B,q)=>z=>{const G=getValueTransition(F,V)||{},Y=G.delay||F.delay||0;let{elapsed:Q=0}=F;Q=Q-secondsToMilliseconds(Y);const W={keyframes:Array.isArray(U)?U:[null,U],ease:"easeOut",velocity:j.getVelocity(),...G,delay:-Q,onUpdate:ee=>{j.set(ee),G.onUpdate&&G.onUpdate(ee)},onComplete:()=>{z(),G.onComplete&&G.onComplete()},name:V,motionValue:j,element:q?void 0:B};isTransitionDefined(G)||Object.assign(W,getDefaultTransition(V,W)),W.duration&&(W.duration=secondsToMilliseconds(W.duration)),W.repeatDelay&&(W.repeatDelay=secondsToMilliseconds(W.repeatDelay)),W.from!==void 0&&(W.keyframes[0]=W.from);let Z=!1;if((W.type===!1||W.duration===0&&!W.repeatDelay)&&(makeAnimationInstant(W),W.delay===0&&(Z=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(Z=!0,makeAnimationInstant(W),W.delay=0),W.allowFlatten=!G.type&&!G.ease,Z&&!q&&j.get()!==void 0){const ee=getFinalKeyframe(W.keyframes,G);if(ee!==void 0){frame.update(()=>{W.onUpdate(ee),W.onComplete()});return}}return G.isSync?new JSAnimation(W):new AsyncMotionValueAnimation(W)};function shouldBlockAnimation({protectedKeys:V,needsAnimating:j},U){const F=V.hasOwnProperty(U)&&j[U]!==!0;return j[U]=!1,F}function animateTarget(V,j,{delay:U=0,transitionOverride:F,type:B}={}){let{transition:q=V.getDefaultTransition(),transitionEnd:z,...G}=j;F&&(q=F);const Y=[],Q=B&&V.animationState&&V.animationState.getState()[B];for(const W in G){const Z=V.getValue(W,V.latestValues[W]??null),ee=G[W];if(ee===void 0||Q&&shouldBlockAnimation(Q,W))continue;const ne={delay:U,...getValueTransition(q||{},W)},ae=Z.get();if(ae!==void 0&&!Z.isAnimating&&!Array.isArray(ee)&&ee===ae&&!ne.velocity)continue;let se=!1;if(window.MotionHandoffAnimation){const oe=getOptimisedAppearId(V);if(oe){const ue=window.MotionHandoffAnimation(oe,W,frame);ue!==null&&(ne.startTime=ue,se=!0)}}addValueToWillChange(V,W),Z.start(animateMotionValue(W,Z,ee,V.shouldReduceMotion&&positionalKeys.has(W)?{type:!1}:ne,V,se));const de=Z.animation;de&&Y.push(de)}return z&&Promise.all(Y).then(()=>{frame.update(()=>{z&&setTarget(V,z)})}),Y}function calcChildStagger(V,j,U,F=0,B=1){const q=Array.from(V).sort((Q,W)=>Q.sortNodePosition(W)).indexOf(j),z=V.size,G=(z-1)*F;return typeof U=="function"?U(q,z):B===1?q*F:G-q*F}function animateVariant(V,j,U={}){const F=resolveVariant(V,j,U.type==="exit"?V.presenceContext?.custom:void 0);let{transition:B=V.getDefaultTransition()||{}}=F||{};U.transitionOverride&&(B=U.transitionOverride);const q=F?()=>Promise.all(animateTarget(V,F,U)):()=>Promise.resolve(),z=V.variantChildren&&V.variantChildren.size?(Y=0)=>{const{delayChildren:Q=0,staggerChildren:W,staggerDirection:Z}=B;return animateChildren(V,j,Y,Q,W,Z,U)}:()=>Promise.resolve(),{when:G}=B;if(G){const[Y,Q]=G==="beforeChildren"?[q,z]:[z,q];return Y().then(()=>Q())}else return Promise.all([q(),z(U.delay)])}function animateChildren(V,j,U=0,F=0,B=0,q=1,z){const G=[];for(const Y of V.variantChildren)Y.notify("AnimationStart",j),G.push(animateVariant(Y,j,{...z,delay:U+(typeof F=="function"?0:F)+calcChildStagger(V.variantChildren,Y,F,B,q)}).then(()=>Y.notify("AnimationComplete",j)));return Promise.all(G)}function animateVisualElement(V,j,U={}){V.notify("AnimationStart",j);let F;if(Array.isArray(j)){const B=j.map(q=>animateVariant(V,q,U));F=Promise.all(B)}else if(typeof j=="string")F=animateVariant(V,j,U);else{const B=typeof j=="function"?resolveVariant(V,j,U.custom):j;F=Promise.all(animateTarget(V,B,U))}return F.then(()=>{V.notify("AnimationComplete",j)})}function shallowCompare(V,j){if(!Array.isArray(j))return!1;const U=j.length;if(U!==V.length)return!1;for(let F=0;F<U;F++)if(j[F]!==V[F])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(V){if(!V)return;if(!V.isControllingVariants){const U=V.parent?getVariantContext(V.parent)||{}:{};return V.props.initial!==void 0&&(U.initial=V.props.initial),U}const j={};for(let U=0;U<numVariantProps;U++){const F=variantProps[U],B=V.props[F];(isVariantLabel(B)||B===!1)&&(j[F]=B)}return j}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(V){return j=>Promise.all(j.map(({animation:U,options:F})=>animateVisualElement(V,U,F)))}function createAnimationState(V){let j=animateList(V),U=createState$1(),F=!0;const B=Y=>(Q,W)=>{const Z=resolveVariant(V,W,Y==="exit"?V.presenceContext?.custom:void 0);if(Z){const{transition:ee,transitionEnd:ne,...ae}=Z;Q={...Q,...ae,...ne}}return Q};function q(Y){j=Y(V)}function z(Y){const{props:Q}=V,W=getVariantContext(V.parent)||{},Z=[],ee=new Set;let ne={},ae=1/0;for(let de=0;de<numAnimationTypes;de++){const oe=reversePriorityOrder[de],ue=U[oe],he=Q[oe]!==void 0?Q[oe]:W[oe],ye=isVariantLabel(he),fe=oe===Y?ue.isActive:null;fe===!1&&(ae=de);let pe=he===W[oe]&&he!==Q[oe]&&ye;if(pe&&F&&V.manuallyAnimateOnMount&&(pe=!1),ue.protectedKeys={...ne},!ue.isActive&&fe===null||!he&&!ue.prevProp||isAnimationControls(he)||typeof he=="boolean")continue;const xe=checkVariantsDidChange(ue.prevProp,he);let Ee=xe||oe===Y&&ue.isActive&&!pe&&ye||de>ae&&ye,ke=!1;const Ae=Array.isArray(he)?he:[he];let be=Ae.reduce(B(oe),{});fe===!1&&(be={});const{prevResolvedValues:Le={}}=ue,Fe={...Le,...be},Ne=Oe=>{Ee=!0,ee.has(Oe)&&(ke=!0,ee.delete(Oe)),ue.needsAnimating[Oe]=!0;const Ue=V.getValue(Oe);Ue&&(Ue.liveStyle=!1)};for(const Oe in Fe){const Ue=be[Oe],Ye=Le[Oe];if(ne.hasOwnProperty(Oe))continue;let le=!1;isKeyframesTarget(Ue)&&isKeyframesTarget(Ye)?le=!shallowCompare(Ue,Ye):le=Ue!==Ye,le?Ue!=null?Ne(Oe):ee.add(Oe):Ue!==void 0&&ee.has(Oe)?Ne(Oe):ue.protectedKeys[Oe]=!0}ue.prevProp=he,ue.prevResolvedValues=be,ue.isActive&&(ne={...ne,...be}),F&&V.blockInitialAnimation&&(Ee=!1);const Ve=pe&&xe;Ee&&(!Ve||ke)&&Z.push(...Ae.map(Oe=>{const Ue={type:oe};if(typeof Oe=="string"&&F&&!Ve&&V.manuallyAnimateOnMount&&V.parent){const{parent:Ye}=V,le=resolveVariant(Ye,Oe);if(Ye.enteringChildren&&le){const{delayChildren:we}=le.transition||{};Ue.delay=calcChildStagger(Ye.enteringChildren,V,we)}}return{animation:Oe,options:Ue}}))}if(ee.size){const de={};if(typeof Q.initial!="boolean"){const oe=resolveVariant(V,Array.isArray(Q.initial)?Q.initial[0]:Q.initial);oe&&oe.transition&&(de.transition=oe.transition)}ee.forEach(oe=>{const ue=V.getBaseTarget(oe),he=V.getValue(oe);he&&(he.liveStyle=!0),de[oe]=ue??null}),Z.push({animation:de})}let se=!!Z.length;return F&&(Q.initial===!1||Q.initial===Q.animate)&&!V.manuallyAnimateOnMount&&(se=!1),F=!1,se?j(Z):Promise.resolve()}function G(Y,Q){if(U[Y].isActive===Q)return Promise.resolve();V.variantChildren?.forEach(Z=>Z.animationState?.setActive(Y,Q)),U[Y].isActive=Q;const W=z(Y);for(const Z in U)U[Z].protectedKeys={};return W}return{animateChanges:z,setActive:G,setAnimateFunction:q,getState:()=>U,reset:()=>{U=createState$1(),F=!0}}}function checkVariantsDidChange(V,j){return typeof j=="string"?j!==V:Array.isArray(j)?!shallowCompare(j,V):!1}function createTypeState(V=!1){return{isActive:V,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState$1(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(j){this.isMounted=!1,this.node=j}update(){}}class AnimationFeature extends Feature{constructor(j){super(j),j.animationState||(j.animationState=createAnimationState(j))}updateAnimationControlsSubscription(){const{animate:j}=this.node.getProps();isAnimationControls(j)&&(this.unmountControls=j.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:j}=this.node.getProps(),{animate:U}=this.node.prevProps||{};j!==U&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:j,onExitComplete:U}=this.node.presenceContext,{isPresent:F}=this.node.prevPresenceContext||{};if(!this.node.animationState||j===F)return;const B=this.node.animationState.setActive("exit",!j);U&&!j&&B.then(()=>{U(this.id)})}mount(){const{register:j,onExitComplete:U}=this.node.presenceContext||{};U&&U(this.id),j&&(this.unmount=j(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(V,j,U,F={passive:!0}){return V.addEventListener(j,U,F),()=>V.removeEventListener(j,U)}function extractEventInfo(V){return{point:{x:V.pageX,y:V.pageY}}}const addPointerInfo=V=>j=>isPrimaryPointer(j)&&V(j,extractEventInfo(j));function addPointerEvent(V,j,U,F){return addDomEvent(V,j,addPointerInfo(U),F)}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(V){return V.max-V.min}function isNear(V,j,U){return Math.abs(V-j)<=U}function calcAxisDelta(V,j,U,F=.5){V.origin=F,V.originPoint=mixNumber$1(j.min,j.max,V.origin),V.scale=calcLength(U)/calcLength(j),V.translate=mixNumber$1(U.min,U.max,V.origin)-V.originPoint,(V.scale>=SCALE_MIN&&V.scale<=SCALE_MAX||isNaN(V.scale))&&(V.scale=1),(V.translate>=TRANSLATE_MIN&&V.translate<=TRANSLATE_MAX||isNaN(V.translate))&&(V.translate=0)}function calcBoxDelta(V,j,U,F){calcAxisDelta(V.x,j.x,U.x,F?F.originX:void 0),calcAxisDelta(V.y,j.y,U.y,F?F.originY:void 0)}function calcRelativeAxis(V,j,U){V.min=U.min+j.min,V.max=V.min+calcLength(j)}function calcRelativeBox(V,j,U){calcRelativeAxis(V.x,j.x,U.x),calcRelativeAxis(V.y,j.y,U.y)}function calcRelativeAxisPosition(V,j,U){V.min=j.min-U.min,V.max=V.min+calcLength(j)}function calcRelativePosition(V,j,U){calcRelativeAxisPosition(V.x,j.x,U.x),calcRelativeAxisPosition(V.y,j.y,U.y)}function eachAxis(V){return[V("x"),V("y")]}const getContextWindow=({current:V})=>V?V.ownerDocument.defaultView:null,distance=(V,j)=>Math.abs(V-j);function distance2D(V,j){const U=distance(V.x,j.x),F=distance(V.y,j.y);return Math.sqrt(U**2+F**2)}class PanSession{constructor(j,U,{transformPagePoint:F,contextWindow:B=window,dragSnapToOrigin:q=!1,distanceThreshold:z=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ee=getPanInfo(this.lastMoveEventInfo,this.history),ne=this.startEvent!==null,ae=distance2D(ee.offset,{x:0,y:0})>=this.distanceThreshold;if(!ne&&!ae)return;const{point:se}=ee,{timestamp:de}=frameData;this.history.push({...se,timestamp:de});const{onStart:oe,onMove:ue}=this.handlers;ne||(oe&&oe(this.lastMoveEvent,ee),this.startEvent=this.lastMoveEvent),ue&&ue(this.lastMoveEvent,ee)},this.handlePointerMove=(ee,ne)=>{this.lastMoveEvent=ee,this.lastMoveEventInfo=transformPoint(ne,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(ee,ne)=>{this.end();const{onEnd:ae,onSessionEnd:se,resumeAnimation:de}=this.handlers;if(this.dragSnapToOrigin&&de&&de(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const oe=getPanInfo(ee.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(ne,this.transformPagePoint),this.history);this.startEvent&&ae&&ae(ee,oe),se&&se(ee,oe)},!isPrimaryPointer(j))return;this.dragSnapToOrigin=q,this.handlers=U,this.transformPagePoint=F,this.distanceThreshold=z,this.contextWindow=B||window;const G=extractEventInfo(j),Y=transformPoint(G,this.transformPagePoint),{point:Q}=Y,{timestamp:W}=frameData;this.history=[{...Q,timestamp:W}];const{onSessionStart:Z}=U;Z&&Z(j,getPanInfo(Y,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(j){this.handlers=j}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(V,j){return j?{point:j(V.point)}:V}function subtractPoint(V,j){return{x:V.x-j.x,y:V.y-j.y}}function getPanInfo({point:V},j){return{point:V,delta:subtractPoint(V,lastDevicePoint(j)),offset:subtractPoint(V,startDevicePoint(j)),velocity:getVelocity(j,.1)}}function startDevicePoint(V){return V[0]}function lastDevicePoint(V){return V[V.length-1]}function getVelocity(V,j){if(V.length<2)return{x:0,y:0};let U=V.length-1,F=null;const B=lastDevicePoint(V);for(;U>=0&&(F=V[U],!(B.timestamp-F.timestamp>secondsToMilliseconds(j)));)U--;if(!F)return{x:0,y:0};const q=millisecondsToSeconds(B.timestamp-F.timestamp);if(q===0)return{x:0,y:0};const z={x:(B.x-F.x)/q,y:(B.y-F.y)/q};return z.x===1/0&&(z.x=0),z.y===1/0&&(z.y=0),z}function applyConstraints(V,{min:j,max:U},F){return j!==void 0&&V<j?V=F?mixNumber$1(j,V,F.min):Math.max(V,j):U!==void 0&&V>U&&(V=F?mixNumber$1(U,V,F.max):Math.min(V,U)),V}function calcRelativeAxisConstraints(V,j,U){return{min:j!==void 0?V.min+j:void 0,max:U!==void 0?V.max+U-(V.max-V.min):void 0}}function calcRelativeConstraints(V,{top:j,left:U,bottom:F,right:B}){return{x:calcRelativeAxisConstraints(V.x,U,B),y:calcRelativeAxisConstraints(V.y,j,F)}}function calcViewportAxisConstraints(V,j){let U=j.min-V.min,F=j.max-V.max;return j.max-j.min<V.max-V.min&&([U,F]=[F,U]),{min:U,max:F}}function calcViewportConstraints(V,j){return{x:calcViewportAxisConstraints(V.x,j.x),y:calcViewportAxisConstraints(V.y,j.y)}}function calcOrigin(V,j){let U=.5;const F=calcLength(V),B=calcLength(j);return B>F?U=progress(j.min,j.max-F,V.min):F>B&&(U=progress(V.min,V.max-B,j.min)),clamp(0,1,U)}function rebaseAxisConstraints(V,j){const U={};return j.min!==void 0&&(U.min=j.min-V.min),j.max!==void 0&&(U.max=j.max-V.min),U}const defaultElastic=.35;function resolveDragElastic(V=defaultElastic){return V===!1?V=0:V===!0&&(V=defaultElastic),{x:resolveAxisElastic(V,"left","right"),y:resolveAxisElastic(V,"top","bottom")}}function resolveAxisElastic(V,j,U){return{min:resolvePointElastic(V,j),max:resolvePointElastic(V,U)}}function resolvePointElastic(V,j){return typeof V=="number"?V:V[j]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(j){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=j}start(j,{snapToCursor:U=!1,distanceThreshold:F}={}){const{presenceContext:B}=this.visualElement;if(B&&B.isPresent===!1)return;const q=Z=>{const{dragSnapToOrigin:ee}=this.getProps();ee?this.pauseAnimation():this.stopAnimation(),U&&this.snapToCursor(extractEventInfo(Z).point)},z=(Z,ee)=>{const{drag:ne,dragPropagation:ae,onDragStart:se}=this.getProps();if(ne&&!ae&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(ne),!this.openDragLock))return;this.latestPointerEvent=Z,this.latestPanInfo=ee,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(oe=>{let ue=this.getAxisMotionValue(oe).get()||0;if(percent.test(ue)){const{projection:he}=this.visualElement;if(he&&he.layout){const ye=he.layout.layoutBox[oe];ye&&(ue=calcLength(ye)*(parseFloat(ue)/100))}}this.originPoint[oe]=ue}),se&&frame.postRender(()=>se(Z,ee)),addValueToWillChange(this.visualElement,"transform");const{animationState:de}=this.visualElement;de&&de.setActive("whileDrag",!0)},G=(Z,ee)=>{this.latestPointerEvent=Z,this.latestPanInfo=ee;const{dragPropagation:ne,dragDirectionLock:ae,onDirectionLock:se,onDrag:de}=this.getProps();if(!ne&&!this.openDragLock)return;const{offset:oe}=ee;if(ae&&this.currentDirection===null){this.currentDirection=getCurrentDirection(oe),this.currentDirection!==null&&se&&se(this.currentDirection);return}this.updateAxis("x",ee.point,oe),this.updateAxis("y",ee.point,oe),this.visualElement.render(),de&&de(Z,ee)},Y=(Z,ee)=>{this.latestPointerEvent=Z,this.latestPanInfo=ee,this.stop(Z,ee),this.latestPointerEvent=null,this.latestPanInfo=null},Q=()=>eachAxis(Z=>this.getAnimationState(Z)==="paused"&&this.getAxisMotionValue(Z).animation?.play()),{dragSnapToOrigin:W}=this.getProps();this.panSession=new PanSession(j,{onSessionStart:q,onStart:z,onMove:G,onSessionEnd:Y,resumeAnimation:Q},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:W,distanceThreshold:F,contextWindow:getContextWindow(this.visualElement)})}stop(j,U){const F=j||this.latestPointerEvent,B=U||this.latestPanInfo,q=this.isDragging;if(this.cancel(),!q||!B||!F)return;const{velocity:z}=B;this.startAnimation(z);const{onDragEnd:G}=this.getProps();G&&frame.postRender(()=>G(F,B))}cancel(){this.isDragging=!1;const{projection:j,animationState:U}=this.visualElement;j&&(j.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:F}=this.getProps();!F&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),U&&U.setActive("whileDrag",!1)}updateAxis(j,U,F){const{drag:B}=this.getProps();if(!F||!shouldDrag(j,B,this.currentDirection))return;const q=this.getAxisMotionValue(j);let z=this.originPoint[j]+F[j];this.constraints&&this.constraints[j]&&(z=applyConstraints(z,this.constraints[j],this.elastic[j])),q.set(z)}resolveConstraints(){const{dragConstraints:j,dragElastic:U}=this.getProps(),F=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,B=this.constraints;j&&isRefObject(j)?this.constraints||(this.constraints=this.resolveRefConstraints()):j&&F?this.constraints=calcRelativeConstraints(F.layoutBox,j):this.constraints=!1,this.elastic=resolveDragElastic(U),B!==this.constraints&&F&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(q=>{this.constraints!==!1&&this.getAxisMotionValue(q)&&(this.constraints[q]=rebaseAxisConstraints(F.layoutBox[q],this.constraints[q]))})}resolveRefConstraints(){const{dragConstraints:j,onMeasureDragConstraints:U}=this.getProps();if(!j||!isRefObject(j))return!1;const F=j.current,{projection:B}=this.visualElement;if(!B||!B.layout)return!1;const q=measurePageBox(F,B.root,this.visualElement.getTransformPagePoint());let z=calcViewportConstraints(B.layout.layoutBox,q);if(U){const G=U(convertBoxToBoundingBox(z));this.hasMutatedConstraints=!!G,G&&(z=convertBoundingBoxToBox(G))}return z}startAnimation(j){const{drag:U,dragMomentum:F,dragElastic:B,dragTransition:q,dragSnapToOrigin:z,onDragTransitionEnd:G}=this.getProps(),Y=this.constraints||{},Q=eachAxis(W=>{if(!shouldDrag(W,U,this.currentDirection))return;let Z=Y&&Y[W]||{};z&&(Z={min:0,max:0});const ee=B?200:1e6,ne=B?40:1e7,ae={type:"inertia",velocity:F?j[W]:0,bounceStiffness:ee,bounceDamping:ne,timeConstant:750,restDelta:1,restSpeed:10,...q,...Z};return this.startAxisValueAnimation(W,ae)});return Promise.all(Q).then(G)}startAxisValueAnimation(j,U){const F=this.getAxisMotionValue(j);return addValueToWillChange(this.visualElement,j),F.start(animateMotionValue(j,F,0,U,this.visualElement,!1))}stopAnimation(){eachAxis(j=>this.getAxisMotionValue(j).stop())}pauseAnimation(){eachAxis(j=>this.getAxisMotionValue(j).animation?.pause())}getAnimationState(j){return this.getAxisMotionValue(j).animation?.state}getAxisMotionValue(j){const U=`_drag${j.toUpperCase()}`,F=this.visualElement.getProps(),B=F[U];return B||this.visualElement.getValue(j,(F.initial?F.initial[j]:void 0)||0)}snapToCursor(j){eachAxis(U=>{const{drag:F}=this.getProps();if(!shouldDrag(U,F,this.currentDirection))return;const{projection:B}=this.visualElement,q=this.getAxisMotionValue(U);if(B&&B.layout){const{min:z,max:G}=B.layout.layoutBox[U];q.set(j[U]-mixNumber$1(z,G,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:j,dragConstraints:U}=this.getProps(),{projection:F}=this.visualElement;if(!isRefObject(U)||!F||!this.constraints)return;this.stopAnimation();const B={x:0,y:0};eachAxis(z=>{const G=this.getAxisMotionValue(z);if(G&&this.constraints!==!1){const Y=G.get();B[z]=calcOrigin({min:Y,max:Y},this.constraints[z])}});const{transformTemplate:q}=this.visualElement.getProps();this.visualElement.current.style.transform=q?q({},""):"none",F.root&&F.root.updateScroll(),F.updateLayout(),this.resolveConstraints(),eachAxis(z=>{if(!shouldDrag(z,j,null))return;const G=this.getAxisMotionValue(z),{min:Y,max:Q}=this.constraints[z];G.set(mixNumber$1(Y,Q,B[z]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const j=this.visualElement.current,U=addPointerEvent(j,"pointerdown",Y=>{const{drag:Q,dragListener:W=!0}=this.getProps();Q&&W&&this.start(Y)}),F=()=>{const{dragConstraints:Y}=this.getProps();isRefObject(Y)&&Y.current&&(this.constraints=this.resolveRefConstraints())},{projection:B}=this.visualElement,q=B.addEventListener("measure",F);B&&!B.layout&&(B.root&&B.root.updateScroll(),B.updateLayout()),frame.read(F);const z=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),G=B.addEventListener("didUpdate",(({delta:Y,hasLayoutChanged:Q})=>{this.isDragging&&Q&&(eachAxis(W=>{const Z=this.getAxisMotionValue(W);Z&&(this.originPoint[W]+=Y[W].translate,Z.set(Z.get()+Y[W].translate))}),this.visualElement.render())}));return()=>{z(),U(),q(),G&&G()}}getProps(){const j=this.visualElement.getProps(),{drag:U=!1,dragDirectionLock:F=!1,dragPropagation:B=!1,dragConstraints:q=!1,dragElastic:z=defaultElastic,dragMomentum:G=!0}=j;return{...j,drag:U,dragDirectionLock:F,dragPropagation:B,dragConstraints:q,dragElastic:z,dragMomentum:G}}}function shouldDrag(V,j,U){return(j===!0||j===V)&&(U===null||U===V)}function getCurrentDirection(V,j=10){let U=null;return Math.abs(V.y)>j?U="y":Math.abs(V.x)>j&&(U="x"),U}class DragGesture extends Feature{constructor(j){super(j),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(j)}mount(){const{dragControls:j}=this.node.getProps();j&&(this.removeGroupControls=j.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=V=>(j,U)=>{V&&frame.postRender(()=>V(j,U))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(j){this.session=new PanSession(j,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:j,onPanStart:U,onPan:F,onPanEnd:B}=this.node.getProps();return{onSessionStart:asyncHandler(j),onStart:asyncHandler(U),onMove:F,onEnd:(q,z)=>{delete this.session,B&&frame.postRender(()=>B(q,z))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",j=>this.onPointerDown(j))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(V,j){return j.max===j.min?0:V/(j.max-j.min)*100}const correctBorderRadius={correct:(V,j)=>{if(!j.target)return V;if(typeof V=="string")if(px.test(V))V=parseFloat(V);else return V;const U=pixelsToPercent(V,j.target.x),F=pixelsToPercent(V,j.target.y);return`${U}% ${F}%`}},correctBoxShadow={correct:(V,{treeScale:j,projectionDelta:U})=>{const F=V,B=complex.parse(V);if(B.length>5)return F;const q=complex.createTransformer(V),z=typeof B[0]!="number"?1:0,G=U.x.scale*j.x,Y=U.y.scale*j.y;B[0+z]/=G,B[1+z]/=Y;const Q=mixNumber$1(G,Y,.5);return typeof B[2+z]=="number"&&(B[2+z]/=Q),typeof B[3+z]=="number"&&(B[3+z]/=Q),q(B)}};let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:j,layoutGroup:U,switchLayoutGroup:F,layoutId:B}=this.props,{projection:q}=j;addScaleCorrector(defaultScaleCorrectors),q&&(U.group&&U.group.add(q),F&&F.register&&B&&F.register(q),hasTakenAnySnapshot&&q.root.didUpdate(),q.addEventListener("animationComplete",()=>{this.safeToRemove()}),q.setOptions({...q.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(j){const{layoutDependency:U,visualElement:F,drag:B,isPresent:q}=this.props,{projection:z}=F;return z&&(z.isPresent=q,hasTakenAnySnapshot=!0,B||j.layoutDependency!==U||U===void 0||j.isPresent!==q?z.willUpdate():this.safeToRemove(),j.isPresent!==q&&(q?z.promote():z.relegate()||frame.postRender(()=>{const G=z.getStack();(!G||!G.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:j}=this.props.visualElement;j&&(j.root.didUpdate(),microtask.postRender(()=>{!j.currentAnimation&&j.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:j,layoutGroup:U,switchLayoutGroup:F}=this.props,{projection:B}=j;hasTakenAnySnapshot=!0,B&&(B.scheduleCheckAfterUnmount(),U&&U.group&&U.group.remove(B),F&&F.deregister&&F.deregister(B))}safeToRemove(){const{safeToRemove:j}=this.props;j&&j()}render(){return null}}function MeasureLayout(V){const[j,U]=usePresence(),F=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...V,layoutGroup:F,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:j,safeToRemove:U})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(V,j,U){const F=isMotionValue(V)?V:motionValue(V);return F.start(animateMotionValue("",F,j,U)),F.animation}const compareByDepth=(V,j)=>V.depth-j.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(j){addUniqueItem(this.children,j),this.isDirty=!0}remove(j){removeItem(this.children,j),this.isDirty=!0}forEach(j){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(j)}}function delay(V,j){const U=time.now(),F=({timestamp:B})=>{const q=B-U;q>=j&&(cancelFrame(F),V(q-j))};return frame.setup(F,!0),()=>cancelFrame(F)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=V=>typeof V=="string"?parseFloat(V):V,isPx=V=>typeof V=="number"||px.test(V);function mixValues(V,j,U,F,B,q){B?(V.opacity=mixNumber$1(0,U.opacity??1,easeCrossfadeIn(F)),V.opacityExit=mixNumber$1(j.opacity??1,0,easeCrossfadeOut(F))):q&&(V.opacity=mixNumber$1(j.opacity??1,U.opacity??1,F));for(let z=0;z<numBorders;z++){const G=`border${borders[z]}Radius`;let Y=getRadius(j,G),Q=getRadius(U,G);if(Y===void 0&&Q===void 0)continue;Y||(Y=0),Q||(Q=0),Y===0||Q===0||isPx(Y)===isPx(Q)?(V[G]=Math.max(mixNumber$1(asNumber(Y),asNumber(Q),F),0),(percent.test(Q)||percent.test(Y))&&(V[G]+="%")):V[G]=Q}(j.rotate||U.rotate)&&(V.rotate=mixNumber$1(j.rotate||0,U.rotate||0,F))}function getRadius(V,j){return V[j]!==void 0?V[j]:V.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(V,j,U){return F=>F<V?0:F>j?1:U(progress(V,j,F))}function copyAxisInto(V,j){V.min=j.min,V.max=j.max}function copyBoxInto(V,j){copyAxisInto(V.x,j.x),copyAxisInto(V.y,j.y)}function copyAxisDeltaInto(V,j){V.translate=j.translate,V.scale=j.scale,V.originPoint=j.originPoint,V.origin=j.origin}function removePointDelta(V,j,U,F,B){return V-=j,V=scalePoint(V,1/U,F),B!==void 0&&(V=scalePoint(V,1/B,F)),V}function removeAxisDelta(V,j=0,U=1,F=.5,B,q=V,z=V){if(percent.test(j)&&(j=parseFloat(j),j=mixNumber$1(z.min,z.max,j/100)-z.min),typeof j!="number")return;let G=mixNumber$1(q.min,q.max,F);V===q&&(G-=j),V.min=removePointDelta(V.min,j,U,G,B),V.max=removePointDelta(V.max,j,U,G,B)}function removeAxisTransforms(V,j,[U,F,B],q,z){removeAxisDelta(V,j[U],j[F],j[B],j.scale,q,z)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(V,j,U,F){removeAxisTransforms(V.x,j,xKeys,U?U.x:void 0,F?F.x:void 0),removeAxisTransforms(V.y,j,yKeys,U?U.y:void 0,F?F.y:void 0)}function isAxisDeltaZero(V){return V.translate===0&&V.scale===1}function isDeltaZero(V){return isAxisDeltaZero(V.x)&&isAxisDeltaZero(V.y)}function axisEquals(V,j){return V.min===j.min&&V.max===j.max}function boxEquals(V,j){return axisEquals(V.x,j.x)&&axisEquals(V.y,j.y)}function axisEqualsRounded(V,j){return Math.round(V.min)===Math.round(j.min)&&Math.round(V.max)===Math.round(j.max)}function boxEqualsRounded(V,j){return axisEqualsRounded(V.x,j.x)&&axisEqualsRounded(V.y,j.y)}function aspectRatio(V){return calcLength(V.x)/calcLength(V.y)}function axisDeltaEquals(V,j){return V.translate===j.translate&&V.scale===j.scale&&V.originPoint===j.originPoint}class NodeStack{constructor(){this.members=[]}add(j){addUniqueItem(this.members,j),j.scheduleRender()}remove(j){if(removeItem(this.members,j),j===this.prevLead&&(this.prevLead=void 0),j===this.lead){const U=this.members[this.members.length-1];U&&this.promote(U)}}relegate(j){const U=this.members.findIndex(B=>j===B);if(U===0)return!1;let F;for(let B=U;B>=0;B--){const q=this.members[B];if(q.isPresent!==!1){F=q;break}}return F?(this.promote(F),!0):!1}promote(j,U){const F=this.lead;if(j!==F&&(this.prevLead=F,this.lead=j,j.show(),F)){F.instance&&F.scheduleRender(),j.scheduleRender(),j.resumeFrom=F,U&&(j.resumeFrom.preserveOpacity=!0),F.snapshot&&(j.snapshot=F.snapshot,j.snapshot.latestValues=F.animationValues||F.latestValues),j.root&&j.root.isUpdating&&(j.isLayoutDirty=!0);const{crossfade:B}=j.options;B===!1&&F.hide()}}exitAnimationComplete(){this.members.forEach(j=>{const{options:U,resumingFrom:F}=j;U.onExitComplete&&U.onExitComplete(),F&&F.options.onExitComplete&&F.options.onExitComplete()})}scheduleRender(){this.members.forEach(j=>{j.instance&&j.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(V,j,U){let F="";const B=V.x.translate/j.x,q=V.y.translate/j.y,z=U?.z||0;if((B||q||z)&&(F=`translate3d(${B}px, ${q}px, ${z}px) `),(j.x!==1||j.y!==1)&&(F+=`scale(${1/j.x}, ${1/j.y}) `),U){const{transformPerspective:Q,rotate:W,rotateX:Z,rotateY:ee,skewX:ne,skewY:ae}=U;Q&&(F=`perspective(${Q}px) ${F}`),W&&(F+=`rotate(${W}deg) `),Z&&(F+=`rotateX(${Z}deg) `),ee&&(F+=`rotateY(${ee}deg) `),ne&&(F+=`skewX(${ne}deg) `),ae&&(F+=`skewY(${ae}deg) `)}const G=V.x.scale*j.x,Y=V.y.scale*j.y;return(G!==1||Y!==1)&&(F+=`scale(${G}, ${Y})`),F||"none"}const transformAxes=["","X","Y","Z"],animationTarget=1e3;let id=0;function resetDistortingTransform(V,j,U,F){const{latestValues:B}=j;B[V]&&(U[V]=B[V],j.setStaticValue(V,0),F&&(F[V]=0))}function cancelTreeOptimisedTransformAnimations(V){if(V.hasCheckedOptimisedAppear=!0,V.root===V)return;const{visualElement:j}=V.options;if(!j)return;const U=getOptimisedAppearId(j);if(window.MotionHasOptimisedAnimation(U,"transform")){const{layout:B,layoutId:q}=V.options;window.MotionCancelOptimisedAnimation(U,"transform",frame,!(B||q))}const{parent:F}=V;F&&!F.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(F)}function createProjectionNode({attachResizeListener:V,defaultParent:j,measureScroll:U,checkIsScrollRoot:F,resetTransform:B}){return class{constructor(z={},G=j?.()){this.id=id++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=z,this.root=G?G.root||G:this,this.path=G?[...G.path,G]:[],this.parent=G,this.depth=G?G.depth+1:0;for(let Y=0;Y<this.path.length;Y++)this.path[Y].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(z,G){return this.eventHandlers.has(z)||this.eventHandlers.set(z,new SubscriptionManager),this.eventHandlers.get(z).add(G)}notifyListeners(z,...G){const Y=this.eventHandlers.get(z);Y&&Y.notify(...G)}hasListeners(z){return this.eventHandlers.has(z)}mount(z){if(this.instance)return;this.isSVG=isSVGElement(z)&&!isSVGSVGElement(z),this.instance=z;const{layoutId:G,layout:Y,visualElement:Q}=this.options;if(Q&&!Q.current&&Q.mount(z),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(Y||G)&&(this.isLayoutDirty=!0),V){let W,Z=0;const ee=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{Z=window.innerWidth}),V(z,()=>{const ne=window.innerWidth;ne!==Z&&(Z=ne,this.root.updateBlockedByResize=!0,W&&W(),W=delay(ee,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}G&&this.root.registerSharedNode(G,this),this.options.animate!==!1&&Q&&(G||Y)&&this.addEventListener("didUpdate",({delta:W,hasLayoutChanged:Z,hasRelativeLayoutChanged:ee,layout:ne})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const ae=this.options.transition||Q.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:se,onLayoutAnimationComplete:de}=Q.getProps(),oe=!this.targetLayout||!boxEqualsRounded(this.targetLayout,ne),ue=!Z&&ee;if(this.options.layoutRoot||this.resumeFrom||ue||Z&&(oe||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const he={...getValueTransition(ae,"layout"),onPlay:se,onComplete:de};(Q.shouldReduceMotion||this.options.layoutRoot)&&(he.delay=0,he.type=!1),this.startAnimation(he),this.setAnimationOrigin(W,ue)}else Z||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=ne})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const z=this.getStack();z&&z.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:z}=this.options;return z&&z.getProps().transformTemplate}willUpdate(z=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let W=0;W<this.path.length;W++){const Z=this.path[W];Z.shouldResetTransform=!0,Z.updateScroll("snapshot"),Z.options.layoutRoot&&Z.willUpdate(!1)}const{layoutId:G,layout:Y}=this.options;if(G===void 0&&!Y)return;const Q=this.getTransformTemplate();this.prevTransformTemplateValue=Q?Q(this.latestValues,""):void 0,this.updateSnapshot(),z&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const G=time.now();frameData.delta=clamp(0,1e3/60,G-frameData.timestamp),frameData.timestamp=G,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let Y=0;Y<this.path.length;Y++)this.path[Y].updateScroll();const z=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:G}=this.options;G&&G.notify("LayoutMeasure",this.layout.layoutBox,z?z.layoutBox:void 0)}updateScroll(z="measure"){let G=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===z&&(G=!1),G&&this.instance){const Y=F(this.instance);this.scroll={animationId:this.root.animationId,phase:z,isRoot:Y,offset:U(this.instance),wasRoot:this.scroll?this.scroll.isRoot:Y}}}resetTransform(){if(!B)return;const z=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,G=this.projectionDelta&&!isDeltaZero(this.projectionDelta),Y=this.getTransformTemplate(),Q=Y?Y(this.latestValues,""):void 0,W=Q!==this.prevTransformTemplateValue;z&&this.instance&&(G||hasTransform(this.latestValues)||W)&&(B(this.instance,Q),this.shouldResetTransform=!1,this.scheduleRender())}measure(z=!0){const G=this.measurePageBox();let Y=this.removeElementScroll(G);return z&&(Y=this.removeTransform(Y)),roundBox(Y),{animationId:this.root.animationId,measuredBox:G,layoutBox:Y,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:z}=this.options;if(!z)return createBox();const G=z.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(checkNodeWasScrollRoot))){const{scroll:Q}=this.root;Q&&(translateAxis(G.x,Q.offset.x),translateAxis(G.y,Q.offset.y))}return G}removeElementScroll(z){const G=createBox();if(copyBoxInto(G,z),this.scroll?.wasRoot)return G;for(let Y=0;Y<this.path.length;Y++){const Q=this.path[Y],{scroll:W,options:Z}=Q;Q!==this.root&&W&&Z.layoutScroll&&(W.wasRoot&&copyBoxInto(G,z),translateAxis(G.x,W.offset.x),translateAxis(G.y,W.offset.y))}return G}applyTransform(z,G=!1){const Y=createBox();copyBoxInto(Y,z);for(let Q=0;Q<this.path.length;Q++){const W=this.path[Q];!G&&W.options.layoutScroll&&W.scroll&&W!==W.root&&transformBox(Y,{x:-W.scroll.offset.x,y:-W.scroll.offset.y}),hasTransform(W.latestValues)&&transformBox(Y,W.latestValues)}return hasTransform(this.latestValues)&&transformBox(Y,this.latestValues),Y}removeTransform(z){const G=createBox();copyBoxInto(G,z);for(let Y=0;Y<this.path.length;Y++){const Q=this.path[Y];if(!Q.instance||!hasTransform(Q.latestValues))continue;hasScale(Q.latestValues)&&Q.updateSnapshot();const W=createBox(),Z=Q.measurePageBox();copyBoxInto(W,Z),removeBoxTransforms(G,Q.latestValues,Q.snapshot?Q.snapshot.layoutBox:void 0,W)}return hasTransform(this.latestValues)&&removeBoxTransforms(G,this.latestValues),G}setTargetDelta(z){this.targetDelta=z,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(z){this.options={...this.options,...z,crossfade:z.crossfade!==void 0?z.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(z=!1){const G=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=G.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=G.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=G.isSharedProjectionDirty);const Y=!!this.resumingFrom||this!==G;if(!(z||Y&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:W,layoutId:Z}=this.options;if(!(!this.layout||!(W||Z))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const ee=this.getClosestProjectingParent();ee&&ee.layout&&this.animationProgress!==1?(this.relativeParent=ee,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,ee.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const ee=this.getClosestProjectingParent();ee&&!!ee.resumingFrom==!!this.resumingFrom&&!ee.options.layoutScroll&&ee.target&&this.animationProgress!==1?(this.relativeParent=ee,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,ee.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const z=this.getLead(),G=!!this.resumingFrom||this!==z;let Y=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(Y=!1),G&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(Y=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(Y=!1),Y)return;const{layout:Q,layoutId:W}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(Q||W))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const Z=this.treeScale.x,ee=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,G),z.layout&&!z.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(z.target=z.layout.layoutBox,z.targetWithTransforms=createBox());const{target:ne}=z;if(!ne){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,ne,this.latestValues),(this.treeScale.x!==Z||this.treeScale.y!==ee||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",ne))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(z=!0){if(this.options.visualElement?.scheduleRender(),z){const G=this.getStack();G&&G.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(z,G=!1){const Y=this.snapshot,Q=Y?Y.latestValues:{},W={...this.latestValues},Z=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!G;const ee=createBox(),ne=Y?Y.source:void 0,ae=this.layout?this.layout.source:void 0,se=ne!==ae,de=this.getStack(),oe=!de||de.members.length<=1,ue=!!(se&&!oe&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let he;this.mixTargetDelta=ye=>{const fe=ye/1e3;mixAxisDelta(Z.x,z.x,fe),mixAxisDelta(Z.y,z.y,fe),this.setTargetDelta(Z),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(ee,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,ee,fe),he&&boxEquals(this.relativeTarget,he)&&(this.isProjectionDirty=!1),he||(he=createBox()),copyBoxInto(he,this.relativeTarget)),se&&(this.animationValues=W,mixValues(W,Q,this.latestValues,fe,ue,oe)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=fe},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(z){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...z,velocity:0,isSync:!0,onUpdate:G=>{this.mixTargetDelta(G),z.onUpdate&&z.onUpdate(G)},onStop:()=>{},onComplete:()=>{z.onComplete&&z.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const z=this.getStack();z&&z.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const z=this.getLead();let{targetWithTransforms:G,target:Y,layout:Q,latestValues:W}=z;if(!(!G||!Y||!Q)){if(this!==z&&this.layout&&Q&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,Q.layoutBox)){Y=this.target||createBox();const Z=calcLength(this.layout.layoutBox.x);Y.x.min=z.target.x.min,Y.x.max=Y.x.min+Z;const ee=calcLength(this.layout.layoutBox.y);Y.y.min=z.target.y.min,Y.y.max=Y.y.min+ee}copyBoxInto(G,Y),transformBox(G,W),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,G,W)}}registerSharedNode(z,G){this.sharedNodes.has(z)||this.sharedNodes.set(z,new NodeStack),this.sharedNodes.get(z).add(G);const Q=G.options.initialPromotionConfig;G.promote({transition:Q?Q.transition:void 0,preserveFollowOpacity:Q&&Q.shouldPreserveFollowOpacity?Q.shouldPreserveFollowOpacity(G):void 0})}isLead(){const z=this.getStack();return z?z.lead===this:!0}getLead(){const{layoutId:z}=this.options;return z?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:z}=this.options;return z?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:z}=this.options;if(z)return this.root.sharedNodes.get(z)}promote({needsReset:z,transition:G,preserveFollowOpacity:Y}={}){const Q=this.getStack();Q&&Q.promote(this,Y),z&&(this.projectionDelta=void 0,this.needsReset=!0),G&&this.setOptions({transition:G})}relegate(){const z=this.getStack();return z?z.relegate(this):!1}resetSkewAndRotation(){const{visualElement:z}=this.options;if(!z)return;let G=!1;const{latestValues:Y}=z;if((Y.z||Y.rotate||Y.rotateX||Y.rotateY||Y.rotateZ||Y.skewX||Y.skewY)&&(G=!0),!G)return;const Q={};Y.z&&resetDistortingTransform("z",z,Q,this.animationValues);for(let W=0;W<transformAxes.length;W++)resetDistortingTransform(`rotate${transformAxes[W]}`,z,Q,this.animationValues),resetDistortingTransform(`skew${transformAxes[W]}`,z,Q,this.animationValues);z.render();for(const W in Q)z.setStaticValue(W,Q[W]),this.animationValues&&(this.animationValues[W]=Q[W]);z.scheduleRender()}applyProjectionStyles(z,G){if(!this.instance||this.isSVG)return;if(!this.isVisible){z.visibility="hidden";return}const Y=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,z.visibility="",z.opacity="",z.pointerEvents=resolveMotionValue(G?.pointerEvents)||"",z.transform=Y?Y(this.latestValues,""):"none";return}const Q=this.getLead();if(!this.projectionDelta||!this.layout||!Q.target){this.options.layoutId&&(z.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,z.pointerEvents=resolveMotionValue(G?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(z.transform=Y?Y({},""):"none",this.hasProjected=!1);return}z.visibility="";const W=Q.animationValues||Q.latestValues;this.applyTransformsToTarget();let Z=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,W);Y&&(Z=Y(W,Z)),z.transform=Z;const{x:ee,y:ne}=this.projectionDelta;z.transformOrigin=`${ee.origin*100}% ${ne.origin*100}% 0`,Q.animationValues?z.opacity=Q===this?W.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:W.opacityExit:z.opacity=Q===this?W.opacity!==void 0?W.opacity:"":W.opacityExit!==void 0?W.opacityExit:0;for(const ae in scaleCorrectors){if(W[ae]===void 0)continue;const{correct:se,applyTo:de,isCSSVariable:oe}=scaleCorrectors[ae],ue=Z==="none"?W[ae]:se(W[ae],Q);if(de){const he=de.length;for(let ye=0;ye<he;ye++)z[de[ye]]=ue}else oe?this.options.visualElement.renderState.vars[ae]=ue:z[ae]=ue}this.options.layoutId&&(z.pointerEvents=Q===this?resolveMotionValue(G?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(z=>z.currentAnimation?.stop()),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(V){V.updateLayout()}function notifyLayoutUpdate(V){const j=V.resumeFrom?.snapshot||V.snapshot;if(V.isLead()&&V.layout&&j&&V.hasListeners("didUpdate")){const{layoutBox:U,measuredBox:F}=V.layout,{animationType:B}=V.options,q=j.source!==V.layout.source;B==="size"?eachAxis(W=>{const Z=q?j.measuredBox[W]:j.layoutBox[W],ee=calcLength(Z);Z.min=U[W].min,Z.max=Z.min+ee}):shouldAnimatePositionOnly(B,j.layoutBox,U)&&eachAxis(W=>{const Z=q?j.measuredBox[W]:j.layoutBox[W],ee=calcLength(U[W]);Z.max=Z.min+ee,V.relativeTarget&&!V.currentAnimation&&(V.isProjectionDirty=!0,V.relativeTarget[W].max=V.relativeTarget[W].min+ee)});const z=createDelta();calcBoxDelta(z,U,j.layoutBox);const G=createDelta();q?calcBoxDelta(G,V.applyTransform(F,!0),j.measuredBox):calcBoxDelta(G,U,j.layoutBox);const Y=!isDeltaZero(z);let Q=!1;if(!V.resumeFrom){const W=V.getClosestProjectingParent();if(W&&!W.resumeFrom){const{snapshot:Z,layout:ee}=W;if(Z&&ee){const ne=createBox();calcRelativePosition(ne,j.layoutBox,Z.layoutBox);const ae=createBox();calcRelativePosition(ae,U,ee.layoutBox),boxEqualsRounded(ne,ae)||(Q=!0),W.options.layoutRoot&&(V.relativeTarget=ae,V.relativeTargetOrigin=ne,V.relativeParent=W)}}}V.notifyListeners("didUpdate",{layout:U,snapshot:j,delta:G,layoutDelta:z,hasLayoutChanged:Y,hasRelativeLayoutChanged:Q})}else if(V.isLead()){const{onExitComplete:U}=V.options;U&&U()}V.options.transition=void 0}function propagateDirtyNodes(V){V.parent&&(V.isProjecting()||(V.isProjectionDirty=V.parent.isProjectionDirty),V.isSharedProjectionDirty||(V.isSharedProjectionDirty=!!(V.isProjectionDirty||V.parent.isProjectionDirty||V.parent.isSharedProjectionDirty)),V.isTransformDirty||(V.isTransformDirty=V.parent.isTransformDirty))}function cleanDirtyNodes(V){V.isProjectionDirty=V.isSharedProjectionDirty=V.isTransformDirty=!1}function clearSnapshot(V){V.clearSnapshot()}function clearMeasurements(V){V.clearMeasurements()}function clearIsLayoutDirty(V){V.isLayoutDirty=!1}function resetTransformStyle(V){const{visualElement:j}=V.options;j&&j.getProps().onBeforeLayoutMeasure&&j.notify("BeforeLayoutMeasure"),V.resetTransform()}function finishAnimation(V){V.finishAnimation(),V.targetDelta=V.relativeTarget=V.target=void 0,V.isProjectionDirty=!0}function resolveTargetDelta(V){V.resolveTargetDelta()}function calcProjection(V){V.calcProjection()}function resetSkewAndRotation(V){V.resetSkewAndRotation()}function removeLeadSnapshots(V){V.removeLeadSnapshot()}function mixAxisDelta(V,j,U){V.translate=mixNumber$1(j.translate,0,U),V.scale=mixNumber$1(j.scale,1,U),V.origin=j.origin,V.originPoint=j.originPoint}function mixAxis(V,j,U,F){V.min=mixNumber$1(j.min,U.min,F),V.max=mixNumber$1(j.max,U.max,F)}function mixBox(V,j,U,F){mixAxis(V.x,j.x,U.x,F),mixAxis(V.y,j.y,U.y,F)}function hasOpacityCrossfade(V){return V.animationValues&&V.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=V=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(V),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(V){V.min=roundPoint(V.min),V.max=roundPoint(V.max)}function roundBox(V){roundAxis(V.x),roundAxis(V.y)}function shouldAnimatePositionOnly(V,j,U){return V==="position"||V==="preserve-aspect"&&!isNear(aspectRatio(j),aspectRatio(U),.2)}function checkNodeWasScrollRoot(V){return V!==V.root&&V.scroll?.wasRoot}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(V,j)=>addDomEvent(V,"resize",j),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:V=>({x:V.scrollLeft,y:V.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const V=new DocumentProjectionNode({});V.mount(window),V.setOptions({layoutScroll:!0}),rootProjectionNode.current=V}return rootProjectionNode.current},resetTransform:(V,j)=>{V.style.transform=j!==void 0?j:"none"},checkIsScrollRoot:V=>window.getComputedStyle(V).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(V,j,U){const{props:F}=V;V.animationState&&F.whileHover&&V.animationState.setActive("whileHover",U==="Start");const B="onHover"+U,q=F[B];q&&frame.postRender(()=>q(j,extractEventInfo(j)))}class HoverGesture extends Feature{mount(){const{current:j}=this.node;j&&(this.unmount=hover(j,(U,F)=>(handleHoverEvent(this.node,F,"Start"),B=>handleHoverEvent(this.node,B,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let j=!1;try{j=this.node.current.matches(":focus-visible")}catch{j=!0}!j||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(V,j,U){const{props:F}=V;if(V.current instanceof HTMLButtonElement&&V.current.disabled)return;V.animationState&&F.whileTap&&V.animationState.setActive("whileTap",U==="Start");const B="onTap"+(U==="End"?"":U),q=F[B];q&&frame.postRender(()=>q(j,extractEventInfo(j)))}class PressGesture extends Feature{mount(){const{current:j}=this.node;j&&(this.unmount=press(j,(U,F)=>(handlePressEvent(this.node,F,"Start"),(B,{success:q})=>handlePressEvent(this.node,B,q?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=V=>{const j=observerCallbacks.get(V.target);j&&j(V)},fireAllObserverCallbacks=V=>{V.forEach(fireObserverCallback)};function initIntersectionObserver({root:V,...j}){const U=V||document;observers.has(U)||observers.set(U,{});const F=observers.get(U),B=JSON.stringify(j);return F[B]||(F[B]=new IntersectionObserver(fireAllObserverCallbacks,{root:V,...j})),F[B]}function observeIntersection(V,j,U){const F=initIntersectionObserver(j);return observerCallbacks.set(V,U),F.observe(V),()=>{observerCallbacks.delete(V),F.unobserve(V)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:j={}}=this.node.getProps(),{root:U,margin:F,amount:B="some",once:q}=j,z={root:U?U.current:void 0,rootMargin:F,threshold:typeof B=="number"?B:thresholdNames[B]},G=Y=>{const{isIntersecting:Q}=Y;if(this.isInView===Q||(this.isInView=Q,q&&!Q&&this.hasEnteredView))return;Q&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",Q);const{onViewportEnter:W,onViewportLeave:Z}=this.node.getProps(),ee=Q?W:Z;ee&&ee(Y)};return observeIntersection(this.node.current,z,G)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:j,prevProps:U}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(j,U))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:V={}},{viewport:j={}}={}){return U=>V[U]!==j[U]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement);var define_process_env_default={};function _mergeNamespaces$1(V,j){return j.forEach(function(U){U&&typeof U!="string"&&!Array.isArray(U)&&Object.keys(U).forEach(function(F){if(F!=="default"&&!(F in V)){var B=Object.getOwnPropertyDescriptor(U,F);Object.defineProperty(V,F,B.get?B:{enumerable:!0,get:function(){return U[F]}})}})}),Object.freeze(V)}var e$1=Object.defineProperty,h$1=(V,j,U)=>j in V?e$1(V,j,{enumerable:!0,configurable:!0,writable:!0,value:U}):V[j]=U,o$1=(V,j,U)=>h$1(V,typeof j!="symbol"?j+"":j,U);let _$1=class{constructor(){o$1(this,"_locking"),o$1(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let j;const U=new Promise(B=>j=()=>{this._locks-=1,B()}),F=this._locking.then(()=>j);return this._locking=this._locking.then(()=>U),F}};function assert(V,j){if(!V)throw new Error(j)}const FLOAT32_MAX=34028234663852886e22,FLOAT32_MIN=-34028234663852886e22,UINT32_MAX=4294967295,INT32_MAX=2147483647,INT32_MIN=-2147483648;function assertInt32(V){if(typeof V!="number")throw new Error("invalid int 32: "+typeof V);if(!Number.isInteger(V)||V>INT32_MAX||V<INT32_MIN)throw new Error("invalid int 32: "+V)}function assertUInt32(V){if(typeof V!="number")throw new Error("invalid uint 32: "+typeof V);if(!Number.isInteger(V)||V>UINT32_MAX||V<0)throw new Error("invalid uint 32: "+V)}function assertFloat32(V){if(typeof V!="number")throw new Error("invalid float 32: "+typeof V);if(Number.isFinite(V)&&(V>FLOAT32_MAX||V<FLOAT32_MIN))throw new Error("invalid float 32: "+V)}const enumTypeSymbol=Symbol("@bufbuild/protobuf/enum-type");function getEnumType(V){const j=V[enumTypeSymbol];return assert(j,"missing enum type on enum object"),j}function setEnumType(V,j,U,F){V[enumTypeSymbol]=makeEnumType(j,U.map(B=>({no:B.no,name:B.name,localName:V[B.no]})))}function makeEnumType(V,j,U){const F=Object.create(null),B=Object.create(null),q=[];for(const z of j){const G=normalizeEnumValue(z);q.push(G),F[z.name]=G,B[z.no]=G}return{typeName:V,values:q,findName(z){return F[z]},findNumber(z){return B[z]}}}function makeEnum(V,j,U){const F={};for(const B of j){const q=normalizeEnumValue(B);F[q.localName]=q.no,F[q.no]=q.localName}return setEnumType(F,V,j),F}function normalizeEnumValue(V){return"localName"in V?V:Object.assign(Object.assign({},V),{localName:V.name})}class Message{equals(j){return this.getType().runtime.util.equals(this.getType(),this,j)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(j,U){const F=this.getType(),B=F.runtime.bin,q=B.makeReadOptions(U);return B.readMessage(this,q.readerFactory(j),j.byteLength,q),this}fromJson(j,U){const F=this.getType(),B=F.runtime.json,q=B.makeReadOptions(U);return B.readMessage(F,j,q,this),this}fromJsonString(j,U){let F;try{F=JSON.parse(j)}catch(B){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(B instanceof Error?B.message:String(B)))}return this.fromJson(F,U)}toBinary(j){const U=this.getType(),F=U.runtime.bin,B=F.makeWriteOptions(j),q=B.writerFactory();return F.writeMessage(this,q,B),q.finish()}toJson(j){const U=this.getType(),F=U.runtime.json,B=F.makeWriteOptions(j);return F.writeMessage(this,B)}toJsonString(j){var U;const F=this.toJson(j);return JSON.stringify(F,null,(U=j?.prettySpaces)!==null&&U!==void 0?U:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function makeMessageType(V,j,U,F){var B;const q=(B=F?.localName)!==null&&B!==void 0?B:j.substring(j.lastIndexOf(".")+1),z={[q]:function(G){V.util.initFields(this),V.util.initPartial(G,this)}}[q];return Object.setPrototypeOf(z.prototype,new Message),Object.assign(z,{runtime:V,typeName:j,fields:V.util.newFieldList(U),fromBinary(G,Y){return new z().fromBinary(G,Y)},fromJson(G,Y){return new z().fromJson(G,Y)},fromJsonString(G,Y){return new z().fromJsonString(G,Y)},equals(G,Y){return V.util.equals(z,G,Y)}}),z}function varint64read(){let V=0,j=0;for(let F=0;F<28;F+=7){let B=this.buf[this.pos++];if(V|=(B&127)<<F,(B&128)==0)return this.assertBounds(),[V,j]}let U=this.buf[this.pos++];if(V|=(U&15)<<28,j=(U&112)>>4,(U&128)==0)return this.assertBounds(),[V,j];for(let F=3;F<=31;F+=7){let B=this.buf[this.pos++];if(j|=(B&127)<<F,(B&128)==0)return this.assertBounds(),[V,j]}throw new Error("invalid varint")}function varint64write(V,j,U){for(let q=0;q<28;q=q+7){const z=V>>>q,G=!(!(z>>>7)&&j==0),Y=(G?z|128:z)&255;if(U.push(Y),!G)return}const F=V>>>28&15|(j&7)<<4,B=j>>3!=0;if(U.push((B?F|128:F)&255),!!B){for(let q=3;q<31;q=q+7){const z=j>>>q,G=!!(z>>>7),Y=(G?z|128:z)&255;if(U.push(Y),!G)return}U.push(j>>>31&1)}}const TWO_PWR_32_DBL=4294967296;function int64FromString(V){const j=V[0]==="-";j&&(V=V.slice(1));const U=1e6;let F=0,B=0;function q(z,G){const Y=Number(V.slice(z,G));B*=U,F=F*U+Y,F>=TWO_PWR_32_DBL&&(B=B+(F/TWO_PWR_32_DBL|0),F=F%TWO_PWR_32_DBL)}return q(-24,-18),q(-18,-12),q(-12,-6),q(-6),j?negate(F,B):newBits(F,B)}function int64ToString(V,j){let U=newBits(V,j);const F=U.hi&2147483648;F&&(U=negate(U.lo,U.hi));const B=uInt64ToString(U.lo,U.hi);return F?"-"+B:B}function uInt64ToString(V,j){if({lo:V,hi:j}=toUnsigned(V,j),j<=2097151)return String(TWO_PWR_32_DBL*j+V);const U=V&16777215,F=(V>>>24|j<<8)&16777215,B=j>>16&65535;let q=U+F*6777216+B*6710656,z=F+B*8147497,G=B*2;const Y=1e7;return q>=Y&&(z+=Math.floor(q/Y),q%=Y),z>=Y&&(G+=Math.floor(z/Y),z%=Y),G.toString()+decimalFrom1e7WithLeadingZeros(z)+decimalFrom1e7WithLeadingZeros(q)}function toUnsigned(V,j){return{lo:V>>>0,hi:j>>>0}}function newBits(V,j){return{lo:V|0,hi:j|0}}function negate(V,j){return j=~j,V?V=~V+1:j+=1,newBits(V,j)}const decimalFrom1e7WithLeadingZeros=V=>{const j=String(V);return"0000000".slice(j.length)+j};function varint32write(V,j){if(V>=0){for(;V>127;)j.push(V&127|128),V=V>>>7;j.push(V)}else{for(let U=0;U<9;U++)j.push(V&127|128),V=V>>7;j.push(1)}}function varint32read(){let V=this.buf[this.pos++],j=V&127;if((V&128)==0)return this.assertBounds(),j;if(V=this.buf[this.pos++],j|=(V&127)<<7,(V&128)==0)return this.assertBounds(),j;if(V=this.buf[this.pos++],j|=(V&127)<<14,(V&128)==0)return this.assertBounds(),j;if(V=this.buf[this.pos++],j|=(V&127)<<21,(V&128)==0)return this.assertBounds(),j;V=this.buf[this.pos++],j|=(V&15)<<28;for(let U=5;(V&128)!==0&&U<10;U++)V=this.buf[this.pos++];if((V&128)!=0)throw new Error("invalid varint");return this.assertBounds(),j>>>0}function makeInt64Support(){const V=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof V.getBigInt64=="function"&&typeof V.getBigUint64=="function"&&typeof V.setBigInt64=="function"&&typeof V.setBigUint64=="function"&&(typeof process!="object"||typeof define_process_env_default!="object"||define_process_env_default.BUF_BIGINT_DISABLE!=="1")){const B=BigInt("-9223372036854775808"),q=BigInt("9223372036854775807"),z=BigInt("0"),G=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(Y){const Q=typeof Y=="bigint"?Y:BigInt(Y);if(Q>q||Q<B)throw new Error("int64 invalid: ".concat(Y));return Q},uParse(Y){const Q=typeof Y=="bigint"?Y:BigInt(Y);if(Q>G||Q<z)throw new Error("uint64 invalid: ".concat(Y));return Q},enc(Y){return V.setBigInt64(0,this.parse(Y),!0),{lo:V.getInt32(0,!0),hi:V.getInt32(4,!0)}},uEnc(Y){return V.setBigInt64(0,this.uParse(Y),!0),{lo:V.getInt32(0,!0),hi:V.getInt32(4,!0)}},dec(Y,Q){return V.setInt32(0,Y,!0),V.setInt32(4,Q,!0),V.getBigInt64(0,!0)},uDec(Y,Q){return V.setInt32(0,Y,!0),V.setInt32(4,Q,!0),V.getBigUint64(0,!0)}}}const U=B=>assert(/^-?[0-9]+$/.test(B),"int64 invalid: ".concat(B)),F=B=>assert(/^[0-9]+$/.test(B),"uint64 invalid: ".concat(B));return{zero:"0",supported:!1,parse(B){return typeof B!="string"&&(B=B.toString()),U(B),B},uParse(B){return typeof B!="string"&&(B=B.toString()),F(B),B},enc(B){return typeof B!="string"&&(B=B.toString()),U(B),int64FromString(B)},uEnc(B){return typeof B!="string"&&(B=B.toString()),F(B),int64FromString(B)},dec(B,q){return int64ToString(B,q)},uDec(B,q){return uInt64ToString(B,q)}}}const protoInt64=makeInt64Support();var ScalarType;(function(V){V[V.DOUBLE=1]="DOUBLE",V[V.FLOAT=2]="FLOAT",V[V.INT64=3]="INT64",V[V.UINT64=4]="UINT64",V[V.INT32=5]="INT32",V[V.FIXED64=6]="FIXED64",V[V.FIXED32=7]="FIXED32",V[V.BOOL=8]="BOOL",V[V.STRING=9]="STRING",V[V.BYTES=12]="BYTES",V[V.UINT32=13]="UINT32",V[V.SFIXED32=15]="SFIXED32",V[V.SFIXED64=16]="SFIXED64",V[V.SINT32=17]="SINT32",V[V.SINT64=18]="SINT64"})(ScalarType||(ScalarType={}));var LongType;(function(V){V[V.BIGINT=0]="BIGINT",V[V.STRING=1]="STRING"})(LongType||(LongType={}));function scalarEquals(V,j,U){if(j===U)return!0;if(V==ScalarType.BYTES){if(!(j instanceof Uint8Array)||!(U instanceof Uint8Array)||j.length!==U.length)return!1;for(let F=0;F<j.length;F++)if(j[F]!==U[F])return!1;return!0}switch(V){case ScalarType.UINT64:case ScalarType.FIXED64:case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:return j==U}return!1}function scalarZeroValue(V,j){switch(V){case ScalarType.BOOL:return!1;case ScalarType.UINT64:case ScalarType.FIXED64:case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:return j==0?protoInt64.zero:"0";case ScalarType.DOUBLE:case ScalarType.FLOAT:return 0;case ScalarType.BYTES:return new Uint8Array(0);case ScalarType.STRING:return"";default:return 0}}function isScalarZeroValue(V,j){switch(V){case ScalarType.BOOL:return j===!1;case ScalarType.STRING:return j==="";case ScalarType.BYTES:return j instanceof Uint8Array&&!j.byteLength;default:return j==0}}var WireType;(function(V){V[V.Varint=0]="Varint",V[V.Bit64=1]="Bit64",V[V.LengthDelimited=2]="LengthDelimited",V[V.StartGroup=3]="StartGroup",V[V.EndGroup=4]="EndGroup",V[V.Bit32=5]="Bit32"})(WireType||(WireType={}));class BinaryWriter{constructor(j){this.stack=[],this.textEncoder=j??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let j=0;for(let B=0;B<this.chunks.length;B++)j+=this.chunks[B].length;let U=new Uint8Array(j),F=0;for(let B=0;B<this.chunks.length;B++)U.set(this.chunks[B],F),F+=this.chunks[B].length;return this.chunks=[],U}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let j=this.finish(),U=this.stack.pop();if(!U)throw new Error("invalid state, fork stack empty");return this.chunks=U.chunks,this.buf=U.buf,this.uint32(j.byteLength),this.raw(j)}tag(j,U){return this.uint32((j<<3|U)>>>0)}raw(j){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(j),this}uint32(j){for(assertUInt32(j);j>127;)this.buf.push(j&127|128),j=j>>>7;return this.buf.push(j),this}int32(j){return assertInt32(j),varint32write(j,this.buf),this}bool(j){return this.buf.push(j?1:0),this}bytes(j){return this.uint32(j.byteLength),this.raw(j)}string(j){let U=this.textEncoder.encode(j);return this.uint32(U.byteLength),this.raw(U)}float(j){assertFloat32(j);let U=new Uint8Array(4);return new DataView(U.buffer).setFloat32(0,j,!0),this.raw(U)}double(j){let U=new Uint8Array(8);return new DataView(U.buffer).setFloat64(0,j,!0),this.raw(U)}fixed32(j){assertUInt32(j);let U=new Uint8Array(4);return new DataView(U.buffer).setUint32(0,j,!0),this.raw(U)}sfixed32(j){assertInt32(j);let U=new Uint8Array(4);return new DataView(U.buffer).setInt32(0,j,!0),this.raw(U)}sint32(j){return assertInt32(j),j=(j<<1^j>>31)>>>0,varint32write(j,this.buf),this}sfixed64(j){let U=new Uint8Array(8),F=new DataView(U.buffer),B=protoInt64.enc(j);return F.setInt32(0,B.lo,!0),F.setInt32(4,B.hi,!0),this.raw(U)}fixed64(j){let U=new Uint8Array(8),F=new DataView(U.buffer),B=protoInt64.uEnc(j);return F.setInt32(0,B.lo,!0),F.setInt32(4,B.hi,!0),this.raw(U)}int64(j){let U=protoInt64.enc(j);return varint64write(U.lo,U.hi,this.buf),this}sint64(j){let U=protoInt64.enc(j),F=U.hi>>31,B=U.lo<<1^F,q=(U.hi<<1|U.lo>>>31)^F;return varint64write(B,q,this.buf),this}uint64(j){let U=protoInt64.uEnc(j);return varint64write(U.lo,U.hi,this.buf),this}}class BinaryReader{constructor(j,U){this.varint64=varint64read,this.uint32=varint32read,this.buf=j,this.len=j.length,this.pos=0,this.view=new DataView(j.buffer,j.byteOffset,j.byteLength),this.textDecoder=U??new TextDecoder}tag(){let j=this.uint32(),U=j>>>3,F=j&7;if(U<=0||F<0||F>5)throw new Error("illegal tag: field no "+U+" wire type "+F);return[U,F]}skip(j,U){let F=this.pos;switch(j){case WireType.Varint:for(;this.buf[this.pos++]&128;);break;case WireType.Bit64:this.pos+=4;case WireType.Bit32:this.pos+=4;break;case WireType.LengthDelimited:let B=this.uint32();this.pos+=B;break;case WireType.StartGroup:for(;;){const[q,z]=this.tag();if(z===WireType.EndGroup){if(U!==void 0&&q!==U)throw new Error("invalid end group tag");break}this.skip(z,q)}break;default:throw new Error("cant skip wire type "+j)}return this.assertBounds(),this.buf.subarray(F,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let j=this.uint32();return j>>>1^-(j&1)}int64(){return protoInt64.dec(...this.varint64())}uint64(){return protoInt64.uDec(...this.varint64())}sint64(){let[j,U]=this.varint64(),F=-(j&1);return j=(j>>>1|(U&1)<<31)^F,U=U>>>1^F,protoInt64.dec(j,U)}bool(){let[j,U]=this.varint64();return j!==0||U!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return protoInt64.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return protoInt64.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let j=this.uint32(),U=this.pos;return this.pos+=j,this.assertBounds(),this.buf.subarray(U,U+j)}string(){return this.textDecoder.decode(this.bytes())}}function makeExtension(V,j,U,F){let B;return{typeName:j,extendee:U,get field(){if(!B){const q=typeof F=="function"?F():F;q.name=j.split(".").pop(),q.jsonName="[".concat(j,"]"),B=V.util.newFieldList([q]).list()[0]}return B},runtime:V}}function createExtensionContainer(V){const j=V.field.localName,U=Object.create(null);return U[j]=initExtensionField(V),[U,()=>U[j]]}function initExtensionField(V){const j=V.field;if(j.repeated)return[];if(j.default!==void 0)return j.default;switch(j.kind){case"enum":return j.T.values[0].no;case"scalar":return scalarZeroValue(j.T,j.L);case"message":const U=j.T,F=new U;return U.fieldWrapper?U.fieldWrapper.unwrapField(F):F;case"map":throw"map fields are not allowed to be extensions"}}function filterUnknownFields(V,j){if(!j.repeated&&(j.kind=="enum"||j.kind=="scalar")){for(let U=V.length-1;U>=0;--U)if(V[U].no==j.no)return[V[U]];return[]}return V.filter(U=>U.no===j.no)}let encTable="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),decTable=[];for(let V=0;V<encTable.length;V++)decTable[encTable[V].charCodeAt(0)]=V;decTable[45]=encTable.indexOf("+"),decTable[95]=encTable.indexOf("/");const protoBase64={dec(V){let j=V.length*3/4;V[V.length-2]=="="?j-=2:V[V.length-1]=="="&&(j-=1);let U=new Uint8Array(j),F=0,B=0,q,z=0;for(let G=0;G<V.length;G++){if(q=decTable[V.charCodeAt(G)],q===void 0)switch(V[G]){case"=":B=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(B){case 0:z=q,B=1;break;case 1:U[F++]=z<<2|(q&48)>>4,z=q,B=2;break;case 2:U[F++]=(z&15)<<4|(q&60)>>2,z=q,B=3;break;case 3:U[F++]=(z&3)<<6|q,B=0;break}}if(B==1)throw Error("invalid base64 string.");return U.subarray(0,F)},enc(V){let j="",U=0,F,B=0;for(let q=0;q<V.length;q++)switch(F=V[q],U){case 0:j+=encTable[F>>2],B=(F&3)<<4,U=1;break;case 1:j+=encTable[B|F>>4],B=(F&15)<<2,U=2;break;case 2:j+=encTable[B|F>>6],j+=encTable[F&63],U=0;break}return U&&(j+=encTable[B],j+="=",U==1&&(j+="=")),j}};function getExtension(V,j,U){assertExtendee(j,V);const F=j.runtime.bin.makeReadOptions(U),B=filterUnknownFields(V.getType().runtime.bin.listUnknownFields(V),j.field),[q,z]=createExtensionContainer(j);for(const G of B)j.runtime.bin.readField(q,F.readerFactory(G.data),j.field,G.wireType,F);return z()}function setExtension(V,j,U,F){assertExtendee(j,V);const B=j.runtime.bin.makeReadOptions(F),q=j.runtime.bin.makeWriteOptions(F);if(hasExtension(V,j)){const Q=V.getType().runtime.bin.listUnknownFields(V).filter(W=>W.no!=j.field.no);V.getType().runtime.bin.discardUnknownFields(V);for(const W of Q)V.getType().runtime.bin.onUnknownField(V,W.no,W.wireType,W.data)}const z=q.writerFactory();let G=j.field;!G.opt&&!G.repeated&&(G.kind=="enum"||G.kind=="scalar")&&(G=Object.assign(Object.assign({},j.field),{opt:!0})),j.runtime.bin.writeField(G,U,z,q);const Y=B.readerFactory(z.finish());for(;Y.pos<Y.len;){const[Q,W]=Y.tag(),Z=Y.skip(W,Q);V.getType().runtime.bin.onUnknownField(V,Q,W,Z)}}function hasExtension(V,j){const U=V.getType();return j.extendee.typeName===U.typeName&&!!U.runtime.bin.listUnknownFields(V).find(F=>F.no==j.field.no)}function assertExtendee(V,j){assert(V.extendee.typeName==j.getType().typeName,"extension ".concat(V.typeName," can only be applied to message ").concat(V.extendee.typeName))}function isFieldSet(V,j){const U=V.localName;if(V.repeated)return j[U].length>0;if(V.oneof)return j[V.oneof.localName].case===U;switch(V.kind){case"enum":case"scalar":return V.opt||V.req?j[U]!==void 0:V.kind=="enum"?j[U]!==V.T.values[0].no:!isScalarZeroValue(V.T,j[U]);case"message":return j[U]!==void 0;case"map":return Object.keys(j[U]).length>0}}function clearField(V,j){const U=V.localName,F=!V.opt&&!V.req;if(V.repeated)j[U]=[];else if(V.oneof)j[V.oneof.localName]={case:void 0};else switch(V.kind){case"map":j[U]={};break;case"enum":j[U]=F?V.T.values[0].no:void 0;break;case"scalar":j[U]=F?scalarZeroValue(V.T,V.L):void 0;break;case"message":j[U]=void 0;break}}function isMessage(V,j){if(V===null||typeof V!="object"||!Object.getOwnPropertyNames(Message.prototype).every(F=>F in V&&typeof V[F]=="function"))return!1;const U=V.getType();return U===null||typeof U!="function"||!("typeName"in U)||typeof U.typeName!="string"?!1:j===void 0?!0:U.typeName==j.typeName}function wrapField(V,j){return isMessage(j)||!V.fieldWrapper?j:V.fieldWrapper.wrapField(j)}ScalarType.DOUBLE,ScalarType.FLOAT,ScalarType.INT64,ScalarType.UINT64,ScalarType.INT32,ScalarType.UINT32,ScalarType.BOOL,ScalarType.STRING,ScalarType.BYTES;const jsonReadDefaults={ignoreUnknownFields:!1},jsonWriteDefaults={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function makeReadOptions$1(V){return V?Object.assign(Object.assign({},jsonReadDefaults),V):jsonReadDefaults}function makeWriteOptions$1(V){return V?Object.assign(Object.assign({},jsonWriteDefaults),V):jsonWriteDefaults}const tokenNull=Symbol(),tokenIgnoredUnknownEnum=Symbol();function makeJsonFormat(){return{makeReadOptions:makeReadOptions$1,makeWriteOptions:makeWriteOptions$1,readMessage(V,j,U,F){if(j==null||Array.isArray(j)||typeof j!="object")throw new Error("cannot decode message ".concat(V.typeName," from JSON: ").concat(debugJsonValue(j)));F=F??new V;const B=new Map,q=U.typeRegistry;for(const[z,G]of Object.entries(j)){const Y=V.fields.findJsonName(z);if(Y){if(Y.oneof){if(G===null&&Y.kind=="scalar")continue;const Q=B.get(Y.oneof);if(Q!==void 0)throw new Error("cannot decode message ".concat(V.typeName,' from JSON: multiple keys for oneof "').concat(Y.oneof.name,'" present: "').concat(Q,'", "').concat(z,'"'));B.set(Y.oneof,z)}readField$1(F,G,Y,U,V)}else{let Q=!1;if(q?.findExtension&&z.startsWith("[")&&z.endsWith("]")){const W=q.findExtension(z.substring(1,z.length-1));if(W&&W.extendee.typeName==V.typeName){Q=!0;const[Z,ee]=createExtensionContainer(W);readField$1(Z,G,W.field,U,W),setExtension(F,W,ee(),U)}}if(!Q&&!U.ignoreUnknownFields)throw new Error("cannot decode message ".concat(V.typeName,' from JSON: key "').concat(z,'" is unknown'))}}return F},writeMessage(V,j){const U=V.getType(),F={};let B;try{for(B of U.fields.byNumber()){if(!isFieldSet(B,V)){if(B.req)throw"required field not set";if(!j.emitDefaultValues||!canEmitFieldDefaultValue(B))continue}const z=B.oneof?V[B.oneof.localName].value:V[B.localName],G=writeField$1(B,z,j);G!==void 0&&(F[j.useProtoFieldName?B.name:B.jsonName]=G)}const q=j.typeRegistry;if(q?.findExtensionFor)for(const z of U.runtime.bin.listUnknownFields(V)){const G=q.findExtensionFor(U.typeName,z.no);if(G&&hasExtension(V,G)){const Y=getExtension(V,G,j),Q=writeField$1(G.field,Y,j);Q!==void 0&&(F[G.field.jsonName]=Q)}}}catch(q){const z=B?"cannot encode field ".concat(U.typeName,".").concat(B.name," to JSON"):"cannot encode message ".concat(U.typeName," to JSON"),G=q instanceof Error?q.message:String(q);throw new Error(z+(G.length>0?": ".concat(G):""))}return F},readScalar(V,j,U){return readScalar$1(V,j,U??LongType.BIGINT,!0)},writeScalar(V,j,U){if(j!==void 0&&(U||isScalarZeroValue(V,j)))return writeScalar$1(V,j)},debug:debugJsonValue}}function debugJsonValue(V){if(V===null)return"null";switch(typeof V){case"object":return Array.isArray(V)?"array":"object";case"string":return V.length>100?"string":'"'.concat(V.split('"').join('\\"'),'"');default:return String(V)}}function readField$1(V,j,U,F,B){let q=U.localName;if(U.repeated){if(assert(U.kind!="map"),j===null)return;if(!Array.isArray(j))throw new Error("cannot decode field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(j)));const z=V[q];for(const G of j){if(G===null)throw new Error("cannot decode field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(G)));switch(U.kind){case"message":z.push(U.T.fromJson(G,F));break;case"enum":const Y=readEnum(U.T,G,F.ignoreUnknownFields,!0);Y!==tokenIgnoredUnknownEnum&&z.push(Y);break;case"scalar":try{z.push(readScalar$1(U.T,G,U.L,!0))}catch(Q){let W="cannot decode field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(G));throw Q instanceof Error&&Q.message.length>0&&(W+=": ".concat(Q.message)),new Error(W)}break}}}else if(U.kind=="map"){if(j===null)return;if(typeof j!="object"||Array.isArray(j))throw new Error("cannot decode field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(j)));const z=V[q];for(const[G,Y]of Object.entries(j)){if(Y===null)throw new Error("cannot decode field ".concat(B.typeName,".").concat(U.name," from JSON: map value null"));let Q;try{Q=readMapKey(U.K,G)}catch(W){let Z="cannot decode map key for field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(j));throw W instanceof Error&&W.message.length>0&&(Z+=": ".concat(W.message)),new Error(Z)}switch(U.V.kind){case"message":z[Q]=U.V.T.fromJson(Y,F);break;case"enum":const W=readEnum(U.V.T,Y,F.ignoreUnknownFields,!0);W!==tokenIgnoredUnknownEnum&&(z[Q]=W);break;case"scalar":try{z[Q]=readScalar$1(U.V.T,Y,LongType.BIGINT,!0)}catch(Z){let ee="cannot decode map value for field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(j));throw Z instanceof Error&&Z.message.length>0&&(ee+=": ".concat(Z.message)),new Error(ee)}break}}}else switch(U.oneof&&(V=V[U.oneof.localName]={case:q},q="value"),U.kind){case"message":const z=U.T;if(j===null&&z.typeName!="google.protobuf.Value")return;let G=V[q];isMessage(G)?G.fromJson(j,F):(V[q]=G=z.fromJson(j,F),z.fieldWrapper&&!U.oneof&&(V[q]=z.fieldWrapper.unwrapField(G)));break;case"enum":const Y=readEnum(U.T,j,F.ignoreUnknownFields,!1);switch(Y){case tokenNull:clearField(U,V);break;case tokenIgnoredUnknownEnum:break;default:V[q]=Y;break}break;case"scalar":try{const Q=readScalar$1(U.T,j,U.L,!1);switch(Q){case tokenNull:clearField(U,V);break;default:V[q]=Q;break}}catch(Q){let W="cannot decode field ".concat(B.typeName,".").concat(U.name," from JSON: ").concat(debugJsonValue(j));throw Q instanceof Error&&Q.message.length>0&&(W+=": ".concat(Q.message)),new Error(W)}break}}function readMapKey(V,j){if(V===ScalarType.BOOL)switch(j){case"true":j=!0;break;case"false":j=!1;break}return readScalar$1(V,j,LongType.BIGINT,!0).toString()}function readScalar$1(V,j,U,F){if(j===null)return F?scalarZeroValue(V,U):tokenNull;switch(V){case ScalarType.DOUBLE:case ScalarType.FLOAT:if(j==="NaN")return Number.NaN;if(j==="Infinity")return Number.POSITIVE_INFINITY;if(j==="-Infinity")return Number.NEGATIVE_INFINITY;if(j===""||typeof j=="string"&&j.trim().length!==j.length||typeof j!="string"&&typeof j!="number")break;const B=Number(j);if(Number.isNaN(B)||!Number.isFinite(B))break;return V==ScalarType.FLOAT&&assertFloat32(B),B;case ScalarType.INT32:case ScalarType.FIXED32:case ScalarType.SFIXED32:case ScalarType.SINT32:case ScalarType.UINT32:let q;if(typeof j=="number"?q=j:typeof j=="string"&&j.length>0&&j.trim().length===j.length&&(q=Number(j)),q===void 0)break;return V==ScalarType.UINT32||V==ScalarType.FIXED32?assertUInt32(q):assertInt32(q),q;case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:if(typeof j!="number"&&typeof j!="string")break;const z=protoInt64.parse(j);return U?z.toString():z;case ScalarType.FIXED64:case ScalarType.UINT64:if(typeof j!="number"&&typeof j!="string")break;const G=protoInt64.uParse(j);return U?G.toString():G;case ScalarType.BOOL:if(typeof j!="boolean")break;return j;case ScalarType.STRING:if(typeof j!="string")break;try{encodeURIComponent(j)}catch{throw new Error("invalid UTF8")}return j;case ScalarType.BYTES:if(j==="")return new Uint8Array(0);if(typeof j!="string")break;return protoBase64.dec(j)}throw new Error}function readEnum(V,j,U,F){if(j===null)return V.typeName=="google.protobuf.NullValue"?0:F?V.values[0].no:tokenNull;switch(typeof j){case"number":if(Number.isInteger(j))return j;break;case"string":const B=V.findName(j);if(B!==void 0)return B.no;if(U)return tokenIgnoredUnknownEnum;break}throw new Error("cannot decode enum ".concat(V.typeName," from JSON: ").concat(debugJsonValue(j)))}function canEmitFieldDefaultValue(V){return V.repeated||V.kind=="map"?!0:!(V.oneof||V.kind=="message"||V.opt||V.req)}function writeField$1(V,j,U){if(V.kind=="map"){assert(typeof j=="object"&&j!=null);const F={},B=Object.entries(j);switch(V.V.kind){case"scalar":for(const[z,G]of B)F[z.toString()]=writeScalar$1(V.V.T,G);break;case"message":for(const[z,G]of B)F[z.toString()]=G.toJson(U);break;case"enum":const q=V.V.T;for(const[z,G]of B)F[z.toString()]=writeEnum(q,G,U.enumAsInteger);break}return U.emitDefaultValues||B.length>0?F:void 0}if(V.repeated){assert(Array.isArray(j));const F=[];switch(V.kind){case"scalar":for(let B=0;B<j.length;B++)F.push(writeScalar$1(V.T,j[B]));break;case"enum":for(let B=0;B<j.length;B++)F.push(writeEnum(V.T,j[B],U.enumAsInteger));break;case"message":for(let B=0;B<j.length;B++)F.push(j[B].toJson(U));break}return U.emitDefaultValues||F.length>0?F:void 0}switch(V.kind){case"scalar":return writeScalar$1(V.T,j);case"enum":return writeEnum(V.T,j,U.enumAsInteger);case"message":return wrapField(V.T,j).toJson(U)}}function writeEnum(V,j,U){var F;if(assert(typeof j=="number"),V.typeName=="google.protobuf.NullValue")return null;if(U)return j;const B=V.findNumber(j);return(F=B?.name)!==null&&F!==void 0?F:j}function writeScalar$1(V,j){switch(V){case ScalarType.INT32:case ScalarType.SFIXED32:case ScalarType.SINT32:case ScalarType.FIXED32:case ScalarType.UINT32:return assert(typeof j=="number"),j;case ScalarType.FLOAT:case ScalarType.DOUBLE:return assert(typeof j=="number"),Number.isNaN(j)?"NaN":j===Number.POSITIVE_INFINITY?"Infinity":j===Number.NEGATIVE_INFINITY?"-Infinity":j;case ScalarType.STRING:return assert(typeof j=="string"),j;case ScalarType.BOOL:return assert(typeof j=="boolean"),j;case ScalarType.UINT64:case ScalarType.FIXED64:case ScalarType.INT64:case ScalarType.SFIXED64:case ScalarType.SINT64:return assert(typeof j=="bigint"||typeof j=="string"||typeof j=="number"),j.toString();case ScalarType.BYTES:return assert(j instanceof Uint8Array),protoBase64.enc(j)}}const unknownFieldsSymbol=Symbol("@bufbuild/protobuf/unknown-fields"),readDefaults={readUnknownFields:!0,readerFactory:V=>new BinaryReader(V)},writeDefaults={writeUnknownFields:!0,writerFactory:()=>new BinaryWriter};function makeReadOptions(V){return V?Object.assign(Object.assign({},readDefaults),V):readDefaults}function makeWriteOptions(V){return V?Object.assign(Object.assign({},writeDefaults),V):writeDefaults}function makeBinaryFormat(){return{makeReadOptions,makeWriteOptions,listUnknownFields(V){var j;return(j=V[unknownFieldsSymbol])!==null&&j!==void 0?j:[]},discardUnknownFields(V){delete V[unknownFieldsSymbol]},writeUnknownFields(V,j){const F=V[unknownFieldsSymbol];if(F)for(const B of F)j.tag(B.no,B.wireType).raw(B.data)},onUnknownField(V,j,U,F){const B=V;Array.isArray(B[unknownFieldsSymbol])||(B[unknownFieldsSymbol]=[]),B[unknownFieldsSymbol].push({no:j,wireType:U,data:F})},readMessage(V,j,U,F,B){const q=V.getType(),z=B?j.len:j.pos+U;let G,Y;for(;j.pos<z&&([G,Y]=j.tag(),!(B===!0&&Y==WireType.EndGroup));){const Q=q.fields.find(G);if(!Q){const W=j.skip(Y,G);F.readUnknownFields&&this.onUnknownField(V,G,Y,W);continue}readField(V,j,Q,Y,F)}if(B&&(Y!=WireType.EndGroup||G!==U))throw new Error("invalid end group tag")},readField,writeMessage(V,j,U){const F=V.getType();for(const B of F.fields.byNumber()){if(!isFieldSet(B,V)){if(B.req)throw new Error("cannot encode field ".concat(F.typeName,".").concat(B.name," to binary: required field not set"));continue}const q=B.oneof?V[B.oneof.localName].value:V[B.localName];writeField(B,q,j,U)}return U.writeUnknownFields&&this.writeUnknownFields(V,j),j},writeField(V,j,U,F){j!==void 0&&writeField(V,j,U,F)}}}function readField(V,j,U,F,B){let{repeated:q,localName:z}=U;switch(U.oneof&&(V=V[U.oneof.localName],V.case!=z&&delete V.value,V.case=z,z="value"),U.kind){case"scalar":case"enum":const G=U.kind=="enum"?ScalarType.INT32:U.T;let Y=readScalar;if(U.kind=="scalar"&&U.L>0&&(Y=readScalarLTString),q){let ee=V[z];if(F==WireType.LengthDelimited&&G!=ScalarType.STRING&&G!=ScalarType.BYTES){let ae=j.uint32()+j.pos;for(;j.pos<ae;)ee.push(Y(j,G))}else ee.push(Y(j,G))}else V[z]=Y(j,G);break;case"message":const Q=U.T;q?V[z].push(readMessageField(j,new Q,B,U)):isMessage(V[z])?readMessageField(j,V[z],B,U):(V[z]=readMessageField(j,new Q,B,U),Q.fieldWrapper&&!U.oneof&&!U.repeated&&(V[z]=Q.fieldWrapper.unwrapField(V[z])));break;case"map":let[W,Z]=readMapEntry(U,j,B);V[z][W]=Z;break}}function readMessageField(V,j,U,F){const B=j.getType().runtime.bin,q=F?.delimited;return B.readMessage(j,V,q?F.no:V.uint32(),U,q),j}function readMapEntry(V,j,U){const F=j.uint32(),B=j.pos+F;let q,z;for(;j.pos<B;){const[G]=j.tag();switch(G){case 1:q=readScalar(j,V.K);break;case 2:switch(V.V.kind){case"scalar":z=readScalar(j,V.V.T);break;case"enum":z=j.int32();break;case"message":z=readMessageField(j,new V.V.T,U,void 0);break}break}}if(q===void 0&&(q=scalarZeroValue(V.K,LongType.BIGINT)),typeof q!="string"&&typeof q!="number"&&(q=q.toString()),z===void 0)switch(V.V.kind){case"scalar":z=scalarZeroValue(V.V.T,LongType.BIGINT);break;case"enum":z=V.V.T.values[0].no;break;case"message":z=new V.V.T;break}return[q,z]}function readScalarLTString(V,j){const U=readScalar(V,j);return typeof U=="bigint"?U.toString():U}function readScalar(V,j){switch(j){case ScalarType.STRING:return V.string();case ScalarType.BOOL:return V.bool();case ScalarType.DOUBLE:return V.double();case ScalarType.FLOAT:return V.float();case ScalarType.INT32:return V.int32();case ScalarType.INT64:return V.int64();case ScalarType.UINT64:return V.uint64();case ScalarType.FIXED64:return V.fixed64();case ScalarType.BYTES:return V.bytes();case ScalarType.FIXED32:return V.fixed32();case ScalarType.SFIXED32:return V.sfixed32();case ScalarType.SFIXED64:return V.sfixed64();case ScalarType.SINT64:return V.sint64();case ScalarType.UINT32:return V.uint32();case ScalarType.SINT32:return V.sint32()}}function writeField(V,j,U,F){assert(j!==void 0);const B=V.repeated;switch(V.kind){case"scalar":case"enum":let q=V.kind=="enum"?ScalarType.INT32:V.T;if(B)if(assert(Array.isArray(j)),V.packed)writePacked(U,q,V.no,j);else for(const z of j)writeScalar(U,q,V.no,z);else writeScalar(U,q,V.no,j);break;case"message":if(B){assert(Array.isArray(j));for(const z of j)writeMessageField(U,F,V,z)}else writeMessageField(U,F,V,j);break;case"map":assert(typeof j=="object"&&j!=null);for(const[z,G]of Object.entries(j))writeMapEntry(U,F,V,z,G);break}}function writeMapEntry(V,j,U,F,B){V.tag(U.no,WireType.LengthDelimited),V.fork();let q=F;switch(U.K){case ScalarType.INT32:case ScalarType.FIXED32:case ScalarType.UINT32:case ScalarType.SFIXED32:case ScalarType.SINT32:q=Number.parseInt(F);break;case ScalarType.BOOL:assert(F=="true"||F=="false"),q=F=="true";break}switch(writeScalar(V,U.K,1,q),U.V.kind){case"scalar":writeScalar(V,U.V.T,2,B);break;case"enum":writeScalar(V,ScalarType.INT32,2,B);break;case"message":assert(B!==void 0),V.tag(2,WireType.LengthDelimited).bytes(B.toBinary(j));break}V.join()}function writeMessageField(V,j,U,F){const B=wrapField(U.T,F);U.delimited?V.tag(U.no,WireType.StartGroup).raw(B.toBinary(j)).tag(U.no,WireType.EndGroup):V.tag(U.no,WireType.LengthDelimited).bytes(B.toBinary(j))}function writeScalar(V,j,U,F){assert(F!==void 0);let[B,q]=scalarTypeInfo(j);V.tag(U,B)[q](F)}function writePacked(V,j,U,F){if(!F.length)return;V.tag(U,WireType.LengthDelimited).fork();let[,B]=scalarTypeInfo(j);for(let q=0;q<F.length;q++)V[B](F[q]);V.join()}function scalarTypeInfo(V){let j=WireType.Varint;switch(V){case ScalarType.BYTES:case ScalarType.STRING:j=WireType.LengthDelimited;break;case ScalarType.DOUBLE:case ScalarType.FIXED64:case ScalarType.SFIXED64:j=WireType.Bit64;break;case ScalarType.FIXED32:case ScalarType.SFIXED32:case ScalarType.FLOAT:j=WireType.Bit32;break}const U=ScalarType[V].toLowerCase();return[j,U]}function makeUtilCommon(){return{setEnumType,initPartial(V,j){if(V===void 0)return;const U=j.getType();for(const F of U.fields.byMember()){const B=F.localName,q=j,z=V;if(z[B]!=null)switch(F.kind){case"oneof":const G=z[B].case;if(G===void 0)continue;const Y=F.findField(G);let Q=z[B].value;Y&&Y.kind=="message"&&!isMessage(Q,Y.T)?Q=new Y.T(Q):Y&&Y.kind==="scalar"&&Y.T===ScalarType.BYTES&&(Q=toU8Arr(Q)),q[B]={case:G,value:Q};break;case"scalar":case"enum":let W=z[B];F.T===ScalarType.BYTES&&(W=F.repeated?W.map(toU8Arr):toU8Arr(W)),q[B]=W;break;case"map":switch(F.V.kind){case"scalar":case"enum":if(F.V.T===ScalarType.BYTES)for(const[ne,ae]of Object.entries(z[B]))q[B][ne]=toU8Arr(ae);else Object.assign(q[B],z[B]);break;case"message":const ee=F.V.T;for(const ne of Object.keys(z[B])){let ae=z[B][ne];ee.fieldWrapper||(ae=new ee(ae)),q[B][ne]=ae}break}break;case"message":const Z=F.T;if(F.repeated)q[B]=z[B].map(ee=>isMessage(ee,Z)?ee:new Z(ee));else{const ee=z[B];Z.fieldWrapper?Z.typeName==="google.protobuf.BytesValue"?q[B]=toU8Arr(ee):q[B]=ee:q[B]=isMessage(ee,Z)?ee:new Z(ee)}break}}},equals(V,j,U){return j===U?!0:!j||!U?!1:V.fields.byMember().every(F=>{const B=j[F.localName],q=U[F.localName];if(F.repeated){if(B.length!==q.length)return!1;switch(F.kind){case"message":return B.every((z,G)=>F.T.equals(z,q[G]));case"scalar":return B.every((z,G)=>scalarEquals(F.T,z,q[G]));case"enum":return B.every((z,G)=>scalarEquals(ScalarType.INT32,z,q[G]))}throw new Error("repeated cannot contain ".concat(F.kind))}switch(F.kind){case"message":let z=B,G=q;return F.T.fieldWrapper&&(z!==void 0&&!isMessage(z)&&(z=F.T.fieldWrapper.wrapField(z)),G!==void 0&&!isMessage(G)&&(G=F.T.fieldWrapper.wrapField(G))),F.T.equals(z,G);case"enum":return scalarEquals(ScalarType.INT32,B,q);case"scalar":return scalarEquals(F.T,B,q);case"oneof":if(B.case!==q.case)return!1;const Y=F.findField(B.case);if(Y===void 0)return!0;switch(Y.kind){case"message":return Y.T.equals(B.value,q.value);case"enum":return scalarEquals(ScalarType.INT32,B.value,q.value);case"scalar":return scalarEquals(Y.T,B.value,q.value)}throw new Error("oneof cannot contain ".concat(Y.kind));case"map":const Q=Object.keys(B).concat(Object.keys(q));switch(F.V.kind){case"message":const W=F.V.T;return Q.every(ee=>W.equals(B[ee],q[ee]));case"enum":return Q.every(ee=>scalarEquals(ScalarType.INT32,B[ee],q[ee]));case"scalar":const Z=F.V.T;return Q.every(ee=>scalarEquals(Z,B[ee],q[ee]))}break}})},clone(V){const j=V.getType(),U=new j,F=U;for(const B of j.fields.byMember()){const q=V[B.localName];let z;if(B.repeated)z=q.map(cloneSingularField);else if(B.kind=="map"){z=F[B.localName];for(const[G,Y]of Object.entries(q))z[G]=cloneSingularField(Y)}else B.kind=="oneof"?z=B.findField(q.case)?{case:q.case,value:cloneSingularField(q.value)}:{case:void 0}:z=cloneSingularField(q);F[B.localName]=z}for(const B of j.runtime.bin.listUnknownFields(V))j.runtime.bin.onUnknownField(F,B.no,B.wireType,B.data);return U}}}function cloneSingularField(V){if(V===void 0)return V;if(isMessage(V))return V.clone();if(V instanceof Uint8Array){const j=new Uint8Array(V.byteLength);return j.set(V),j}return V}function toU8Arr(V){return V instanceof Uint8Array?V:new Uint8Array(V)}function makeProtoRuntime(V,j,U){return{syntax:V,json:makeJsonFormat(),bin:makeBinaryFormat(),util:Object.assign(Object.assign({},makeUtilCommon()),{newFieldList:j,initFields:U}),makeMessageType(F,B,q){return makeMessageType(this,F,B,q)},makeEnum,makeEnumType,getEnumType,makeExtension(F,B,q){return makeExtension(this,F,B,q)}}}class InternalFieldList{constructor(j,U){this._fields=j,this._normalizer=U}findJsonName(j){if(!this.jsonNames){const U={};for(const F of this.list())U[F.jsonName]=U[F.name]=F;this.jsonNames=U}return this.jsonNames[j]}find(j){if(!this.numbers){const U={};for(const F of this.list())U[F.no]=F;this.numbers=U}return this.numbers[j]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((j,U)=>j.no-U.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const j=this.members;let U;for(const F of this.list())F.oneof?F.oneof!==U&&(U=F.oneof,j.push(U)):j.push(F)}return this.members}}function localFieldName(V,j){const U=protoCamelCase(V);return j?U:safeObjectProperty(safeMessageProperty(U))}function localOneofName(V){return localFieldName(V,!1)}const fieldJsonName=protoCamelCase;function protoCamelCase(V){let j=!1;const U=[];for(let F=0;F<V.length;F++){let B=V.charAt(F);switch(B){case"_":j=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":U.push(B),j=!1;break;default:j&&(j=!1,B=B.toUpperCase()),U.push(B);break}}return U.join("")}const reservedObjectProperties=new Set(["constructor","toString","toJSON","valueOf"]),reservedMessageProperties=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),fallback=V=>"".concat(V,"$"),safeMessageProperty=V=>reservedMessageProperties.has(V)?fallback(V):V,safeObjectProperty=V=>reservedObjectProperties.has(V)?fallback(V):V;class InternalOneofInfo{constructor(j){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=j,this.localName=localOneofName(j)}addField(j){assert(j.oneof===this,"field ".concat(j.name," not one of ").concat(this.name)),this.fields.push(j)}findField(j){if(!this._lookup){this._lookup=Object.create(null);for(let U=0;U<this.fields.length;U++)this._lookup[this.fields[U].localName]=this.fields[U]}return this._lookup[j]}}function normalizeFieldInfos(V,j){var U,F,B,q,z,G;const Y=[];let Q;for(const W of typeof V=="function"?V():V){const Z=W;if(Z.localName=localFieldName(W.name,W.oneof!==void 0),Z.jsonName=(U=W.jsonName)!==null&&U!==void 0?U:fieldJsonName(W.name),Z.repeated=(F=W.repeated)!==null&&F!==void 0?F:!1,W.kind=="scalar"&&(Z.L=(B=W.L)!==null&&B!==void 0?B:LongType.BIGINT),Z.delimited=(q=W.delimited)!==null&&q!==void 0?q:!1,Z.req=(z=W.req)!==null&&z!==void 0?z:!1,Z.opt=(G=W.opt)!==null&&G!==void 0?G:!1,W.packed===void 0&&(Z.packed=W.kind=="enum"||W.kind=="scalar"&&W.T!=ScalarType.BYTES&&W.T!=ScalarType.STRING),W.oneof!==void 0){const ee=typeof W.oneof=="string"?W.oneof:W.oneof.name;(!Q||Q.name!=ee)&&(Q=new InternalOneofInfo(ee)),Z.oneof=Q,Q.addField(Z)}Y.push(Z)}return Y}const proto3=makeProtoRuntime("proto3",V=>new InternalFieldList(V,j=>normalizeFieldInfos(j)),V=>{for(const j of V.getType().fields.byMember()){if(j.opt)continue;const U=j.localName,F=V;if(j.repeated){F[U]=[];continue}switch(j.kind){case"oneof":F[U]={case:void 0};break;case"enum":F[U]=0;break;case"map":F[U]={};break;case"scalar":F[U]=scalarZeroValue(j.T,j.L);break}}});class Timestamp extends Message{constructor(j){super(),this.seconds=protoInt64.zero,this.nanos=0,proto3.util.initPartial(j,this)}fromJson(j,U){if(typeof j!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(proto3.json.debug(j)));const F=j.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!F)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const B=Date.parse(F[1]+"-"+F[2]+"-"+F[3]+"T"+F[4]+":"+F[5]+":"+F[6]+(F[8]?F[8]:"Z"));if(Number.isNaN(B))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(B<Date.parse("0001-01-01T00:00:00Z")||B>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=protoInt64.parse(B/1e3),this.nanos=0,F[7]&&(this.nanos=parseInt("1"+F[7]+"0".repeat(9-F[7].length))-1e9),this}toJson(j){const U=Number(this.seconds)*1e3;if(U<Date.parse("0001-01-01T00:00:00Z")||U>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let F="Z";if(this.nanos>0){const B=(this.nanos+1e9).toString().substring(1);B.substring(3)==="000000"?F="."+B.substring(0,3)+"Z":B.substring(6)==="000"?F="."+B.substring(0,6)+"Z":F="."+B+"Z"}return new Date(U).toISOString().replace(".000Z",F)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Timestamp.fromDate(new Date)}static fromDate(j){const U=j.getTime();return new Timestamp({seconds:protoInt64.parse(Math.floor(U/1e3)),nanos:U%1e3*1e6})}static fromBinary(j,U){return new Timestamp().fromBinary(j,U)}static fromJson(j,U){return new Timestamp().fromJson(j,U)}static fromJsonString(j,U){return new Timestamp().fromJsonString(j,U)}static equals(j,U){return proto3.util.equals(Timestamp,j,U)}}Timestamp.runtime=proto3,Timestamp.typeName="google.protobuf.Timestamp",Timestamp.fields=proto3.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const MetricsBatch=proto3.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Timestamp},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:TimeSeriesMetric,repeated:!0},{no:5,name:"events",kind:"message",T:EventMetric,repeated:!0}]),TimeSeriesMetric=proto3.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:MetricSample,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),MetricSample=proto3.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Timestamp},{no:3,name:"value",kind:"scalar",T:2}]),EventMetric=proto3.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Timestamp},{no:7,name:"normalized_end_timestamp",kind:"message",T:Timestamp,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),BackupCodecPolicy$1=proto3.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),TrackType=proto3.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),TrackSource=proto3.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),VideoQuality$1=proto3.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),ConnectionQuality$1=proto3.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),ClientConfigSetting=proto3.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),DisconnectReason=proto3.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),ReconnectReason=proto3.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),SubscriptionError=proto3.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),AudioTrackFeature=proto3.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Room$1=proto3.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Codec,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:TimedVersion}]),Codec=proto3.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),ParticipantPermission=proto3.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:proto3.getEnumType(TrackSource),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),ParticipantInfo=proto3.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:proto3.getEnumType(ParticipantInfo_State)},{no:4,name:"tracks",kind:"message",T:TrackInfo,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:ParticipantPermission},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:proto3.getEnumType(ParticipantInfo_Kind)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:proto3.getEnumType(DisconnectReason)},{no:18,name:"kind_details",kind:"enum",T:proto3.getEnumType(ParticipantInfo_KindDetail),repeated:!0}]),ParticipantInfo_State=proto3.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),ParticipantInfo_Kind=proto3.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),ParticipantInfo_KindDetail=proto3.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Encryption_Type=proto3.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),SimulcastCodecInfo=proto3.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:VideoLayer,repeated:!0}]),TrackInfo=proto3.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:proto3.getEnumType(TrackType)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:proto3.getEnumType(TrackSource)},{no:10,name:"layers",kind:"message",T:VideoLayer,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:SimulcastCodecInfo,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:proto3.getEnumType(Encryption_Type)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:TimedVersion},{no:19,name:"audio_features",kind:"enum",T:proto3.getEnumType(AudioTrackFeature),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:proto3.getEnumType(BackupCodecPolicy$1)}]),VideoLayer=proto3.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:proto3.getEnumType(VideoQuality$1)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),DataPacket=proto3.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:proto3.getEnumType(DataPacket_Kind)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:UserPacket,oneof:"value"},{no:3,name:"speaker",kind:"message",T:ActiveSpeakerUpdate,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:SipDTMF,oneof:"value"},{no:7,name:"transcription",kind:"message",T:Transcription,oneof:"value"},{no:8,name:"metrics",kind:"message",T:MetricsBatch,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:ChatMessage,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:RpcRequest,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:RpcAck,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:RpcResponse,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:DataStream_Header,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:DataStream_Chunk,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:DataStream_Trailer,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),DataPacket_Kind=proto3.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),ActiveSpeakerUpdate=proto3.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:SpeakerInfo,repeated:!0}]),SpeakerInfo=proto3.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),UserPacket=proto3.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),SipDTMF=proto3.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),Transcription=proto3.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:TranscriptionSegment,repeated:!0}]),TranscriptionSegment=proto3.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),ChatMessage=proto3.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),RpcRequest=proto3.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),RpcAck=proto3.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),RpcResponse=proto3.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:RpcError$1,oneof:"value"}]),RpcError$1=proto3.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),ParticipantTracks=proto3.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),ServerInfo=proto3.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:proto3.getEnumType(ServerInfo_Edition)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),ServerInfo_Edition=proto3.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),ClientInfo=proto3.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:proto3.getEnumType(ClientInfo_SDK)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),ClientInfo_SDK=proto3.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),ClientConfiguration=proto3.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:VideoConfiguration},{no:2,name:"screen",kind:"message",T:VideoConfiguration},{no:3,name:"resume_connection",kind:"enum",T:proto3.getEnumType(ClientConfigSetting)},{no:4,name:"disabled_codecs",kind:"message",T:DisabledCodecs},{no:5,name:"force_relay",kind:"enum",T:proto3.getEnumType(ClientConfigSetting)}]),VideoConfiguration=proto3.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:proto3.getEnumType(ClientConfigSetting)}]),DisabledCodecs=proto3.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Codec,repeated:!0},{no:2,name:"publish",kind:"message",T:Codec,repeated:!0}]),TimedVersion=proto3.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),DataStream_OperationType=proto3.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),DataStream_TextHeader=proto3.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:proto3.getEnumType(DataStream_OperationType)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),DataStream_ByteHeader=proto3.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),DataStream_Header=proto3.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:proto3.getEnumType(Encryption_Type)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:DataStream_TextHeader,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:DataStream_ByteHeader,oneof:"content_header"}],{localName:"DataStream_Header"}),DataStream_Chunk=proto3.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),DataStream_Trailer=proto3.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),SignalTarget=proto3.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),StreamState=proto3.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),CandidateProtocol=proto3.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),SignalRequest=proto3.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:SessionDescription,oneof:"message"},{no:2,name:"answer",kind:"message",T:SessionDescription,oneof:"message"},{no:3,name:"trickle",kind:"message",T:TrickleRequest,oneof:"message"},{no:4,name:"add_track",kind:"message",T:AddTrackRequest,oneof:"message"},{no:5,name:"mute",kind:"message",T:MuteTrackRequest,oneof:"message"},{no:6,name:"subscription",kind:"message",T:UpdateSubscription,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:UpdateTrackSettings,oneof:"message"},{no:8,name:"leave",kind:"message",T:LeaveRequest,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:UpdateVideoLayers,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:SubscriptionPermission,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:SyncState,oneof:"message"},{no:13,name:"simulate",kind:"message",T:SimulateScenario,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:UpdateParticipantMetadata,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Ping,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:UpdateLocalAudioTrack,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:UpdateLocalVideoTrack,oneof:"message"}]),SignalResponse=proto3.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:JoinResponse,oneof:"message"},{no:2,name:"answer",kind:"message",T:SessionDescription,oneof:"message"},{no:3,name:"offer",kind:"message",T:SessionDescription,oneof:"message"},{no:4,name:"trickle",kind:"message",T:TrickleRequest,oneof:"message"},{no:5,name:"update",kind:"message",T:ParticipantUpdate,oneof:"message"},{no:6,name:"track_published",kind:"message",T:TrackPublishedResponse,oneof:"message"},{no:8,name:"leave",kind:"message",T:LeaveRequest,oneof:"message"},{no:9,name:"mute",kind:"message",T:MuteTrackRequest,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:SpeakersChanged,oneof:"message"},{no:11,name:"room_update",kind:"message",T:RoomUpdate,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:ConnectionQualityUpdate,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:StreamStateUpdate,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:SubscribedQualityUpdate,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:SubscriptionPermissionUpdate,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:TrackUnpublishedResponse,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:ReconnectResponse,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Pong,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:SubscriptionResponse,oneof:"message"},{no:22,name:"request_response",kind:"message",T:RequestResponse,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:TrackSubscribed,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:RoomMovedResponse,oneof:"message"}]),SimulcastCodec=proto3.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),AddTrackRequest=proto3.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:proto3.getEnumType(TrackType)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:proto3.getEnumType(TrackSource)},{no:9,name:"layers",kind:"message",T:VideoLayer,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:SimulcastCodec,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:proto3.getEnumType(Encryption_Type)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:proto3.getEnumType(BackupCodecPolicy$1)},{no:17,name:"audio_features",kind:"enum",T:proto3.getEnumType(AudioTrackFeature),repeated:!0}]),TrickleRequest=proto3.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:proto3.getEnumType(SignalTarget)},{no:3,name:"final",kind:"scalar",T:8}]),MuteTrackRequest=proto3.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),JoinResponse=proto3.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Room$1},{no:2,name:"participant",kind:"message",T:ParticipantInfo},{no:3,name:"other_participants",kind:"message",T:ParticipantInfo,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:ICEServer,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:ClientConfiguration},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:ServerInfo},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Codec,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),ReconnectResponse=proto3.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:ICEServer,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:ClientConfiguration},{no:3,name:"server_info",kind:"message",T:ServerInfo},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),TrackPublishedResponse=proto3.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:TrackInfo}]),TrackUnpublishedResponse=proto3.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),SessionDescription=proto3.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}]),ParticipantUpdate=proto3.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:ParticipantInfo,repeated:!0}]),UpdateSubscription=proto3.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:ParticipantTracks,repeated:!0}]),UpdateTrackSettings=proto3.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:proto3.getEnumType(VideoQuality$1)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),UpdateLocalAudioTrack=proto3.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:proto3.getEnumType(AudioTrackFeature),repeated:!0}]),UpdateLocalVideoTrack=proto3.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),LeaveRequest=proto3.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:proto3.getEnumType(DisconnectReason)},{no:3,name:"action",kind:"enum",T:proto3.getEnumType(LeaveRequest_Action)},{no:4,name:"regions",kind:"message",T:RegionSettings}]),LeaveRequest_Action=proto3.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),UpdateVideoLayers=proto3.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:VideoLayer,repeated:!0}]),UpdateParticipantMetadata=proto3.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),ICEServer=proto3.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),SpeakersChanged=proto3.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:SpeakerInfo,repeated:!0}]),RoomUpdate=proto3.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Room$1}]),ConnectionQualityInfo=proto3.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:proto3.getEnumType(ConnectionQuality$1)},{no:3,name:"score",kind:"scalar",T:2}]),ConnectionQualityUpdate=proto3.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:ConnectionQualityInfo,repeated:!0}]),StreamStateInfo=proto3.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:proto3.getEnumType(StreamState)}]),StreamStateUpdate=proto3.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:StreamStateInfo,repeated:!0}]),SubscribedQuality=proto3.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:proto3.getEnumType(VideoQuality$1)},{no:2,name:"enabled",kind:"scalar",T:8}]),SubscribedCodec=proto3.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:SubscribedQuality,repeated:!0}]),SubscribedQualityUpdate=proto3.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:SubscribedQuality,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:SubscribedCodec,repeated:!0}]),TrackPermission=proto3.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),SubscriptionPermission=proto3.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:TrackPermission,repeated:!0}]),SubscriptionPermissionUpdate=proto3.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),RoomMovedResponse=proto3.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Room$1},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:ParticipantInfo},{no:4,name:"other_participants",kind:"message",T:ParticipantInfo,repeated:!0}]),SyncState=proto3.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:SessionDescription},{no:2,name:"subscription",kind:"message",T:UpdateSubscription},{no:3,name:"publish_tracks",kind:"message",T:TrackPublishedResponse,repeated:!0},{no:4,name:"data_channels",kind:"message",T:DataChannelInfo,repeated:!0},{no:5,name:"offer",kind:"message",T:SessionDescription},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:DataChannelReceiveState,repeated:!0}]),DataChannelReceiveState=proto3.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),DataChannelInfo=proto3.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:proto3.getEnumType(SignalTarget)}]),SimulateScenario=proto3.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:proto3.getEnumType(CandidateProtocol),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Ping=proto3.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Pong=proto3.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),RegionSettings=proto3.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:RegionInfo,repeated:!0}]),RegionInfo=proto3.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),SubscriptionResponse=proto3.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:proto3.getEnumType(SubscriptionError)}]),RequestResponse=proto3.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:proto3.getEnumType(RequestResponse_Reason)},{no:3,name:"message",kind:"scalar",T:9}]),RequestResponse_Reason=proto3.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),TrackSubscribed=proto3.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function getDefaultExportFromCjs(V){return V&&V.__esModule&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V}var loglevel$1={exports:{}},loglevel=loglevel$1.exports,hasRequiredLoglevel;function requireLoglevel(){return hasRequiredLoglevel||(hasRequiredLoglevel=1,(function(V){(function(j,U){V.exports?V.exports=U():j.log=U()})(loglevel,function(){var j=function(){},U="undefined",F=typeof window!==U&&typeof window.navigator!==U&&/Trident\/|MSIE /.test(window.navigator.userAgent),B=["trace","debug","info","warn","error"],q={},z=null;function G(se,de){var oe=se[de];if(typeof oe.bind=="function")return oe.bind(se);try{return Function.prototype.bind.call(oe,se)}catch{return function(){return Function.prototype.apply.apply(oe,[se,arguments])}}}function Y(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function Q(se){return se==="debug"&&(se="log"),typeof console===U?!1:se==="trace"&&F?Y:console[se]!==void 0?G(console,se):console.log!==void 0?G(console,"log"):j}function W(){for(var se=this.getLevel(),de=0;de<B.length;de++){var oe=B[de];this[oe]=de<se?j:this.methodFactory(oe,se,this.name)}if(this.log=this.debug,typeof console===U&&se<this.levels.SILENT)return"No console available for logging"}function Z(se){return function(){typeof console!==U&&(W.call(this),this[se].apply(this,arguments))}}function ee(se,de,oe){return Q(se)||Z.apply(this,arguments)}function ne(se,de){var oe=this,ue,he,ye,fe="loglevel";typeof se=="string"?fe+=":"+se:typeof se=="symbol"&&(fe=void 0);function pe(be){var Le=(B[be]||"silent").toUpperCase();if(!(typeof window===U||!fe)){try{window.localStorage[fe]=Le;return}catch{}try{window.document.cookie=encodeURIComponent(fe)+"="+Le+";"}catch{}}}function xe(){var be;if(!(typeof window===U||!fe)){try{be=window.localStorage[fe]}catch{}if(typeof be===U)try{var Le=window.document.cookie,Fe=encodeURIComponent(fe),Ne=Le.indexOf(Fe+"=");Ne!==-1&&(be=/^([^;]+)/.exec(Le.slice(Ne+Fe.length+1))[1])}catch{}return oe.levels[be]===void 0&&(be=void 0),be}}function Ee(){if(!(typeof window===U||!fe)){try{window.localStorage.removeItem(fe)}catch{}try{window.document.cookie=encodeURIComponent(fe)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function ke(be){var Le=be;if(typeof Le=="string"&&oe.levels[Le.toUpperCase()]!==void 0&&(Le=oe.levels[Le.toUpperCase()]),typeof Le=="number"&&Le>=0&&Le<=oe.levels.SILENT)return Le;throw new TypeError("log.setLevel() called with invalid level: "+be)}oe.name=se,oe.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},oe.methodFactory=de||ee,oe.getLevel=function(){return ye??he??ue},oe.setLevel=function(be,Le){return ye=ke(be),Le!==!1&&pe(ye),W.call(oe)},oe.setDefaultLevel=function(be){he=ke(be),xe()||oe.setLevel(be,!1)},oe.resetLevel=function(){ye=null,Ee(),W.call(oe)},oe.enableAll=function(be){oe.setLevel(oe.levels.TRACE,be)},oe.disableAll=function(be){oe.setLevel(oe.levels.SILENT,be)},oe.rebuild=function(){if(z!==oe&&(ue=ke(z.getLevel())),W.call(oe),z===oe)for(var be in q)q[be].rebuild()},ue=ke(z?z.getLevel():"WARN");var Ae=xe();Ae!=null&&(ye=ke(Ae)),W.call(oe)}z=new ne,z.getLogger=function(de){if(typeof de!="symbol"&&typeof de!="string"||de==="")throw new TypeError("You must supply a name when creating a logger.");var oe=q[de];return oe||(oe=q[de]=new ne(de,z.methodFactory)),oe};var ae=typeof window!==U?window.log:void 0;return z.noConflict=function(){return typeof window!==U&&window.log===z&&(window.log=ae),z},z.getLoggers=function(){return q},z.default=z,z})})(loglevel$1)),loglevel$1.exports}var loglevelExports=requireLoglevel(),LogLevel;(function(V){V[V.trace=0]="trace",V[V.debug=1]="debug",V[V.info=2]="info",V[V.warn=3]="warn",V[V.error=4]="error",V[V.silent=5]="silent"})(LogLevel||(LogLevel={}));var LoggerNames;(function(V){V.Default="livekit",V.Room="livekit-room",V.Participant="livekit-participant",V.Track="livekit-track",V.Publication="livekit-track-publication",V.Engine="livekit-engine",V.Signal="livekit-signal",V.PCManager="livekit-pc-manager",V.PCTransport="livekit-pc-transport",V.E2EE="lk-e2ee"})(LoggerNames||(LoggerNames={}));let livekitLogger=loglevelExports.getLogger("livekit");Object.values(LoggerNames).map(V=>loglevelExports.getLogger(V)),livekitLogger.setDefaultLevel(LogLevel.info);function getLogger(V){const j=loglevelExports.getLogger(V);return j.setDefaultLevel(livekitLogger.getLevel()),j}const workerLogger=loglevelExports.getLogger("lk-e2ee"),maxRetryDelay=7e3,DEFAULT_RETRY_DELAYS_IN_MS=[0,300,4*300,9*300,16*300,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay];class DefaultReconnectPolicy{constructor(j){this._retryDelays=j!==void 0?[...j]:DEFAULT_RETRY_DELAYS_IN_MS}nextRetryDelayInMs(j){if(j.retryCount>=this._retryDelays.length)return null;const U=this._retryDelays[j.retryCount];return j.retryCount<=1?U:U+Math.random()*1e3}}function __rest(V,j){var U={};for(var F in V)Object.prototype.hasOwnProperty.call(V,F)&&j.indexOf(F)<0&&(U[F]=V[F]);if(V!=null&&typeof Object.getOwnPropertySymbols=="function")for(var B=0,F=Object.getOwnPropertySymbols(V);B<F.length;B++)j.indexOf(F[B])<0&&Object.prototype.propertyIsEnumerable.call(V,F[B])&&(U[F[B]]=V[F[B]]);return U}function __awaiter$1(V,j,U,F){function B(q){return q instanceof U?q:new U(function(z){z(q)})}return new(U||(U=Promise))(function(q,z){function G(W){try{Q(F.next(W))}catch(Z){z(Z)}}function Y(W){try{Q(F.throw(W))}catch(Z){z(Z)}}function Q(W){W.done?q(W.value):B(W.value).then(G,Y)}Q((F=F.apply(V,j||[])).next())})}function __values(V){var j=typeof Symbol=="function"&&Symbol.iterator,U=j&&V[j],F=0;if(U)return U.call(V);if(V&&typeof V.length=="number")return{next:function(){return V&&F>=V.length&&(V=void 0),{value:V&&V[F++],done:!V}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}function __asyncValues(V){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var j=V[Symbol.asyncIterator],U;return j?j.call(V):(V=typeof __values=="function"?__values(V):V[Symbol.iterator](),U={},F("next"),F("throw"),F("return"),U[Symbol.asyncIterator]=function(){return this},U);function F(q){U[q]=V[q]&&function(z){return new Promise(function(G,Y){z=V[q](z),B(G,Y,z.done,z.value)})}}function B(q,z,G,Y){Promise.resolve(Y).then(function(Q){q({value:Q,done:G})},z)}}typeof SuppressedError=="function"&&SuppressedError;var events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var V=typeof Reflect=="object"?Reflect:null,j=V&&typeof V.apply=="function"?V.apply:function(fe,pe,xe){return Function.prototype.apply.call(fe,pe,xe)},U;V&&typeof V.ownKeys=="function"?U=V.ownKeys:Object.getOwnPropertySymbols?U=function(fe){return Object.getOwnPropertyNames(fe).concat(Object.getOwnPropertySymbols(fe))}:U=function(fe){return Object.getOwnPropertyNames(fe)};function F(ye){console&&console.warn&&console.warn(ye)}var B=Number.isNaN||function(fe){return fe!==fe};function q(){q.init.call(this)}events.exports=q,events.exports.once=oe,q.EventEmitter=q,q.prototype._events=void 0,q.prototype._eventsCount=0,q.prototype._maxListeners=void 0;var z=10;function G(ye){if(typeof ye!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ye)}Object.defineProperty(q,"defaultMaxListeners",{enumerable:!0,get:function(){return z},set:function(ye){if(typeof ye!="number"||ye<0||B(ye))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ye+".");z=ye}}),q.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},q.prototype.setMaxListeners=function(fe){if(typeof fe!="number"||fe<0||B(fe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+fe+".");return this._maxListeners=fe,this};function Y(ye){return ye._maxListeners===void 0?q.defaultMaxListeners:ye._maxListeners}q.prototype.getMaxListeners=function(){return Y(this)},q.prototype.emit=function(fe){for(var pe=[],xe=1;xe<arguments.length;xe++)pe.push(arguments[xe]);var Ee=fe==="error",ke=this._events;if(ke!==void 0)Ee=Ee&&ke.error===void 0;else if(!Ee)return!1;if(Ee){var Ae;if(pe.length>0&&(Ae=pe[0]),Ae instanceof Error)throw Ae;var be=new Error("Unhandled error."+(Ae?" ("+Ae.message+")":""));throw be.context=Ae,be}var Le=ke[fe];if(Le===void 0)return!1;if(typeof Le=="function")j(Le,this,pe);else for(var Fe=Le.length,Ne=ae(Le,Fe),xe=0;xe<Fe;++xe)j(Ne[xe],this,pe);return!0};function Q(ye,fe,pe,xe){var Ee,ke,Ae;if(G(pe),ke=ye._events,ke===void 0?(ke=ye._events=Object.create(null),ye._eventsCount=0):(ke.newListener!==void 0&&(ye.emit("newListener",fe,pe.listener?pe.listener:pe),ke=ye._events),Ae=ke[fe]),Ae===void 0)Ae=ke[fe]=pe,++ye._eventsCount;else if(typeof Ae=="function"?Ae=ke[fe]=xe?[pe,Ae]:[Ae,pe]:xe?Ae.unshift(pe):Ae.push(pe),Ee=Y(ye),Ee>0&&Ae.length>Ee&&!Ae.warned){Ae.warned=!0;var be=new Error("Possible EventEmitter memory leak detected. "+Ae.length+" "+String(fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");be.name="MaxListenersExceededWarning",be.emitter=ye,be.type=fe,be.count=Ae.length,F(be)}return ye}q.prototype.addListener=function(fe,pe){return Q(this,fe,pe,!1)},q.prototype.on=q.prototype.addListener,q.prototype.prependListener=function(fe,pe){return Q(this,fe,pe,!0)};function W(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Z(ye,fe,pe){var xe={fired:!1,wrapFn:void 0,target:ye,type:fe,listener:pe},Ee=W.bind(xe);return Ee.listener=pe,xe.wrapFn=Ee,Ee}q.prototype.once=function(fe,pe){return G(pe),this.on(fe,Z(this,fe,pe)),this},q.prototype.prependOnceListener=function(fe,pe){return G(pe),this.prependListener(fe,Z(this,fe,pe)),this},q.prototype.removeListener=function(fe,pe){var xe,Ee,ke,Ae,be;if(G(pe),Ee=this._events,Ee===void 0)return this;if(xe=Ee[fe],xe===void 0)return this;if(xe===pe||xe.listener===pe)--this._eventsCount===0?this._events=Object.create(null):(delete Ee[fe],Ee.removeListener&&this.emit("removeListener",fe,xe.listener||pe));else if(typeof xe!="function"){for(ke=-1,Ae=xe.length-1;Ae>=0;Ae--)if(xe[Ae]===pe||xe[Ae].listener===pe){be=xe[Ae].listener,ke=Ae;break}if(ke<0)return this;ke===0?xe.shift():se(xe,ke),xe.length===1&&(Ee[fe]=xe[0]),Ee.removeListener!==void 0&&this.emit("removeListener",fe,be||pe)}return this},q.prototype.off=q.prototype.removeListener,q.prototype.removeAllListeners=function(fe){var pe,xe,Ee;if(xe=this._events,xe===void 0)return this;if(xe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xe[fe]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete xe[fe]),this;if(arguments.length===0){var ke=Object.keys(xe),Ae;for(Ee=0;Ee<ke.length;++Ee)Ae=ke[Ee],Ae!=="removeListener"&&this.removeAllListeners(Ae);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(pe=xe[fe],typeof pe=="function")this.removeListener(fe,pe);else if(pe!==void 0)for(Ee=pe.length-1;Ee>=0;Ee--)this.removeListener(fe,pe[Ee]);return this};function ee(ye,fe,pe){var xe=ye._events;if(xe===void 0)return[];var Ee=xe[fe];return Ee===void 0?[]:typeof Ee=="function"?pe?[Ee.listener||Ee]:[Ee]:pe?de(Ee):ae(Ee,Ee.length)}q.prototype.listeners=function(fe){return ee(this,fe,!0)},q.prototype.rawListeners=function(fe){return ee(this,fe,!1)},q.listenerCount=function(ye,fe){return typeof ye.listenerCount=="function"?ye.listenerCount(fe):ne.call(ye,fe)},q.prototype.listenerCount=ne;function ne(ye){var fe=this._events;if(fe!==void 0){var pe=fe[ye];if(typeof pe=="function")return 1;if(pe!==void 0)return pe.length}return 0}q.prototype.eventNames=function(){return this._eventsCount>0?U(this._events):[]};function ae(ye,fe){for(var pe=new Array(fe),xe=0;xe<fe;++xe)pe[xe]=ye[xe];return pe}function se(ye,fe){for(;fe+1<ye.length;fe++)ye[fe]=ye[fe+1];ye.pop()}function de(ye){for(var fe=new Array(ye.length),pe=0;pe<fe.length;++pe)fe[pe]=ye[pe].listener||ye[pe];return fe}function oe(ye,fe){return new Promise(function(pe,xe){function Ee(Ae){ye.removeListener(fe,ke),xe(Ae)}function ke(){typeof ye.removeListener=="function"&&ye.removeListener("error",Ee),pe([].slice.call(arguments))}he(ye,fe,ke,{once:!0}),fe!=="error"&&ue(ye,Ee,{once:!0})})}function ue(ye,fe,pe){typeof ye.on=="function"&&he(ye,"error",fe,pe)}function he(ye,fe,pe,xe){if(typeof ye.on=="function")xe.once?ye.once(fe,pe):ye.on(fe,pe);else if(typeof ye.addEventListener=="function")ye.addEventListener(fe,function Ee(ke){xe.once&&ye.removeEventListener(fe,Ee),pe(ke)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ye)}return events.exports}var eventsExports=requireEvents();let logDisabled_=!0,deprecationWarnings_=!0;function extractVersion(V,j,U){const F=V.match(j);return F&&F.length>=U&&parseFloat(F[U],10)}function wrapPeerConnectionEvent(V,j,U){if(!V.RTCPeerConnection)return;const F=V.RTCPeerConnection.prototype,B=F.addEventListener;F.addEventListener=function(z,G){if(z!==j)return B.apply(this,arguments);const Y=Q=>{const W=U(Q);W&&(G.handleEvent?G.handleEvent(W):G(W))};return this._eventMap=this._eventMap||{},this._eventMap[j]||(this._eventMap[j]=new Map),this._eventMap[j].set(G,Y),B.apply(this,[z,Y])};const q=F.removeEventListener;F.removeEventListener=function(z,G){if(z!==j||!this._eventMap||!this._eventMap[j])return q.apply(this,arguments);if(!this._eventMap[j].has(G))return q.apply(this,arguments);const Y=this._eventMap[j].get(G);return this._eventMap[j].delete(G),this._eventMap[j].size===0&&delete this._eventMap[j],Object.keys(this._eventMap).length===0&&delete this._eventMap,q.apply(this,[z,Y])},Object.defineProperty(F,"on"+j,{get(){return this["_on"+j]},set(z){this["_on"+j]&&(this.removeEventListener(j,this["_on"+j]),delete this["_on"+j]),z&&this.addEventListener(j,this["_on"+j]=z)},enumerable:!0,configurable:!0})}function disableLog(V){return typeof V!="boolean"?new Error("Argument type: "+typeof V+". Please use a boolean."):(logDisabled_=V,V?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(V){return typeof V!="boolean"?new Error("Argument type: "+typeof V+". Please use a boolean."):(deprecationWarnings_=!V,"adapter.js deprecation warnings "+(V?"disabled":"enabled"))}function log(){if(typeof window=="object"){if(logDisabled_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function deprecated(V,j){deprecationWarnings_&&console.warn(V+" is deprecated, please use "+j+" instead.")}function detectBrowser(V){const j={browser:null,version:null};if(typeof V>"u"||!V.navigator||!V.navigator.userAgent)return j.browser="Not a browser.",j;const{navigator:U}=V;if(U.userAgentData&&U.userAgentData.brands){const F=U.userAgentData.brands.find(B=>B.brand==="Chromium");if(F)return{browser:"chrome",version:parseInt(F.version,10)}}if(U.mozGetUserMedia)j.browser="firefox",j.version=parseInt(extractVersion(U.userAgent,/Firefox\/(\d+)\./,1));else if(U.webkitGetUserMedia||V.isSecureContext===!1&&V.webkitRTCPeerConnection)j.browser="chrome",j.version=parseInt(extractVersion(U.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(V.RTCPeerConnection&&U.userAgent.match(/AppleWebKit\/(\d+)\./))j.browser="safari",j.version=parseInt(extractVersion(U.userAgent,/AppleWebKit\/(\d+)\./,1)),j.supportsUnifiedPlan=V.RTCRtpTransceiver&&"currentDirection"in V.RTCRtpTransceiver.prototype,j._safariVersion=extractVersion(U.userAgent,/Version\/(\d+(\.?\d+))/,1);else return j.browser="Not a supported browser.",j;return j}function isObject$3(V){return Object.prototype.toString.call(V)==="[object Object]"}function compactObject(V){return isObject$3(V)?Object.keys(V).reduce(function(j,U){const F=isObject$3(V[U]),B=F?compactObject(V[U]):V[U],q=F&&!Object.keys(B).length;return B===void 0||q?j:Object.assign(j,{[U]:B})},{}):V}function walkStats(V,j,U){!j||U.has(j.id)||(U.set(j.id,j),Object.keys(j).forEach(F=>{F.endsWith("Id")?walkStats(V,V.get(j[F]),U):F.endsWith("Ids")&&j[F].forEach(B=>{walkStats(V,V.get(B),U)})}))}function filterStats(V,j,U){const F=U?"outbound-rtp":"inbound-rtp",B=new Map;if(j===null)return B;const q=[];return V.forEach(z=>{z.type==="track"&&z.trackIdentifier===j.id&&q.push(z)}),q.forEach(z=>{V.forEach(G=>{G.type===F&&G.trackId===z.id&&walkStats(V,G,B)})}),B}const logging=log;function shimGetUserMedia$2(V,j){const U=V&&V.navigator;if(!U.mediaDevices)return;const F=function(G){if(typeof G!="object"||G.mandatory||G.optional)return G;const Y={};return Object.keys(G).forEach(Q=>{if(Q==="require"||Q==="advanced"||Q==="mediaSource")return;const W=typeof G[Q]=="object"?G[Q]:{ideal:G[Q]};W.exact!==void 0&&typeof W.exact=="number"&&(W.min=W.max=W.exact);const Z=function(ee,ne){return ee?ee+ne.charAt(0).toUpperCase()+ne.slice(1):ne==="deviceId"?"sourceId":ne};if(W.ideal!==void 0){Y.optional=Y.optional||[];let ee={};typeof W.ideal=="number"?(ee[Z("min",Q)]=W.ideal,Y.optional.push(ee),ee={},ee[Z("max",Q)]=W.ideal,Y.optional.push(ee)):(ee[Z("",Q)]=W.ideal,Y.optional.push(ee))}W.exact!==void 0&&typeof W.exact!="number"?(Y.mandatory=Y.mandatory||{},Y.mandatory[Z("",Q)]=W.exact):["min","max"].forEach(ee=>{W[ee]!==void 0&&(Y.mandatory=Y.mandatory||{},Y.mandatory[Z(ee,Q)]=W[ee])})}),G.advanced&&(Y.optional=(Y.optional||[]).concat(G.advanced)),Y},B=function(G,Y){if(j.version>=61)return Y(G);if(G=JSON.parse(JSON.stringify(G)),G&&typeof G.audio=="object"){const Q=function(W,Z,ee){Z in W&&!(ee in W)&&(W[ee]=W[Z],delete W[Z])};G=JSON.parse(JSON.stringify(G)),Q(G.audio,"autoGainControl","googAutoGainControl"),Q(G.audio,"noiseSuppression","googNoiseSuppression"),G.audio=F(G.audio)}if(G&&typeof G.video=="object"){let Q=G.video.facingMode;Q=Q&&(typeof Q=="object"?Q:{ideal:Q});const W=j.version<66;if(Q&&(Q.exact==="user"||Q.exact==="environment"||Q.ideal==="user"||Q.ideal==="environment")&&!(U.mediaDevices.getSupportedConstraints&&U.mediaDevices.getSupportedConstraints().facingMode&&!W)){delete G.video.facingMode;let Z;if(Q.exact==="environment"||Q.ideal==="environment"?Z=["back","rear"]:(Q.exact==="user"||Q.ideal==="user")&&(Z=["front"]),Z)return U.mediaDevices.enumerateDevices().then(ee=>{ee=ee.filter(ae=>ae.kind==="videoinput");let ne=ee.find(ae=>Z.some(se=>ae.label.toLowerCase().includes(se)));return!ne&&ee.length&&Z.includes("back")&&(ne=ee[ee.length-1]),ne&&(G.video.deviceId=Q.exact?{exact:ne.deviceId}:{ideal:ne.deviceId}),G.video=F(G.video),logging("chrome: "+JSON.stringify(G)),Y(G)})}G.video=F(G.video)}return logging("chrome: "+JSON.stringify(G)),Y(G)},q=function(G){return j.version>=64?G:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[G.name]||G.name,message:G.message,constraint:G.constraint||G.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},z=function(G,Y,Q){B(G,W=>{U.webkitGetUserMedia(W,Y,Z=>{Q&&Q(q(Z))})})};if(U.getUserMedia=z.bind(U),U.mediaDevices.getUserMedia){const G=U.mediaDevices.getUserMedia.bind(U.mediaDevices);U.mediaDevices.getUserMedia=function(Y){return B(Y,Q=>G(Q).then(W=>{if(Q.audio&&!W.getAudioTracks().length||Q.video&&!W.getVideoTracks().length)throw W.getTracks().forEach(Z=>{Z.stop()}),new DOMException("","NotFoundError");return W},W=>Promise.reject(q(W))))}}}function shimMediaStream(V){V.MediaStream=V.MediaStream||V.webkitMediaStream}function shimOnTrack$1(V){if(typeof V=="object"&&V.RTCPeerConnection&&!("ontrack"in V.RTCPeerConnection.prototype)){Object.defineProperty(V.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(U){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=U)},enumerable:!0,configurable:!0});const j=V.RTCPeerConnection.prototype.setRemoteDescription;V.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=F=>{F.stream.addEventListener("addtrack",B=>{let q;V.RTCPeerConnection.prototype.getReceivers?q=this.getReceivers().find(G=>G.track&&G.track.id===B.track.id):q={track:B.track};const z=new Event("track");z.track=B.track,z.receiver=q,z.transceiver={receiver:q},z.streams=[F.stream],this.dispatchEvent(z)}),F.stream.getTracks().forEach(B=>{let q;V.RTCPeerConnection.prototype.getReceivers?q=this.getReceivers().find(G=>G.track&&G.track.id===B.id):q={track:B};const z=new Event("track");z.track=B,z.receiver=q,z.transceiver={receiver:q},z.streams=[F.stream],this.dispatchEvent(z)})},this.addEventListener("addstream",this._ontrackpoly)),j.apply(this,arguments)}}else wrapPeerConnectionEvent(V,"track",j=>(j.transceiver||Object.defineProperty(j,"transceiver",{value:{receiver:j.receiver}}),j))}function shimGetSendersWithDtmf(V){if(typeof V=="object"&&V.RTCPeerConnection&&!("getSenders"in V.RTCPeerConnection.prototype)&&"createDTMFSender"in V.RTCPeerConnection.prototype){const j=function(B,q){return{track:q,get dtmf(){return this._dtmf===void 0&&(q.kind==="audio"?this._dtmf=B.createDTMFSender(q):this._dtmf=null),this._dtmf},_pc:B}};if(!V.RTCPeerConnection.prototype.getSenders){V.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const B=V.RTCPeerConnection.prototype.addTrack;V.RTCPeerConnection.prototype.addTrack=function(G,Y){let Q=B.apply(this,arguments);return Q||(Q=j(this,G),this._senders.push(Q)),Q};const q=V.RTCPeerConnection.prototype.removeTrack;V.RTCPeerConnection.prototype.removeTrack=function(G){q.apply(this,arguments);const Y=this._senders.indexOf(G);Y!==-1&&this._senders.splice(Y,1)}}const U=V.RTCPeerConnection.prototype.addStream;V.RTCPeerConnection.prototype.addStream=function(q){this._senders=this._senders||[],U.apply(this,[q]),q.getTracks().forEach(z=>{this._senders.push(j(this,z))})};const F=V.RTCPeerConnection.prototype.removeStream;V.RTCPeerConnection.prototype.removeStream=function(q){this._senders=this._senders||[],F.apply(this,[q]),q.getTracks().forEach(z=>{const G=this._senders.find(Y=>Y.track===z);G&&this._senders.splice(this._senders.indexOf(G),1)})}}else if(typeof V=="object"&&V.RTCPeerConnection&&"getSenders"in V.RTCPeerConnection.prototype&&"createDTMFSender"in V.RTCPeerConnection.prototype&&V.RTCRtpSender&&!("dtmf"in V.RTCRtpSender.prototype)){const j=V.RTCPeerConnection.prototype.getSenders;V.RTCPeerConnection.prototype.getSenders=function(){const F=j.apply(this,[]);return F.forEach(B=>B._pc=this),F},Object.defineProperty(V.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimSenderReceiverGetStats(V){if(!(typeof V=="object"&&V.RTCPeerConnection&&V.RTCRtpSender&&V.RTCRtpReceiver))return;if(!("getStats"in V.RTCRtpSender.prototype)){const U=V.RTCPeerConnection.prototype.getSenders;U&&(V.RTCPeerConnection.prototype.getSenders=function(){const q=U.apply(this,[]);return q.forEach(z=>z._pc=this),q});const F=V.RTCPeerConnection.prototype.addTrack;F&&(V.RTCPeerConnection.prototype.addTrack=function(){const q=F.apply(this,arguments);return q._pc=this,q}),V.RTCRtpSender.prototype.getStats=function(){const q=this;return this._pc.getStats().then(z=>filterStats(z,q.track,!0))}}if(!("getStats"in V.RTCRtpReceiver.prototype)){const U=V.RTCPeerConnection.prototype.getReceivers;U&&(V.RTCPeerConnection.prototype.getReceivers=function(){const B=U.apply(this,[]);return B.forEach(q=>q._pc=this),B}),wrapPeerConnectionEvent(V,"track",F=>(F.receiver._pc=F.srcElement,F)),V.RTCRtpReceiver.prototype.getStats=function(){const B=this;return this._pc.getStats().then(q=>filterStats(q,B.track,!1))}}if(!("getStats"in V.RTCRtpSender.prototype&&"getStats"in V.RTCRtpReceiver.prototype))return;const j=V.RTCPeerConnection.prototype.getStats;V.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof V.MediaStreamTrack){const F=arguments[0];let B,q,z;return this.getSenders().forEach(G=>{G.track===F&&(B?z=!0:B=G)}),this.getReceivers().forEach(G=>(G.track===F&&(q?z=!0:q=G),G.track===F)),z||B&&q?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):B?B.getStats():q?q.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return j.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(V){V.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(z=>this._shimmedLocalStreams[z][0])};const j=V.RTCPeerConnection.prototype.addTrack;V.RTCPeerConnection.prototype.addTrack=function(z,G){if(!G)return j.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const Y=j.apply(this,arguments);return this._shimmedLocalStreams[G.id]?this._shimmedLocalStreams[G.id].indexOf(Y)===-1&&this._shimmedLocalStreams[G.id].push(Y):this._shimmedLocalStreams[G.id]=[G,Y],Y};const U=V.RTCPeerConnection.prototype.addStream;V.RTCPeerConnection.prototype.addStream=function(z){this._shimmedLocalStreams=this._shimmedLocalStreams||{},z.getTracks().forEach(Q=>{if(this.getSenders().find(Z=>Z.track===Q))throw new DOMException("Track already exists.","InvalidAccessError")});const G=this.getSenders();U.apply(this,arguments);const Y=this.getSenders().filter(Q=>G.indexOf(Q)===-1);this._shimmedLocalStreams[z.id]=[z].concat(Y)};const F=V.RTCPeerConnection.prototype.removeStream;V.RTCPeerConnection.prototype.removeStream=function(z){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[z.id],F.apply(this,arguments)};const B=V.RTCPeerConnection.prototype.removeTrack;V.RTCPeerConnection.prototype.removeTrack=function(z){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},z&&Object.keys(this._shimmedLocalStreams).forEach(G=>{const Y=this._shimmedLocalStreams[G].indexOf(z);Y!==-1&&this._shimmedLocalStreams[G].splice(Y,1),this._shimmedLocalStreams[G].length===1&&delete this._shimmedLocalStreams[G]}),B.apply(this,arguments)}}function shimAddTrackRemoveTrack(V,j){if(!V.RTCPeerConnection)return;if(V.RTCPeerConnection.prototype.addTrack&&j.version>=65)return shimAddTrackRemoveTrackWithNative(V);const U=V.RTCPeerConnection.prototype.getLocalStreams;V.RTCPeerConnection.prototype.getLocalStreams=function(){const W=U.apply(this);return this._reverseStreams=this._reverseStreams||{},W.map(Z=>this._reverseStreams[Z.id])};const F=V.RTCPeerConnection.prototype.addStream;V.RTCPeerConnection.prototype.addStream=function(W){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},W.getTracks().forEach(Z=>{if(this.getSenders().find(ne=>ne.track===Z))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[W.id]){const Z=new V.MediaStream(W.getTracks());this._streams[W.id]=Z,this._reverseStreams[Z.id]=W,W=Z}F.apply(this,[W])};const B=V.RTCPeerConnection.prototype.removeStream;V.RTCPeerConnection.prototype.removeStream=function(W){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},B.apply(this,[this._streams[W.id]||W]),delete this._reverseStreams[this._streams[W.id]?this._streams[W.id].id:W.id],delete this._streams[W.id]},V.RTCPeerConnection.prototype.addTrack=function(W,Z){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const ee=[].slice.call(arguments,1);if(ee.length!==1||!ee[0].getTracks().find(se=>se===W))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(se=>se.track===W))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const ae=this._streams[Z.id];if(ae)ae.addTrack(W),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const se=new V.MediaStream([W]);this._streams[Z.id]=se,this._reverseStreams[se.id]=Z,this.addStream(se)}return this.getSenders().find(se=>se.track===W)};function q(Q,W){let Z=W.sdp;return Object.keys(Q._reverseStreams||[]).forEach(ee=>{const ne=Q._reverseStreams[ee],ae=Q._streams[ne.id];Z=Z.replace(new RegExp(ae.id,"g"),ne.id)}),new RTCSessionDescription({type:W.type,sdp:Z})}function z(Q,W){let Z=W.sdp;return Object.keys(Q._reverseStreams||[]).forEach(ee=>{const ne=Q._reverseStreams[ee],ae=Q._streams[ne.id];Z=Z.replace(new RegExp(ne.id,"g"),ae.id)}),new RTCSessionDescription({type:W.type,sdp:Z})}["createOffer","createAnswer"].forEach(function(Q){const W=V.RTCPeerConnection.prototype[Q],Z={[Q](){const ee=arguments;return arguments.length&&typeof arguments[0]=="function"?W.apply(this,[ae=>{const se=q(this,ae);ee[0].apply(null,[se])},ae=>{ee[1]&&ee[1].apply(null,ae)},arguments[2]]):W.apply(this,arguments).then(ae=>q(this,ae))}};V.RTCPeerConnection.prototype[Q]=Z[Q]});const G=V.RTCPeerConnection.prototype.setLocalDescription;V.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?G.apply(this,arguments):(arguments[0]=z(this,arguments[0]),G.apply(this,arguments))};const Y=Object.getOwnPropertyDescriptor(V.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(V.RTCPeerConnection.prototype,"localDescription",{get(){const Q=Y.get.apply(this);return Q.type===""?Q:q(this,Q)}}),V.RTCPeerConnection.prototype.removeTrack=function(W){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!W._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(W._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let ee;Object.keys(this._streams).forEach(ne=>{this._streams[ne].getTracks().find(se=>W.track===se)&&(ee=this._streams[ne])}),ee&&(ee.getTracks().length===1?this.removeStream(this._reverseStreams[ee.id]):ee.removeTrack(W.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection$1(V,j){!V.RTCPeerConnection&&V.webkitRTCPeerConnection&&(V.RTCPeerConnection=V.webkitRTCPeerConnection),V.RTCPeerConnection&&j.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(U){const F=V.RTCPeerConnection.prototype[U],B={[U](){return arguments[0]=new(U==="addIceCandidate"?V.RTCIceCandidate:V.RTCSessionDescription)(arguments[0]),F.apply(this,arguments)}};V.RTCPeerConnection.prototype[U]=B[U]})}function fixNegotiationNeeded(V,j){wrapPeerConnectionEvent(V,"negotiationneeded",U=>{const F=U.target;if(!((j.version<72||F.getConfiguration&&F.getConfiguration().sdpSemantics==="plan-b")&&F.signalingState!=="stable"))return U})}var chromeShim=Object.freeze({__proto__:null,fixNegotiationNeeded,shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative,shimGetSendersWithDtmf,shimGetUserMedia:shimGetUserMedia$2,shimMediaStream,shimOnTrack:shimOnTrack$1,shimPeerConnection:shimPeerConnection$1,shimSenderReceiverGetStats});function shimGetUserMedia$1(V,j){const U=V&&V.navigator,F=V&&V.MediaStreamTrack;if(U.getUserMedia=function(B,q,z){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),U.mediaDevices.getUserMedia(B).then(q,z)},!(j.version>55&&"autoGainControl"in U.mediaDevices.getSupportedConstraints())){const B=function(z,G,Y){G in z&&!(Y in z)&&(z[Y]=z[G],delete z[G])},q=U.mediaDevices.getUserMedia.bind(U.mediaDevices);if(U.mediaDevices.getUserMedia=function(z){return typeof z=="object"&&typeof z.audio=="object"&&(z=JSON.parse(JSON.stringify(z)),B(z.audio,"autoGainControl","mozAutoGainControl"),B(z.audio,"noiseSuppression","mozNoiseSuppression")),q(z)},F&&F.prototype.getSettings){const z=F.prototype.getSettings;F.prototype.getSettings=function(){const G=z.apply(this,arguments);return B(G,"mozAutoGainControl","autoGainControl"),B(G,"mozNoiseSuppression","noiseSuppression"),G}}if(F&&F.prototype.applyConstraints){const z=F.prototype.applyConstraints;F.prototype.applyConstraints=function(G){return this.kind==="audio"&&typeof G=="object"&&(G=JSON.parse(JSON.stringify(G)),B(G,"autoGainControl","mozAutoGainControl"),B(G,"noiseSuppression","mozNoiseSuppression")),z.apply(this,[G])}}}}function shimGetDisplayMedia(V,j){V.navigator.mediaDevices&&"getDisplayMedia"in V.navigator.mediaDevices||V.navigator.mediaDevices&&(V.navigator.mediaDevices.getDisplayMedia=function(F){if(!(F&&F.video)){const B=new DOMException("getDisplayMedia without video constraints is undefined");return B.name="NotFoundError",B.code=8,Promise.reject(B)}return F.video===!0?F.video={mediaSource:j}:F.video.mediaSource=j,V.navigator.mediaDevices.getUserMedia(F)})}function shimOnTrack(V){typeof V=="object"&&V.RTCTrackEvent&&"receiver"in V.RTCTrackEvent.prototype&&!("transceiver"in V.RTCTrackEvent.prototype)&&Object.defineProperty(V.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimPeerConnection(V,j){if(typeof V!="object"||!(V.RTCPeerConnection||V.mozRTCPeerConnection))return;!V.RTCPeerConnection&&V.mozRTCPeerConnection&&(V.RTCPeerConnection=V.mozRTCPeerConnection),j.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(B){const q=V.RTCPeerConnection.prototype[B],z={[B](){return arguments[0]=new(B==="addIceCandidate"?V.RTCIceCandidate:V.RTCSessionDescription)(arguments[0]),q.apply(this,arguments)}};V.RTCPeerConnection.prototype[B]=z[B]});const U={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},F=V.RTCPeerConnection.prototype.getStats;V.RTCPeerConnection.prototype.getStats=function(){const[q,z,G]=arguments;return F.apply(this,[q||null]).then(Y=>{if(j.version<53&&!z)try{Y.forEach(Q=>{Q.type=U[Q.type]||Q.type})}catch(Q){if(Q.name!=="TypeError")throw Q;Y.forEach((W,Z)=>{Y.set(Z,Object.assign({},W,{type:U[W.type]||W.type}))})}return Y}).then(z,G)}}function shimSenderGetStats(V){if(!(typeof V=="object"&&V.RTCPeerConnection&&V.RTCRtpSender)||V.RTCRtpSender&&"getStats"in V.RTCRtpSender.prototype)return;const j=V.RTCPeerConnection.prototype.getSenders;j&&(V.RTCPeerConnection.prototype.getSenders=function(){const B=j.apply(this,[]);return B.forEach(q=>q._pc=this),B});const U=V.RTCPeerConnection.prototype.addTrack;U&&(V.RTCPeerConnection.prototype.addTrack=function(){const B=U.apply(this,arguments);return B._pc=this,B}),V.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(V){if(!(typeof V=="object"&&V.RTCPeerConnection&&V.RTCRtpSender)||V.RTCRtpSender&&"getStats"in V.RTCRtpReceiver.prototype)return;const j=V.RTCPeerConnection.prototype.getReceivers;j&&(V.RTCPeerConnection.prototype.getReceivers=function(){const F=j.apply(this,[]);return F.forEach(B=>B._pc=this),F}),wrapPeerConnectionEvent(V,"track",U=>(U.receiver._pc=U.srcElement,U)),V.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function shimRemoveStream(V){!V.RTCPeerConnection||"removeStream"in V.RTCPeerConnection.prototype||(V.RTCPeerConnection.prototype.removeStream=function(U){deprecated("removeStream","removeTrack"),this.getSenders().forEach(F=>{F.track&&U.getTracks().includes(F.track)&&this.removeTrack(F)})})}function shimRTCDataChannel(V){V.DataChannel&&!V.RTCDataChannel&&(V.RTCDataChannel=V.DataChannel)}function shimAddTransceiver(V){if(!(typeof V=="object"&&V.RTCPeerConnection))return;const j=V.RTCPeerConnection.prototype.addTransceiver;j&&(V.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let F=arguments[1]&&arguments[1].sendEncodings;F===void 0&&(F=[]),F=[...F];const B=F.length>0;B&&F.forEach(z=>{if("rid"in z&&!/^[a-z0-9]{0,16}$/i.test(z.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in z&&!(parseFloat(z.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in z&&!(parseFloat(z.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const q=j.apply(this,arguments);if(B){const{sender:z}=q,G=z.getParameters();(!("encodings"in G)||G.encodings.length===1&&Object.keys(G.encodings[0]).length===0)&&(G.encodings=F,z.sendEncodings=F,this.setParametersPromises.push(z.setParameters(G).then(()=>{delete z.sendEncodings}).catch(()=>{delete z.sendEncodings})))}return q})}function shimGetParameters(V){if(!(typeof V=="object"&&V.RTCRtpSender))return;const j=V.RTCRtpSender.prototype.getParameters;j&&(V.RTCRtpSender.prototype.getParameters=function(){const F=j.apply(this,arguments);return"encodings"in F||(F.encodings=[].concat(this.sendEncodings||[{}])),F})}function shimCreateOffer(V){if(!(typeof V=="object"&&V.RTCPeerConnection))return;const j=V.RTCPeerConnection.prototype.createOffer;V.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>j.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):j.apply(this,arguments)}}function shimCreateAnswer(V){if(!(typeof V=="object"&&V.RTCPeerConnection))return;const j=V.RTCPeerConnection.prototype.createAnswer;V.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>j.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):j.apply(this,arguments)}}var firefoxShim=Object.freeze({__proto__:null,shimAddTransceiver,shimCreateAnswer,shimCreateOffer,shimGetDisplayMedia,shimGetParameters,shimGetUserMedia:shimGetUserMedia$1,shimOnTrack,shimPeerConnection,shimRTCDataChannel,shimReceiverGetStats,shimRemoveStream,shimSenderGetStats});function shimLocalStreamsAPI(V){if(!(typeof V!="object"||!V.RTCPeerConnection)){if("getLocalStreams"in V.RTCPeerConnection.prototype||(V.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in V.RTCPeerConnection.prototype)){const j=V.RTCPeerConnection.prototype.addTrack;V.RTCPeerConnection.prototype.addStream=function(F){this._localStreams||(this._localStreams=[]),this._localStreams.includes(F)||this._localStreams.push(F),F.getAudioTracks().forEach(B=>j.call(this,B,F)),F.getVideoTracks().forEach(B=>j.call(this,B,F))},V.RTCPeerConnection.prototype.addTrack=function(F){for(var B=arguments.length,q=new Array(B>1?B-1:0),z=1;z<B;z++)q[z-1]=arguments[z];return q&&q.forEach(G=>{this._localStreams?this._localStreams.includes(G)||this._localStreams.push(G):this._localStreams=[G]}),j.apply(this,arguments)}}"removeStream"in V.RTCPeerConnection.prototype||(V.RTCPeerConnection.prototype.removeStream=function(U){this._localStreams||(this._localStreams=[]);const F=this._localStreams.indexOf(U);if(F===-1)return;this._localStreams.splice(F,1);const B=U.getTracks();this.getSenders().forEach(q=>{B.includes(q.track)&&this.removeTrack(q)})})}}function shimRemoteStreamsAPI(V){if(!(typeof V!="object"||!V.RTCPeerConnection)&&("getRemoteStreams"in V.RTCPeerConnection.prototype||(V.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in V.RTCPeerConnection.prototype))){Object.defineProperty(V.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(U){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=U),this.addEventListener("track",this._onaddstreampoly=F=>{F.streams.forEach(B=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(B))return;this._remoteStreams.push(B);const q=new Event("addstream");q.stream=B,this.dispatchEvent(q)})})}});const j=V.RTCPeerConnection.prototype.setRemoteDescription;V.RTCPeerConnection.prototype.setRemoteDescription=function(){const F=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(B){B.streams.forEach(q=>{if(F._remoteStreams||(F._remoteStreams=[]),F._remoteStreams.indexOf(q)>=0)return;F._remoteStreams.push(q);const z=new Event("addstream");z.stream=q,F.dispatchEvent(z)})}),j.apply(F,arguments)}}}function shimCallbacksAPI(V){if(typeof V!="object"||!V.RTCPeerConnection)return;const j=V.RTCPeerConnection.prototype,U=j.createOffer,F=j.createAnswer,B=j.setLocalDescription,q=j.setRemoteDescription,z=j.addIceCandidate;j.createOffer=function(Q,W){const Z=arguments.length>=2?arguments[2]:arguments[0],ee=U.apply(this,[Z]);return W?(ee.then(Q,W),Promise.resolve()):ee},j.createAnswer=function(Q,W){const Z=arguments.length>=2?arguments[2]:arguments[0],ee=F.apply(this,[Z]);return W?(ee.then(Q,W),Promise.resolve()):ee};let G=function(Y,Q,W){const Z=B.apply(this,[Y]);return W?(Z.then(Q,W),Promise.resolve()):Z};j.setLocalDescription=G,G=function(Y,Q,W){const Z=q.apply(this,[Y]);return W?(Z.then(Q,W),Promise.resolve()):Z},j.setRemoteDescription=G,G=function(Y,Q,W){const Z=z.apply(this,[Y]);return W?(Z.then(Q,W),Promise.resolve()):Z},j.addIceCandidate=G}function shimGetUserMedia(V){const j=V&&V.navigator;if(j.mediaDevices&&j.mediaDevices.getUserMedia){const U=j.mediaDevices,F=U.getUserMedia.bind(U);j.mediaDevices.getUserMedia=B=>F(shimConstraints(B))}!j.getUserMedia&&j.mediaDevices&&j.mediaDevices.getUserMedia&&(j.getUserMedia=(function(F,B,q){j.mediaDevices.getUserMedia(F).then(B,q)}).bind(j))}function shimConstraints(V){return V&&V.video!==void 0?Object.assign({},V,{video:compactObject(V.video)}):V}function shimRTCIceServerUrls(V){if(!V.RTCPeerConnection)return;const j=V.RTCPeerConnection;V.RTCPeerConnection=function(F,B){if(F&&F.iceServers){const q=[];for(let z=0;z<F.iceServers.length;z++){let G=F.iceServers[z];G.urls===void 0&&G.url?(deprecated("RTCIceServer.url","RTCIceServer.urls"),G=JSON.parse(JSON.stringify(G)),G.urls=G.url,delete G.url,q.push(G)):q.push(F.iceServers[z])}F.iceServers=q}return new j(F,B)},V.RTCPeerConnection.prototype=j.prototype,"generateCertificate"in j&&Object.defineProperty(V.RTCPeerConnection,"generateCertificate",{get(){return j.generateCertificate}})}function shimTrackEventTransceiver(V){typeof V=="object"&&V.RTCTrackEvent&&"receiver"in V.RTCTrackEvent.prototype&&!("transceiver"in V.RTCTrackEvent.prototype)&&Object.defineProperty(V.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(V){const j=V.RTCPeerConnection.prototype.createOffer;V.RTCPeerConnection.prototype.createOffer=function(F){if(F){typeof F.offerToReceiveAudio<"u"&&(F.offerToReceiveAudio=!!F.offerToReceiveAudio);const B=this.getTransceivers().find(z=>z.receiver.track.kind==="audio");F.offerToReceiveAudio===!1&&B?B.direction==="sendrecv"?B.setDirection?B.setDirection("sendonly"):B.direction="sendonly":B.direction==="recvonly"&&(B.setDirection?B.setDirection("inactive"):B.direction="inactive"):F.offerToReceiveAudio===!0&&!B&&this.addTransceiver("audio",{direction:"recvonly"}),typeof F.offerToReceiveVideo<"u"&&(F.offerToReceiveVideo=!!F.offerToReceiveVideo);const q=this.getTransceivers().find(z=>z.receiver.track.kind==="video");F.offerToReceiveVideo===!1&&q?q.direction==="sendrecv"?q.setDirection?q.setDirection("sendonly"):q.direction="sendonly":q.direction==="recvonly"&&(q.setDirection?q.setDirection("inactive"):q.direction="inactive"):F.offerToReceiveVideo===!0&&!q&&this.addTransceiver("video",{direction:"recvonly"})}return j.apply(this,arguments)}}function shimAudioContext(V){typeof V!="object"||V.AudioContext||(V.AudioContext=V.webkitAudioContext)}var safariShim=Object.freeze({__proto__:null,shimAudioContext,shimCallbacksAPI,shimConstraints,shimCreateOfferLegacy,shimGetUserMedia,shimLocalStreamsAPI,shimRTCIceServerUrls,shimRemoteStreamsAPI,shimTrackEventTransceiver}),sdp$1={exports:{}},hasRequiredSdp;function requireSdp(){return hasRequiredSdp||(hasRequiredSdp=1,(function(V){const j={};j.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},j.localCName=j.generateIdentifier(),j.splitLines=function(U){return U.trim().split(`
`).map(F=>F.trim())},j.splitSections=function(U){return U.split(`
m=`).map((B,q)=>(q>0?"m="+B:B).trim()+`\r
`)},j.getDescription=function(U){const F=j.splitSections(U);return F&&F[0]},j.getMediaSections=function(U){const F=j.splitSections(U);return F.shift(),F},j.matchPrefix=function(U,F){return j.splitLines(U).filter(B=>B.indexOf(F)===0)},j.parseCandidate=function(U){let F;U.indexOf("a=candidate:")===0?F=U.substring(12).split(" "):F=U.substring(10).split(" ");const B={foundation:F[0],component:{1:"rtp",2:"rtcp"}[F[1]]||F[1],protocol:F[2].toLowerCase(),priority:parseInt(F[3],10),ip:F[4],address:F[4],port:parseInt(F[5],10),type:F[7]};for(let q=8;q<F.length;q+=2)switch(F[q]){case"raddr":B.relatedAddress=F[q+1];break;case"rport":B.relatedPort=parseInt(F[q+1],10);break;case"tcptype":B.tcpType=F[q+1];break;case"ufrag":B.ufrag=F[q+1],B.usernameFragment=F[q+1];break;default:B[F[q]]===void 0&&(B[F[q]]=F[q+1]);break}return B},j.writeCandidate=function(U){const F=[];F.push(U.foundation);const B=U.component;B==="rtp"?F.push(1):B==="rtcp"?F.push(2):F.push(B),F.push(U.protocol.toUpperCase()),F.push(U.priority),F.push(U.address||U.ip),F.push(U.port);const q=U.type;return F.push("typ"),F.push(q),q!=="host"&&U.relatedAddress&&U.relatedPort&&(F.push("raddr"),F.push(U.relatedAddress),F.push("rport"),F.push(U.relatedPort)),U.tcpType&&U.protocol.toLowerCase()==="tcp"&&(F.push("tcptype"),F.push(U.tcpType)),(U.usernameFragment||U.ufrag)&&(F.push("ufrag"),F.push(U.usernameFragment||U.ufrag)),"candidate:"+F.join(" ")},j.parseIceOptions=function(U){return U.substring(14).split(" ")},j.parseRtpMap=function(U){let F=U.substring(9).split(" ");const B={payloadType:parseInt(F.shift(),10)};return F=F[0].split("/"),B.name=F[0],B.clockRate=parseInt(F[1],10),B.channels=F.length===3?parseInt(F[2],10):1,B.numChannels=B.channels,B},j.writeRtpMap=function(U){let F=U.payloadType;U.preferredPayloadType!==void 0&&(F=U.preferredPayloadType);const B=U.channels||U.numChannels||1;return"a=rtpmap:"+F+" "+U.name+"/"+U.clockRate+(B!==1?"/"+B:"")+`\r
`},j.parseExtmap=function(U){const F=U.substring(9).split(" ");return{id:parseInt(F[0],10),direction:F[0].indexOf("/")>0?F[0].split("/")[1]:"sendrecv",uri:F[1],attributes:F.slice(2).join(" ")}},j.writeExtmap=function(U){return"a=extmap:"+(U.id||U.preferredId)+(U.direction&&U.direction!=="sendrecv"?"/"+U.direction:"")+" "+U.uri+(U.attributes?" "+U.attributes:"")+`\r
`},j.parseFmtp=function(U){const F={};let B;const q=U.substring(U.indexOf(" ")+1).split(";");for(let z=0;z<q.length;z++)B=q[z].trim().split("="),F[B[0].trim()]=B[1];return F},j.writeFmtp=function(U){let F="",B=U.payloadType;if(U.preferredPayloadType!==void 0&&(B=U.preferredPayloadType),U.parameters&&Object.keys(U.parameters).length){const q=[];Object.keys(U.parameters).forEach(z=>{U.parameters[z]!==void 0?q.push(z+"="+U.parameters[z]):q.push(z)}),F+="a=fmtp:"+B+" "+q.join(";")+`\r
`}return F},j.parseRtcpFb=function(U){const F=U.substring(U.indexOf(" ")+1).split(" ");return{type:F.shift(),parameter:F.join(" ")}},j.writeRtcpFb=function(U){let F="",B=U.payloadType;return U.preferredPayloadType!==void 0&&(B=U.preferredPayloadType),U.rtcpFeedback&&U.rtcpFeedback.length&&U.rtcpFeedback.forEach(q=>{F+="a=rtcp-fb:"+B+" "+q.type+(q.parameter&&q.parameter.length?" "+q.parameter:"")+`\r
`}),F},j.parseSsrcMedia=function(U){const F=U.indexOf(" "),B={ssrc:parseInt(U.substring(7,F),10)},q=U.indexOf(":",F);return q>-1?(B.attribute=U.substring(F+1,q),B.value=U.substring(q+1)):B.attribute=U.substring(F+1),B},j.parseSsrcGroup=function(U){const F=U.substring(13).split(" ");return{semantics:F.shift(),ssrcs:F.map(B=>parseInt(B,10))}},j.getMid=function(U){const F=j.matchPrefix(U,"a=mid:")[0];if(F)return F.substring(6)},j.parseFingerprint=function(U){const F=U.substring(14).split(" ");return{algorithm:F[0].toLowerCase(),value:F[1].toUpperCase()}},j.getDtlsParameters=function(U,F){return{role:"auto",fingerprints:j.matchPrefix(U+F,"a=fingerprint:").map(j.parseFingerprint)}},j.writeDtlsParameters=function(U,F){let B="a=setup:"+F+`\r
`;return U.fingerprints.forEach(q=>{B+="a=fingerprint:"+q.algorithm+" "+q.value+`\r
`}),B},j.parseCryptoLine=function(U){const F=U.substring(9).split(" ");return{tag:parseInt(F[0],10),cryptoSuite:F[1],keyParams:F[2],sessionParams:F.slice(3)}},j.writeCryptoLine=function(U){return"a=crypto:"+U.tag+" "+U.cryptoSuite+" "+(typeof U.keyParams=="object"?j.writeCryptoKeyParams(U.keyParams):U.keyParams)+(U.sessionParams?" "+U.sessionParams.join(" "):"")+`\r
`},j.parseCryptoKeyParams=function(U){if(U.indexOf("inline:")!==0)return null;const F=U.substring(7).split("|");return{keyMethod:"inline",keySalt:F[0],lifeTime:F[1],mkiValue:F[2]?F[2].split(":")[0]:void 0,mkiLength:F[2]?F[2].split(":")[1]:void 0}},j.writeCryptoKeyParams=function(U){return U.keyMethod+":"+U.keySalt+(U.lifeTime?"|"+U.lifeTime:"")+(U.mkiValue&&U.mkiLength?"|"+U.mkiValue+":"+U.mkiLength:"")},j.getCryptoParameters=function(U,F){return j.matchPrefix(U+F,"a=crypto:").map(j.parseCryptoLine)},j.getIceParameters=function(U,F){const B=j.matchPrefix(U+F,"a=ice-ufrag:")[0],q=j.matchPrefix(U+F,"a=ice-pwd:")[0];return B&&q?{usernameFragment:B.substring(12),password:q.substring(10)}:null},j.writeIceParameters=function(U){let F="a=ice-ufrag:"+U.usernameFragment+`\r
a=ice-pwd:`+U.password+`\r
`;return U.iceLite&&(F+=`a=ice-lite\r
`),F},j.parseRtpParameters=function(U){const F={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},q=j.splitLines(U)[0].split(" ");F.profile=q[2];for(let G=3;G<q.length;G++){const Y=q[G],Q=j.matchPrefix(U,"a=rtpmap:"+Y+" ")[0];if(Q){const W=j.parseRtpMap(Q),Z=j.matchPrefix(U,"a=fmtp:"+Y+" ");switch(W.parameters=Z.length?j.parseFmtp(Z[0]):{},W.rtcpFeedback=j.matchPrefix(U,"a=rtcp-fb:"+Y+" ").map(j.parseRtcpFb),F.codecs.push(W),W.name.toUpperCase()){case"RED":case"ULPFEC":F.fecMechanisms.push(W.name.toUpperCase());break}}}j.matchPrefix(U,"a=extmap:").forEach(G=>{F.headerExtensions.push(j.parseExtmap(G))});const z=j.matchPrefix(U,"a=rtcp-fb:* ").map(j.parseRtcpFb);return F.codecs.forEach(G=>{z.forEach(Y=>{G.rtcpFeedback.find(W=>W.type===Y.type&&W.parameter===Y.parameter)||G.rtcpFeedback.push(Y)})}),F},j.writeRtpDescription=function(U,F){let B="";B+="m="+U+" ",B+=F.codecs.length>0?"9":"0",B+=" "+(F.profile||"UDP/TLS/RTP/SAVPF")+" ",B+=F.codecs.map(z=>z.preferredPayloadType!==void 0?z.preferredPayloadType:z.payloadType).join(" ")+`\r
`,B+=`c=IN IP4 0.0.0.0\r
`,B+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,F.codecs.forEach(z=>{B+=j.writeRtpMap(z),B+=j.writeFmtp(z),B+=j.writeRtcpFb(z)});let q=0;return F.codecs.forEach(z=>{z.maxptime>q&&(q=z.maxptime)}),q>0&&(B+="a=maxptime:"+q+`\r
`),F.headerExtensions&&F.headerExtensions.forEach(z=>{B+=j.writeExtmap(z)}),B},j.parseRtpEncodingParameters=function(U){const F=[],B=j.parseRtpParameters(U),q=B.fecMechanisms.indexOf("RED")!==-1,z=B.fecMechanisms.indexOf("ULPFEC")!==-1,G=j.matchPrefix(U,"a=ssrc:").map(ee=>j.parseSsrcMedia(ee)).filter(ee=>ee.attribute==="cname"),Y=G.length>0&&G[0].ssrc;let Q;const W=j.matchPrefix(U,"a=ssrc-group:FID").map(ee=>ee.substring(17).split(" ").map(ae=>parseInt(ae,10)));W.length>0&&W[0].length>1&&W[0][0]===Y&&(Q=W[0][1]),B.codecs.forEach(ee=>{if(ee.name.toUpperCase()==="RTX"&&ee.parameters.apt){let ne={ssrc:Y,codecPayloadType:parseInt(ee.parameters.apt,10)};Y&&Q&&(ne.rtx={ssrc:Q}),F.push(ne),q&&(ne=JSON.parse(JSON.stringify(ne)),ne.fec={ssrc:Y,mechanism:z?"red+ulpfec":"red"},F.push(ne))}}),F.length===0&&Y&&F.push({ssrc:Y});let Z=j.matchPrefix(U,"b=");return Z.length&&(Z[0].indexOf("b=TIAS:")===0?Z=parseInt(Z[0].substring(7),10):Z[0].indexOf("b=AS:")===0?Z=parseInt(Z[0].substring(5),10)*1e3*.95-2e3*8:Z=void 0,F.forEach(ee=>{ee.maxBitrate=Z})),F},j.parseRtcpParameters=function(U){const F={},B=j.matchPrefix(U,"a=ssrc:").map(G=>j.parseSsrcMedia(G)).filter(G=>G.attribute==="cname")[0];B&&(F.cname=B.value,F.ssrc=B.ssrc);const q=j.matchPrefix(U,"a=rtcp-rsize");F.reducedSize=q.length>0,F.compound=q.length===0;const z=j.matchPrefix(U,"a=rtcp-mux");return F.mux=z.length>0,F},j.writeRtcpParameters=function(U){let F="";return U.reducedSize&&(F+=`a=rtcp-rsize\r
`),U.mux&&(F+=`a=rtcp-mux\r
`),U.ssrc!==void 0&&U.cname&&(F+="a=ssrc:"+U.ssrc+" cname:"+U.cname+`\r
`),F},j.parseMsid=function(U){let F;const B=j.matchPrefix(U,"a=msid:");if(B.length===1)return F=B[0].substring(7).split(" "),{stream:F[0],track:F[1]};const q=j.matchPrefix(U,"a=ssrc:").map(z=>j.parseSsrcMedia(z)).filter(z=>z.attribute==="msid");if(q.length>0)return F=q[0].value.split(" "),{stream:F[0],track:F[1]}},j.parseSctpDescription=function(U){const F=j.parseMLine(U),B=j.matchPrefix(U,"a=max-message-size:");let q;B.length>0&&(q=parseInt(B[0].substring(19),10)),isNaN(q)&&(q=65536);const z=j.matchPrefix(U,"a=sctp-port:");if(z.length>0)return{port:parseInt(z[0].substring(12),10),protocol:F.fmt,maxMessageSize:q};const G=j.matchPrefix(U,"a=sctpmap:");if(G.length>0){const Y=G[0].substring(10).split(" ");return{port:parseInt(Y[0],10),protocol:Y[1],maxMessageSize:q}}},j.writeSctpDescription=function(U,F){let B=[];return U.protocol!=="DTLS/SCTP"?B=["m="+U.kind+" 9 "+U.protocol+" "+F.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+F.port+`\r
`]:B=["m="+U.kind+" 9 "+U.protocol+" "+F.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+F.port+" "+F.protocol+` 65535\r
`],F.maxMessageSize!==void 0&&B.push("a=max-message-size:"+F.maxMessageSize+`\r
`),B.join("")},j.generateSessionId=function(){return Math.random().toString().substr(2,22)},j.writeSessionBoilerplate=function(U,F,B){let q;const z=F!==void 0?F:2;return U?q=U:q=j.generateSessionId(),`v=0\r
o=`+(B||"thisisadapterortc")+" "+q+" "+z+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},j.getDirection=function(U,F){const B=j.splitLines(U);for(let q=0;q<B.length;q++)switch(B[q]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return B[q].substring(2)}return F?j.getDirection(F):"sendrecv"},j.getKind=function(U){return j.splitLines(U)[0].split(" ")[0].substring(2)},j.isRejected=function(U){return U.split(" ",2)[1]==="0"},j.parseMLine=function(U){const B=j.splitLines(U)[0].substring(2).split(" ");return{kind:B[0],port:parseInt(B[1],10),protocol:B[2],fmt:B.slice(3).join(" ")}},j.parseOLine=function(U){const B=j.matchPrefix(U,"o=")[0].substring(2).split(" ");return{username:B[0],sessionId:B[1],sessionVersion:parseInt(B[2],10),netType:B[3],addressType:B[4],address:B[5]}},j.isValidSDP=function(U){if(typeof U!="string"||U.length===0)return!1;const F=j.splitLines(U);for(let B=0;B<F.length;B++)if(F[B].length<2||F[B].charAt(1)!=="=")return!1;return!0},V.exports=j})(sdp$1)),sdp$1.exports}var sdpExports=requireSdp(),SDPUtils=getDefaultExportFromCjs(sdpExports),sdp=_mergeNamespaces$1({__proto__:null,default:SDPUtils},[sdpExports]);function shimRTCIceCandidate(V){if(!V.RTCIceCandidate||V.RTCIceCandidate&&"foundation"in V.RTCIceCandidate.prototype)return;const j=V.RTCIceCandidate;V.RTCIceCandidate=function(F){if(typeof F=="object"&&F.candidate&&F.candidate.indexOf("a=")===0&&(F=JSON.parse(JSON.stringify(F)),F.candidate=F.candidate.substring(2)),F.candidate&&F.candidate.length){const B=new j(F),q=SDPUtils.parseCandidate(F.candidate);for(const z in q)z in B||Object.defineProperty(B,z,{value:q[z]});return B.toJSON=function(){return{candidate:B.candidate,sdpMid:B.sdpMid,sdpMLineIndex:B.sdpMLineIndex,usernameFragment:B.usernameFragment}},B}return new j(F)},V.RTCIceCandidate.prototype=j.prototype,wrapPeerConnectionEvent(V,"icecandidate",U=>(U.candidate&&Object.defineProperty(U,"candidate",{value:new V.RTCIceCandidate(U.candidate),writable:"false"}),U))}function shimRTCIceCandidateRelayProtocol(V){!V.RTCIceCandidate||V.RTCIceCandidate&&"relayProtocol"in V.RTCIceCandidate.prototype||wrapPeerConnectionEvent(V,"icecandidate",j=>{if(j.candidate){const U=SDPUtils.parseCandidate(j.candidate.candidate);U.type==="relay"&&(j.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[U.priority>>24])}return j})}function shimMaxMessageSize(V,j){if(!V.RTCPeerConnection)return;"sctp"in V.RTCPeerConnection.prototype||Object.defineProperty(V.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const U=function(G){if(!G||!G.sdp)return!1;const Y=SDPUtils.splitSections(G.sdp);return Y.shift(),Y.some(Q=>{const W=SDPUtils.parseMLine(Q);return W&&W.kind==="application"&&W.protocol.indexOf("SCTP")!==-1})},F=function(G){const Y=G.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(Y===null||Y.length<2)return-1;const Q=parseInt(Y[1],10);return Q!==Q?-1:Q},B=function(G){let Y=65536;return j.browser==="firefox"&&(j.version<57?G===-1?Y=16384:Y=2147483637:j.version<60?Y=j.version===57?65535:65536:Y=2147483637),Y},q=function(G,Y){let Q=65536;j.browser==="firefox"&&j.version===57&&(Q=65535);const W=SDPUtils.matchPrefix(G.sdp,"a=max-message-size:");return W.length>0?Q=parseInt(W[0].substring(19),10):j.browser==="firefox"&&Y!==-1&&(Q=2147483637),Q},z=V.RTCPeerConnection.prototype.setRemoteDescription;V.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,j.browser==="chrome"&&j.version>=76){const{sdpSemantics:Y}=this.getConfiguration();Y==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(U(arguments[0])){const Y=F(arguments[0]),Q=B(Y),W=q(arguments[0],Y);let Z;Q===0&&W===0?Z=Number.POSITIVE_INFINITY:Q===0||W===0?Z=Math.max(Q,W):Z=Math.min(Q,W);const ee={};Object.defineProperty(ee,"maxMessageSize",{get(){return Z}}),this._sctp=ee}return z.apply(this,arguments)}}function shimSendThrowTypeError(V){if(!(V.RTCPeerConnection&&"createDataChannel"in V.RTCPeerConnection.prototype))return;function j(F,B){const q=F.send;F.send=function(){const G=arguments[0],Y=G.length||G.size||G.byteLength;if(F.readyState==="open"&&B.sctp&&Y>B.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+B.sctp.maxMessageSize+" bytes)");return q.apply(F,arguments)}}const U=V.RTCPeerConnection.prototype.createDataChannel;V.RTCPeerConnection.prototype.createDataChannel=function(){const B=U.apply(this,arguments);return j(B,this),B},wrapPeerConnectionEvent(V,"datachannel",F=>(j(F.channel,F.target),F))}function shimConnectionState(V){if(!V.RTCPeerConnection||"connectionState"in V.RTCPeerConnection.prototype)return;const j=V.RTCPeerConnection.prototype;Object.defineProperty(j,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(j,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(U){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),U&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=U)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(U=>{const F=j[U];j[U]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=B=>{const q=B.target;if(q._lastConnectionState!==q.connectionState){q._lastConnectionState=q.connectionState;const z=new Event("connectionstatechange",B);q.dispatchEvent(z)}return B},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),F.apply(this,arguments)}})}function removeExtmapAllowMixed(V,j){if(!V.RTCPeerConnection||j.browser==="chrome"&&j.version>=71||j.browser==="safari"&&j._safariVersion>=13.1)return;const U=V.RTCPeerConnection.prototype.setRemoteDescription;V.RTCPeerConnection.prototype.setRemoteDescription=function(B){if(B&&B.sdp&&B.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const q=B.sdp.split(`
`).filter(z=>z.trim()!=="a=extmap-allow-mixed").join(`
`);V.RTCSessionDescription&&B instanceof V.RTCSessionDescription?arguments[0]=new V.RTCSessionDescription({type:B.type,sdp:q}):B.sdp=q}return U.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(V,j){if(!(V.RTCPeerConnection&&V.RTCPeerConnection.prototype))return;const U=V.RTCPeerConnection.prototype.addIceCandidate;!U||U.length===0||(V.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(j.browser==="chrome"&&j.version<78||j.browser==="firefox"&&j.version<68||j.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():U.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(V,j){if(!(V.RTCPeerConnection&&V.RTCPeerConnection.prototype))return;const U=V.RTCPeerConnection.prototype.setLocalDescription;!U||U.length===0||(V.RTCPeerConnection.prototype.setLocalDescription=function(){let B=arguments[0]||{};if(typeof B!="object"||B.type&&B.sdp)return U.apply(this,arguments);if(B={type:B.type,sdp:B.sdp},!B.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":B.type="offer";break;default:B.type="answer";break}return B.sdp||B.type!=="offer"&&B.type!=="answer"?U.apply(this,[B]):(B.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(z=>U.apply(this,[z]))})}var commonShim=Object.freeze({__proto__:null,removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty,shimConnectionState,shimMaxMessageSize,shimParameterlessSetLocalDescription,shimRTCIceCandidate,shimRTCIceCandidateRelayProtocol,shimSendThrowTypeError});function adapterFactory(){let{window:V}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const U=log,F=detectBrowser(V),B={browserDetails:F,commonShim,extractVersion,disableLog,disableWarnings,sdp};switch(F.browser){case"chrome":if(!chromeShim||!shimPeerConnection$1||!j.shimChrome)return U("Chrome shim is not included in this adapter release."),B;if(F.version===null)return U("Chrome shim can not determine version, not shimming."),B;U("adapter.js shimming chrome."),B.browserShim=chromeShim,shimAddIceCandidateNullOrEmpty(V,F),shimParameterlessSetLocalDescription(V),shimGetUserMedia$2(V,F),shimMediaStream(V),shimPeerConnection$1(V,F),shimOnTrack$1(V),shimAddTrackRemoveTrack(V,F),shimGetSendersWithDtmf(V),shimSenderReceiverGetStats(V),fixNegotiationNeeded(V,F),shimRTCIceCandidate(V),shimRTCIceCandidateRelayProtocol(V),shimConnectionState(V),shimMaxMessageSize(V,F),shimSendThrowTypeError(V),removeExtmapAllowMixed(V,F);break;case"firefox":if(!firefoxShim||!shimPeerConnection||!j.shimFirefox)return U("Firefox shim is not included in this adapter release."),B;U("adapter.js shimming firefox."),B.browserShim=firefoxShim,shimAddIceCandidateNullOrEmpty(V,F),shimParameterlessSetLocalDescription(V),shimGetUserMedia$1(V,F),shimPeerConnection(V,F),shimOnTrack(V),shimRemoveStream(V),shimSenderGetStats(V),shimReceiverGetStats(V),shimRTCDataChannel(V),shimAddTransceiver(V),shimGetParameters(V),shimCreateOffer(V),shimCreateAnswer(V),shimRTCIceCandidate(V),shimConnectionState(V),shimMaxMessageSize(V,F),shimSendThrowTypeError(V);break;case"safari":if(!safariShim||!j.shimSafari)return U("Safari shim is not included in this adapter release."),B;U("adapter.js shimming safari."),B.browserShim=safariShim,shimAddIceCandidateNullOrEmpty(V,F),shimParameterlessSetLocalDescription(V),shimRTCIceServerUrls(V),shimCreateOfferLegacy(V),shimCallbacksAPI(V),shimLocalStreamsAPI(V),shimRemoteStreamsAPI(V),shimTrackEventTransceiver(V),shimGetUserMedia(V),shimAudioContext(V),shimRTCIceCandidate(V),shimRTCIceCandidateRelayProtocol(V),shimMaxMessageSize(V,F),shimSendThrowTypeError(V),removeExtmapAllowMixed(V,F);break;default:U("Unsupported browser!");break}return B}adapterFactory({window:typeof window>"u"?void 0:window});const DECRYPTION_FAILURE_TOLERANCE=10,E2EE_FLAG="lk_e2ee",SALT="LKFrameEncryptionKey",KEY_PROVIDER_DEFAULTS={sharedKey:!1,ratchetSalt:SALT,ratchetWindowSize:8,failureTolerance:DECRYPTION_FAILURE_TOLERANCE,keyringSize:16};var KeyProviderEvent;(function(V){V.SetKey="setKey",V.RatchetRequest="ratchetRequest",V.KeyRatcheted="keyRatcheted"})(KeyProviderEvent||(KeyProviderEvent={}));var KeyHandlerEvent;(function(V){V.KeyRatcheted="keyRatcheted"})(KeyHandlerEvent||(KeyHandlerEvent={}));var EncryptionEvent;(function(V){V.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",V.EncryptionError="encryptionError"})(EncryptionEvent||(EncryptionEvent={}));var CryptorEvent;(function(V){V.Error="cryptorError"})(CryptorEvent||(CryptorEvent={}));function isE2EESupported(){return isInsertableStreamSupported()||isScriptTransformSupported()}function isScriptTransformSupported(){return typeof window.RTCRtpScriptTransform<"u"}function isInsertableStreamSupported(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class BaseKeyProvider extends eventsExports.EventEmitter{constructor(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(U,F,B)=>{livekitLogger.debug("key ratcheted event received",{ratchetResult:U,participantId:F,keyIndex:B})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},KEY_PROVIDER_DEFAULTS),j),this.on(KeyProviderEvent.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(j,U,F){const B={key:j,participantIdentity:U,keyIndex:F};if(!this.options.sharedKey&&!U)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(U??"shared","-").concat(F??0),B),this.emit(KeyProviderEvent.SetKey,B)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(j,U){this.emit(KeyProviderEvent.RatchetRequest,j,U)}}class LivekitError extends Error{constructor(j,U){super(U||"an error has occured"),this.name="LiveKitError",this.code=j}}var ConnectionErrorReason;(function(V){V[V.NotAllowed=0]="NotAllowed",V[V.ServerUnreachable=1]="ServerUnreachable",V[V.InternalError=2]="InternalError",V[V.Cancelled=3]="Cancelled",V[V.LeaveRequest=4]="LeaveRequest",V[V.Timeout=5]="Timeout"})(ConnectionErrorReason||(ConnectionErrorReason={}));class ConnectionError extends LivekitError{constructor(j,U,F,B){super(1,j),this.name="ConnectionError",this.status=F,this.reason=U,this.context=B,this.reasonName=ConnectionErrorReason[U]}}class DeviceUnsupportedError extends LivekitError{constructor(j){super(21,j??"device is unsupported"),this.name="DeviceUnsupportedError"}}class TrackInvalidError extends LivekitError{constructor(j){super(20,j??"track is invalid"),this.name="TrackInvalidError"}}class UnsupportedServer extends LivekitError{constructor(j){super(10,j??"unsupported server"),this.name="UnsupportedServer"}}class UnexpectedConnectionState extends LivekitError{constructor(j){super(12,j??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class NegotiationError extends LivekitError{constructor(j){super(13,j??"unable to negotiate"),this.name="NegotiationError"}}class PublishTrackError extends LivekitError{constructor(j,U){super(15,j),this.name="PublishTrackError",this.status=U}}class SignalRequestError extends LivekitError{constructor(j,U){super(15,j),this.reason=U,this.reasonName=typeof U=="string"?U:RequestResponse_Reason[U]}}var DataStreamErrorReason;(function(V){V[V.AlreadyOpened=0]="AlreadyOpened",V[V.AbnormalEnd=1]="AbnormalEnd",V[V.DecodeFailed=2]="DecodeFailed",V[V.LengthExceeded=3]="LengthExceeded",V[V.Incomplete=4]="Incomplete",V[V.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered"})(DataStreamErrorReason||(DataStreamErrorReason={}));class DataStreamError extends LivekitError{constructor(j,U){super(16,j),this.name="DataStreamError",this.reason=U,this.reasonName=DataStreamErrorReason[U]}}var MediaDeviceFailure;(function(V){V.PermissionDenied="PermissionDenied",V.NotFound="NotFound",V.DeviceInUse="DeviceInUse",V.Other="Other"})(MediaDeviceFailure||(MediaDeviceFailure={})),(function(V){function j(U){if(U&&"name"in U)return U.name==="NotFoundError"||U.name==="DevicesNotFoundError"?V.NotFound:U.name==="NotAllowedError"||U.name==="PermissionDeniedError"?V.PermissionDenied:U.name==="NotReadableError"||U.name==="TrackStartError"?V.DeviceInUse:V.Other}V.getFailure=j})(MediaDeviceFailure||(MediaDeviceFailure={}));var CryptorErrorReason;(function(V){V[V.InvalidKey=0]="InvalidKey",V[V.MissingKey=1]="MissingKey",V[V.InternalError=2]="InternalError"})(CryptorErrorReason||(CryptorErrorReason={}));var RoomEvent;(function(V){V.Connected="connected",V.Reconnecting="reconnecting",V.SignalReconnecting="signalReconnecting",V.Reconnected="reconnected",V.Disconnected="disconnected",V.ConnectionStateChanged="connectionStateChanged",V.Moved="moved",V.MediaDevicesChanged="mediaDevicesChanged",V.ParticipantConnected="participantConnected",V.ParticipantDisconnected="participantDisconnected",V.TrackPublished="trackPublished",V.TrackSubscribed="trackSubscribed",V.TrackSubscriptionFailed="trackSubscriptionFailed",V.TrackUnpublished="trackUnpublished",V.TrackUnsubscribed="trackUnsubscribed",V.TrackMuted="trackMuted",V.TrackUnmuted="trackUnmuted",V.LocalTrackPublished="localTrackPublished",V.LocalTrackUnpublished="localTrackUnpublished",V.LocalAudioSilenceDetected="localAudioSilenceDetected",V.ActiveSpeakersChanged="activeSpeakersChanged",V.ParticipantMetadataChanged="participantMetadataChanged",V.ParticipantNameChanged="participantNameChanged",V.ParticipantAttributesChanged="participantAttributesChanged",V.ParticipantActive="participantActive",V.RoomMetadataChanged="roomMetadataChanged",V.DataReceived="dataReceived",V.SipDTMFReceived="sipDTMFReceived",V.TranscriptionReceived="transcriptionReceived",V.ConnectionQualityChanged="connectionQualityChanged",V.TrackStreamStateChanged="trackStreamStateChanged",V.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",V.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",V.AudioPlaybackStatusChanged="audioPlaybackChanged",V.VideoPlaybackStatusChanged="videoPlaybackChanged",V.MediaDevicesError="mediaDevicesError",V.ParticipantPermissionsChanged="participantPermissionsChanged",V.SignalConnected="signalConnected",V.RecordingStatusChanged="recordingStatusChanged",V.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",V.EncryptionError="encryptionError",V.DCBufferStatusChanged="dcBufferStatusChanged",V.ActiveDeviceChanged="activeDeviceChanged",V.ChatMessage="chatMessage",V.LocalTrackSubscribed="localTrackSubscribed",V.MetricsReceived="metricsReceived"})(RoomEvent||(RoomEvent={}));var ParticipantEvent;(function(V){V.TrackPublished="trackPublished",V.TrackSubscribed="trackSubscribed",V.TrackSubscriptionFailed="trackSubscriptionFailed",V.TrackUnpublished="trackUnpublished",V.TrackUnsubscribed="trackUnsubscribed",V.TrackMuted="trackMuted",V.TrackUnmuted="trackUnmuted",V.LocalTrackPublished="localTrackPublished",V.LocalTrackUnpublished="localTrackUnpublished",V.LocalTrackCpuConstrained="localTrackCpuConstrained",V.LocalSenderCreated="localSenderCreated",V.ParticipantMetadataChanged="participantMetadataChanged",V.ParticipantNameChanged="participantNameChanged",V.DataReceived="dataReceived",V.SipDTMFReceived="sipDTMFReceived",V.TranscriptionReceived="transcriptionReceived",V.IsSpeakingChanged="isSpeakingChanged",V.ConnectionQualityChanged="connectionQualityChanged",V.TrackStreamStateChanged="trackStreamStateChanged",V.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",V.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",V.TrackCpuConstrained="trackCpuConstrained",V.MediaDevicesError="mediaDevicesError",V.AudioStreamAcquired="audioStreamAcquired",V.ParticipantPermissionsChanged="participantPermissionsChanged",V.PCTrackAdded="pcTrackAdded",V.AttributesChanged="attributesChanged",V.LocalTrackSubscribed="localTrackSubscribed",V.ChatMessage="chatMessage",V.Active="active"})(ParticipantEvent||(ParticipantEvent={}));var EngineEvent;(function(V){V.TransportsCreated="transportsCreated",V.Connected="connected",V.Disconnected="disconnected",V.Resuming="resuming",V.Resumed="resumed",V.Restarting="restarting",V.Restarted="restarted",V.SignalResumed="signalResumed",V.SignalRestarted="signalRestarted",V.Closing="closing",V.MediaTrackAdded="mediaTrackAdded",V.ActiveSpeakersUpdate="activeSpeakersUpdate",V.DataPacketReceived="dataPacketReceived",V.RTPVideoMapUpdate="rtpVideoMapUpdate",V.DCBufferStatusChanged="dcBufferStatusChanged",V.ParticipantUpdate="participantUpdate",V.RoomUpdate="roomUpdate",V.SpeakersChanged="speakersChanged",V.StreamStateChanged="streamStateChanged",V.ConnectionQualityUpdate="connectionQualityUpdate",V.SubscriptionError="subscriptionError",V.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",V.RemoteMute="remoteMute",V.SubscribedQualityUpdate="subscribedQualityUpdate",V.LocalTrackUnpublished="localTrackUnpublished",V.LocalTrackSubscribed="localTrackSubscribed",V.Offline="offline",V.SignalRequestResponse="signalRequestResponse",V.SignalConnected="signalConnected",V.RoomMoved="roomMoved"})(EngineEvent||(EngineEvent={}));var TrackEvent;(function(V){V.Message="message",V.Muted="muted",V.Unmuted="unmuted",V.Restarted="restarted",V.Ended="ended",V.Subscribed="subscribed",V.Unsubscribed="unsubscribed",V.CpuConstrained="cpuConstrained",V.UpdateSettings="updateSettings",V.UpdateSubscription="updateSubscription",V.AudioPlaybackStarted="audioPlaybackStarted",V.AudioPlaybackFailed="audioPlaybackFailed",V.AudioSilenceDetected="audioSilenceDetected",V.VisibilityChanged="visibilityChanged",V.VideoDimensionsChanged="videoDimensionsChanged",V.VideoPlaybackStarted="videoPlaybackStarted",V.VideoPlaybackFailed="videoPlaybackFailed",V.ElementAttached="elementAttached",V.ElementDetached="elementDetached",V.UpstreamPaused="upstreamPaused",V.UpstreamResumed="upstreamResumed",V.SubscriptionPermissionChanged="subscriptionPermissionChanged",V.SubscriptionStatusChanged="subscriptionStatusChanged",V.SubscriptionFailed="subscriptionFailed",V.TrackProcessorUpdate="trackProcessorUpdate",V.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",V.TranscriptionReceived="transcriptionReceived",V.TimeSyncUpdate="timeSyncUpdate",V.PreConnectBufferFlushed="preConnectBufferFlushed"})(TrackEvent||(TrackEvent={}));function cloneDeep$1(V){return typeof V>"u"?V:typeof structuredClone=="function"?typeof V=="object"&&V!==null?structuredClone(Object.assign({},V)):structuredClone(V):JSON.parse(JSON.stringify(V))}const commonVersionIdentifier=/version\/(\d+(\.?_?\d+)+)/i;let browserDetails;function getBrowser(V){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const U=navigator.userAgent.toLowerCase();if(browserDetails===void 0||j){const F=browsersList.find(B=>{let{test:q}=B;return q.test(U)});browserDetails=F?.describe(U)}return browserDetails}const browsersList=[{test:/firefox|iceweasel|fxios/i,describe(V){return{name:"Firefox",version:getMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,V),os:V.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:getOSVersion(V)}}},{test:/chrom|crios|crmo/i,describe(V){return{name:"Chrome",version:getMatch(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,V),os:V.toLowerCase().includes("crios")?"iOS":void 0,osVersion:getOSVersion(V)}}},{test:/safari|applewebkit/i,describe(V){return{name:"Safari",version:getMatch(commonVersionIdentifier,V),os:V.includes("mobile/")?"iOS":"macOS",osVersion:getOSVersion(V)}}}];function getMatch(V,j){let U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const F=j.match(V);return F&&F.length>=U&&F[U]||""}function getOSVersion(V){return V.includes("mac os")?getMatch(/\(.+?(\d+_\d+(:?_\d+)?)/,V,1).replace(/_/g,"."):void 0}var version$1="2.15.5";const version=version$1,protocolVersion=16;class CriticalTimers{}CriticalTimers.setTimeout=function(){return setTimeout(...arguments)},CriticalTimers.setInterval=function(){return setInterval(...arguments)},CriticalTimers.clearTimeout=function(){return clearTimeout(...arguments)},CriticalTimers.clearInterval=function(){return clearInterval(...arguments)};const BACKGROUND_REACTION_DELAY=5e3,recycledElements=[];var VideoQuality;(function(V){V[V.LOW=0]="LOW",V[V.MEDIUM=1]="MEDIUM",V[V.HIGH=2]="HIGH"})(VideoQuality||(VideoQuality={}));class Track extends eventsExports.EventEmitter{constructor(j,U){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var B;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Track.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=livekitLogger,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),BACKGROUND_REACTION_DELAY):this.handleAppVisibilityChanged()},this.log=getLogger((B=F.loggerName)!==null&&B!==void 0?B:LoggerNames.Track),this.loggerContextCb=F.loggerContextCb,this.setMaxListeners(100),this.kind=U,this._mediaStreamTrack=j,this._mediaStreamID=j.id,this.source=Track.Source.Unknown}get logContext(){var j;return Object.assign(Object.assign({},(j=this.loggerContextCb)===null||j===void 0?void 0:j.call(this)),getLogContextFromTrack(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(j){let U="audio";this.kind===Track.Kind.Video&&(U="video"),this.attachedElements.length===0&&this.kind===Track.Kind.Video&&this.addAppVisibilityListener(),j||(U==="audio"&&(recycledElements.forEach(q=>{q.parentElement===null&&!j&&(j=q)}),j&&recycledElements.splice(recycledElements.indexOf(j),1)),j||(j=document.createElement(U))),this.attachedElements.includes(j)||this.attachedElements.push(j),attachToElement(this.mediaStreamTrack,j);const F=j.srcObject.getTracks(),B=F.some(q=>q.kind==="audio");return j.play().then(()=>{this.emit(B?TrackEvent.AudioPlaybackStarted:TrackEvent.VideoPlaybackStarted)}).catch(q=>{q.name==="NotAllowedError"?this.emit(B?TrackEvent.AudioPlaybackFailed:TrackEvent.VideoPlaybackFailed,q):q.name==="AbortError"?livekitLogger.debug("".concat(B?"audio":"video"," playback aborted, likely due to new play request")):livekitLogger.warn("could not playback ".concat(B?"audio":"video"),q),B&&j&&F.some(z=>z.kind==="video")&&q.name==="NotAllowedError"&&(j.muted=!0,j.play().catch(()=>{}))}),this.emit(TrackEvent.ElementAttached,j),j}detach(j){try{if(j){detachTrack(this.mediaStreamTrack,j);const F=this.attachedElements.indexOf(j);return F>=0&&(this.attachedElements.splice(F,1),this.recycleElement(j),this.emit(TrackEvent.ElementDetached,j)),j}const U=[];return this.attachedElements.forEach(F=>{detachTrack(this.mediaStreamTrack,F),U.push(F),this.recycleElement(F),this.emit(TrackEvent.ElementDetached,F)}),this.attachedElements=[],U}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(j){j.loggerName&&(this.log=getLogger(j.loggerName)),j.loggerContextCb&&(this.loggerContextCb=j.loggerContextCb)}recycleElement(j){if(j instanceof HTMLAudioElement){let U=!0;j.pause(),recycledElements.forEach(F=>{F.parentElement||(U=!1)}),U&&recycledElements.push(j)}}handleAppVisibilityChanged(){return __awaiter$1(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Track.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(j=>j.play().catch(()=>{})),0)})}addAppVisibilityListener(){isWeb()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){isWeb()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function attachToElement(V,j){let U;j.srcObject instanceof MediaStream?U=j.srcObject:U=new MediaStream;let F;V.kind==="audio"?F=U.getAudioTracks():F=U.getVideoTracks(),F.includes(V)||(F.forEach(B=>{U.removeTrack(B)}),U.addTrack(V)),(!isSafari()||!(j instanceof HTMLVideoElement))&&(j.autoplay=!0),j.muted=U.getAudioTracks().length===0,j instanceof HTMLVideoElement&&(j.playsInline=!0),j.srcObject!==U&&(j.srcObject=U,(isSafari()||isFireFox())&&j instanceof HTMLVideoElement&&setTimeout(()=>{j.srcObject=U,j.play().catch(()=>{})},0))}function detachTrack(V,j){if(j.srcObject instanceof MediaStream){const U=j.srcObject;U.removeTrack(V),U.getTracks().length>0?j.srcObject=U:j.srcObject=null}}(function(V){let j;(function(Q){Q.Audio="audio",Q.Video="video",Q.Unknown="unknown"})(j=V.Kind||(V.Kind={}));let U;(function(Q){Q.Camera="camera",Q.Microphone="microphone",Q.ScreenShare="screen_share",Q.ScreenShareAudio="screen_share_audio",Q.Unknown="unknown"})(U=V.Source||(V.Source={}));let F;(function(Q){Q.Active="active",Q.Paused="paused",Q.Unknown="unknown"})(F=V.StreamState||(V.StreamState={}));function B(Q){switch(Q){case j.Audio:return TrackType.AUDIO;case j.Video:return TrackType.VIDEO;default:return TrackType.DATA}}V.kindToProto=B;function q(Q){switch(Q){case TrackType.AUDIO:return j.Audio;case TrackType.VIDEO:return j.Video;default:return j.Unknown}}V.kindFromProto=q;function z(Q){switch(Q){case U.Camera:return TrackSource.CAMERA;case U.Microphone:return TrackSource.MICROPHONE;case U.ScreenShare:return TrackSource.SCREEN_SHARE;case U.ScreenShareAudio:return TrackSource.SCREEN_SHARE_AUDIO;default:return TrackSource.UNKNOWN}}V.sourceToProto=z;function G(Q){switch(Q){case TrackSource.CAMERA:return U.Camera;case TrackSource.MICROPHONE:return U.Microphone;case TrackSource.SCREEN_SHARE:return U.ScreenShare;case TrackSource.SCREEN_SHARE_AUDIO:return U.ScreenShareAudio;default:return U.Unknown}}V.sourceFromProto=G;function Y(Q){switch(Q){case StreamState.ACTIVE:return F.Active;case StreamState.PAUSED:return F.Paused;default:return F.Unknown}}V.streamStateFromProto=Y})(Track||(Track={}));class VideoPreset{constructor(j,U,F,B,q){if(typeof j=="object")this.width=j.width,this.height=j.height,this.aspectRatio=j.aspectRatio,this.encoding={maxBitrate:j.maxBitrate,maxFramerate:j.maxFramerate,priority:j.priority};else if(U!==void 0&&F!==void 0)this.width=j,this.height=U,this.aspectRatio=j/U,this.encoding={maxBitrate:F,maxFramerate:B,priority:q};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const backupCodecs=["vp8","h264"],videoCodecs=["vp8","h264","vp9","av1","h265"];function isBackupCodec(V){return!!backupCodecs.find(j=>j===V)}var BackupCodecPolicy;(function(V){V[V.PREFER_REGRESSION=0]="PREFER_REGRESSION",V[V.SIMULCAST=1]="SIMULCAST",V[V.REGRESSION=2]="REGRESSION"})(BackupCodecPolicy||(BackupCodecPolicy={}));var AudioPresets;(function(V){V.telephone={maxBitrate:12e3},V.speech={maxBitrate:24e3},V.music={maxBitrate:48e3},V.musicStereo={maxBitrate:64e3},V.musicHighQuality={maxBitrate:96e3},V.musicHighQualityStereo={maxBitrate:128e3}})(AudioPresets||(AudioPresets={}));const VideoPresets={h90:new VideoPreset(160,90,9e4,20),h180:new VideoPreset(320,180,16e4,20),h216:new VideoPreset(384,216,18e4,20),h360:new VideoPreset(640,360,45e4,20),h540:new VideoPreset(960,540,8e5,25),h720:new VideoPreset(1280,720,17e5,30),h1080:new VideoPreset(1920,1080,3e6,30),h1440:new VideoPreset(2560,1440,5e6,30),h2160:new VideoPreset(3840,2160,8e6,30)},VideoPresets43={h120:new VideoPreset(160,120,7e4,20),h180:new VideoPreset(240,180,125e3,20),h240:new VideoPreset(320,240,14e4,20),h360:new VideoPreset(480,360,33e4,20),h480:new VideoPreset(640,480,5e5,20),h540:new VideoPreset(720,540,6e5,25),h720:new VideoPreset(960,720,13e5,30),h1080:new VideoPreset(1440,1080,23e5,30),h1440:new VideoPreset(1920,1440,38e5,30)},ScreenSharePresets={h360fps3:new VideoPreset(640,360,2e5,3,"medium"),h360fps15:new VideoPreset(640,360,4e5,15,"medium"),h720fps5:new VideoPreset(1280,720,8e5,5,"medium"),h720fps15:new VideoPreset(1280,720,15e5,15,"medium"),h720fps30:new VideoPreset(1280,720,2e6,30,"medium"),h1080fps15:new VideoPreset(1920,1080,25e5,15,"medium"),h1080fps30:new VideoPreset(1920,1080,5e6,30,"medium"),original:new VideoPreset(0,0,7e6,30,"medium")},separator="|",ddExtensionURI="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function unpackStreamId(V){const j=V.split(separator);return j.length>1?[j[0],V.substr(j[0].length+1)]:[V,""]}function sleep$1(V){return __awaiter$1(this,void 0,void 0,function*(){return new Promise(j=>CriticalTimers.setTimeout(j,V))})}function supportsTransceiver(){return"addTransceiver"in RTCPeerConnection.prototype}function supportsAddTrack(){return"addTrack"in RTCPeerConnection.prototype}function supportsAV1(){if(!("getCapabilities"in RTCRtpSender)||isSafari())return!1;const V=RTCRtpSender.getCapabilities("video");let j=!1;if(V){for(const U of V.codecs)if(U.mimeType==="video/AV1"){j=!0;break}}return j}function supportsVP9(){if(!("getCapabilities"in RTCRtpSender)||isFireFox())return!1;if(isSafari()){const U=getBrowser();if(U?.version&&compareVersions(U.version,"16")<0||U?.os==="iOS"&&U?.osVersion&&compareVersions(U.osVersion,"16")<0)return!1}const V=RTCRtpSender.getCapabilities("video");let j=!1;if(V){for(const U of V.codecs)if(U.mimeType==="video/VP9"){j=!0;break}}return j}function isSVCCodec(V){return V==="av1"||V==="vp9"}function supportsSetSinkId(V){return!document||isSafariBased()?!1:(V||(V=document.createElement("audio")),"setSinkId"in V)}function isBrowserSupported(){return typeof RTCPeerConnection>"u"?!1:supportsTransceiver()||supportsAddTrack()}function isFireFox(){var V;return((V=getBrowser())===null||V===void 0?void 0:V.name)==="Firefox"}function isSafari(){var V;return((V=getBrowser())===null||V===void 0?void 0:V.name)==="Safari"}function isSafariBased(){const V=getBrowser();return V?.name==="Safari"||V?.os==="iOS"}function isSafari17Based(){const V=getBrowser();return V?.name==="Safari"&&V.version.startsWith("17.")||V?.os==="iOS"&&!!V?.osVersion&&compareVersions(V.osVersion,"17")>=0}function isSafariSvcApi(V){return V||(V=getBrowser()),V?.name==="Safari"&&compareVersions(V.version,"18.3")>0||V?.os==="iOS"&&!!V?.osVersion&&compareVersions(V.osVersion,"18.3")>0}function isMobile(){var V,j;return isWeb()?(j=(V=navigator.userAgentData)===null||V===void 0?void 0:V.mobile)!==null&&j!==void 0?j:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function isE2EESimulcastSupported(){const V=getBrowser(),j="17.2";if(V)return V.name!=="Safari"&&V.os!=="iOS"||V.os==="iOS"&&V.osVersion&&compareVersions(j,V.osVersion)>=0?!0:V.name==="Safari"&&compareVersions(j,V.version)>=0}function isWeb(){return typeof document<"u"}function isReactNative(){return navigator.product=="ReactNative"}function isCloud(V){return V.hostname.endsWith(".livekit.cloud")||V.hostname.endsWith(".livekit.run")}function getLKReactNativeInfo(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function getReactNativeOs(){if(!isReactNative())return;let V=getLKReactNativeInfo();if(V)return V.platform}function getDevicePixelRatio(){if(isWeb())return window.devicePixelRatio;if(isReactNative()){let V=getLKReactNativeInfo();if(V)return V.devicePixelRatio}return 1}function compareVersions(V,j){const U=V.split("."),F=j.split("."),B=Math.min(U.length,F.length);for(let q=0;q<B;++q){const z=parseInt(U[q],10),G=parseInt(F[q],10);if(z>G)return 1;if(z<G)return-1;if(q===B-1&&z===G)return 0}return V===""&&j!==""?-1:j===""?1:U.length==F.length?0:U.length<F.length?-1:1}function roDispatchCallback(V){for(const j of V)j.target.handleResize(j)}function ioDispatchCallback(V){for(const j of V)j.target.handleVisibilityChanged(j)}let resizeObserver=null;const getResizeObserver=()=>(resizeObserver||(resizeObserver=new ResizeObserver(roDispatchCallback)),resizeObserver);let intersectionObserver=null;const getIntersectionObserver=()=>(intersectionObserver||(intersectionObserver=new IntersectionObserver(ioDispatchCallback,{root:null,rootMargin:"0px"})),intersectionObserver);function getClientInfo(){var V;const j=new ClientInfo({sdk:ClientInfo_SDK.JS,protocol:protocolVersion,version});return isReactNative()&&(j.os=(V=getReactNativeOs())!==null&&V!==void 0?V:""),j}function createDummyVideoStreamTrack(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,F=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const B=document.createElement("canvas");B.width=V,B.height=j;const q=B.getContext("2d");q?.fillRect(0,0,B.width,B.height),F&&q&&(q.beginPath(),q.arc(V/2,j/2,50,0,Math.PI*2,!0),q.closePath(),q.fillStyle="grey",q.fill());const z=B.captureStream(),[G]=z.getTracks();if(!G)throw Error("Could not get empty media stream video track");return G.enabled=U,G}let emptyAudioStreamTrack;function getEmptyAudioStreamTrack(){if(!emptyAudioStreamTrack){const V=new AudioContext,j=V.createOscillator(),U=V.createGain();U.gain.setValueAtTime(0,0);const F=V.createMediaStreamDestination();if(j.connect(U),U.connect(F),j.start(),[emptyAudioStreamTrack]=F.stream.getAudioTracks(),!emptyAudioStreamTrack)throw Error("Could not get empty media stream audio track");emptyAudioStreamTrack.enabled=!1}return emptyAudioStreamTrack.clone()}class Future{get isResolved(){return this._isResolved}constructor(j,U){this._isResolved=!1,this.onFinally=U,this.promise=new Promise((F,B)=>__awaiter$1(this,void 0,void 0,function*(){this.resolve=F,this.reject=B,j&&(yield j(F,B))})).finally(()=>{var F;this._isResolved=!0,(F=this.onFinally)===null||F===void 0||F.call(this)})}}function isVideoCodec(V){return videoCodecs.includes(V)}function unwrapConstraint(V){if(typeof V=="string"||typeof V=="number")return V;if(Array.isArray(V))return V[0];if(V.exact!==void 0)return Array.isArray(V.exact)?V.exact[0]:V.exact;if(V.ideal!==void 0)return Array.isArray(V.ideal)?V.ideal[0]:V.ideal;throw Error("could not unwrap constraint")}function toWebsocketUrl(V){return V.startsWith("http")?V.replace(/^(http)/,"ws"):V}function toHttpUrl(V){return V.startsWith("ws")?V.replace(/^(ws)/,"http"):V}function extractTranscriptionSegments(V,j){return V.segments.map(U=>{let{id:F,text:B,language:q,startTime:z,endTime:G,final:Y}=U;var Q;const W=(Q=j.get(F))!==null&&Q!==void 0?Q:Date.now(),Z=Date.now();return Y?j.delete(F):j.set(F,W),{id:F,text:B,startTime:Number.parseInt(z.toString()),endTime:Number.parseInt(G.toString()),final:Y,language:q,firstReceivedTime:W,lastReceivedTime:Z}})}function extractChatMessage(V){const{id:j,timestamp:U,message:F,editTimestamp:B}=V;return{id:j,timestamp:Number.parseInt(U.toString()),editTimestamp:B?Number.parseInt(B.toString()):void 0,message:F}}function getDisconnectReasonFromConnectionError(V){switch(V.reason){case ConnectionErrorReason.LeaveRequest:return V.context;case ConnectionErrorReason.Cancelled:return DisconnectReason.CLIENT_INITIATED;case ConnectionErrorReason.NotAllowed:return DisconnectReason.USER_REJECTED;case ConnectionErrorReason.ServerUnreachable:return DisconnectReason.JOIN_FAILURE;default:return DisconnectReason.UNKNOWN_REASON}}function bigIntToNumber(V){return V!==void 0?Number(V):void 0}function numberToBigInt(V){return V!==void 0?BigInt(V):void 0}function isLocalTrack(V){return!!V&&!(V instanceof MediaStreamTrack)&&V.isLocal}function isAudioTrack(V){return!!V&&V.kind==Track.Kind.Audio}function isVideoTrack(V){return!!V&&V.kind==Track.Kind.Video}function isLocalVideoTrack(V){return isLocalTrack(V)&&isVideoTrack(V)}function isLocalAudioTrack(V){return isLocalTrack(V)&&isAudioTrack(V)}function isRemoteTrack(V){return!!V&&!V.isLocal}function isRemotePub(V){return!!V&&!V.isLocal}function isRemoteVideoTrack(V){return isRemoteTrack(V)&&isVideoTrack(V)}function isLocalParticipant(V){return V.isLocal}function splitUtf8(V,j){const U=[];let F=new TextEncoder().encode(V);for(;F.length>j;){let B=j;for(;B>0;){const q=F[B];if(q!==void 0&&(q&192)!==128)break;B--}U.push(F.slice(0,B)),F=F.slice(B)}return F.length>0&&U.push(F),U}function mergeDefaultOptions(V,j,U){var F,B,q,z;const{optionsWithoutProcessor:G,audioProcessor:Y,videoProcessor:Q}=extractProcessorsFromOptions(V??{}),W=j?.processor,Z=U?.processor,ee=G??{};return ee.audio===!0&&(ee.audio={}),ee.video===!0&&(ee.video={}),ee.audio&&(mergeObjectWithoutOverwriting(ee.audio,j),(F=(q=ee.audio).deviceId)!==null&&F!==void 0||(q.deviceId={ideal:"default"}),(Y||W)&&(ee.audio.processor=Y??W)),ee.video&&(mergeObjectWithoutOverwriting(ee.video,U),(B=(z=ee.video).deviceId)!==null&&B!==void 0||(z.deviceId={ideal:"default"}),(Q||Z)&&(ee.video.processor=Q??Z)),ee}function mergeObjectWithoutOverwriting(V,j){return Object.keys(j).forEach(U=>{V[U]===void 0&&(V[U]=j[U])}),V}function constraintsForOptions(V){var j,U,F,B;const q={};if(V.video)if(typeof V.video=="object"){const z={},G=z,Y=V.video;Object.keys(Y).forEach(Q=>{switch(Q){case"resolution":mergeObjectWithoutOverwriting(G,Y.resolution);break;default:G[Q]=Y[Q]}}),q.video=z,(j=(F=q.video).deviceId)!==null&&j!==void 0||(F.deviceId={ideal:"default"})}else q.video=V.video?{deviceId:{ideal:"default"}}:!1;else q.video=!1;return V.audio?typeof V.audio=="object"?(q.audio=V.audio,(U=(B=q.audio).deviceId)!==null&&U!==void 0||(B.deviceId={ideal:"default"})):q.audio={deviceId:{ideal:"default"}}:q.audio=!1,q}function detectSilence(V){return __awaiter$1(this,arguments,void 0,function(j){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return(function*(){const F=getNewAudioContext();if(F){const B=F.createAnalyser();B.fftSize=2048;const q=B.frequencyBinCount,z=new Uint8Array(q);F.createMediaStreamSource(new MediaStream([j.mediaStreamTrack])).connect(B),yield sleep$1(U),B.getByteTimeDomainData(z);const Y=z.some(Q=>Q!==128&&Q!==0);return F.close(),!Y}return!1})()})}function getNewAudioContext(){var V;const j=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(j){const U=new j({latencyHint:"interactive"});if(U.state==="suspended"&&typeof window<"u"&&(!((V=window.document)===null||V===void 0)&&V.body)){const F=()=>__awaiter$1(this,void 0,void 0,function*(){var B;try{U.state==="suspended"&&(yield U.resume())}catch(q){console.warn("Error trying to auto-resume audio context",q)}(B=window.document.body)===null||B===void 0||B.removeEventListener("click",F)});window.document.body.addEventListener("click",F)}return U}}function kindToSource(V){return V==="audioinput"?Track.Source.Microphone:V==="videoinput"?Track.Source.Camera:Track.Source.Unknown}function sourceToKind(V){return V===Track.Source.Microphone?"audioinput":V===Track.Source.Camera?"videoinput":void 0}function screenCaptureToDisplayMediaStreamOptions(V){var j,U;let F=(j=V.video)!==null&&j!==void 0?j:!0;return V.resolution&&V.resolution.width>0&&V.resolution.height>0&&(F=typeof F=="boolean"?{}:F,isSafari()?F=Object.assign(Object.assign({},F),{width:{max:V.resolution.width},height:{max:V.resolution.height},frameRate:V.resolution.frameRate}):F=Object.assign(Object.assign({},F),{width:{ideal:V.resolution.width},height:{ideal:V.resolution.height},frameRate:V.resolution.frameRate})),{audio:(U=V.audio)!==null&&U!==void 0?U:!1,video:F,controller:V.controller,selfBrowserSurface:V.selfBrowserSurface,surfaceSwitching:V.surfaceSwitching,systemAudio:V.systemAudio,preferCurrentTab:V.preferCurrentTab}}function mimeTypeToVideoCodecString(V){return V.split("/")[1].toLowerCase()}function getTrackPublicationInfo(V){const j=[];return V.forEach(U=>{U.track!==void 0&&j.push(new TrackPublishedResponse({cid:U.track.mediaStreamID,track:U.trackInfo}))}),j}function getLogContextFromTrack(V){return"mediaStreamTrack"in V?{trackID:V.sid,source:V.source,muted:V.isMuted,enabled:V.mediaStreamTrack.enabled,kind:V.kind,streamID:V.mediaStreamID,streamTrackID:V.mediaStreamTrack.id}:{trackID:V.trackSid,enabled:V.isEnabled,muted:V.isMuted,trackInfo:Object.assign({mimeType:V.mimeType,name:V.trackName,encrypted:V.isEncrypted,kind:V.kind,source:V.source},V.track?getLogContextFromTrack(V.track):{})}}function supportsSynchronizationSources(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function diffAttributes(V,j){var U;V===void 0&&(V={}),j===void 0&&(j={});const F=[...Object.keys(j),...Object.keys(V)],B={};for(const q of F)V[q]!==j[q]&&(B[q]=(U=j[q])!==null&&U!==void 0?U:"");return B}function extractProcessorsFromOptions(V){const j=Object.assign({},V);let U,F;return typeof j.audio=="object"&&j.audio.processor&&(U=j.audio.processor,j.audio=Object.assign(Object.assign({},j.audio),{processor:void 0})),typeof j.video=="object"&&j.video.processor&&(F=j.video.processor,j.video=Object.assign(Object.assign({},j.video),{processor:void 0})),{audioProcessor:U,videoProcessor:F,optionsWithoutProcessor:cloneDeep$1(j)}}function getTrackSourceFromProto(V){switch(V){case TrackSource.CAMERA:return Track.Source.Camera;case TrackSource.MICROPHONE:return Track.Source.Microphone;case TrackSource.SCREEN_SHARE:return Track.Source.ScreenShare;case TrackSource.SCREEN_SHARE_AUDIO:return Track.Source.ScreenShareAudio;default:return Track.Source.Unknown}}function areDimensionsSmaller(V,j){return V.width*V.height<j.width*j.height}function layerDimensionsFor(V,j){var U;return(U=V.layers)===null||U===void 0?void 0:U.find(F=>F.quality===j)}class E2EEManager extends eventsExports.EventEmitter{constructor(j){super(),this.onWorkerMessage=U=>{var F,B;const{kind:q,data:z}=U.data;switch(q){case"error":livekitLogger.error(z.error.message),this.emit(EncryptionEvent.EncryptionError,z.error);break;case"initAck":z.enabled&&this.keyProvider.getKeys().forEach(G=>{this.postKey(G)});break;case"enable":if(z.enabled&&this.keyProvider.getKeys().forEach(G=>{this.postKey(G)}),this.encryptionEnabled!==z.enabled&&z.participantIdentity===((F=this.room)===null||F===void 0?void 0:F.localParticipant.identity))this.emit(EncryptionEvent.ParticipantEncryptionStatusChanged,z.enabled,this.room.localParticipant),this.encryptionEnabled=z.enabled;else if(z.participantIdentity){const G=(B=this.room)===null||B===void 0?void 0:B.getParticipantByIdentity(z.participantIdentity);if(!G)throw TypeError("couldn't set encryption status, participant not found".concat(z.participantIdentity));this.emit(EncryptionEvent.ParticipantEncryptionStatusChanged,z.enabled,G)}break;case"ratchetKey":this.keyProvider.emit(KeyProviderEvent.KeyRatcheted,z.ratchetResult,z.participantIdentity,z.keyIndex);break}},this.onWorkerError=U=>{livekitLogger.error("e2ee worker encountered an error:",{error:U.error}),this.emit(EncryptionEvent.EncryptionError,U.error)},this.keyProvider=j.keyProvider,this.worker=j.worker,this.encryptionEnabled=!1}setup(j){if(!isE2EESupported())throw new DeviceUnsupportedError("tried to setup end-to-end encryption on an unsupported browser");if(livekitLogger.info("setting up e2ee"),j!==this.room){this.room=j,this.setupEventListeners(j,this.keyProvider);const U={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:workerLogger.getLevel()}};this.worker&&(livekitLogger.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(U))}}setParticipantCryptorEnabled(j,U){livekitLogger.debug("set e2ee to ".concat(j," for participant ").concat(U)),this.postEnable(j,U)}setSifTrailer(j){!j||j.length===0?livekitLogger.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(j)}setupEngine(j){j.on(EngineEvent.RTPVideoMapUpdate,U=>{this.postRTPMap(U)})}setupEventListeners(j,U){j.on(RoomEvent.TrackPublished,(F,B)=>this.setParticipantCryptorEnabled(F.trackInfo.encryption!==Encryption_Type.NONE,B.identity)),j.on(RoomEvent.ConnectionStateChanged,F=>{F===ConnectionState.Connected&&j.remoteParticipants.forEach(B=>{B.trackPublications.forEach(q=>{this.setParticipantCryptorEnabled(q.trackInfo.encryption!==Encryption_Type.NONE,B.identity)})})}).on(RoomEvent.TrackUnsubscribed,(F,B,q)=>{var z;const G={kind:"removeTransform",data:{participantIdentity:q.identity,trackId:F.mediaStreamID}};(z=this.worker)===null||z===void 0||z.postMessage(G)}).on(RoomEvent.TrackSubscribed,(F,B,q)=>{this.setupE2EEReceiver(F,q.identity,B.trackInfo)}).on(RoomEvent.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");U.getKeys().forEach(F=>{this.postKey(F)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),j.localParticipant.on(ParticipantEvent.LocalSenderCreated,(F,B)=>__awaiter$1(this,void 0,void 0,function*(){this.setupE2EESender(B,F)})),U.on(KeyProviderEvent.SetKey,F=>this.postKey(F)).on(KeyProviderEvent.RatchetRequest,(F,B)=>this.postRatchetRequest(F,B))}postRatchetRequest(j,U){if(!this.worker)throw Error("could not ratchet key, worker is missing");const F={kind:"ratchetRequest",data:{participantIdentity:j,keyIndex:U}};this.worker.postMessage(F)}postKey(j){let{key:U,participantIdentity:F,keyIndex:B}=j;var q;if(!this.worker)throw Error("could not set key, worker is missing");const z={kind:"setKey",data:{participantIdentity:F,isPublisher:F===((q=this.room)===null||q===void 0?void 0:q.localParticipant.identity),key:U,keyIndex:B}};this.worker.postMessage(z)}postEnable(j,U){if(this.worker){const F={kind:"enable",data:{enabled:j,participantIdentity:U}};this.worker.postMessage(F)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(j){var U;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((U=this.room)===null||U===void 0)&&U.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const F={kind:"setRTPMap",data:{map:j,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(F)}postSifTrailer(j){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const U={kind:"setSifTrailer",data:{trailer:j}};this.worker.postMessage(U)}setupE2EEReceiver(j,U,F){if(j.receiver){if(!F?.mimeType||F.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(j.receiver,j.mediaStreamID,U,j.kind==="video"?mimeTypeToVideoCodecString(F.mimeType):void 0)}}setupE2EESender(j,U){if(!isLocalTrack(j)||!U){U||livekitLogger.warn("early return because sender is not ready");return}this.handleSender(U,j.mediaStreamID,void 0)}handleReceiver(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){if(this.worker){if(isScriptTransformSupported()){const q={kind:"decode",participantIdentity:F,trackId:U,codec:B};j.transform=new RTCRtpScriptTransform(this.worker,q)}else{if(E2EE_FLAG in j&&B){const Y={kind:"updateCodec",data:{trackId:U,codec:B,participantIdentity:F}};this.worker.postMessage(Y);return}let q=j.writableStream,z=j.readableStream;if(!q||!z){const Y=j.createEncodedStreams();j.writableStream=Y.writable,q=Y.writable,j.readableStream=Y.readable,z=Y.readable}const G={kind:"decode",data:{readableStream:z,writableStream:q,trackId:U,codec:B,participantIdentity:F,isReuse:E2EE_FLAG in j}};this.worker.postMessage(G,[z,q])}j[E2EE_FLAG]=!0}})}handleSender(j,U,F){var B;if(!(E2EE_FLAG in j||!this.worker)){if(!(!((B=this.room)===null||B===void 0)&&B.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(isScriptTransformSupported()){livekitLogger.info("initialize script transform");const q={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:U,codec:F};j.transform=new RTCRtpScriptTransform(this.worker,q)}else{livekitLogger.info("initialize encoded streams");const q=j.createEncodedStreams(),z={kind:"encode",data:{readableStream:q.readable,writableStream:q.writable,codec:F,trackId:U,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(z,[q.readable,q.writable])}j[E2EE_FLAG]=!0}}}const defaultId="default";class DeviceManager{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new DeviceManager),this.instance}get previousDevices(){return this._previousDevices}getDevices(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var q;if(((q=DeviceManager.userMediaPromiseMap)===null||q===void 0?void 0:q.size)>0){livekitLogger.debug("awaiting getUserMedia promise");try{U?yield DeviceManager.userMediaPromiseMap.get(U):yield Promise.all(DeviceManager.userMediaPromiseMap.values())}catch{livekitLogger.warn("error waiting for media permissons")}}let z=yield navigator.mediaDevices.enumerateDevices();if(B&&!(isSafari()&&F.hasDeviceInUse(U))&&(z.filter(Y=>Y.kind===U).length===0||z.some(Y=>{const Q=Y.label==="",W=U?Y.kind===U:!0;return Q&&W}))){const Y={video:U!=="audioinput"&&U!=="audiooutput",audio:U!=="videoinput"&&{deviceId:{ideal:"default"}}},Q=yield navigator.mediaDevices.getUserMedia(Y);z=yield navigator.mediaDevices.enumerateDevices(),Q.getTracks().forEach(W=>{W.stop()})}return F._previousDevices=z,U&&(z=z.filter(G=>G.kind===U)),z})()})}normalizeDeviceId(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){if(U!==defaultId)return U;const B=yield this.getDevices(j),q=B.find(G=>G.deviceId===defaultId);if(!q){livekitLogger.warn("could not reliably determine default device");return}const z=B.find(G=>G.deviceId!==defaultId&&G.groupId===(F??q.groupId));if(!z){livekitLogger.warn("could not reliably determine default device");return}return z?.deviceId})}hasDeviceInUse(j){return j?DeviceManager.userMediaPromiseMap.has(j):DeviceManager.userMediaPromiseMap.size>0}}DeviceManager.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],DeviceManager.userMediaPromiseMap=new Map;var QueueTaskStatus;(function(V){V[V.WAITING=0]="WAITING",V[V.RUNNING=1]="RUNNING",V[V.COMPLETED=2]="COMPLETED"})(QueueTaskStatus||(QueueTaskStatus={}));class AsyncQueue{constructor(){this.pendingTasks=new Map,this.taskMutex=new _$1,this.nextTaskIndex=0}run(j){return __awaiter$1(this,void 0,void 0,function*(){const U={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:QueueTaskStatus.WAITING};this.pendingTasks.set(U.id,U);const F=yield this.taskMutex.lock();try{return U.executedAt=Date.now(),U.status=QueueTaskStatus.RUNNING,yield j()}finally{U.status=QueueTaskStatus.COMPLETED,this.pendingTasks.delete(U.id),F()}})}flush(){return __awaiter$1(this,void 0,void 0,function*(){return this.run(()=>__awaiter$1(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function createRtcUrl(V,j){const U=new URL(toWebsocketUrl(V));return j.forEach((F,B)=>{U.searchParams.set(B,F)}),appendUrlPath(U,"rtc")}function createValidateUrl(V){const j=new URL(toHttpUrl(V));return appendUrlPath(j,"validate")}function ensureTrailingSlash(V){return V.endsWith("/")?V:"".concat(V,"/")}function appendUrlPath(V,j){return V.pathname="".concat(ensureTrailingSlash(V.pathname)).concat(j),V.toString()}const passThroughQueueSignals=["syncState","trickle","offer","answer","simulate","leave"];function canPassThroughQueue(V){const j=passThroughQueueSignals.indexOf(V.case)>=0;return livekitLogger.trace("request allowed to bypass queue:",{canPass:j,req:V}),j}var SignalConnectionState;(function(V){V[V.CONNECTING=0]="CONNECTING",V[V.CONNECTED=1]="CONNECTED",V[V.RECONNECTING=2]="RECONNECTING",V[V.DISCONNECTING=3]="DISCONNECTING",V[V.DISCONNECTED=4]="DISCONNECTED"})(SignalConnectionState||(SignalConnectionState={}));class SignalClient{get currentState(){return this.state}get isDisconnected(){return this.state===SignalConnectionState.DISCONNECTING||this.state===SignalConnectionState.DISCONNECTED}get isEstablishingConnection(){return this.state===SignalConnectionState.CONNECTING||this.state===SignalConnectionState.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var F;this.rtt=0,this.state=SignalConnectionState.DISCONNECTED,this.log=livekitLogger,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=getLogger((F=U.loggerName)!==null&&F!==void 0?F:LoggerNames.Signal),this.loggerContextCb=U.loggerContextCb,this.useJSON=j,this.requestQueue=new AsyncQueue,this.queuedRequests=[],this.closingLock=new _$1,this.connectionLock=new _$1,this.state=SignalConnectionState.DISCONNECTED}get logContext(){var j,U;return(U=(j=this.loggerContextCb)===null||j===void 0?void 0:j.call(this))!==null&&U!==void 0?U:{}}join(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){return this.state=SignalConnectionState.CONNECTING,this.options=F,yield this.connect(j,U,F,B)})}reconnect(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=SignalConnectionState.RECONNECTING,this.clearPingInterval(),yield this.connect(j,U,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:F,reconnectReason:B}))})}connect(j,U,F,B){this.connectOptions=F;const q=getClientInfo(),z=createConnectionParams(U,q,F),G=createRtcUrl(j,z),Y=createValidateUrl(G);return new Promise((Q,W)=>__awaiter$1(this,void 0,void 0,function*(){const Z=yield this.connectionLock.lock();try{const ee=()=>__awaiter$1(this,void 0,void 0,function*(){this.close(),clearTimeout(ne),W(new ConnectionError("room connection has been cancelled (signal)",ConnectionErrorReason.Cancelled))}),ne=setTimeout(()=>{this.close(),W(new ConnectionError("room connection has timed out (signal)",ConnectionErrorReason.ServerUnreachable))},F.websocketTimeout);B?.aborted&&ee(),B?.addEventListener("abort",ee);const ae=new URL(G);ae.searchParams.has("access_token")&&ae.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(ae),Object.assign({reconnect:F.reconnect,reconnectReason:F.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(G),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(ne)},this.ws.onerror=se=>__awaiter$1(this,void 0,void 0,function*(){if(this.state!==SignalConnectionState.CONNECTED){this.state=SignalConnectionState.DISCONNECTED,clearTimeout(ne);try{const de=yield fetch(Y);if(de.status.toFixed(0).startsWith("4")){const oe=yield de.text();W(new ConnectionError(oe,ConnectionErrorReason.NotAllowed,de.status))}else W(new ConnectionError("Encountered unknown websocket error during connection: ".concat(se.toString()),ConnectionErrorReason.InternalError,de.status))}catch(de){W(new ConnectionError(de instanceof Error?de.message:"server was not reachable",ConnectionErrorReason.ServerUnreachable))}return}this.handleWSError(se)}),this.ws.onmessage=se=>__awaiter$1(this,void 0,void 0,function*(){var de,oe,ue;let he;if(typeof se.data=="string"){const ye=JSON.parse(se.data);he=SignalResponse.fromJson(ye,{ignoreUnknownFields:!0})}else if(se.data instanceof ArrayBuffer)he=SignalResponse.fromBinary(new Uint8Array(se.data));else{this.log.error("could not decode websocket message: ".concat(typeof se.data),this.logContext);return}if(this.state!==SignalConnectionState.CONNECTED){let ye=!1;if(((de=he.message)===null||de===void 0?void 0:de.case)==="join"?(this.state=SignalConnectionState.CONNECTED,B?.removeEventListener("abort",ee),this.pingTimeoutDuration=he.message.value.pingTimeout,this.pingIntervalDuration=he.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),Q(he.message.value)):this.state===SignalConnectionState.RECONNECTING&&he.message.case!=="leave"?(this.state=SignalConnectionState.CONNECTED,B?.removeEventListener("abort",ee),this.startPingInterval(),((oe=he.message)===null||oe===void 0?void 0:oe.case)==="reconnect"?Q(he.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),Q(void 0),ye=!0)):this.isEstablishingConnection&&he.message.case==="leave"?W(new ConnectionError("Received leave request while trying to (re)connect",ConnectionErrorReason.LeaveRequest,void 0,he.message.value.reason)):F.reconnect||W(new ConnectionError("did not receive join response, got ".concat((ue=he.message)===null||ue===void 0?void 0:ue.case," instead"),ConnectionErrorReason.InternalError)),!ye)return}this.signalLatency&&(yield sleep$1(this.signalLatency)),this.handleSignalResponse(he)}),this.ws.onclose=se=>{this.isEstablishingConnection&&W(new ConnectionError("Websocket got closed during a (re)connection attempt",ConnectionErrorReason.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:se.reason,code:se.code,wasClean:se.wasClean,state:this.state})),this.handleOnClose(se.reason)}}finally{Z()}}))}close(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){const F=yield j.closingLock.lock();try{if(j.clearPingInterval(),U&&(j.state=SignalConnectionState.DISCONNECTING),j.ws){j.ws.onmessage=null,j.ws.onopen=null,j.ws.onclose=null;const B=new Promise(q=>{j.ws?j.ws.onclose=()=>{q()}:q()});j.ws.readyState<j.ws.CLOSING&&(j.ws.close(),yield Promise.race([B,sleep$1(250)])),j.ws=void 0}}finally{U&&(j.state=SignalConnectionState.DISCONNECTED),F()}})()})}sendOffer(j,U){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:j.sdp})),this.sendRequest({case:"offer",value:toProtoSessionDescription(j,U)})}sendAnswer(j,U){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:j.sdp})),this.sendRequest({case:"answer",value:toProtoSessionDescription(j,U)})}sendIceCandidate(j,U){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:j})),this.sendRequest({case:"trickle",value:new TrickleRequest({candidateInit:JSON.stringify(j),target:U})})}sendMuteTrack(j,U){return this.sendRequest({case:"mute",value:new MuteTrackRequest({sid:j,muted:U})})}sendAddTrack(j){return this.sendRequest({case:"addTrack",value:j})}sendUpdateLocalMetadata(j,U){return __awaiter$1(this,arguments,void 0,function(F,B){var q=this;let z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(function*(){const G=q.getNextRequestId();return yield q.sendRequest({case:"updateMetadata",value:new UpdateParticipantMetadata({requestId:G,metadata:F,name:B,attributes:z})}),G})()})}sendUpdateTrackSettings(j){this.sendRequest({case:"trackSetting",value:j})}sendUpdateSubscription(j){return this.sendRequest({case:"subscription",value:j})}sendSyncState(j){return this.sendRequest({case:"syncState",value:j})}sendUpdateVideoLayers(j,U){return this.sendRequest({case:"updateLayers",value:new UpdateVideoLayers({trackSid:j,layers:U})})}sendUpdateSubscriptionPermissions(j,U){return this.sendRequest({case:"subscriptionPermission",value:new SubscriptionPermission({allParticipants:j,trackPermissions:U})})}sendSimulateScenario(j){return this.sendRequest({case:"simulate",value:j})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:protoInt64.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Ping({timestamp:protoInt64.parse(Date.now()),rtt:protoInt64.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(j,U){return this.sendRequest({case:"updateAudioTrack",value:new UpdateLocalAudioTrack({trackSid:j,features:U})})}sendLeave(){return this.sendRequest({case:"leave",value:new LeaveRequest({reason:DisconnectReason.CLIENT_INITIATED,action:LeaveRequest_Action.DISCONNECT})})}sendRequest(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(function*(){if(!B&&!canPassThroughQueue(U)&&F.state===SignalConnectionState.RECONNECTING){F.queuedRequests.push(()=>__awaiter$1(F,void 0,void 0,function*(){yield this.sendRequest(U,!0)}));return}if(B||(yield F.requestQueue.flush()),F.signalLatency&&(yield sleep$1(F.signalLatency)),F.isDisconnected){F.log.debug("skipping signal request (type: ".concat(U.case,") - SignalClient disconnected"));return}if(!F.ws||F.ws.readyState!==F.ws.OPEN){F.log.error("cannot send signal request before connected, type: ".concat(U?.case),F.logContext);return}const z=new SignalRequest({message:U});try{F.useJSON?F.ws.send(z.toJsonString()):F.ws.send(z.toBinary())}catch(G){F.log.error("error sending signal message",Object.assign(Object.assign({},F.logContext),{error:G}))}})()})}handleSignalResponse(j){var U,F;const B=j.message;if(B==null){this.log.debug("received unsupported message",this.logContext);return}let q=!1;if(B.case==="answer"){const z=fromProtoSessionDescription(B.value);this.onAnswer&&this.onAnswer(z,B.value.id)}else if(B.case==="offer"){const z=fromProtoSessionDescription(B.value);this.onOffer&&this.onOffer(z,B.value.id)}else if(B.case==="trickle"){const z=JSON.parse(B.value.candidateInit);this.onTrickle&&this.onTrickle(z,B.value.target)}else B.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((U=B.value.participants)!==null&&U!==void 0?U:[]):B.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(B.value):B.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((F=B.value.speakers)!==null&&F!==void 0?F:[]):B.case==="leave"?this.onLeave&&this.onLeave(B.value):B.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(B.value.sid,B.value.muted):B.case==="roomUpdate"?this.onRoomUpdate&&B.value.room&&this.onRoomUpdate(B.value.room):B.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(B.value):B.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(B.value):B.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(B.value):B.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(B.value):B.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(B.value):B.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(B.value):B.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(B.value):B.case==="pong"||(B.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(B.value.lastPingTimestamp.toString()),this.resetPingTimeout(),q=!0):B.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(B.value):B.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(B.value.trackSid):B.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(B.value.token),this.onRoomMoved&&this.onRoomMoved(B.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:B.case})));q||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const j=this.queuedRequests.shift();j&&this.requestQueue.run(j)}}handleOnClose(j){return __awaiter$1(this,void 0,void 0,function*(){if(this.state===SignalConnectionState.DISCONNECTED)return;const U=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(j),Object.assign(Object.assign({},this.logContext),{reason:j})),U&&U(j)})}handleWSError(j){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:j}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=CriticalTimers.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&CriticalTimers.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=CriticalTimers.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&CriticalTimers.clearInterval(this.pingInterval)}}function fromProtoSessionDescription(V){const j={type:"offer",sdp:V.sdp};switch(V.type){case"answer":case"offer":case"pranswer":case"rollback":j.type=V.type;break}return j}function toProtoSessionDescription(V,j){return new SessionDescription({sdp:V.sdp,type:V.type,id:j})}function createConnectionParams(V,j,U){var F;const B=new URLSearchParams;return B.set("access_token",V),U.reconnect&&(B.set("reconnect","1"),U.sid&&B.set("sid",U.sid)),B.set("auto_subscribe",U.autoSubscribe?"1":"0"),B.set("sdk",isReactNative()?"reactnative":"js"),B.set("version",j.version),B.set("protocol",j.protocol.toString()),j.deviceModel&&B.set("device_model",j.deviceModel),j.os&&B.set("os",j.os),j.osVersion&&B.set("os_version",j.osVersion),j.browser&&B.set("browser",j.browser),j.browserVersion&&B.set("browser_version",j.browserVersion),U.adaptiveStream&&B.set("adaptive_stream","1"),U.reconnectReason&&B.set("reconnect_reason",U.reconnectReason.toString()),!((F=navigator.connection)===null||F===void 0)&&F.type&&B.set("network",navigator.connection.type),B}class DataPacketBuffer{constructor(){this.buffer=[],this._totalSize=0}push(j){this.buffer.push(j),this._totalSize+=j.data.byteLength}pop(){const j=this.buffer.shift();return j&&(this._totalSize-=j.data.byteLength),j}getAll(){return this.buffer.slice()}popToSequence(j){for(;this.buffer.length>0&&this.buffer[0].sequence<=j;)this.pop()}alignBufferedAmount(j){for(;this.buffer.length>0;){const U=this.buffer[0];if(this._totalSize-U.data.byteLength<=j)break;this.pop()}}get length(){return this.buffer.length}}class TTLMap{constructor(j){this._map=new Map,this._lastCleanup=0,this.ttl=j}set(j,U){const F=Date.now();F-this._lastCleanup>this.ttl/2&&this.cleanup();const B=F+this.ttl;return this._map.set(j,{value:U,expiresAt:B}),this}get(j){const U=this._map.get(j);if(U){if(U.expiresAt<Date.now()){this._map.delete(j);return}return U.value}}has(j){const U=this._map.get(j);return U?U.expiresAt<Date.now()?(this._map.delete(j),!1):!0:!1}delete(j){return this._map.delete(j)}clear(){this._map.clear()}cleanup(){const j=Date.now();for(const[U,F]of this._map.entries())F.expiresAt<j&&this._map.delete(U);this._lastCleanup=j}get size(){return this.cleanup(),this._map.size}forEach(j){this.cleanup();for(const[U,F]of this._map.entries())F.expiresAt>=Date.now()&&j(F.value,U,this.asValueMap())}map(j){this.cleanup();const U=[],F=this.asValueMap();for(const[B,q]of F.entries())U.push(j(q,B,F));return U}asValueMap(){const j=new Map;for(const[U,F]of this._map.entries())F.expiresAt>=Date.now()&&j.set(U,F.value);return j}}var lib={},parser={},grammar={exports:{}},hasRequiredGrammar;function requireGrammar(){if(hasRequiredGrammar)return grammar.exports;hasRequiredGrammar=1;var V=grammar.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(j){return j.encoding?"rtpmap:%d %s/%s/%s":j.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(j){return j.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(j){return j.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(j){return"extmap:%d"+(j.direction?"/%s":"%v")+(j["encrypt-uri"]?" %s":"%v")+" %s"+(j.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(j){return j.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(j){var U="candidate:%s %d %s %d %s %d typ %s";return U+=j.raddr!=null?" raddr %s rport %d":"%v%v",U+=j.tcptype!=null?" tcptype %s":"%v",j.generation!=null&&(U+=" generation %d"),U+=j["network-id"]!=null?" network-id %d":"%v",U+=j["network-cost"]!=null?" network-cost %d":"%v",U}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(j){var U="ssrc:%d";return j.attribute!=null&&(U+=" %s",j.value!=null&&(U+=":%s")),U}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(j){return j.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(j){return j.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(j){return"imageattr:%s %s %s"+(j.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(j){return"simulcast:%s %s"+(j.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(j){return"ts-refclk:%s"+(j.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(j){var U="mediaclk:";return U+=j.id!=null?"id=%s %s":"%v%s",U+=j.mediaClockValue!=null?"=%s":"",U+=j.rateNumerator!=null?" rate=%s":"",U+=j.rateDenominator!=null?"/%s":"",U}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(V).forEach(function(j){var U=V[j];U.forEach(function(F){F.reg||(F.reg=/(.*)/),F.format||(F.format="%s")})}),grammar.exports}var hasRequiredParser;function requireParser(){return hasRequiredParser||(hasRequiredParser=1,(function(V){var j=function(G){return String(Number(G))===G?Number(G):G},U=function(G,Y,Q,W){if(W&&!Q)Y[W]=j(G[1]);else for(var Z=0;Z<Q.length;Z+=1)G[Z+1]!=null&&(Y[Q[Z]]=j(G[Z+1]))},F=function(G,Y,Q){var W=G.name&&G.names;G.push&&!Y[G.push]?Y[G.push]=[]:W&&!Y[G.name]&&(Y[G.name]={});var Z=G.push?{}:W?Y[G.name]:Y;U(Q.match(G.reg),Z,G.names,G.name),G.push&&Y[G.push].push(Z)},B=requireGrammar(),q=RegExp.prototype.test.bind(/^([a-z])=(.*)/);V.parse=function(G){var Y={},Q=[],W=Y;return G.split(/(\r\n|\r|\n)/).filter(q).forEach(function(Z){var ee=Z[0],ne=Z.slice(2);ee==="m"&&(Q.push({rtp:[],fmtp:[]}),W=Q[Q.length-1]);for(var ae=0;ae<(B[ee]||[]).length;ae+=1){var se=B[ee][ae];if(se.reg.test(ne))return F(se,W,ne)}}),Y.media=Q,Y};var z=function(G,Y){var Q=Y.split(/=(.+)/,2);return Q.length===2?G[Q[0]]=j(Q[1]):Q.length===1&&Y.length>1&&(G[Q[0]]=void 0),G};V.parseParams=function(G){return G.split(/;\s?/).reduce(z,{})},V.parseFmtpConfig=V.parseParams,V.parsePayloads=function(G){return G.toString().split(" ").map(Number)},V.parseRemoteCandidates=function(G){for(var Y=[],Q=G.split(" ").map(j),W=0;W<Q.length;W+=3)Y.push({component:Q[W],ip:Q[W+1],port:Q[W+2]});return Y},V.parseImageAttributes=function(G){return G.split(" ").map(function(Y){return Y.substring(1,Y.length-1).split(",").reduce(z,{})})},V.parseSimulcastStreamList=function(G){return G.split(";").map(function(Y){return Y.split(",").map(function(Q){var W,Z=!1;return Q[0]!=="~"?W=j(Q):(W=j(Q.substring(1,Q.length)),Z=!0),{scid:W,paused:Z}})})}})(parser)),parser}var writer$1,hasRequiredWriter$1;function requireWriter$1(){if(hasRequiredWriter$1)return writer$1;hasRequiredWriter$1=1;var V=requireGrammar(),j=/%[sdv%]/g,U=function(z){var G=1,Y=arguments,Q=Y.length;return z.replace(j,function(W){if(G>=Q)return W;var Z=Y[G];switch(G+=1,W){case"%%":return"%";case"%s":return String(Z);case"%d":return Number(Z);case"%v":return""}})},F=function(z,G,Y){var Q=G.format instanceof Function?G.format(G.push?Y:Y[G.name]):G.format,W=[z+"="+Q];if(G.names)for(var Z=0;Z<G.names.length;Z+=1){var ee=G.names[Z];G.name?W.push(Y[G.name][ee]):W.push(Y[G.names[Z]])}else W.push(Y[G.name]);return U.apply(null,W)},B=["v","o","s","i","u","e","p","c","b","t","r","z","a"],q=["i","c","b","a"];return writer$1=function(z,G){G=G||{},z.version==null&&(z.version=0),z.name==null&&(z.name=" "),z.media.forEach(function(Z){Z.payloads==null&&(Z.payloads="")});var Y=G.outerOrder||B,Q=G.innerOrder||q,W=[];return Y.forEach(function(Z){V[Z].forEach(function(ee){ee.name in z&&z[ee.name]!=null?W.push(F(Z,ee,z)):ee.push in z&&z[ee.push]!=null&&z[ee.push].forEach(function(ne){W.push(F(Z,ee,ne))})})}),z.media.forEach(function(Z){W.push(F("m",V.m[0],Z)),Q.forEach(function(ee){V[ee].forEach(function(ne){ne.name in Z&&Z[ne.name]!=null?W.push(F(ee,ne,Z)):ne.push in Z&&Z[ne.push]!=null&&Z[ne.push].forEach(function(ae){W.push(F(ee,ne,ae))})})})}),W.join(`\r
`)+`\r
`},writer$1}var hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib;hasRequiredLib=1;var V=requireParser(),j=requireWriter$1(),U=requireGrammar();return lib.grammar=U,lib.write=j,lib.parse=V.parse,lib.parseParams=V.parseParams,lib.parseFmtpConfig=V.parseFmtpConfig,lib.parsePayloads=V.parsePayloads,lib.parseRemoteCandidates=V.parseRemoteCandidates,lib.parseImageAttributes=V.parseImageAttributes,lib.parseSimulcastStreamList=V.parseSimulcastStreamList,lib}var libExports=requireLib();function r$1(V,j,U){var F,B,q;j===void 0&&(j=50),U===void 0&&(U={});var z=(F=U.isImmediate)!=null&&F,G=(B=U.callback)!=null&&B,Y=U.maxWait,Q=Date.now(),W=[];function Z(){if(Y!==void 0){var ne=Date.now()-Q;if(ne+j>=Y)return Y-ne}return j}var ee=function(){var ne=[].slice.call(arguments),ae=this;return new Promise(function(se,de){var oe=z&&q===void 0;if(q!==void 0&&clearTimeout(q),q=setTimeout(function(){if(q=void 0,Q=Date.now(),!z){var he=V.apply(ae,ne);G&&G(he),W.forEach(function(ye){return(0,ye.resolve)(he)}),W=[]}},Z()),oe){var ue=V.apply(ae,ne);return G&&G(ue),se(ue)}W.push({resolve:se,reject:de})})};return ee.cancel=function(ne){q!==void 0&&clearTimeout(q),W.forEach(function(ae){return(0,ae.reject)(ne)}),W=[]},ee}const startBitrateForSVC=.7,debounceInterval=20,PCEvents={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class PCTransport extends eventsExports.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(j){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var F;super(),this.log=livekitLogger,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=r$1(B=>__awaiter$1(this,void 0,void 0,function*(){this.emit(PCEvents.NegotiationStarted);try{yield this.createAndSendOffer()}catch(q){if(B)B(q);else throw q}}),debounceInterval),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=getLogger((F=U.loggerName)!==null&&F!==void 0?F:LoggerNames.PCTransport),this.loggerOptions=U,this.config=j,this._pc=this.createPC(),this.offerLock=new _$1}createPC(){const j=new RTCPeerConnection(this.config);return j.onicecandidate=U=>{var F;U.candidate&&((F=this.onIceCandidate)===null||F===void 0||F.call(this,U.candidate))},j.onicecandidateerror=U=>{var F;(F=this.onIceCandidateError)===null||F===void 0||F.call(this,U)},j.oniceconnectionstatechange=()=>{var U;(U=this.onIceConnectionStateChange)===null||U===void 0||U.call(this,j.iceConnectionState)},j.onsignalingstatechange=()=>{var U;(U=this.onSignalingStatechange)===null||U===void 0||U.call(this,j.signalingState)},j.onconnectionstatechange=()=>{var U;(U=this.onConnectionStateChange)===null||U===void 0||U.call(this,j.connectionState)},j.ondatachannel=U=>{var F;(F=this.onDataChannel)===null||F===void 0||F.call(this,U)},j.ontrack=U=>{var F;(F=this.onTrack)===null||F===void 0||F.call(this,U)},j}get logContext(){var j,U;return Object.assign({},(U=(j=this.loggerOptions).loggerContextCb)===null||U===void 0?void 0:U.call(j))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(j){return __awaiter$1(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(j);this.pendingCandidates.push(j)})}setRemoteDescription(j,U){return __awaiter$1(this,void 0,void 0,function*(){var F;if(j.type==="answer"&&this.latestOfferId>0&&U>0&&U!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:U,latestOfferId:this.latestOfferId})),!1;let B;if(j.type==="offer"){let{stereoMids:q,nackMids:z}=extractStereoAndNackAudioFromOffer(j);this.remoteStereoMids=q,this.remoteNackMids=z}else if(j.type==="answer"){const q=libExports.parse((F=j.sdp)!==null&&F!==void 0?F:"");q.media.forEach(z=>{z.type==="audio"&&this.trackBitrates.some(G=>{if(!G.transceiver||z.mid!=G.transceiver.mid)return!1;let Y=0;if(z.rtp.some(W=>W.codec.toUpperCase()===G.codec.toUpperCase()?(Y=W.payload,!0):!1),Y===0)return!0;let Q=!1;for(const W of z.fmtp)if(W.payload===Y){W.config=W.config.split(";").filter(Z=>!Z.includes("maxaveragebitrate")).join(";"),G.maxbr>0&&(W.config+=";maxaveragebitrate=".concat(G.maxbr*1e3)),Q=!0;break}return Q||G.maxbr>0&&z.fmtp.push({payload:Y,config:"maxaveragebitrate=".concat(G.maxbr*1e3)}),!0})}),B=libExports.write(q)}return yield this.setMungedSDP(j,B,!0),this.pendingCandidates.forEach(q=>{this.pc.addIceCandidate(q)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):j.type==="answer"&&(this.emit(PCEvents.NegotiationComplete),j.sdp&&libExports.parse(j.sdp).media.forEach(z=>{z.type==="video"&&this.emit(PCEvents.RTPVideoPayloadTypes,z.rtp)})),!0})}createAndSendOffer(j){return __awaiter$1(this,void 0,void 0,function*(){var U;const F=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(j?.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const G=this._pc.remoteDescription;if(j?.iceRestart&&G)yield this._pc.setRemoteDescription(G);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const B=this.latestOfferId+1;this.latestOfferId=B;const q=yield this.pc.createOffer(j);this.log.debug("original offer",Object.assign({sdp:q.sdp},this.logContext));const z=libExports.parse((U=q.sdp)!==null&&U!==void 0?U:"");if(z.media.forEach(G=>{ensureIPAddrMatchVersion(G),G.type==="audio"?ensureAudioNackAndStereo(G,[],[]):G.type==="video"&&this.trackBitrates.some(Y=>{if(!G.msid||!Y.cid||!G.msid.includes(Y.cid))return!1;let Q=0;if(G.rtp.some(Z=>Z.codec.toUpperCase()===Y.codec.toUpperCase()?(Q=Z.payload,!0):!1),Q===0||(isSVCCodec(Y.codec)&&!isSafari()&&this.ensureVideoDDExtensionForSVC(G,z),Y.codec!=="av1"))return!0;const W=Math.round(Y.maxbr*startBitrateForSVC);for(const Z of G.fmtp)if(Z.payload===Q){Z.config.includes("x-google-start-bitrate")||(Z.config+=";x-google-start-bitrate=".concat(W));break}return!0})}),this.latestOfferId>B){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:B}));return}yield this.setMungedSDP(q,libExports.write(z)),this.onOffer(q,this.latestOfferId)}finally{F()}})}createAndSetAnswer(){return __awaiter$1(this,void 0,void 0,function*(){var j;const U=yield this.pc.createAnswer(),F=libExports.parse((j=U.sdp)!==null&&j!==void 0?j:"");return F.media.forEach(B=>{ensureIPAddrMatchVersion(B),B.type==="audio"&&ensureAudioNackAndStereo(B,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(U,libExports.write(F)),U})}createDataChannel(j,U){return this.pc.createDataChannel(j,U)}addTransceiver(j,U){return this.pc.addTransceiver(j,U)}addTrack(j){if(!this._pc)throw new UnexpectedConnectionState("PC closed, cannot add track");return this._pc.addTrack(j)}setTrackCodecBitrate(j){this.trackBitrates.push(j)}setConfiguration(j){var U;if(!this._pc)throw new UnexpectedConnectionState("PC closed, cannot configure");return(U=this._pc)===null||U===void 0?void 0:U.setConfiguration(j)}canRemoveTrack(){var j;return!!(!((j=this._pc)===null||j===void 0)&&j.removeTrack)}removeTrack(j){var U;return(U=this._pc)===null||U===void 0?void 0:U.removeTrack(j)}getConnectionState(){var j,U;return(U=(j=this._pc)===null||j===void 0?void 0:j.connectionState)!==null&&U!==void 0?U:"closed"}getICEConnectionState(){var j,U;return(U=(j=this._pc)===null||j===void 0?void 0:j.iceConnectionState)!==null&&U!==void 0?U:"closed"}getSignallingState(){var j,U;return(U=(j=this._pc)===null||j===void 0?void 0:j.signalingState)!==null&&U!==void 0?U:"closed"}getTransceivers(){var j,U;return(U=(j=this._pc)===null||j===void 0?void 0:j.getTransceivers())!==null&&U!==void 0?U:[]}getSenders(){var j,U;return(U=(j=this._pc)===null||j===void 0?void 0:j.getSenders())!==null&&U!==void 0?U:[]}getLocalDescription(){var j;return(j=this._pc)===null||j===void 0?void 0:j.localDescription}getRemoteDescription(){var j;return(j=this.pc)===null||j===void 0?void 0:j.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return __awaiter$1(this,void 0,void 0,function*(){var j;if(!this._pc)return;let U="";const F=new Map,B=new Map;if((yield this._pc.getStats()).forEach(G=>{switch(G.type){case"transport":U=G.selectedCandidatePairId;break;case"candidate-pair":U===""&&G.selected&&(U=G.id),F.set(G.id,G);break;case"remote-candidate":B.set(G.id,"".concat(G.address,":").concat(G.port));break}}),U==="")return;const z=(j=F.get(U))===null||j===void 0?void 0:j.remoteCandidateId;if(z!==void 0)return B.get(z)})}setMungedSDP(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){if(U){const B=j.sdp;j.sdp=U;try{this.log.debug("setting munged ".concat(F?"remote":"local"," description"),this.logContext),F?yield this.pc.setRemoteDescription(j):yield this.pc.setLocalDescription(j);return}catch(q){this.log.warn("not able to set ".concat(j.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:q,sdp:U})),j.sdp=B}}try{F?yield this.pc.setRemoteDescription(j):yield this.pc.setLocalDescription(j)}catch(B){let q="unknown error";B instanceof Error?q=B.message:typeof B=="string"&&(q=B);const z={error:q,sdp:j.sdp};throw!F&&this.pc.remoteDescription&&(z.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(j.type),Object.assign(Object.assign({},this.logContext),{fields:z})),new NegotiationError(q)}})}ensureVideoDDExtensionForSVC(j,U){var F,B;if(!((F=j.ext)===null||F===void 0?void 0:F.some(z=>z.uri===ddExtensionURI))){if(this.ddExtID===0){let z=0;U.media.forEach(G=>{var Y;G.type==="video"&&((Y=G.ext)===null||Y===void 0||Y.forEach(Q=>{Q.value>z&&(z=Q.value)}))}),this.ddExtID=z+1}(B=j.ext)===null||B===void 0||B.push({value:this.ddExtID,uri:ddExtensionURI})}}}function ensureAudioNackAndStereo(V,j,U){let F=0;V.rtp.some(B=>B.codec==="opus"?(F=B.payload,!0):!1),F>0&&(V.rtcpFb||(V.rtcpFb=[]),U.includes(V.mid)&&!V.rtcpFb.some(B=>B.payload===F&&B.type==="nack")&&V.rtcpFb.push({payload:F,type:"nack"}),j.includes(V.mid)&&V.fmtp.some(B=>B.payload===F?(B.config.includes("stereo=1")||(B.config+=";stereo=1"),!0):!1))}function extractStereoAndNackAudioFromOffer(V){var j;const U=[],F=[],B=libExports.parse((j=V.sdp)!==null&&j!==void 0?j:"");let q=0;return B.media.forEach(z=>{var G;z.type==="audio"&&(z.rtp.some(Y=>Y.codec==="opus"?(q=Y.payload,!0):!1),!((G=z.rtcpFb)===null||G===void 0)&&G.some(Y=>Y.payload===q&&Y.type==="nack")&&F.push(z.mid),z.fmtp.some(Y=>Y.payload===q?(Y.config.includes("sprop-stereo=1")&&U.push(z.mid),!0):!1))}),{stereoMids:U,nackMids:F}}function ensureIPAddrMatchVersion(V){if(V.connection){const j=V.connection.ip.indexOf(":")>=0;(V.connection.version===4&&j||V.connection.version===6&&!j)&&(V.connection.ip="0.0.0.0",V.connection.version=4)}}const defaultVideoCodec="vp8",publishDefaults={audioPreset:AudioPresets.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:ScreenSharePresets.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:defaultVideoCodec,backupCodec:!0,preConnectBuffer:!1},audioDefaults={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},videoDefaults={deviceId:{ideal:"default"},resolution:VideoPresets.h720.resolution},roomOptionDefaults={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new DefaultReconnectPolicy,disconnectOnPageLeave:!0,webAudioMix:!1},roomConnectOptionDefaults={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var PCTransportState;(function(V){V[V.NEW=0]="NEW",V[V.CONNECTING=1]="CONNECTING",V[V.CONNECTED=2]="CONNECTED",V[V.FAILED=3]="FAILED",V[V.CLOSING=4]="CLOSING",V[V.CLOSED=5]="CLOSED"})(PCTransportState||(PCTransportState={}));class PCTransportManager{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(j,U,F){var B;this.peerConnectionTimeout=roomConnectOptionDefaults.peerConnectionTimeout,this.log=livekitLogger,this.updateState=()=>{var q;const z=this.state,G=this.requiredTransports.map(Y=>Y.getConnectionState());G.every(Y=>Y==="connected")?this.state=PCTransportState.CONNECTED:G.some(Y=>Y==="failed")?this.state=PCTransportState.FAILED:G.some(Y=>Y==="connecting")?this.state=PCTransportState.CONNECTING:G.every(Y=>Y==="closed")?this.state=PCTransportState.CLOSED:G.some(Y=>Y==="closed")?this.state=PCTransportState.CLOSING:G.every(Y=>Y==="new")&&(this.state=PCTransportState.NEW),z!==this.state&&(this.log.debug("pc state change: from ".concat(PCTransportState[z]," to ").concat(PCTransportState[this.state]),this.logContext),(q=this.onStateChange)===null||q===void 0||q.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=getLogger((B=F.loggerName)!==null&&B!==void 0?B:LoggerNames.PCManager),this.loggerOptions=F,this.isPublisherConnectionRequired=!U,this.isSubscriberConnectionRequired=U,this.publisher=new PCTransport(j,F),this.subscriber=new PCTransport(j,F),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=q=>{var z;(z=this.onIceCandidate)===null||z===void 0||z.call(this,q,SignalTarget.PUBLISHER)},this.subscriber.onIceCandidate=q=>{var z;(z=this.onIceCandidate)===null||z===void 0||z.call(this,q,SignalTarget.SUBSCRIBER)},this.subscriber.onDataChannel=q=>{var z;(z=this.onDataChannel)===null||z===void 0||z.call(this,q)},this.subscriber.onTrack=q=>{var z;(z=this.onTrack)===null||z===void 0||z.call(this,q)},this.publisher.onOffer=(q,z)=>{var G;(G=this.onPublisherOffer)===null||G===void 0||G.call(this,q,z)},this.state=PCTransportState.NEW,this.connectionLock=new _$1,this.remoteOfferLock=new _$1}get logContext(){var j,U;return Object.assign({},(U=(j=this.loggerOptions).loggerContextCb)===null||U===void 0?void 0:U.call(j))}requirePublisher(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=j,this.updateState()}requireSubscriber(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=j,this.updateState()}createAndSendPublisherOffer(j){return this.publisher.createAndSendOffer(j)}setPublisherAnswer(j,U){return this.publisher.setRemoteDescription(j,U)}removeTrack(j){return this.publisher.removeTrack(j)}close(){return __awaiter$1(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const j=this.publisher;for(const U of j.getSenders())try{j.canRemoveTrack()&&j.removeTrack(U)}catch(F){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:F}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return __awaiter$1(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(j,U){return __awaiter$1(this,void 0,void 0,function*(){U===SignalTarget.PUBLISHER?yield this.publisher.addIceCandidate(j):yield this.subscriber.addIceCandidate(j)})}createSubscriberAnswerFromOffer(j,U){return __awaiter$1(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:j.type,sdp:j.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const F=yield this.remoteOfferLock.lock();try{return(yield this.subscriber.setRemoteDescription(j,U))?yield this.subscriber.createAndSetAnswer():void 0}finally{F()}})}updateConfiguration(j,U){this.publisher.setConfiguration(j),this.subscriber.setConfiguration(j),U&&this.triggerIceRestart()}ensurePCTransportConnection(j,U){return __awaiter$1(this,void 0,void 0,function*(){var F;const B=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((F=this.requiredTransports)===null||F===void 0?void 0:F.map(q=>this.ensureTransportConnected(q,j,U)))}finally{B()}})}negotiate(j){return __awaiter$1(this,void 0,void 0,function*(){return new Promise((U,F)=>__awaiter$1(this,void 0,void 0,function*(){const B=setTimeout(()=>{F("negotiation timed out")},this.peerConnectionTimeout),q=()=>{clearTimeout(B),F("negotiation aborted")};j.signal.addEventListener("abort",q),this.publisher.once(PCEvents.NegotiationStarted,()=>{j.signal.aborted||this.publisher.once(PCEvents.NegotiationComplete,()=>{clearTimeout(B),U()})}),yield this.publisher.negotiate(z=>{clearTimeout(B),F(z)})}))})}addPublisherTransceiver(j,U){return this.publisher.addTransceiver(j,U)}addPublisherTrack(j){return this.publisher.addTrack(j)}createPublisherDataChannel(j,U){return this.publisher.createDataChannel(j,U)}getConnectedAddress(j){return j===SignalTarget.PUBLISHER?this.publisher.getConnectedAddress():j===SignalTarget.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const j=[];return this.isPublisherConnectionRequired&&j.push(this.publisher),this.isSubscriberConnectionRequired&&j.push(this.subscriber),j}ensureTransportConnected(j,U){return __awaiter$1(this,arguments,void 0,function(F,B){var q=this;let z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return(function*(){if(F.getConnectionState()!=="connected")return new Promise((Y,Q)=>__awaiter$1(q,void 0,void 0,function*(){const W=()=>{this.log.warn("abort transport connection",this.logContext),CriticalTimers.clearTimeout(Z),Q(new ConnectionError("room connection has been cancelled",ConnectionErrorReason.Cancelled))};B?.signal.aborted&&W(),B?.signal.addEventListener("abort",W);const Z=CriticalTimers.setTimeout(()=>{B?.signal.removeEventListener("abort",W),Q(new ConnectionError("could not establish pc connection",ConnectionErrorReason.InternalError))},z);for(;this.state!==PCTransportState.CONNECTED;)if(yield sleep$1(50),B?.signal.aborted){Q(new ConnectionError("room connection has been cancelled",ConnectionErrorReason.Cancelled));return}CriticalTimers.clearTimeout(Z),B?.signal.removeEventListener("abort",W),Y()}))})()})}}class RpcError extends Error{constructor(j,U,F){super(U),this.code=j,this.message=truncateBytes(U,RpcError.MAX_MESSAGE_BYTES),this.data=F?truncateBytes(F,RpcError.MAX_DATA_BYTES):void 0}static fromProto(j){return new RpcError(j.code,j.message,j.data)}toProto(){return new RpcError$1({code:this.code,message:this.message,data:this.data})}static builtIn(j,U){return new RpcError(RpcError.ErrorCode[j],RpcError.ErrorMessage[j],U)}}RpcError.MAX_MESSAGE_BYTES=256,RpcError.MAX_DATA_BYTES=15360,RpcError.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},RpcError.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const MAX_PAYLOAD_BYTES=15360;function byteLength(V){return new TextEncoder().encode(V).length}function truncateBytes(V,j){if(byteLength(V)<=j)return V;let U=0,F=V.length;const B=new TextEncoder;for(;U<F;){const q=Math.floor((U+F+1)/2);B.encode(V.slice(0,q)).length<=j?U=q:F=q-1}return V.slice(0,U)}const monitorFrequency=2e3;function computeBitrate(V,j){if(!j)return 0;let U,F;return"bytesReceived"in V?(U=V.bytesReceived,F=j.bytesReceived):"bytesSent"in V&&(U=V.bytesSent,F=j.bytesSent),U===void 0||F===void 0||V.timestamp===void 0||j.timestamp===void 0?0:(U-F)*8*1e3/(V.timestamp-j.timestamp)}const isMediaRecorderAvailable=typeof MediaRecorder<"u";class FallbackRecorder{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const RecorderBase=isMediaRecorderAvailable?MediaRecorder:FallbackRecorder;class LocalTrackRecorder extends RecorderBase{constructor(j,U){if(!isMediaRecorderAvailable)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([j.mediaStreamTrack]),U);let F,B;const q=()=>B===void 0,z=()=>{this.removeEventListener("dataavailable",F),this.removeEventListener("stop",z),this.removeEventListener("error",G),B?.close(),B=void 0},G=Y=>{B?.error(Y),this.removeEventListener("dataavailable",F),this.removeEventListener("stop",z),this.removeEventListener("error",G),B=void 0};this.byteStream=new ReadableStream({start:Y=>{B=Y,F=Q=>__awaiter$1(this,void 0,void 0,function*(){let W;if(Q.data.arrayBuffer){const Z=yield Q.data.arrayBuffer();W=new Uint8Array(Z)}else if(Q.data.byteArray)W=Q.data.byteArray;else throw new Error("no data available!");q()||Y.enqueue(W)}),this.addEventListener("dataavailable",F)},cancel:()=>{z()}}),this.addEventListener("stop",z),this.addEventListener("error",G)}}function isRecordingSupported(){return isMediaRecorderAvailable}const DEFAULT_DIMENSIONS_TIMEOUT=1e3,PRE_CONNECT_BUFFER_TIMEOUT=1e4;class LocalTrack extends Track{get sender(){return this._sender}set sender(j){this._sender=j}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(j,U,F){let B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,q=arguments.length>4?arguments[4]:void 0;super(j,U,q),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=r$1(()=>__awaiter$1(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>__awaiter$1(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(TrackEvent.Ended,this)},this.reacquireTrack=!1,this.providedByUser=B,this.muteLock=new _$1,this.pauseUpstreamLock=new _$1,this.trackChangeLock=new _$1,this.trackChangeLock.lock().then(z=>__awaiter$1(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(j,!0)}finally{z()}})),this._constraints=j.getConstraints(),F&&(this._constraints=F)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Track.Kind.Video)return;const{width:j,height:U}=this._mediaStreamTrack.getSettings();if(j&&U)return{width:j,height:U}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var j,U;return(U=(j=this.processor)===null||j===void 0?void 0:j.processedTrack)!==null&&U!==void 0?U:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(j,U){return __awaiter$1(this,void 0,void 0,function*(){var F;if(j===this._mediaStreamTrack&&!U)return;this._mediaStreamTrack&&(this.attachedElements.forEach(q=>{detachTrack(this._mediaStreamTrack,q)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([j]),j&&(j.addEventListener("ended",this.handleEnded),j.addEventListener("mute",this.handleTrackMuteEvent),j.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=j.getConstraints());let B;if(this.processor&&j){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(attachToElement(j,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:j,kind:this.kind,element:this.processorElement}),B=this.processor.processedTrack}this.sender&&((F=this.sender.transport)===null||F===void 0?void 0:F.state)!=="closed"&&(yield this.sender.replaceTrack(B??j)),!this.providedByUser&&this._mediaStreamTrack!==j&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=j,j&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(q=>{attachToElement(B??j,q)}))})}waitForDimensions(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DIMENSIONS_TIMEOUT;return(function*(){var F;if(j.kind===Track.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((F=getBrowser())===null||F===void 0?void 0:F.os)==="iOS"&&(yield sleep$1(10));const B=Date.now();for(;Date.now()-B<U;){const q=j.dimensions;if(q)return q;yield sleep$1(50)}throw new TrackInvalidError("unable to get track dimensions after timeout")})()})}setDeviceId(j){return __awaiter$1(this,void 0,void 0,function*(){return this._constraints.deviceId===j&&this._mediaStreamTrack.getSettings().deviceId===unwrapConstraint(j)||(this._constraints.deviceId=j,this.isMuted)?!0:(yield this.restartTrack(),unwrapConstraint(j)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){if(j.source===Track.Source.ScreenShare)return;const{deviceId:F,groupId:B}=j._mediaStreamTrack.getSettings(),q=j.kind===Track.Kind.Audio?"audioinput":"videoinput";return U?DeviceManager.getInstance().normalizeDeviceId(q,F,B):F})()})}mute(){return __awaiter$1(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return __awaiter$1(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(j,U){return __awaiter$1(this,void 0,void 0,function*(){const F=yield this.trackChangeLock.lock();try{if(!this.sender)throw new TrackInvalidError("unable to replace an unpublished track");let B,q;return typeof U=="boolean"?B=U:U!==void 0&&(B=U.userProvidedTrack,q=U.stopProcessor),this.providedByUser=B??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(j),q&&this.processor&&(yield this.internalStopProcessor()),this}finally{F()}})}restart(j){return __awaiter$1(this,void 0,void 0,function*(){this.manuallyStopped=!1;const U=yield this.trackChangeLock.lock();try{j||(j=this._constraints);const{deviceId:F,facingMode:B}=j,q=__rest(j,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:j}));const z={audio:!1,video:!1};this.kind===Track.Kind.Video?z.video=F||B?{deviceId:F,facingMode:B}:!0:z.audio=F?{deviceId:F}:!0,this.attachedElements.forEach(Q=>{detachTrack(this.mediaStreamTrack,Q)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const Y=(yield navigator.mediaDevices.getUserMedia(z)).getTracks()[0];return yield Y.applyConstraints(q),Y.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(Y),this._constraints=j,this.emit(TrackEvent.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{U()}})}setTrackMuted(j){this.log.debug("setting ".concat(this.kind," track ").concat(j?"muted":"unmuted"),this.logContext),!(this.isMuted===j&&this._mediaStreamTrack.enabled!==j)&&(this.isMuted=j,this._mediaStreamTrack.enabled=!j,this.emit(j?TrackEvent.Muted:TrackEvent.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const j=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter$1(this,void 0,void 0,function*(){yield j.handleAppVisibilityChanged.call(this),isMobile()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var j;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(j=this.processor)===null||j===void 0||j.destroy(),this.processor=void 0}pauseUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var j;const U=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(TrackEvent.UpstreamPaused,this);const F=getBrowser();if(F?.name==="Safari"&&compareVersions(F.version,"12.0")<0)throw new DeviceUnsupportedError("pauseUpstream is not supported on Safari < 12.");((j=this.sender.transport)===null||j===void 0?void 0:j.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{U()}})}resumeUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var j;const U=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(TrackEvent.UpstreamResumed,this),((j=this.sender.transport)===null||j===void 0?void 0:j.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{U()}})}getRTCStatsReport(){return __awaiter$1(this,void 0,void 0,function*(){var j;return!((j=this.sender)===null||j===void 0)&&j.getStats?yield this.sender.getStats():void 0})}setProcessor(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var q;const z=yield F.trackChangeLock.lock();try{F.log.debug("setting up processor",F.logContext);const G=document.createElement(F.kind),Y={kind:F.kind,track:F._mediaStreamTrack,element:G,audioContext:F.audioContext};if(yield U.init(Y),F.log.debug("processor initialized",F.logContext),F.processor&&(yield F.internalStopProcessor()),F.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(attachToElement(F._mediaStreamTrack,G),G.muted=!0,G.play().catch(Q=>{Q instanceof DOMException&&Q.name==="AbortError"?(F.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},F.logContext),{error:Q})),setTimeout(()=>{G.play().catch(W=>{F.log.error("failed to play processor element",Object.assign(Object.assign({},F.logContext),{err:W}))})},100)):F.log.error("failed to play processor element",Object.assign(Object.assign({},F.logContext),{error:Q}))}),F.processor=U,F.processorElement=G,F.processor.processedTrack){for(const Q of F.attachedElements)Q!==F.processorElement&&B&&(detachTrack(F._mediaStreamTrack,Q),attachToElement(F.processor.processedTrack,Q));yield(q=F.sender)===null||q===void 0?void 0:q.replaceTrack(F.processor.processedTrack)}F.emit(TrackEvent.TrackProcessorUpdate,F.processor)}finally{z()}})()})}getProcessor(){return this.processor}stopProcessor(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){const F=yield j.trackChangeLock.lock();try{yield j.internalStopProcessor(U)}finally{F()}})()})}internalStopProcessor(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var F,B;j.processor&&(j.log.debug("stopping processor",j.logContext),(F=j.processor.processedTrack)===null||F===void 0||F.stop(),yield j.processor.destroy(),j.processor=void 0,U||((B=j.processorElement)===null||B===void 0||B.remove(),j.processorElement=void 0),yield j._mediaStreamTrack.applyConstraints(j._constraints),yield j.setMediaStreamTrack(j._mediaStreamTrack,!0),j.emit(TrackEvent.TrackProcessorUpdate))})()})}startPreConnectBuffer(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!isRecordingSupported()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let U="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(U)||(U="video/mp4"),this.localTrackRecorder=new LocalTrackRecorder(this,{mimeType:U})}this.localTrackRecorder.start(j),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},PRE_CONNECT_BUFFER_TIMEOUT)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var j;return(j=this.localTrackRecorder)===null||j===void 0?void 0:j.byteStream}getPreConnectBufferMimeType(){var j;return(j=this.localTrackRecorder)===null||j===void 0?void 0:j.mimeType}}class LocalAudioTrack extends LocalTrack{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(j,U){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,B=arguments.length>3?arguments[3]:void 0,q=arguments.length>4?arguments[4]:void 0;super(j,Track.Kind.Audio,U,F,q),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let z;try{z=yield this.getSenderStats()}catch(G){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:G}));return}z&&this.prevStats&&(this._currentBitrate=computeBitrate(z,this.prevStats)),this.prevStats=z}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(TrackEvent.AudioTrackFeatureUpdate,this,AudioTrackFeature.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(TrackEvent.AudioTrackFeatureUpdate,this,AudioTrackFeature.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=B,this.checkForSilence()}mute(){const j=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter$1(this,void 0,void 0,function*(){const U=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Track.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield j.mute.call(this),this)}finally{U()}})}unmute(){const j=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter$1(this,void 0,void 0,function*(){const U=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const F=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==unwrapConstraint(this._constraints.deviceId);return this.source===Track.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||F)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield j.unmute.call(this),this}finally{U()}})}restartTrack(j){return __awaiter$1(this,void 0,void 0,function*(){let U;if(j){const F=constraintsForOptions({audio:j});typeof F.audio!="boolean"&&(U=F.audio)}yield this.restart(U)})}restart(j){const U=Object.create(null,{restart:{get:()=>super.restart}});return __awaiter$1(this,void 0,void 0,function*(){const F=yield U.restart.call(this,j);return this.checkForSilence(),F})}startMonitor(){isWeb()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency)))}setProcessor(j){return __awaiter$1(this,void 0,void 0,function*(){var U;const F=yield this.trackChangeLock.lock();try{if(!isReactNative()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const B={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(j.name),this.logContext),yield j.init(B),this.processor=j,this.processor.processedTrack&&(yield(U=this.sender)===null||U===void 0?void 0:U.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(TrackEvent.TrackProcessorUpdate,this.processor)}finally{F()}})}setAudioContext(j){this.audioContext=j}getSenderStats(){return __awaiter$1(this,void 0,void 0,function*(){var j;if(!(!((j=this.sender)===null||j===void 0)&&j.getStats))return;const U=yield this.sender.getStats();let F;return U.forEach(B=>{B.type==="outbound-rtp"&&(F={type:"audio",streamId:B.id,packetsSent:B.packetsSent,packetsLost:B.packetsLost,bytesSent:B.bytesSent,timestamp:B.timestamp,roundTripTime:B.roundTripTime,jitter:B.jitter})}),F})}checkForSilence(){return __awaiter$1(this,void 0,void 0,function*(){const j=yield detectSilence(this);return j&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(TrackEvent.AudioSilenceDetected)),j})}}function mediaTrackToLocalTrack(V,j,U){switch(V.kind){case"audio":return new LocalAudioTrack(V,j,!1,void 0,U);case"video":return new LocalVideoTrack(V,j,!1,U);default:throw new TrackInvalidError("unsupported track type: ".concat(V.kind))}}const presets169=Object.values(VideoPresets),presets43=Object.values(VideoPresets43),presetsScreenShare=Object.values(ScreenSharePresets),defaultSimulcastPresets169=[VideoPresets.h180,VideoPresets.h360],defaultSimulcastPresets43=[VideoPresets43.h180,VideoPresets43.h360],computeDefaultScreenShareSimulcastPresets=V=>[{scaleResolutionDownBy:2,fps:V.encoding.maxFramerate}].map(U=>{var F,B;return new VideoPreset(Math.floor(V.width/U.scaleResolutionDownBy),Math.floor(V.height/U.scaleResolutionDownBy),Math.max(15e4,Math.floor(V.encoding.maxBitrate/(Math.pow(U.scaleResolutionDownBy,2)*(((F=V.encoding.maxFramerate)!==null&&F!==void 0?F:30)/((B=U.fps)!==null&&B!==void 0?B:30))))),U.fps,V.encoding.priority)}),videoRids=["q","h","f"];function computeVideoEncodings(V,j,U,F){var B,q;let z=F?.videoEncoding;V&&(z=F?.screenShareEncoding);const G=F?.simulcast,Y=F?.scalabilityMode,Q=F?.videoCodec;if(!z&&!G&&!Y||!j||!U)return[{}];z||(z=determineAppropriateEncoding(V,j,U,Q),livekitLogger.debug("using video encoding",z));const W=z.maxFramerate,Z=new VideoPreset(j,U,z.maxBitrate,z.maxFramerate,z.priority);if(Y&&isSVCCodec(Q)){const ae=new ScalabilityMode(Y),se=[];if(ae.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(Y));const de=getBrowser();if(isSafariBased()||isReactNative()||de?.name==="Chrome"&&compareVersions(de?.version,"113")<0){const oe=ae.suffix=="h"?2:3,ue=isSafariSvcApi(de);for(let he=0;he<ae.spatial;he+=1)se.push({rid:videoRids[2-he],maxBitrate:z.maxBitrate/Math.pow(oe,he),maxFramerate:Z.encoding.maxFramerate,scaleResolutionDownBy:ue?Math.pow(2,he):void 0});se[0].scalabilityMode=Y}else se.push({maxBitrate:z.maxBitrate,maxFramerate:Z.encoding.maxFramerate,scalabilityMode:Y});return Z.encoding.priority&&(se[0].priority=Z.encoding.priority,se[0].networkPriority=Z.encoding.priority),livekitLogger.debug("using svc encoding",{encodings:se}),se}if(!G)return[z];let ee=[];V?ee=(B=sortPresets(F?.screenShareSimulcastLayers))!==null&&B!==void 0?B:defaultSimulcastLayers(V,Z):ee=(q=sortPresets(F?.videoSimulcastLayers))!==null&&q!==void 0?q:defaultSimulcastLayers(V,Z);let ne;if(ee.length>0){const ae=ee[0];ee.length>1&&([,ne]=ee);const se=Math.max(j,U);if(se>=960&&ne)return encodingsFromPresets(j,U,[ae,ne,Z],W);if(se>=480)return encodingsFromPresets(j,U,[ae,Z],W)}return encodingsFromPresets(j,U,[Z])}function computeTrackBackupEncodings(V,j,U){var F,B,q,z;if(!U.backupCodec||U.backupCodec===!0||U.backupCodec.codec===U.videoCodec)return;j!==U.backupCodec.codec&&livekitLogger.warn("requested a different codec than specified as backup",{serverRequested:j,backup:U.backupCodec.codec}),U.videoCodec=j,U.videoEncoding=U.backupCodec.encoding;const G=V.mediaStreamTrack.getSettings(),Y=(F=G.width)!==null&&F!==void 0?F:(B=V.dimensions)===null||B===void 0?void 0:B.width,Q=(q=G.height)!==null&&q!==void 0?q:(z=V.dimensions)===null||z===void 0?void 0:z.height;return V.source===Track.Source.ScreenShare&&U.simulcast&&(U.simulcast=!1),computeVideoEncodings(V.source===Track.Source.ScreenShare,Y,Q,U)}function determineAppropriateEncoding(V,j,U,F){const B=presetsForResolution(V,j,U);let{encoding:q}=B[0];const z=Math.max(j,U);for(let G=0;G<B.length;G+=1){const Y=B[G];if(q=Y.encoding,Y.width>=z)break}if(F)switch(F){case"av1":case"h265":q=Object.assign({},q),q.maxBitrate=q.maxBitrate*.7;break;case"vp9":q=Object.assign({},q),q.maxBitrate=q.maxBitrate*.85;break}return q}function presetsForResolution(V,j,U){if(V)return presetsScreenShare;const F=j>U?j/U:U/j;return Math.abs(F-16/9)<Math.abs(F-4/3)?presets169:presets43}function defaultSimulcastLayers(V,j){if(V)return computeDefaultScreenShareSimulcastPresets(j);const{width:U,height:F}=j,B=U>F?U/F:F/U;return Math.abs(B-16/9)<Math.abs(B-4/3)?defaultSimulcastPresets169:defaultSimulcastPresets43}function encodingsFromPresets(V,j,U,F){const B=[];if(U.forEach((q,z)=>{if(z>=videoRids.length)return;const G=Math.min(V,j),Q={rid:videoRids[z],scaleResolutionDownBy:Math.max(1,G/Math.min(q.width,q.height)),maxBitrate:q.encoding.maxBitrate},W=F&&q.encoding.maxFramerate?Math.min(F,q.encoding.maxFramerate):q.encoding.maxFramerate;W&&(Q.maxFramerate=W);const Z=isFireFox()||z===0;q.encoding.priority&&Z&&(Q.priority=q.encoding.priority,Q.networkPriority=q.encoding.priority),B.push(Q)}),isReactNative()&&getReactNativeOs()==="ios"){let q;B.forEach(G=>{q?G.maxFramerate&&G.maxFramerate>q&&(q=G.maxFramerate):q=G.maxFramerate});let z=!0;B.forEach(G=>{var Y;G.maxFramerate!=q&&(z&&(z=!1,livekitLogger.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),livekitLogger.info('Setting framerate of encoding "'.concat((Y=G.rid)!==null&&Y!==void 0?Y:"",'" to ').concat(q)),G.maxFramerate=q)})}return B}function sortPresets(V){if(V)return V.sort((j,U)=>{const{encoding:F}=j,{encoding:B}=U;return F.maxBitrate>B.maxBitrate?1:F.maxBitrate<B.maxBitrate?-1:F.maxBitrate===B.maxBitrate&&F.maxFramerate&&B.maxFramerate?F.maxFramerate>B.maxFramerate?1:-1:0})}class ScalabilityMode{constructor(j){const U=j.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!U)throw new Error("invalid scalability mode");if(this.spatial=parseInt(U[1]),this.temporal=parseInt(U[2]),U.length>3)switch(U[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=U[3]}}toString(){var j;return"L".concat(this.spatial,"T").concat(this.temporal).concat((j=this.suffix)!==null&&j!==void 0?j:"")}}function getDefaultDegradationPreference(V){return V.source===Track.Source.ScreenShare||V.constraints.height&&unwrapConstraint(V.constraints.height)>=1080?"maintain-resolution":"balanced"}const refreshSubscribedCodecAfterNewCodec=5e3;class LocalVideoTrack extends LocalTrack{get sender(){return this._sender}set sender(j){this._sender=j,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(j,U){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,B=arguments.length>3?arguments[3]:void 0;super(j,Track.Kind.Video,U,F,B),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let q;try{q=yield this.getSenderStats()}catch(Y){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:Y}));return}const z=new Map(q.map(Y=>[Y.rid,Y])),G=q.some(Y=>Y.qualityLimitationReason==="cpu");if(G!==this.isCpuConstrained&&(this.isCpuConstrained=G,this.isCpuConstrained&&this.emit(TrackEvent.CpuConstrained)),this.prevStats){let Y=0;z.forEach((Q,W)=>{var Z;const ee=(Z=this.prevStats)===null||Z===void 0?void 0:Z.get(W);Y+=computeBitrate(Q,ee)}),this._currentBitrate=Y}this.prevStats=z}),this.senderLock=new _$1}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(j){var U;if(this.signalClient=j,!isWeb())return;const F=(U=this.sender)===null||U===void 0?void 0:U.getParameters();F&&(this.encodings=F.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(j=>{j.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const j=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return __awaiter$1(this,void 0,void 0,function*(){var U,F,B,q,z;yield j.pauseUpstream.call(this);try{for(var G=!0,Y=__asyncValues(this.simulcastCodecs.values()),Q;Q=yield Y.next(),U=Q.done,!U;G=!0)q=Q.value,G=!1,yield(z=q.sender)===null||z===void 0?void 0:z.replaceTrack(null)}catch(W){F={error:W}}finally{try{!G&&!U&&(B=Y.return)&&(yield B.call(Y))}finally{if(F)throw F.error}}})}resumeUpstream(){const j=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return __awaiter$1(this,void 0,void 0,function*(){var U,F,B,q,z;yield j.resumeUpstream.call(this);try{for(var G=!0,Y=__asyncValues(this.simulcastCodecs.values()),Q;Q=yield Y.next(),U=Q.done,!U;G=!0){q=Q.value,G=!1;const W=q;yield(z=W.sender)===null||z===void 0?void 0:z.replaceTrack(W.mediaStreamTrack)}}catch(W){F={error:W}}finally{try{!G&&!U&&(B=Y.return)&&(yield B.call(Y))}finally{if(F)throw F.error}}})}mute(){const j=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter$1(this,void 0,void 0,function*(){const U=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Track.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield j.mute.call(this),this)}finally{U()}})}unmute(){const j=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter$1(this,void 0,void 0,function*(){const U=yield this.muteLock.lock();try{return this.isMuted?(this.source===Track.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield j.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{U()}})}setTrackMuted(j){super.setTrackMuted(j);for(const U of this.simulcastCodecs.values())U.mediaStreamTrack.enabled=!j}getSenderStats(){return __awaiter$1(this,void 0,void 0,function*(){var j;if(!(!((j=this.sender)===null||j===void 0)&&j.getStats))return[];const U=[],F=yield this.sender.getStats();return F.forEach(B=>{var q;if(B.type==="outbound-rtp"){const z={type:"video",streamId:B.id,frameHeight:B.frameHeight,frameWidth:B.frameWidth,framesPerSecond:B.framesPerSecond,framesSent:B.framesSent,firCount:B.firCount,pliCount:B.pliCount,nackCount:B.nackCount,packetsSent:B.packetsSent,bytesSent:B.bytesSent,qualityLimitationReason:B.qualityLimitationReason,qualityLimitationDurations:B.qualityLimitationDurations,qualityLimitationResolutionChanges:B.qualityLimitationResolutionChanges,rid:(q=B.rid)!==null&&q!==void 0?q:B.id,retransmittedPacketsSent:B.retransmittedPacketsSent,targetBitrate:B.targetBitrate,timestamp:B.timestamp},G=F.get(B.remoteId);G&&(z.jitter=G.jitter,z.packetsLost=G.packetsLost,z.roundTripTime=G.roundTripTime),U.push(z)}}),U.sort((B,q)=>{var z,G;return((z=q.frameWidth)!==null&&z!==void 0?z:0)-((G=B.frameWidth)!==null&&G!==void 0?G:0)}),U})}setPublishingQuality(j){const U=[];for(let F=VideoQuality.LOW;F<=VideoQuality.HIGH;F+=1)U.push(new SubscribedQuality({quality:F,enabled:F<=j}));this.log.debug("setting publishing quality. max quality ".concat(j),this.logContext),this.setPublishingLayers(isSVCCodec(this.codec),U)}restartTrack(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F,B,q,z;let G;if(j){const Z=constraintsForOptions({video:j});typeof Z.video!="boolean"&&(G=Z.video)}yield this.restart(G),this.isCpuConstrained=!1;try{for(var Y=!0,Q=__asyncValues(this.simulcastCodecs.values()),W;W=yield Q.next(),U=W.done,!U;Y=!0){q=W.value,Y=!1;const Z=q;Z.sender&&((z=Z.sender.transport)===null||z===void 0?void 0:z.state)!=="closed"&&(Z.mediaStreamTrack=this.mediaStreamTrack.clone(),yield Z.sender.replaceTrack(Z.mediaStreamTrack))}}catch(Z){F={error:Z}}finally{try{!Y&&!U&&(B=Q.return)&&(yield B.call(Q))}finally{if(F)throw F.error}}})}setProcessor(j){const U=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return __awaiter$1(this,arguments,void 0,function(F){var B=this;let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var z,G,Y,Q,W,Z;if(yield U.setProcessor.call(B,F,q),!((W=B.processor)===null||W===void 0)&&W.processedTrack)try{for(var ee=!0,ne=__asyncValues(B.simulcastCodecs.values()),ae;ae=yield ne.next(),z=ae.done,!z;ee=!0)Q=ae.value,ee=!1,yield(Z=Q.sender)===null||Z===void 0?void 0:Z.replaceTrack(B.processor.processedTrack)}catch(se){G={error:se}}finally{try{!ee&&!z&&(Y=ne.return)&&(yield Y.call(ne))}finally{if(G)throw G.error}}})()})}setDegradationPreference(j){return __awaiter$1(this,void 0,void 0,function*(){if(this.degradationPreference=j,this.sender)try{this.log.debug("setting degradationPreference to ".concat(j),this.logContext);const U=this.sender.getParameters();U.degradationPreference=j,this.sender.setParameters(U)}catch(U){this.log.warn("failed to set degradationPreference",Object.assign({error:U},this.logContext))}})}addSimulcastTrack(j,U){if(this.simulcastCodecs.has(j)){this.log.error("".concat(j," already added, skipping adding simulcast codec"),this.logContext);return}const F={codec:j,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:U};return this.simulcastCodecs.set(j,F),F}setSimulcastTrackSender(j,U){const F=this.simulcastCodecs.get(j);F&&(F.sender=U,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},refreshSubscribedCodecAfterNewCodec))}setPublishingCodecs(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F,B,q,z,G,Y;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:j,currentCodec:this.codec})),!this.codec&&j.length>0)return yield this.setPublishingLayers(isSVCCodec(j[0].codec),j[0].qualities),[];this.subscribedCodecs=j;const Q=[];try{for(U=!0,F=__asyncValues(j);B=yield F.next(),q=B.done,!q;U=!0){Y=B.value,U=!1;const W=Y;if(!this.codec||this.codec===W.codec)yield this.setPublishingLayers(isSVCCodec(W.codec),W.qualities);else{const Z=this.simulcastCodecs.get(W.codec);if(this.log.debug("try setPublishingCodec for ".concat(W.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:Z})),!Z||!Z.sender){for(const ee of W.qualities)if(ee.enabled){Q.push(W.codec);break}}else Z.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(W.codec),this.logContext),yield setPublishingLayersForSender(Z.sender,Z.encodings,W.qualities,this.senderLock,isSVCCodec(W.codec),this.log,this.logContext))}}}catch(W){z={error:W}}finally{try{!U&&!q&&(G=F.return)&&(yield G.call(F))}finally{if(z)throw z.error}}return Q})}setPublishingLayers(j,U){return __awaiter$1(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:U}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:U})),!(!this.sender||!this.encodings)&&(yield setPublishingLayersForSender(this.sender,this.encodings,U,this.senderLock,j,this.log,this.logContext))})}prioritizePerformance(){return __awaiter$1(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const j=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const U=this.sender.getParameters();U.encodings=U.encodings.map((F,B)=>{var q;return Object.assign(Object.assign({},F),{active:B===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((q=this.mediaStreamTrack.getSettings().height)!==null&&q!==void 0?q:360)/360)),scalabilityMode:B===0&&isSVCCodec(this.codec)?"L1T3":void 0,maxFramerate:B===0?15:0,maxBitrate:B===0?F.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:U.encodings})),this.encodings=U.encodings,yield this.sender.setParameters(U)}catch(U){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:U})),this.optimizeForPerformance=!1}finally{j()}})}handleAppVisibilityChanged(){const j=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter$1(this,void 0,void 0,function*(){yield j.handleAppVisibilityChanged.call(this),isMobile()&&this.isInBackground&&this.source===Track.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function setPublishingLayersForSender(V,j,U,F,B,q,z){return __awaiter$1(this,void 0,void 0,function*(){const G=yield F.lock();q.debug("setPublishingLayersForSender",Object.assign(Object.assign({},z),{sender:V,qualities:U,senderEncodings:j}));try{const Y=V.getParameters(),{encodings:Q}=Y;if(!Q)return;if(Q.length!==j.length){q.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},z),{encodings:Q,senderEncodings:j}));return}let W=!1;!1&&Q[0].scalabilityMode||(B&&U.some(ne=>ne.enabled)&&U.forEach(ne=>ne.enabled=!0),Q.forEach((ee,ne)=>{var ae;let se=(ae=ee.rid)!==null&&ae!==void 0?ae:"";se===""&&(se="q");const de=videoQualityForRid(se),oe=U.find(ue=>ue.quality===de);oe&&ee.active!==oe.enabled&&(W=!0,ee.active=oe.enabled,q.debug("setting layer ".concat(oe.quality," to ").concat(ee.active?"enabled":"disabled"),z),isFireFox()&&(oe.enabled?(ee.scaleResolutionDownBy=j[ne].scaleResolutionDownBy,ee.maxBitrate=j[ne].maxBitrate,ee.maxFrameRate=j[ne].maxFrameRate):(ee.scaleResolutionDownBy=4,ee.maxBitrate=10,ee.maxFrameRate=2)))})),W&&(Y.encodings=Q,q.debug("setting encodings",Object.assign(Object.assign({},z),{encodings:Y.encodings})),yield V.setParameters(Y))}finally{G()}})}function videoQualityForRid(V){switch(V){case"f":return VideoQuality.HIGH;case"h":return VideoQuality.MEDIUM;case"q":return VideoQuality.LOW;default:return VideoQuality.HIGH}}function videoLayersFromEncodings(V,j,U,F){if(!U)return[new VideoLayer({quality:VideoQuality.HIGH,width:V,height:j,bitrate:0,ssrc:0})];if(F){const B=U[0].scalabilityMode,q=new ScalabilityMode(B),z=[],G=q.suffix=="h"?1.5:2,Y=q.suffix=="h"?2:3;for(let Q=0;Q<q.spatial;Q+=1)z.push(new VideoLayer({quality:Math.min(VideoQuality.HIGH,q.spatial-1)-Q,width:Math.ceil(V/Math.pow(G,Q)),height:Math.ceil(j/Math.pow(G,Q)),bitrate:U[0].maxBitrate?Math.ceil(U[0].maxBitrate/Math.pow(Y,Q)):0,ssrc:0}));return z}return U.map(B=>{var q,z,G;const Y=(q=B.scaleResolutionDownBy)!==null&&q!==void 0?q:1;let Q=videoQualityForRid((z=B.rid)!==null&&z!==void 0?z:"");return new VideoLayer({quality:Q,width:Math.ceil(V/Y),height:Math.ceil(j/Y),bitrate:(G=B.maxBitrate)!==null&&G!==void 0?G:0,ssrc:0})})}const lossyDataChannel="_lossy",reliableDataChannel="_reliable",minReconnectWait=2*1e3,leaveReconnect="leave-reconnect",reliabeReceiveStateTTL=3e4;var PCState;(function(V){V[V.New=0]="New",V[V.Connected=1]="Connected",V[V.Disconnected=2]="Disconnected",V[V.Reconnecting=3]="Reconnecting",V[V.Closed=4]="Closed"})(PCState||(PCState={}));class RTCEngine extends eventsExports.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(j){var U;super(),this.options=j,this.rtcConfig={},this.peerConnectionTimeout=roomConnectOptionDefaults.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=PCState.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=livekitLogger,this.reliableDataSequence=1,this.reliableMessageBuffer=new DataPacketBuffer,this.reliableReceivedState=new TTLMap(reliabeReceiveStateTTL),this.handleDataChannel=F=>__awaiter$1(this,[F],void 0,function(B){var q=this;let{channel:z}=B;return(function*(){if(z){if(z.label===reliableDataChannel)q.reliableDCSub=z;else if(z.label===lossyDataChannel)q.lossyDCSub=z;else return;q.log.debug("on data channel ".concat(z.id,", ").concat(z.label),q.logContext),z.onmessage=q.handleDataMessage}})()}),this.handleDataMessage=F=>__awaiter$1(this,void 0,void 0,function*(){var B,q;const z=yield this.dataProcessLock.lock();try{let G;if(F.data instanceof ArrayBuffer)G=F.data;else if(F.data instanceof Blob)G=yield F.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:F.data}));return}const Y=DataPacket.fromBinary(new Uint8Array(G));if(Y.sequence>0&&Y.participantSid!==""){const Q=this.reliableReceivedState.get(Y.participantSid);if(Q&&Y.sequence<=Q)return;this.reliableReceivedState.set(Y.participantSid,Y.sequence)}((B=Y.value)===null||B===void 0?void 0:B.case)==="speaker"?this.emit(EngineEvent.ActiveSpeakersUpdate,Y.value.value.speakers):(((q=Y.value)===null||q===void 0?void 0:q.case)==="user"&&applyUserDataCompat(Y,Y.value.value),this.emit(EngineEvent.DataPacketReceived,Y))}finally{z()}}),this.handleDataError=F=>{const q=F.currentTarget.maxRetransmits===0?"lossy":"reliable";if(F instanceof ErrorEvent&&F.error){const{error:z}=F.error;this.log.error("DataChannel error on ".concat(q,": ").concat(F.message),Object.assign(Object.assign({},this.logContext),{error:z}))}else this.log.error("Unknown DataChannel error on ".concat(q),Object.assign(Object.assign({},this.logContext),{event:F}))},this.handleBufferedAmountLow=F=>{const q=F.currentTarget.maxRetransmits===0?DataPacket_Kind.LOSSY:DataPacket_Kind.RELIABLE;this.updateAndEmitDCBufferStatus(q)},this.handleDisconnect=(F,B)=>{if(this._isClosed)return;this.log.warn("".concat(F," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const q=Y=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Y,"ms. giving up"),this.logContext),this.emit(EngineEvent.Disconnected),this.close()},z=Date.now()-this.reconnectStart;let G=this.getNextRetryDelay({elapsedMs:z,retryCount:this.reconnectAttempts});if(G===null){q(z);return}F===leaveReconnect&&(G=0),this.log.debug("reconnecting in ".concat(G,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=CriticalTimers.setTimeout(()=>this.attemptReconnect(B).finally(()=>this.reconnectTimeout=void 0),G)},this.waitForRestarted=()=>new Promise((F,B)=>{this.pcState===PCState.Connected&&F();const q=()=>{this.off(EngineEvent.Disconnected,z),F()},z=()=>{this.off(EngineEvent.Restarted,q),B()};this.once(EngineEvent.Restarted,q),this.once(EngineEvent.Disconnected,z)}),this.updateAndEmitDCBufferStatus=F=>{const B=this.isBufferStatusLow(F);typeof B<"u"&&B!==this.dcBufferStatus.get(F)&&(this.dcBufferStatus.set(F,B),this.emit(EngineEvent.DCBufferStatusChanged,B,F))},this.isBufferStatusLow=F=>{const B=this.dataChannelForKind(F);if(B)return F===DataPacket_Kind.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(B.bufferedAmount),B.bufferedAmount<=B.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===SignalConnectionState.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(ReconnectReason.RR_SIGNAL_DISCONNECTED))},this.log=getLogger((U=j.loggerName)!==null&&U!==void 0?U:LoggerNames.Engine),this.loggerOptions={loggerName:j.loggerName,loggerContextCb:()=>this.logContext},this.client=new SignalClient(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new _$1,this.dataProcessLock=new _$1,this.dcBufferStatus=new Map([[DataPacket_Kind.LOSSY,!0],[DataPacket_Kind.RELIABLE,!0]]),this.client.onParticipantUpdate=F=>this.emit(EngineEvent.ParticipantUpdate,F),this.client.onConnectionQuality=F=>this.emit(EngineEvent.ConnectionQualityUpdate,F),this.client.onRoomUpdate=F=>this.emit(EngineEvent.RoomUpdate,F),this.client.onSubscriptionError=F=>this.emit(EngineEvent.SubscriptionError,F),this.client.onSubscriptionPermissionUpdate=F=>this.emit(EngineEvent.SubscriptionPermissionUpdate,F),this.client.onSpeakersChanged=F=>this.emit(EngineEvent.SpeakersChanged,F),this.client.onStreamStateUpdate=F=>this.emit(EngineEvent.StreamStateChanged,F),this.client.onRequestResponse=F=>this.emit(EngineEvent.SignalRequestResponse,F)}get logContext(){var j,U,F,B,q,z;return{room:(U=(j=this.latestJoinResponse)===null||j===void 0?void 0:j.room)===null||U===void 0?void 0:U.name,roomID:(B=(F=this.latestJoinResponse)===null||F===void 0?void 0:F.room)===null||B===void 0?void 0:B.sid,participant:(z=(q=this.latestJoinResponse)===null||q===void 0?void 0:q.participant)===null||z===void 0?void 0:z.identity,pID:this.participantSid}}join(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){this.url=j,this.token=U,this.signalOpts=F,this.maxJoinAttempts=F.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const q=yield this.client.join(j,U,F,B);return this._isClosed=!1,this.latestJoinResponse=q,this.subscriberPrimary=q.subscriberPrimary,this.pcManager||(yield this.configure(q)),(!this.subscriberPrimary||q.fastPublish)&&this.negotiate(),this.clientConfiguration=q.clientConfiguration,this.emit(EngineEvent.SignalConnected,q),q}catch(q){if(q instanceof ConnectionError&&q.reason===ConnectionErrorReason.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(j,U,F,B);throw q}})}close(){return __awaiter$1(this,void 0,void 0,function*(){const j=yield this.closingLock.lock();if(this.isClosed){j();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(EngineEvent.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{j()}})}cleanupPeerConnections(){return __awaiter$1(this,void 0,void 0,function*(){var j;yield(j=this.pcManager)===null||j===void 0?void 0:j.close(),this.pcManager=void 0;const U=F=>{F&&(F.close(),F.onbufferedamountlow=null,F.onclose=null,F.onclosing=null,F.onerror=null,F.onmessage=null,F.onopen=null)};U(this.lossyDC),U(this.lossyDCSub),U(this.reliableDC),U(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new DataPacketBuffer,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return __awaiter$1(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(j){if(this.pendingTrackResolvers[j.cid])throw new TrackInvalidError("a track with the same ID has already been published");return new Promise((U,F)=>{const B=setTimeout(()=>{delete this.pendingTrackResolvers[j.cid],F(new ConnectionError("publication of local track timed out, no response from server",ConnectionErrorReason.Timeout))},1e4);this.pendingTrackResolvers[j.cid]={resolve:q=>{clearTimeout(B),U(q)},reject:()=>{clearTimeout(B),F(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(j)})}removeTrack(j){if(j.track&&this.pendingTrackResolvers[j.track.id]){const{reject:U}=this.pendingTrackResolvers[j.track.id];U&&U(),delete this.pendingTrackResolvers[j.track.id]}try{return this.pcManager.removeTrack(j),!0}catch(U){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:U}))}return!1}updateMuteStatus(j,U){this.client.sendMuteTrack(j,U)}get dataSubscriberReadyState(){var j;return(j=this.reliableDCSub)===null||j===void 0?void 0:j.readyState}getConnectedServerAddress(){return __awaiter$1(this,void 0,void 0,function*(){var j;return(j=this.pcManager)===null||j===void 0?void 0:j.getConnectedAddress()})}setRegionUrlProvider(j){this.regionUrlProvider=j}configure(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F;if(this.pcManager&&this.pcManager.currentState!==PCTransportState.NEW)return;this.participantSid=(U=j.participant)===null||U===void 0?void 0:U.sid;const B=this.makeRTCConfiguration(j);this.pcManager=new PCTransportManager(B,j.subscriberPrimary,this.loggerOptions),this.emit(EngineEvent.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(q,z)=>{this.client.sendIceCandidate(q,z)},this.pcManager.onPublisherOffer=(q,z)=>{this.client.sendOffer(q,z)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(q,z,G)=>__awaiter$1(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(q),this.logContext),["closed","disconnected","failed"].includes(z)&&(this.publisherConnectionPromise=void 0),q===PCTransportState.CONNECTED){const W=this.pcState===PCState.New;this.pcState=PCState.Connected,W&&this.emit(EngineEvent.Connected,j)}else q===PCTransportState.FAILED&&this.pcState===PCState.Connected&&(this.pcState=PCState.Disconnected,this.handleDisconnect("peerconnection failed",G==="failed"?ReconnectReason.RR_SUBSCRIBER_FAILED:ReconnectReason.RR_PUBLISHER_FAILED));const Y=this.client.isDisconnected||this.client.currentState===SignalConnectionState.RECONNECTING,Q=[PCTransportState.FAILED,PCTransportState.CLOSING,PCTransportState.CLOSED].includes(q);Y&&Q&&!this._isClosed&&this.emit(EngineEvent.Offline)}),this.pcManager.onTrack=q=>{this.emit(EngineEvent.MediaTrackAdded,q.track,q.streams[0],q.receiver)},supportOptionalDatachannel((F=j.serverInfo)===null||F===void 0?void 0:F.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(j,U)=>__awaiter$1(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:j.type})),yield this.pcManager.setPublisherAnswer(j,U))}),this.client.onTrickle=(j,U)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:j,target:U})),this.pcManager.addIceCandidate(j,U))},this.client.onOffer=(j,U)=>__awaiter$1(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=U,!this.pcManager)return;const F=yield this.pcManager.createSubscriberAnswerFromOffer(j,U);F&&this.client.sendAnswer(F,U)}),this.client.onLocalTrackPublished=j=>{var U;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:j.cid,track:(U=j.track)===null||U===void 0?void 0:U.sid})),!this.pendingTrackResolvers[j.cid]){this.log.error("missing track resolver for ".concat(j.cid),Object.assign(Object.assign({},this.logContext),{cid:j.cid}));return}const{resolve:F}=this.pendingTrackResolvers[j.cid];delete this.pendingTrackResolvers[j.cid],F(j.track)},this.client.onLocalTrackUnpublished=j=>{this.emit(EngineEvent.LocalTrackUnpublished,j)},this.client.onLocalTrackSubscribed=j=>{this.emit(EngineEvent.LocalTrackSubscribed,j)},this.client.onTokenRefresh=j=>{this.token=j},this.client.onRemoteMuteChanged=(j,U)=>{this.emit(EngineEvent.RemoteMute,j,U)},this.client.onSubscribedQualityUpdate=j=>{this.emit(EngineEvent.SubscribedQualityUpdate,j)},this.client.onRoomMoved=j=>{var U;this.participantSid=(U=j.participant)===null||U===void 0?void 0:U.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=j.room),this.emit(EngineEvent.RoomMoved,j)},this.client.onClose=()=>{this.handleDisconnect("signal",ReconnectReason.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=j=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:j?.reason})),j.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(j.regions)),j.action){case LeaveRequest_Action.DISCONNECT:this.emit(EngineEvent.Disconnected,j?.reason),this.close();break;case LeaveRequest_Action.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(leaveReconnect);break;case LeaveRequest_Action.RESUME:this.handleDisconnect(leaveReconnect)}}}makeRTCConfiguration(j){var U;const F=Object.assign({},this.rtcConfig);if(!((U=this.signalOpts)===null||U===void 0)&&U.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),F.encodedInsertableStreams=!0),j.iceServers&&!F.iceServers){const B=[];j.iceServers.forEach(q=>{const z={urls:q.urls};q.username&&(z.username=q.username),q.credential&&(z.credential=q.credential),B.push(z)}),F.iceServers=B}return j.clientConfiguration&&j.clientConfiguration.forceRelay===ClientConfigSetting.ENABLED&&(F.iceTransportPolicy="relay"),F.sdpSemantics="unified-plan",F.continualGatheringPolicy="gather_continually",F}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(lossyDataChannel,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(reliableDataChannel,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){if(supportsTransceiver())return yield this.createTransceiverRTCRtpSender(j,U,F);if(supportsAddTrack())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(j.mediaStreamTrack);throw new UnexpectedConnectionState("Required webRTC APIs not supported on this device")})}createSimulcastSender(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){if(supportsTransceiver())return this.createSimulcastTransceiverSender(j,U,F,B);if(supportsAddTrack())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(j.mediaStreamTrack);throw new UnexpectedConnectionState("Cannot stream on this device")})}createTransceiverRTCRtpSender(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("publisher is closed");const B=[];j.mediaStream&&B.push(j.mediaStream),isVideoTrack(j)&&(j.codec=U.videoCodec);const q={direction:"sendonly",streams:B};return F&&(q.sendEncodings=F),(yield this.pcManager.addPublisherTransceiver(j.mediaStreamTrack,q)).sender})}createSimulcastTransceiverSender(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("publisher is closed");const q={direction:"sendonly"};B&&(q.sendEncodings=B);const z=yield this.pcManager.addPublisherTransceiver(U.mediaStreamTrack,q);if(F.videoCodec)return j.setSimulcastTrackSender(F.videoCodec,z.sender),z.sender})}createRTCRtpSender(j){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("publisher is closed");return this.pcManager.addPublisherTrack(j)})}attemptReconnect(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F,B;if(!this._isClosed){if(this.attemptingReconnect){livekitLogger.warn("already attempting reconnect, returning early",this.logContext);return}(((U=this.clientConfiguration)===null||U===void 0?void 0:U.resumeConnection)===ClientConfigSetting.DISABLED||((B=(F=this.pcManager)===null||F===void 0?void 0:F.currentState)!==null&&B!==void 0?B:PCTransportState.NEW)===PCTransportState.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(j),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(q){this.reconnectAttempts+=1;let z=!0;q instanceof UnexpectedConnectionState?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:q})),z=!1):q instanceof SignalReconnectError||(this.fullReconnectOnNext=!0),z?this.handleDisconnect("reconnect",ReconnectReason.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(EngineEvent.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(j){try{return this.reconnectPolicy.nextRetryDelayInMs(j)}catch(U){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:U}))}return null}restartConnection(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F,B;try{if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(EngineEvent.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let q;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new SignalReconnectError;q=yield this.join(j??this.url,this.token,this.signalOpts)}catch(z){throw z instanceof ConnectionError&&z.reason===ConnectionErrorReason.NotAllowed?new UnexpectedConnectionState("could not reconnect, token might be expired"):new SignalReconnectError}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(EngineEvent.SignalRestarted,q),yield this.waitForPCReconnected(),this.client.currentState!==SignalConnectionState.CONNECTED)throw new SignalReconnectError("Signal connection got severed during reconnect");(U=this.regionUrlProvider)===null||U===void 0||U.resetAttempts(),this.emit(EngineEvent.Restarted)}catch(q){const z=yield(F=this.regionUrlProvider)===null||F===void 0?void 0:F.getNextBestRegionUrl();if(z){yield this.restartConnection(z);return}else throw(B=this.regionUrlProvider)===null||B===void 0||B.resetAttempts(),q}})}resumeConnection(j){return __awaiter$1(this,void 0,void 0,function*(){var U;if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");if(!this.pcManager)throw new UnexpectedConnectionState("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(EngineEvent.Resuming);let F;try{this.setupSignalClientCallbacks(),F=yield this.client.reconnect(this.url,this.token,this.participantSid,j)}catch(B){let q="";throw B instanceof Error&&(q=B.message,this.log.error(B.message,Object.assign(Object.assign({},this.logContext),{error:B}))),B instanceof ConnectionError&&B.reason===ConnectionErrorReason.NotAllowed?new UnexpectedConnectionState("could not reconnect, token might be expired"):B instanceof ConnectionError&&B.reason===ConnectionErrorReason.LeaveRequest?B:new SignalReconnectError(q)}if(this.emit(EngineEvent.SignalResumed),F){const B=this.makeRTCConfiguration(F);this.pcManager.updateConfiguration(B),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=F.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==SignalConnectionState.CONNECTED)throw new SignalReconnectError("Signal connection got severed during reconnect");this.client.setReconnected(),((U=this.reliableDC)===null||U===void 0?void 0:U.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),F?.lastMessageSeq&&this.resendReliableMessagesForResume(F.lastMessageSeq),this.emit(EngineEvent.Resumed)})}waitForPCInitialConnection(j,U){return __awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager)throw new UnexpectedConnectionState("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(U,j)})}waitForPCReconnected(){return __awaiter$1(this,void 0,void 0,function*(){this.pcState=PCState.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield sleep$1(minReconnectWait),!this.pcManager)throw new UnexpectedConnectionState("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=PCState.Connected}catch(j){throw this.pcState=PCState.Disconnected,new ConnectionError("could not establish PC connection, ".concat(j.message),ConnectionErrorReason.InternalError)}})}publishRpcResponse(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){const q=new DataPacket({destinationIdentities:[j],kind:DataPacket_Kind.RELIABLE,value:{case:"rpcResponse",value:new RpcResponse({requestId:U,value:B?{case:"error",value:B.toProto()}:{case:"payload",value:F??""}})}});yield this.sendDataPacket(q,DataPacket_Kind.RELIABLE)})}publishRpcAck(j,U){return __awaiter$1(this,void 0,void 0,function*(){const F=new DataPacket({destinationIdentities:[j],kind:DataPacket_Kind.RELIABLE,value:{case:"rpcAck",value:new RpcAck({requestId:U})}});yield this.sendDataPacket(F,DataPacket_Kind.RELIABLE)})}sendDataPacket(j,U){return __awaiter$1(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(U),U===DataPacket_Kind.RELIABLE&&(j.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const F=j.toBinary(),B=this.dataChannelForKind(U);if(B){if(U===DataPacket_Kind.RELIABLE&&this.reliableMessageBuffer.push({data:F,sequence:j.sequence}),this.attemptingReconnect)return;B.send(F)}this.updateAndEmitDCBufferStatus(U)})}resendReliableMessagesForResume(j){return __awaiter$1(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(DataPacket_Kind.RELIABLE);const U=this.dataChannelForKind(DataPacket_Kind.RELIABLE);U&&(this.reliableMessageBuffer.popToSequence(j),this.reliableMessageBuffer.getAll().forEach(F=>{U.send(F.data)})),this.updateAndEmitDCBufferStatus(DataPacket_Kind.RELIABLE)})}waitForBufferStatusLow(j){return new Promise((U,F)=>__awaiter$1(this,void 0,void 0,function*(){if(this.isBufferStatusLow(j))U();else{const B=()=>F("Engine closed");for(this.once(EngineEvent.Closing,B);!this.dcBufferStatus.get(j);)yield sleep$1(10);this.off(EngineEvent.Closing,B),U()}}))}ensureDataTransportConnected(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return(function*(){var q;if(!F.pcManager)throw new UnexpectedConnectionState("PC manager is closed");const z=B?F.pcManager.subscriber:F.pcManager.publisher,G=B?"Subscriber":"Publisher";if(!z)throw new ConnectionError("".concat(G," connection not set"),ConnectionErrorReason.InternalError);let Y=!1;!B&&!F.dataChannelForKind(U,B)&&(F.createDataChannels(),Y=!0),!Y&&!B&&!F.pcManager.publisher.isICEConnected&&F.pcManager.publisher.getICEConnectionState()!=="checking"&&(Y=!0),Y&&F.negotiate();const Q=F.dataChannelForKind(U,B);if(Q?.readyState==="open")return;const W=new Date().getTime()+F.peerConnectionTimeout;for(;new Date().getTime()<W;){if(z.isICEConnected&&((q=F.dataChannelForKind(U,B))===null||q===void 0?void 0:q.readyState)==="open")return;yield sleep$1(50)}throw new ConnectionError("could not establish ".concat(G," connection, state: ").concat(z.getICEConnectionState()),ConnectionErrorReason.InternalError)})()})}ensurePublisherConnected(j){return __awaiter$1(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(j,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==PCTransportState.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return __awaiter$1(this,void 0,void 0,function*(){return new Promise((j,U)=>__awaiter$1(this,void 0,void 0,function*(){if(!this.pcManager){U(new NegotiationError("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const F=new AbortController,B=()=>{F.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),j()};this.isClosed&&U("cannot negotiate on closed engine"),this.on(EngineEvent.Closing,B),this.pcManager.publisher.once(PCEvents.RTPVideoPayloadTypes,q=>{const z=new Map;q.forEach(G=>{const Y=G.codec.toLowerCase();isVideoCodec(Y)&&z.set(G.payload,Y)}),this.emit(EngineEvent.RTPVideoMapUpdate,z)});try{yield this.pcManager.negotiate(F),j()}catch(q){q instanceof NegotiationError&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ReconnectReason.RR_UNKNOWN),U(q)}finally{this.off(EngineEvent.Closing,B)}}))})}dataChannelForKind(j,U){if(U){if(j===DataPacket_Kind.LOSSY)return this.lossyDCSub;if(j===DataPacket_Kind.RELIABLE)return this.reliableDCSub}else{if(j===DataPacket_Kind.LOSSY)return this.lossyDC;if(j===DataPacket_Kind.RELIABLE)return this.reliableDC}}sendSyncState(j,U){var F,B;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const q=this.pcManager.subscriber.getLocalDescription(),z=this.pcManager.subscriber.getRemoteDescription(),G=(B=(F=this.signalOpts)===null||F===void 0?void 0:F.autoSubscribe)!==null&&B!==void 0?B:!0,Y=new Array,Q=new Array;j.forEach(W=>{W.isDesired!==G&&Y.push(W.trackSid),W.isEnabled||Q.push(W.trackSid)}),this.client.sendSyncState(new SyncState({answer:q?toProtoSessionDescription({sdp:q.sdp,type:q.type}):void 0,offer:z?toProtoSessionDescription({sdp:z.sdp,type:z.type}):void 0,subscription:new UpdateSubscription({trackSids:Y,subscribe:!G,participantTracks:[]}),publishTracks:getTrackPublicationInfo(U),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:Q,datachannelReceiveStates:this.reliableReceivedState.map((W,Z)=>new DataChannelReceiveState({publisherSid:Z,lastSeq:W}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const j=[],U=(F,B)=>{F?.id!==void 0&&F.id!==null&&j.push(new DataChannelInfo({label:F.label,id:F.id,target:B}))};return U(this.dataChannelForKind(DataPacket_Kind.LOSSY),SignalTarget.PUBLISHER),U(this.dataChannelForKind(DataPacket_Kind.RELIABLE),SignalTarget.PUBLISHER),U(this.dataChannelForKind(DataPacket_Kind.LOSSY,!0),SignalTarget.SUBSCRIBER),U(this.dataChannelForKind(DataPacket_Kind.RELIABLE,!0),SignalTarget.SUBSCRIBER),j}clearReconnectTimeout(){this.reconnectTimeout&&CriticalTimers.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){isWeb()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){isWeb()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class SignalReconnectError extends Error{}function supportOptionalDatachannel(V){return V!==void 0&&V>13}function applyUserDataCompat(V,j){const U=V.participantIdentity?V.participantIdentity:j.participantIdentity;V.participantIdentity=U,j.participantIdentity=U;const F=V.destinationIdentities.length!==0?V.destinationIdentities:j.destinationIdentities;V.destinationIdentities=F,j.destinationIdentities=F}class RegionUrlProvider{constructor(j,U){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(j),this.token=U}updateToken(j){this.token=j}isCloud(){return isCloud(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(j){return __awaiter$1(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(j));const U=this.regionSettings.regions.filter(F=>!this.attemptedRegions.find(B=>B.url===F.url));if(U.length>0){const F=U[0];return this.attemptedRegions.push(F),livekitLogger.debug("next region: ".concat(F.region)),F.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(j){return __awaiter$1(this,void 0,void 0,function*(){const U=yield fetch("".concat(getCloudConfigUrl(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:j});if(U.ok){const F=yield U.json();return this.lastUpdateAt=Date.now(),F}else throw new ConnectionError("Could not fetch region settings: ".concat(U.statusText),U.status===401?ConnectionErrorReason.NotAllowed:ConnectionErrorReason.InternalError,U.status)})}setServerReportedRegions(j){this.regionSettings=j,this.lastUpdateAt=Date.now()}}function getCloudConfigUrl(V){return"".concat(V.protocol.replace("ws","http"),"//").concat(V.host,"/settings")}class BaseStreamReader{get info(){return this._info}validateBytesReceived(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(j&&this.bytesReceived<this.totalByteSize)throw new DataStreamError("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),DataStreamErrorReason.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new DataStreamError("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),DataStreamErrorReason.LengthExceeded)}}constructor(j,U,F,B){this.reader=U,this.totalByteSize=F,this._info=j,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=B}}class ByteStreamReader extends BaseStreamReader{handleChunkReceived(j){var U;this.bytesReceived+=j.content.byteLength,this.validateBytesReceived();const F=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(U=this.onProgress)===null||U===void 0||U.call(this,F)}[Symbol.asyncIterator](){const j=this.reader.getReader();let U=new Future,F=null,B=null;if(this.signal){const z=this.signal;B=()=>{var G;(G=U.reject)===null||G===void 0||G.call(U,z.reason)},z.addEventListener("abort",B),F=z}const q=()=>{j.releaseLock(),F&&B&&F.removeEventListener("abort",B),this.signal=void 0};return{next:()=>__awaiter$1(this,void 0,void 0,function*(){var z,G;try{const{done:Y,value:Q}=yield Promise.race([j.read(),U.promise,(G=(z=this.outOfBandFailureRejectingFuture)===null||z===void 0?void 0:z.promise)!==null&&G!==void 0?G:new Promise(()=>{})]);return Y?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(Q),{done:!1,value:Q.content})}catch(Y){throw q(),Y}}),return(){return __awaiter$1(this,void 0,void 0,function*(){return q(),{done:!0,value:void 0}})}}}withAbortSignal(j){return this.signal=j,this}readAll(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var F,B,q,z;let G=new Set;const Y=U.signal?j.withAbortSignal(U.signal):j;try{for(var Q=!0,W=__asyncValues(Y),Z;Z=yield W.next(),F=Z.done,!F;Q=!0){z=Z.value,Q=!1;const ee=z;G.add(ee)}}catch(ee){B={error:ee}}finally{try{!Q&&!F&&(q=W.return)&&(yield q.call(W))}finally{if(B)throw B.error}}return Array.from(G)})()})}}class TextStreamReader extends BaseStreamReader{constructor(j,U,F,B){super(j,U,F,B),this.receivedChunks=new Map}handleChunkReceived(j){var U;const F=bigIntToNumber(j.chunkIndex),B=this.receivedChunks.get(F);if(B&&B.version>j.version)return;this.receivedChunks.set(F,j),this.bytesReceived+=j.content.byteLength,this.validateBytesReceived();const q=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(U=this.onProgress)===null||U===void 0||U.call(this,q)}[Symbol.asyncIterator](){const j=this.reader.getReader(),U=new TextDecoder("utf-8",{fatal:!0});let F=new Future,B=null,q=null;if(this.signal){const G=this.signal;q=()=>{var Y;(Y=F.reject)===null||Y===void 0||Y.call(F,G.reason)},G.addEventListener("abort",q),B=G}const z=()=>{j.releaseLock(),B&&q&&B.removeEventListener("abort",q),this.signal=void 0};return{next:()=>__awaiter$1(this,void 0,void 0,function*(){var G,Y;try{const{done:Q,value:W}=yield Promise.race([j.read(),F.promise,(Y=(G=this.outOfBandFailureRejectingFuture)===null||G===void 0?void 0:G.promise)!==null&&Y!==void 0?Y:new Promise(()=>{})]);if(Q)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(W);let Z;try{Z=U.decode(W.content)}catch(ee){throw new DataStreamError("Cannot decode datastream chunk ".concat(W.chunkIndex," as text: ").concat(ee),DataStreamErrorReason.DecodeFailed)}return{done:!1,value:Z}}}catch(Q){throw z(),Q}}),return(){return __awaiter$1(this,void 0,void 0,function*(){return z(),{done:!0,value:void 0}})}}}withAbortSignal(j){return this.signal=j,this}readAll(){return __awaiter$1(this,arguments,void 0,function(){var j=this;let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var F,B,q,z;let G="";const Y=U.signal?j.withAbortSignal(U.signal):j;try{for(var Q=!0,W=__asyncValues(Y),Z;Z=yield W.next(),F=Z.done,!F;Q=!0)z=Z.value,Q=!1,G+=z}catch(ee){B={error:ee}}finally{try{!Q&&!F&&(q=W.return)&&(yield q.call(W))}finally{if(B)throw B.error}}return G})()})}}class IncomingDataStreamManager{constructor(){this.log=livekitLogger,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(j,U){if(this.textStreamHandlers.has(j))throw new DataStreamError('A text stream handler for topic "'.concat(j,'" has already been set.'),DataStreamErrorReason.HandlerAlreadyRegistered);this.textStreamHandlers.set(j,U)}unregisterTextStreamHandler(j){this.textStreamHandlers.delete(j)}registerByteStreamHandler(j,U){if(this.byteStreamHandlers.has(j))throw new DataStreamError('A byte stream handler for topic "'.concat(j,'" has already been set.'),DataStreamErrorReason.HandlerAlreadyRegistered);this.byteStreamHandlers.set(j,U)}unregisterByteStreamHandler(j){this.byteStreamHandlers.delete(j)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(j){var U,F,B,q;const z=Array.from(this.textStreamControllers.entries()).filter(Y=>Y[1].sendingParticipantIdentity===j),G=Array.from(this.byteStreamControllers.entries()).filter(Y=>Y[1].sendingParticipantIdentity===j);if(z.length>0||G.length>0){const Y=new DataStreamError("Participant ".concat(j," unexpectedly disconnected in the middle of sending data"),DataStreamErrorReason.AbnormalEnd);for(const[Q,W]of G)(F=(U=W.outOfBandFailureRejectingFuture).reject)===null||F===void 0||F.call(U,Y),this.byteStreamControllers.delete(Q);for(const[Q,W]of z)(q=(B=W.outOfBandFailureRejectingFuture).reject)===null||q===void 0||q.call(B,Y),this.textStreamControllers.delete(Q)}}handleDataStreamPacket(j){return __awaiter$1(this,void 0,void 0,function*(){switch(j.value.case){case"streamHeader":return this.handleStreamHeader(j.value.value,j.participantIdentity);case"streamChunk":return this.handleStreamChunk(j.value.value);case"streamTrailer":return this.handleStreamTrailer(j.value.value);default:throw new Error('DataPacket of value "'.concat(j.value.case,'" is not data stream related!'))}})}handleStreamHeader(j,U){return __awaiter$1(this,void 0,void 0,function*(){var F;if(j.contentHeader.case==="byteHeader"){const B=this.byteStreamHandlers.get(j.topic);if(!B){this.log.debug("ignoring incoming byte stream due to no handler for topic",j.topic);return}let q;const z=new Future,G={id:j.streamId,name:(F=j.contentHeader.value.name)!==null&&F!==void 0?F:"unknown",mimeType:j.mimeType,size:j.totalLength?Number(j.totalLength):void 0,topic:j.topic,timestamp:bigIntToNumber(j.timestamp),attributes:j.attributes},Y=new ReadableStream({start:Q=>{if(q=Q,this.textStreamControllers.has(j.streamId))throw new DataStreamError("A data stream read is already in progress for a stream with id ".concat(j.streamId,"."),DataStreamErrorReason.AlreadyOpened);this.byteStreamControllers.set(j.streamId,{info:G,controller:q,startTime:Date.now(),sendingParticipantIdentity:U,outOfBandFailureRejectingFuture:z})}});B(new ByteStreamReader(G,Y,bigIntToNumber(j.totalLength),z),{identity:U})}else if(j.contentHeader.case==="textHeader"){const B=this.textStreamHandlers.get(j.topic);if(!B){this.log.debug("ignoring incoming text stream due to no handler for topic",j.topic);return}let q;const z=new Future,G={id:j.streamId,mimeType:j.mimeType,size:j.totalLength?Number(j.totalLength):void 0,topic:j.topic,timestamp:Number(j.timestamp),attributes:j.attributes},Y=new ReadableStream({start:Q=>{if(q=Q,this.textStreamControllers.has(j.streamId))throw new DataStreamError("A data stream read is already in progress for a stream with id ".concat(j.streamId,"."),DataStreamErrorReason.AlreadyOpened);this.textStreamControllers.set(j.streamId,{info:G,controller:q,startTime:Date.now(),sendingParticipantIdentity:U,outOfBandFailureRejectingFuture:z})}});B(new TextStreamReader(G,Y,bigIntToNumber(j.totalLength),z),{identity:U})}})}handleStreamChunk(j){const U=this.byteStreamControllers.get(j.streamId);U&&j.content.length>0&&U.controller.enqueue(j);const F=this.textStreamControllers.get(j.streamId);F&&j.content.length>0&&F.controller.enqueue(j)}handleStreamTrailer(j){const U=this.textStreamControllers.get(j.streamId);U&&(U.info.attributes=Object.assign(Object.assign({},U.info.attributes),j.attributes),U.controller.close(),this.textStreamControllers.delete(j.streamId));const F=this.byteStreamControllers.get(j.streamId);F&&(F.info.attributes=Object.assign(Object.assign({},F.info.attributes),j.attributes),F.controller.close(),this.byteStreamControllers.delete(j.streamId))}}class BaseStreamWriter{constructor(j,U,F){this.writableStream=j,this.defaultWriter=j.getWriter(),this.onClose=F,this.info=U}write(j){return this.defaultWriter.write(j)}close(){return __awaiter$1(this,void 0,void 0,function*(){var j;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(j=this.onClose)===null||j===void 0||j.call(this)})}}class TextStreamWriter extends BaseStreamWriter{}class ByteStreamWriter extends BaseStreamWriter{}const STREAM_CHUNK_SIZE=15e3;class OutgoingDataStreamManager{constructor(j,U){this.engine=j,this.log=U}setupEngine(j){this.engine=j}sendText(j,U){return __awaiter$1(this,void 0,void 0,function*(){var F;const B=crypto.randomUUID(),z=new TextEncoder().encode(j).byteLength,G=(F=U?.attachments)===null||F===void 0?void 0:F.map(()=>crypto.randomUUID()),Y=new Array(G?G.length+1:1).fill(0),Q=(Z,ee)=>{var ne;Y[ee]=Z;const ae=Y.reduce((se,de)=>se+de,0);(ne=U?.onProgress)===null||ne===void 0||ne.call(U,ae)},W=yield this.streamText({streamId:B,totalSize:z,destinationIdentities:U?.destinationIdentities,topic:U?.topic,attachedStreamIds:G,attributes:U?.attributes});return yield W.write(j),Q(1,0),yield W.close(),U?.attachments&&G&&(yield Promise.all(U.attachments.map((Z,ee)=>__awaiter$1(this,void 0,void 0,function*(){return this._sendFile(G[ee],Z,{topic:U.topic,mimeType:Z.type,onProgress:ne=>{Q(ne,ee+1)}})})))),W.info})}streamText(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F;const B=(U=j?.streamId)!==null&&U!==void 0?U:crypto.randomUUID(),q={id:B,mimeType:"text/plain",timestamp:Date.now(),topic:(F=j?.topic)!==null&&F!==void 0?F:"",size:j?.totalSize,attributes:j?.attributes},z=new DataStream_Header({streamId:B,mimeType:q.mimeType,topic:q.topic,timestamp:numberToBigInt(q.timestamp),totalLength:numberToBigInt(j?.totalSize),attributes:q.attributes,contentHeader:{case:"textHeader",value:new DataStream_TextHeader({version:j?.version,attachedStreamIds:j?.attachedStreamIds,replyToStreamId:j?.replyToStreamId,operationType:j?.type==="update"?DataStream_OperationType.UPDATE:DataStream_OperationType.CREATE})}}),G=j?.destinationIdentities,Y=new DataPacket({destinationIdentities:G,value:{case:"streamHeader",value:z}});yield this.engine.sendDataPacket(Y,DataPacket_Kind.RELIABLE);let Q=0;const W=this.engine,Z=new WritableStream({write(ae){return __awaiter$1(this,void 0,void 0,function*(){for(const se of splitUtf8(ae,STREAM_CHUNK_SIZE)){yield W.waitForBufferStatusLow(DataPacket_Kind.RELIABLE);const de=new DataStream_Chunk({content:se,streamId:B,chunkIndex:numberToBigInt(Q)}),oe=new DataPacket({destinationIdentities:G,value:{case:"streamChunk",value:de}});yield W.sendDataPacket(oe,DataPacket_Kind.RELIABLE),Q+=1}})},close(){return __awaiter$1(this,void 0,void 0,function*(){const ae=new DataStream_Trailer({streamId:B}),se=new DataPacket({destinationIdentities:G,value:{case:"streamTrailer",value:ae}});yield W.sendDataPacket(se,DataPacket_Kind.RELIABLE)})},abort(ae){console.log("Sink error:",ae)}});let ee=()=>__awaiter$1(this,void 0,void 0,function*(){yield ne.close()});W.once(EngineEvent.Closing,ee);const ne=new TextStreamWriter(Z,q,()=>this.engine.off(EngineEvent.Closing,ee));return ne})}sendFile(j,U){return __awaiter$1(this,void 0,void 0,function*(){const F=crypto.randomUUID();return yield this._sendFile(F,j,U),{id:F}})}_sendFile(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){var B;const q=yield this.streamBytes({streamId:j,totalSize:U.size,name:U.name,mimeType:(B=F?.mimeType)!==null&&B!==void 0?B:U.type,topic:F?.topic,destinationIdentities:F?.destinationIdentities}),z=U.stream().getReader();for(;;){const{done:G,value:Y}=yield z.read();if(G)break;yield q.write(Y)}return yield q.close(),q.info})}streamBytes(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F,B,q,z;const G=(U=j?.streamId)!==null&&U!==void 0?U:crypto.randomUUID(),Y=j?.destinationIdentities,Q={id:G,mimeType:(F=j?.mimeType)!==null&&F!==void 0?F:"application/octet-stream",topic:(B=j?.topic)!==null&&B!==void 0?B:"",timestamp:Date.now(),attributes:j?.attributes,size:j?.totalSize,name:(q=j?.name)!==null&&q!==void 0?q:"unknown"},W=new DataStream_Header({totalLength:numberToBigInt((z=Q.size)!==null&&z!==void 0?z:0),mimeType:Q.mimeType,streamId:G,topic:Q.topic,timestamp:numberToBigInt(Date.now()),attributes:Q.attributes,contentHeader:{case:"byteHeader",value:new DataStream_ByteHeader({name:Q.name})}}),Z=new DataPacket({destinationIdentities:Y,value:{case:"streamHeader",value:W}});yield this.engine.sendDataPacket(Z,DataPacket_Kind.RELIABLE);let ee=0;const ne=new _$1,ae=this.engine,se=this.log,de=new WritableStream({write(ue){return __awaiter$1(this,void 0,void 0,function*(){const he=yield ne.lock();let ye=0;try{for(;ye<ue.byteLength;){const fe=ue.slice(ye,ye+STREAM_CHUNK_SIZE);yield ae.waitForBufferStatusLow(DataPacket_Kind.RELIABLE);const pe=new DataPacket({destinationIdentities:Y,value:{case:"streamChunk",value:new DataStream_Chunk({content:fe,streamId:G,chunkIndex:numberToBigInt(ee)})}});yield ae.sendDataPacket(pe,DataPacket_Kind.RELIABLE),ee+=1,ye+=fe.byteLength}}finally{he()}})},close(){return __awaiter$1(this,void 0,void 0,function*(){const ue=new DataStream_Trailer({streamId:G}),he=new DataPacket({destinationIdentities:Y,value:{case:"streamTrailer",value:ue}});yield ae.sendDataPacket(he,DataPacket_Kind.RELIABLE)})},abort(ue){se.error("Sink error:",ue)}});return new ByteStreamWriter(de,Q)})}}class RemoteTrack extends Track{constructor(j,U,F,B,q){super(j,F,q),this.sid=U,this.receiver=B}get isLocal(){return!1}setMuted(j){this.isMuted!==j&&(this.isMuted=j,this._mediaStreamTrack.enabled=!j,this.emit(j?TrackEvent.Muted:TrackEvent.Unmuted,this))}setMediaStream(j){this.mediaStream=j;const U=F=>{F.track===this._mediaStreamTrack&&(j.removeEventListener("removetrack",U),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(TrackEvent.Ended,this))};j.addEventListener("removetrack",U)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return __awaiter$1(this,void 0,void 0,function*(){var j;return!((j=this.receiver)===null||j===void 0)&&j.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(j){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=j:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),monitorFrequency)),supportsSynchronizationSources()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const j=()=>{var U;this.timeSyncHandle=requestAnimationFrame(()=>j());const F=(U=this.receiver)===null||U===void 0?void 0:U.getSynchronizationSources()[0];if(F){const{timestamp:B,rtpTimestamp:q}=F;q&&this.rtpTimestamp!==q&&(this.emit(TrackEvent.TimeSyncUpdate,{timestamp:B,rtpTimestamp:q}),this.rtpTimestamp=q)}};j()}}class RemoteAudioTrack extends RemoteTrack{constructor(j,U,F,B,q,z){super(j,U,Track.Kind.Audio,F,z),this.monitorReceiver=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const G=yield this.getReceiverStats();G&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(G,this.prevStats)),this.prevStats=G}),this.audioContext=B,this.webAudioPluginNodes=[],q&&(this.sinkId=q.deviceId)}setVolume(j){var U;for(const F of this.attachedElements)this.audioContext?(U=this.gainNode)===null||U===void 0||U.gain.setTargetAtTime(j,0,.1):F.volume=j;isReactNative()&&this._mediaStreamTrack._setVolume(j),this.elementVolume=j}getVolume(){if(this.elementVolume)return this.elementVolume;if(isReactNative())return 1;let j=0;return this.attachedElements.forEach(U=>{U.volume>j&&(j=U.volume)}),j}setSinkId(j){return __awaiter$1(this,void 0,void 0,function*(){this.sinkId=j,yield Promise.all(this.attachedElements.map(U=>{if(supportsSetSinkId(U))return U.setSinkId(j)}))})}attach(j){const U=this.attachedElements.length===0;return j?super.attach(j):j=super.attach(),this.sinkId&&supportsSetSinkId(j)&&j.setSinkId(this.sinkId).catch(F=>{this.log.error("Failed to set sink id on remote audio track",F,this.logContext)}),this.audioContext&&U&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,j),j.volume=0,j.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),j}detach(j){let U;return j?(U=super.detach(j),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(U=super.detach(),this.disconnectWebAudio()),U}setAudioContext(j){this.audioContext=j,j&&this.attachedElements.length>0?this.connectWebAudio(j,this.attachedElements[0]):j||this.disconnectWebAudio()}setWebAudioPlugins(j){this.webAudioPluginNodes=j,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(j,U){this.disconnectWebAudio(),this.sourceNode=j.createMediaStreamSource(U.srcObject);let F=this.sourceNode;this.webAudioPluginNodes.forEach(B=>{F.connect(B),F=B}),this.gainNode=j.createGain(),F.connect(this.gainNode),this.gainNode.connect(j.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),j.state!=="running"&&j.resume().then(()=>{j.state!=="running"&&this.emit(TrackEvent.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(B=>{this.emit(TrackEvent.AudioPlaybackFailed,B)})}disconnectWebAudio(){var j,U;(j=this.gainNode)===null||j===void 0||j.disconnect(),(U=this.sourceNode)===null||U===void 0||U.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return __awaiter$1(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const j=yield this.receiver.getStats();let U;return j.forEach(F=>{F.type==="inbound-rtp"&&(U={type:"audio",streamId:F.id,timestamp:F.timestamp,jitter:F.jitter,bytesReceived:F.bytesReceived,concealedSamples:F.concealedSamples,concealmentEvents:F.concealmentEvents,silentConcealedSamples:F.silentConcealedSamples,silentConcealmentEvents:F.silentConcealmentEvents,totalAudioEnergy:F.totalAudioEnergy,totalSamplesDuration:F.totalSamplesDuration})}),U})}}const REACTION_DELAY=100;class RemoteVideoTrack extends RemoteTrack{constructor(j,U,F,B,q){super(j,U,Track.Kind.Video,F,q),this.elementInfos=[],this.monitorReceiver=()=>__awaiter$1(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const z=yield this.getReceiverStats();z&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(z,this.prevStats)),this.prevStats=z}),this.debouncedHandleResize=r$1(()=>{this.updateDimensions()},REACTION_DELAY),this.adaptiveStreamSettings=B}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(j){super.setMuted(j),this.attachedElements.forEach(U=>{j?detachTrack(this._mediaStreamTrack,U):attachToElement(this._mediaStreamTrack,U)})}attach(j){if(j?super.attach(j):j=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(U=>U.element===j)===void 0){const U=new HTMLElementInfo(j);this.observeElementInfo(U)}return j}observeElementInfo(j){this.adaptiveStreamSettings&&this.elementInfos.find(U=>U===j)===void 0?(j.handleResize=()=>{this.debouncedHandleResize()},j.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(j),j.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(j){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const U=this.elementInfos.filter(F=>F===j);for(const F of U)F.stopObserving();this.elementInfos=this.elementInfos.filter(F=>F!==j),this.updateVisibility(),this.debouncedHandleResize()}detach(j){let U=[];if(j)return this.stopObservingElement(j),super.detach(j);U=super.detach();for(const F of U)this.stopObservingElement(F);return U}getDecoderImplementation(){var j;return(j=this.prevStats)===null||j===void 0?void 0:j.decoderImplementation}getReceiverStats(){return __awaiter$1(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const j=yield this.receiver.getStats();let U,F="",B=new Map;return j.forEach(q=>{q.type==="inbound-rtp"?(F=q.codecId,U={type:"video",streamId:q.id,framesDecoded:q.framesDecoded,framesDropped:q.framesDropped,framesReceived:q.framesReceived,packetsReceived:q.packetsReceived,packetsLost:q.packetsLost,frameWidth:q.frameWidth,frameHeight:q.frameHeight,pliCount:q.pliCount,firCount:q.firCount,nackCount:q.nackCount,jitter:q.jitter,timestamp:q.timestamp,bytesReceived:q.bytesReceived,decoderImplementation:q.decoderImplementation}):q.type==="codec"&&B.set(q.id,q)}),U&&F!==""&&B.get(F)&&(U.mimeType=B.get(F).mimeType),U})}stopObservingElement(j){const U=this.elementInfos.filter(F=>F.element===j);for(const F of U)this.stopObservingElementInfo(F)}handleAppVisibilityChanged(){const j=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter$1(this,void 0,void 0,function*(){yield j.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var j,U;const F=this.elementInfos.reduce((G,Y)=>Math.max(G,Y.visibilityChangedAt||0),0),B=!((U=(j=this.adaptiveStreamSettings)===null||j===void 0?void 0:j.pauseVideoInBackground)!==null&&U!==void 0)||U?this.isInBackground:!1,q=this.elementInfos.some(G=>G.pictureInPicture),z=this.elementInfos.some(G=>G.visible)&&!B||q;if(this.lastVisible!==z){if(!z&&Date.now()-F<REACTION_DELAY){CriticalTimers.setTimeout(()=>{this.updateVisibility()},REACTION_DELAY);return}this.lastVisible=z,this.emit(TrackEvent.VisibilityChanged,z,this)}}updateDimensions(){var j,U;let F=0,B=0;const q=this.getPixelDensity();for(const z of this.elementInfos){const G=z.width()*q,Y=z.height()*q;G+Y>F+B&&(F=G,B=Y)}((j=this.lastDimensions)===null||j===void 0?void 0:j.width)===F&&((U=this.lastDimensions)===null||U===void 0?void 0:U.height)===B||(this.lastDimensions={width:F,height:B},this.emit(TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var j;const U=(j=this.adaptiveStreamSettings)===null||j===void 0?void 0:j.pixelDensity;return U==="screen"?getDevicePixelRatio():U||(getDevicePixelRatio()>2?2:1)}}class HTMLElementInfo{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(j,U){this.onVisibilityChanged=F=>{var B;const{target:q,isIntersecting:z}=F;q===this.element&&(this.isIntersecting=z,this.isPiP=isElementInPiP(this.element),this.visibilityChangedAt=Date.now(),(B=this.handleVisibilityChanged)===null||B===void 0||B.call(this))},this.onEnterPiP=()=>{var F,B,q;(B=(F=window.documentPictureInPicture)===null||F===void 0?void 0:F.window)===null||B===void 0||B.addEventListener("pagehide",this.onLeavePiP),this.isPiP=isElementInPiP(this.element),(q=this.handleVisibilityChanged)===null||q===void 0||q.call(this)},this.onLeavePiP=()=>{var F;this.isPiP=isElementInPiP(this.element),(F=this.handleVisibilityChanged)===null||F===void 0||F.call(this)},this.element=j,this.isIntersecting=U??isElementInViewport(j),this.isPiP=isWeb()&&isElementInPiP(j),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var j,U,F;this.isIntersecting=isElementInViewport(this.element),this.isPiP=isElementInPiP(this.element),this.element.handleResize=()=>{var B;(B=this.handleResize)===null||B===void 0||B.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,getIntersectionObserver().observe(this.element),getResizeObserver().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(j=window.documentPictureInPicture)===null||j===void 0||j.addEventListener("enter",this.onEnterPiP),(F=(U=window.documentPictureInPicture)===null||U===void 0?void 0:U.window)===null||F===void 0||F.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var j,U,F,B,q;(j=getIntersectionObserver())===null||j===void 0||j.unobserve(this.element),(U=getResizeObserver())===null||U===void 0||U.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(F=window.documentPictureInPicture)===null||F===void 0||F.removeEventListener("enter",this.onEnterPiP),(q=(B=window.documentPictureInPicture)===null||B===void 0?void 0:B.window)===null||q===void 0||q.removeEventListener("pagehide",this.onLeavePiP)}}function isElementInPiP(V){var j,U;return document.pictureInPictureElement===V?!0:!((j=window.documentPictureInPicture)===null||j===void 0)&&j.window?isElementInViewport(V,(U=window.documentPictureInPicture)===null||U===void 0?void 0:U.window):!1}function isElementInViewport(V,j){const U=j||window;let F=V.offsetTop,B=V.offsetLeft;const q=V.offsetWidth,z=V.offsetHeight,{hidden:G}=V,{display:Y}=getComputedStyle(V);for(;V.offsetParent;)V=V.offsetParent,F+=V.offsetTop,B+=V.offsetLeft;return F<U.pageYOffset+U.innerHeight&&B<U.pageXOffset+U.innerWidth&&F+z>U.pageYOffset&&B+q>U.pageXOffset&&!G&&Y!=="none"}class TrackPublication extends eventsExports.EventEmitter{constructor(j,U,F,B){var q;super(),this.metadataMuted=!1,this.encryption=Encryption_Type.NONE,this.log=livekitLogger,this.handleMuted=()=>{this.emit(TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(TrackEvent.Unmuted)},this.log=getLogger((q=B?.loggerName)!==null&&q!==void 0?q:LoggerNames.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=j,this.trackSid=U,this.trackName=F,this.source=Track.Source.Unknown}setTrack(j){this.track&&(this.track.off(TrackEvent.Muted,this.handleMuted),this.track.off(TrackEvent.Unmuted,this.handleUnmuted)),this.track=j,j&&(j.on(TrackEvent.Muted,this.handleMuted),j.on(TrackEvent.Unmuted,this.handleUnmuted))}get logContext(){var j;return Object.assign(Object.assign({},(j=this.loggerContextCb)===null||j===void 0?void 0:j.call(this)),getLogContextFromTrack(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Encryption_Type.NONE}get audioTrack(){if(isAudioTrack(this.track))return this.track}get videoTrack(){if(isVideoTrack(this.track))return this.track}updateInfo(j){this.trackSid=j.sid,this.trackName=j.name,this.source=Track.sourceFromProto(j.source),this.mimeType=j.mimeType,this.kind===Track.Kind.Video&&j.width>0&&(this.dimensions={width:j.width,height:j.height},this.simulcasted=j.simulcast),this.encryption=j.encryption,this.trackInfo=j,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:j}))}}(function(V){(function(j){j.Desired="desired",j.Subscribed="subscribed",j.Unsubscribed="unsubscribed"})(V.SubscriptionStatus||(V.SubscriptionStatus={})),(function(j){j.Allowed="allowed",j.NotAllowed="not_allowed"})(V.PermissionStatus||(V.PermissionStatus={}))})(TrackPublication||(TrackPublication={}));class LocalTrackPublication extends TrackPublication{get isUpstreamPaused(){var j;return(j=this.track)===null||j===void 0?void 0:j.isUpstreamPaused}constructor(j,U,F,B){super(j,U.sid,U.name,B),this.track=void 0,this.handleTrackEnded=()=>{this.emit(TrackEvent.Ended)},this.handleCpuConstrained=()=>{this.track&&isVideoTrack(this.track)&&this.emit(TrackEvent.CpuConstrained,this.track)},this.updateInfo(U),this.setTrack(F)}setTrack(j){this.track&&(this.track.off(TrackEvent.Ended,this.handleTrackEnded),this.track.off(TrackEvent.CpuConstrained,this.handleCpuConstrained)),super.setTrack(j),j&&(j.on(TrackEvent.Ended,this.handleTrackEnded),j.on(TrackEvent.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return __awaiter$1(this,void 0,void 0,function*(){var j;return(j=this.track)===null||j===void 0?void 0:j.mute()})}unmute(){return __awaiter$1(this,void 0,void 0,function*(){var j;return(j=this.track)===null||j===void 0?void 0:j.unmute()})}pauseUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var j;yield(j=this.track)===null||j===void 0?void 0:j.pauseUpstream()})}resumeUpstream(){return __awaiter$1(this,void 0,void 0,function*(){var j;yield(j=this.track)===null||j===void 0?void 0:j.resumeUpstream()})}getTrackFeatures(){var j;if(isAudioTrack(this.track)){const U=this.track.getSourceTrackSettings(),F=new Set;return U.autoGainControl&&F.add(AudioTrackFeature.TF_AUTO_GAIN_CONTROL),U.echoCancellation&&F.add(AudioTrackFeature.TF_ECHO_CANCELLATION),U.noiseSuppression&&F.add(AudioTrackFeature.TF_NOISE_SUPPRESSION),U.channelCount&&U.channelCount>1&&F.add(AudioTrackFeature.TF_STEREO),!((j=this.options)===null||j===void 0)&&j.dtx||F.add(AudioTrackFeature.TF_NO_DTX),this.track.enhancedNoiseCancellation&&F.add(AudioTrackFeature.TF_ENHANCED_NOISE_CANCELLATION),Array.from(F.values())}else return[]}}function createLocalTracks(V,j){return __awaiter$1(this,void 0,void 0,function*(){V??(V={});let U=!1;const{audioProcessor:F,videoProcessor:B,optionsWithoutProcessor:q}=extractProcessorsFromOptions(V);let z=q.audio,G=q.video;if(F&&typeof q.audio=="object"&&(q.audio.processor=F),B&&typeof q.video=="object"&&(q.video.processor=B),V.audio&&typeof q.audio=="object"&&typeof q.audio.deviceId=="string"){const Z=q.audio.deviceId;q.audio.deviceId={exact:Z},U=!0,z=Object.assign(Object.assign({},q.audio),{deviceId:{ideal:Z}})}if(q.video&&typeof q.video=="object"&&typeof q.video.deviceId=="string"){const Z=q.video.deviceId;q.video.deviceId={exact:Z},U=!0,G=Object.assign(Object.assign({},q.video),{deviceId:{ideal:Z}})}(q.audio===!0||typeof q.audio=="object"&&!q.audio.deviceId)&&(q.audio={deviceId:"default"}),q.video===!0?q.video={deviceId:"default"}:typeof q.video=="object"&&!q.video.deviceId&&(q.video.deviceId="default");const Y=mergeDefaultOptions(q,audioDefaults,videoDefaults),Q=constraintsForOptions(Y),W=navigator.mediaDevices.getUserMedia(Q);q.audio&&(DeviceManager.userMediaPromiseMap.set("audioinput",W),W.catch(()=>DeviceManager.userMediaPromiseMap.delete("audioinput"))),q.video&&(DeviceManager.userMediaPromiseMap.set("videoinput",W),W.catch(()=>DeviceManager.userMediaPromiseMap.delete("videoinput")));try{const Z=yield W;return yield Promise.all(Z.getTracks().map(ee=>__awaiter$1(this,void 0,void 0,function*(){const ne=ee.kind==="audio";let ae=ne?Y.audio:Y.video;(typeof ae=="boolean"||!ae)&&(ae={});let se;const de=ne?Q.audio:Q.video;typeof de!="boolean"&&(se=de);const oe=ee.getSettings().deviceId;se?.deviceId&&unwrapConstraint(se.deviceId)!==oe?se.deviceId=oe:se||(se={deviceId:oe});const ue=mediaTrackToLocalTrack(ee,se,j);return ue.kind===Track.Kind.Video?ue.source=Track.Source.Camera:ue.kind===Track.Kind.Audio&&(ue.source=Track.Source.Microphone),ue.mediaStream=Z,isAudioTrack(ue)&&F?yield ue.setProcessor(F):isVideoTrack(ue)&&B&&(yield ue.setProcessor(B)),ue})))}catch(Z){if(!U)throw Z;return createLocalTracks(Object.assign(Object.assign({},V),{audio:z,video:G}),j)}})}function createLocalVideoTrack(V){return __awaiter$1(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:!1,video:!0}))[0]})}function createLocalAudioTrack(V){return __awaiter$1(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:V??!0,video:!1}))[0]})}var ConnectionQuality$2;(function(V){V.Excellent="excellent",V.Good="good",V.Poor="poor",V.Lost="lost",V.Unknown="unknown"})(ConnectionQuality$2||(ConnectionQuality$2={}));function qualityFromProto(V){switch(V){case ConnectionQuality$1.EXCELLENT:return ConnectionQuality$2.Excellent;case ConnectionQuality$1.GOOD:return ConnectionQuality$2.Good;case ConnectionQuality$1.POOR:return ConnectionQuality$2.Poor;case ConnectionQuality$1.LOST:return ConnectionQuality$2.Lost;default:return ConnectionQuality$2.Unknown}}class Participant extends eventsExports.EventEmitter{get logContext(){var j,U;return Object.assign({},(U=(j=this.loggerOptions)===null||j===void 0?void 0:j.loggerContextCb)===null||U===void 0?void 0:U.call(j))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(j=>j.isEncrypted)}get isAgent(){var j;return((j=this.permissions)===null||j===void 0?void 0:j.agent)||this.kind===ParticipantInfo_Kind.AGENT}get isActive(){var j;return((j=this.participantInfo)===null||j===void 0?void 0:j.state)===ParticipantInfo_State.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(j,U,F,B,q,z){let G=arguments.length>6&&arguments[6]!==void 0?arguments[6]:ParticipantInfo_Kind.STANDARD;var Y;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ConnectionQuality$2.Unknown,this.log=livekitLogger,this.log=getLogger((Y=z?.loggerName)!==null&&Y!==void 0?Y:LoggerNames.Participant),this.loggerOptions=z,this.setMaxListeners(100),this.sid=j,this.identity=U,this.name=F,this.metadata=B,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=G,this._attributes=q??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(j){for(const[,U]of this.trackPublications)if(U.source===j)return U}getTrackPublicationByName(j){for(const[,U]of this.trackPublications)if(U.trackName===j)return U}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Future,this.once(ParticipantEvent.Active,()=>{var j,U;(U=(j=this.activeFuture)===null||j===void 0?void 0:j.resolve)===null||U===void 0||U.call(j),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var j;const U=this.getTrackPublication(Track.Source.Camera);return!(!((j=U?.isMuted)!==null&&j!==void 0)||j)}get isMicrophoneEnabled(){var j;const U=this.getTrackPublication(Track.Source.Microphone);return!(!((j=U?.isMuted)!==null&&j!==void 0)||j)}get isScreenShareEnabled(){return!!this.getTrackPublication(Track.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(j){var U;return this.participantInfo&&this.participantInfo.sid===j.sid&&this.participantInfo.version>j.version?!1:(this.identity=j.identity,this.sid=j.sid,this._setName(j.name),this._setMetadata(j.metadata),this._setAttributes(j.attributes),j.state===ParticipantInfo_State.ACTIVE&&((U=this.participantInfo)===null||U===void 0?void 0:U.state)!==ParticipantInfo_State.ACTIVE&&this.emit(ParticipantEvent.Active),j.permission&&this.setPermissions(j.permission),this.participantInfo=j,!0)}_setMetadata(j){const U=this.metadata!==j,F=this.metadata;this.metadata=j,U&&this.emit(ParticipantEvent.ParticipantMetadataChanged,F)}_setName(j){const U=this.name!==j;this.name=j,U&&this.emit(ParticipantEvent.ParticipantNameChanged,j)}_setAttributes(j){const U=diffAttributes(this.attributes,j);this._attributes=j,Object.keys(U).length>0&&this.emit(ParticipantEvent.AttributesChanged,U)}setPermissions(j){var U,F,B,q,z,G;const Y=this.permissions,Q=j.canPublish!==((U=this.permissions)===null||U===void 0?void 0:U.canPublish)||j.canSubscribe!==((F=this.permissions)===null||F===void 0?void 0:F.canSubscribe)||j.canPublishData!==((B=this.permissions)===null||B===void 0?void 0:B.canPublishData)||j.hidden!==((q=this.permissions)===null||q===void 0?void 0:q.hidden)||j.recorder!==((z=this.permissions)===null||z===void 0?void 0:z.recorder)||j.canPublishSources.length!==this.permissions.canPublishSources.length||j.canPublishSources.some((W,Z)=>{var ee;return W!==((ee=this.permissions)===null||ee===void 0?void 0:ee.canPublishSources[Z])})||j.canSubscribeMetrics!==((G=this.permissions)===null||G===void 0?void 0:G.canSubscribeMetrics);return this.permissions=j,Q&&this.emit(ParticipantEvent.ParticipantPermissionsChanged,Y),Q}setIsSpeaking(j){j!==this.isSpeaking&&(this.isSpeaking=j,j&&(this.lastSpokeAt=new Date),this.emit(ParticipantEvent.IsSpeakingChanged,j))}setConnectionQuality(j){const U=this._connectionQuality;this._connectionQuality=qualityFromProto(j),U!==this._connectionQuality&&this.emit(ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var j,U;this.activeFuture&&((U=(j=this.activeFuture).reject)===null||U===void 0||U.call(j,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(j){this.audioContext=j,this.audioTrackPublications.forEach(U=>isAudioTrack(U.track)&&U.track.setAudioContext(j))}addTrackPublication(j){j.on(TrackEvent.Muted,()=>{this.emit(ParticipantEvent.TrackMuted,j)}),j.on(TrackEvent.Unmuted,()=>{this.emit(ParticipantEvent.TrackUnmuted,j)});const U=j;switch(U.track&&(U.track.sid=j.trackSid),this.trackPublications.set(j.trackSid,j),j.kind){case Track.Kind.Audio:this.audioTrackPublications.set(j.trackSid,j);break;case Track.Kind.Video:this.videoTrackPublications.set(j.trackSid,j);break}}}function trackPermissionToProto(V){var j,U,F;if(!V.participantSid&&!V.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new TrackPermission({participantIdentity:(j=V.participantIdentity)!==null&&j!==void 0?j:"",participantSid:(U=V.participantSid)!==null&&U!==void 0?U:"",allTracks:(F=V.allowAll)!==null&&F!==void 0?F:!1,trackSids:V.allowedTrackSids||[]})}class LocalParticipant extends Participant{constructor(j,U,F,B,q,z){super(j,U,void 0,void 0,void 0,{loggerName:B.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Encryption_Type.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Future)},this.handleReconnected=()=>{var G,Y;(Y=(G=this.reconnectFuture)===null||G===void 0?void 0:G.resolve)===null||Y===void 0||Y.call(G),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var G,Y,Q,W,Z,ee;this.reconnectFuture&&(this.reconnectFuture.promise.catch(ne=>this.log.warn(ne.message,this.logContext)),(Y=(G=this.reconnectFuture)===null||G===void 0?void 0:G.reject)===null||Y===void 0||Y.call(G,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((W=(Q=this.signalConnectedFuture).reject)===null||W===void 0||W.call(Q,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(ee=(Z=this.activeAgentFuture)===null||Z===void 0?void 0:Z.reject)===null||ee===void 0||ee.call(Z,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=G=>{var Y,Q;G.participant&&this.updateInfo(G.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Future),(Q=(Y=this.signalConnectedFuture).resolve)===null||Q===void 0||Q.call(Y)},this.handleSignalRequestResponse=G=>{const{requestId:Y,reason:Q,message:W}=G,Z=this.pendingSignalRequests.get(Y);Z&&(Q!==RequestResponse_Reason.OK&&Z.reject(new SignalRequestError(W,Q)),this.pendingSignalRequests.delete(Y))},this.handleDataPacket=G=>{switch(G.value.case){case"rpcResponse":let Y=G.value.value,Q=null,W=null;Y.value.case==="payload"?Q=Y.value.value:Y.value.case==="error"&&(W=RpcError.fromProto(Y.value.value)),this.handleIncomingRpcResponse(Y.requestId,Q,W);break;case"rpcAck":let Z=G.value.value;this.handleIncomingRpcAck(Z.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(G=>trackPermissionToProto(G)))},this.onTrackUnmuted=G=>{this.onTrackMuted(G,G.isUpstreamPaused)},this.onTrackMuted=(G,Y)=>{if(Y===void 0&&(Y=!0),!G.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G)));return}this.engine.updateMuteStatus(G.sid,Y)},this.onTrackUpstreamPaused=G=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),this.onTrackMuted(G,!0)},this.onTrackUpstreamResumed=G=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),this.onTrackMuted(G,G.isMuted)},this.onTrackFeatureUpdate=G=>{const Y=this.audioTrackPublications.get(G.sid);if(!Y){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(G.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(Y.trackSid,Y.getTrackFeatures())},this.onTrackCpuConstrained=(G,Y)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(Y))),this.emit(ParticipantEvent.LocalTrackCpuConstrained,G,Y)},this.handleSubscribedQualityUpdate=G=>__awaiter$1(this,void 0,void 0,function*(){var Y,Q,W,Z,ee;if(!(!((ee=this.roomOptions)===null||ee===void 0)&&ee.dynacast))return;const ne=this.videoTrackPublications.get(G.trackSid);if(!ne){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:G.trackSid}));return}if(!ne.videoTrack)return;const ae=yield ne.videoTrack.setPublishingCodecs(G.subscribedCodecs);try{for(var se=!0,de=__asyncValues(ae),oe;oe=yield de.next(),Y=oe.done,!Y;se=!0){Z=oe.value,se=!1;const ue=Z;isBackupCodec(ue)&&(this.log.debug("publish ".concat(ue," for ").concat(ne.videoTrack.sid),Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(ne))),yield this.publishAdditionalCodecForTrack(ne.videoTrack,ue,ne.options))}}catch(ue){Q={error:ue}}finally{try{!se&&!Y&&(W=de.return)&&(yield W.call(de))}finally{if(Q)throw Q.error}}}),this.handleLocalTrackUnpublished=G=>{const Y=this.trackPublications.get(G.trackSid);if(!Y){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:G.trackSid}));return}this.unpublishTrack(Y.track)},this.handleTrackEnded=G=>__awaiter$1(this,void 0,void 0,function*(){if(G.source===Track.Source.ScreenShare||G.source===Track.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),this.unpublishTrack(G);else if(G.isUserProvided)yield G.mute();else if(isLocalAudioTrack(G)||isLocalVideoTrack(G))try{if(isWeb())try{const Y=yield navigator?.permissions.query({name:G.source===Track.Source.Camera?"camera":"microphone"});if(Y&&Y.state==="denied")throw this.log.warn("user has revoked access to ".concat(G.source),Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),Y.onchange=()=>{Y.state!=="denied"&&(G.isMuted||G.restartTrack(),Y.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}G.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),isLocalAudioTrack(G)?yield G.restartTrack({deviceId:"default"}):yield G.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),yield G.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=F,this.roomOptions=B,this.setupEngine(F),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=q,this.roomOutgoingDataStreamManager=z}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Encryption_Type.NONE}getTrackPublication(j){const U=super.getTrackPublication(j);if(U)return U}getTrackPublicationByName(j){const U=super.getTrackPublicationByName(j);if(U)return U}setupEngine(j){var U;this.engine=j,this.engine.on(EngineEvent.RemoteMute,(F,B)=>{const q=this.trackPublications.get(F);!q||!q.track||(B?q.mute():q.unmute())}),!((U=this.signalConnectedFuture)===null||U===void 0)&&U.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(EngineEvent.Connected,this.handleReconnected).on(EngineEvent.SignalConnected,this.handleSignalConnected).on(EngineEvent.SignalRestarted,this.handleReconnected).on(EngineEvent.SignalResumed,this.handleReconnected).on(EngineEvent.Restarting,this.handleReconnecting).on(EngineEvent.Resuming,this.handleReconnecting).on(EngineEvent.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(EngineEvent.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(EngineEvent.Closing,this.handleClosing).on(EngineEvent.SignalRequestResponse,this.handleSignalRequestResponse).on(EngineEvent.DataPacketReceived,this.handleDataPacket)}setMetadata(j){return __awaiter$1(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:j})})}setName(j){return __awaiter$1(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:j})})}setAttributes(j){return __awaiter$1(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:j})})}requestMetadataUpdate(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let{metadata:B,name:q,attributes:z}=U;return(function*(){return new Promise((G,Y)=>__awaiter$1(F,void 0,void 0,function*(){var Q,W;try{let Z=!1;const ee=yield this.engine.client.sendUpdateLocalMetadata((Q=B??this.metadata)!==null&&Q!==void 0?Q:"",(W=q??this.name)!==null&&W!==void 0?W:"",z),ne=performance.now();for(this.pendingSignalRequests.set(ee,{resolve:G,reject:ae=>{Y(ae),Z=!0},values:{name:q,metadata:B,attributes:z}});performance.now()-ne<5e3&&!Z;){if((!q||this.name===q)&&(!B||this.metadata===B)&&(!z||Object.entries(z).every(ae=>{let[se,de]=ae;return this.attributes[se]===de||de===""&&!this.attributes[se]}))){this.pendingSignalRequests.delete(ee),G();return}yield sleep$1(50)}Y(new SignalRequestError("Request to update local metadata timed out","TimeoutError"))}catch(Z){Z instanceof Error&&Y(Z)}}))})()})}setCameraEnabled(j,U,F){return this.setTrackEnabled(Track.Source.Camera,j,U,F)}setMicrophoneEnabled(j,U,F){return this.setTrackEnabled(Track.Source.Microphone,j,U,F)}setScreenShareEnabled(j,U,F){return this.setTrackEnabled(Track.Source.ScreenShare,j,U,F)}setPermissions(j){const U=this.permissions,F=super.setPermissions(j);return F&&U&&this.emit(ParticipantEvent.ParticipantPermissionsChanged,U),F}setE2EEEnabled(j){return __awaiter$1(this,void 0,void 0,function*(){this.encryptionType=j?Encryption_Type.GCM:Encryption_Type.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(j,U,F,B){return __awaiter$1(this,void 0,void 0,function*(){var q,z;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:j,enabled:U})),this.republishPromise&&(yield this.republishPromise);let G=this.getTrackPublication(j);if(U)if(G)yield G.unmute();else{let Y;if(this.pendingPublishing.has(j)){const Q=yield this.waitForPendingPublicationOfSource(j);return Q||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:j})),yield Q?.unmute(),Q}this.pendingPublishing.add(j);try{switch(j){case Track.Source.Camera:Y=yield this.createTracks({video:(q=F)!==null&&q!==void 0?q:!0});break;case Track.Source.Microphone:Y=yield this.createTracks({audio:(z=F)!==null&&z!==void 0?z:!0});break;case Track.Source.ScreenShare:Y=yield this.createScreenTracks(Object.assign({},F));break;default:throw new TrackInvalidError(j)}}catch(Q){throw Y?.forEach(W=>{W.stop()}),Q instanceof Error&&this.emit(ParticipantEvent.MediaDevicesError,Q,sourceToKind(j)),this.pendingPublishing.delete(j),Q}for(const Q of Y){const W=Object.assign(Object.assign({},this.roomOptions.publishDefaults),F);j===Track.Source.Microphone&&isAudioTrack(Q)&&W.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),Q.startPreConnectBuffer())}try{const Q=[];for(const Z of Y)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(Z))),Q.push(this.publishTrack(Z,B));[G]=yield Promise.all(Q)}catch(Q){throw Y?.forEach(W=>{W.stop()}),Q}finally{this.pendingPublishing.delete(j)}}else if(!G?.track&&this.pendingPublishing.has(j)&&(G=yield this.waitForPendingPublicationOfSource(j),G||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:j}))),G&&G.track)if(j===Track.Source.ScreenShare){G=yield this.unpublishTrack(G.track);const Y=this.getTrackPublication(Track.Source.ScreenShareAudio);Y&&Y.track&&this.unpublishTrack(Y.track)}else yield G.mute();return G})}enableCameraAndMicrophone(){return __awaiter$1(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Track.Source.Camera)||this.pendingPublishing.has(Track.Source.Microphone))){this.pendingPublishing.add(Track.Source.Camera),this.pendingPublishing.add(Track.Source.Microphone);try{const j=yield this.createTracks({audio:!0,video:!0});yield Promise.all(j.map(U=>this.publishTrack(U)))}finally{this.pendingPublishing.delete(Track.Source.Camera),this.pendingPublishing.delete(Track.Source.Microphone)}}})}createTracks(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F;j??(j={});const B=mergeDefaultOptions(j,(U=this.roomOptions)===null||U===void 0?void 0:U.audioCaptureDefaults,(F=this.roomOptions)===null||F===void 0?void 0:F.videoCaptureDefaults);try{return(yield createLocalTracks(B,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(G=>(isAudioTrack(G)&&(this.microphoneError=void 0,G.setAudioContext(this.audioContext),G.source=Track.Source.Microphone,this.emit(ParticipantEvent.AudioStreamAcquired)),isVideoTrack(G)&&(this.cameraError=void 0,G.source=Track.Source.Camera),G))}catch(q){throw q instanceof Error&&(j.audio&&(this.microphoneError=q),j.video&&(this.cameraError=q)),q}})}createScreenTracks(j){return __awaiter$1(this,void 0,void 0,function*(){if(j===void 0&&(j={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new DeviceUnsupportedError("getDisplayMedia not supported");j.resolution===void 0&&!isSafari17Based()&&(j.resolution=ScreenSharePresets.h1080fps30.resolution);const U=screenCaptureToDisplayMediaStreamOptions(j),F=yield navigator.mediaDevices.getDisplayMedia(U),B=F.getVideoTracks();if(B.length===0)throw new TrackInvalidError("no video track found");const q=new LocalVideoTrack(B[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});q.source=Track.Source.ScreenShare,j.contentHint&&(q.mediaStreamTrack.contentHint=j.contentHint);const z=[q];if(F.getAudioTracks().length>0){this.emit(ParticipantEvent.AudioStreamAcquired);const G=new LocalAudioTrack(F.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});G.source=Track.Source.ScreenShareAudio,z.push(G)}return z})}publishTrack(j,U){return __awaiter$1(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(j,U)})}publishOrRepublishTrack(j,U){return __awaiter$1(this,arguments,void 0,function(F,B){var q=this;let z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return(function*(){var G,Y,Q,W;isLocalAudioTrack(F)&&F.setAudioContext(q.audioContext),yield(G=q.reconnectFuture)===null||G===void 0?void 0:G.promise,q.republishPromise&&!z&&(yield q.republishPromise),isLocalTrack(F)&&q.pendingPublishPromises.has(F)&&(yield q.pendingPublishPromises.get(F));let Z;if(F instanceof MediaStreamTrack)Z=F.getConstraints();else{Z=F.constraints;let oe;switch(F.source){case Track.Source.Microphone:oe="audioinput";break;case Track.Source.Camera:oe="videoinput"}oe&&q.activeDeviceMap.has(oe)&&(Z=Object.assign(Object.assign({},Z),{deviceId:q.activeDeviceMap.get(oe)}))}if(F instanceof MediaStreamTrack)switch(F.kind){case"audio":F=new LocalAudioTrack(F,Z,!0,q.audioContext,{loggerName:q.roomOptions.loggerName,loggerContextCb:()=>q.logContext});break;case"video":F=new LocalVideoTrack(F,Z,!0,{loggerName:q.roomOptions.loggerName,loggerContextCb:()=>q.logContext});break;default:throw new TrackInvalidError("unsupported MediaStreamTrack kind ".concat(F.kind))}else F.updateLoggerOptions({loggerName:q.roomOptions.loggerName,loggerContextCb:()=>q.logContext});let ee;if(q.trackPublications.forEach(oe=>{oe.track&&oe.track===F&&(ee=oe)}),ee)return q.log.warn("track has already been published, skipping",Object.assign(Object.assign({},q.logContext),getLogContextFromTrack(ee))),ee;const ne="channelCount"in F.mediaStreamTrack.getSettings()&&F.mediaStreamTrack.getSettings().channelCount===2||F.mediaStreamTrack.getConstraints().channelCount===2,ae=(Y=B?.forceStereo)!==null&&Y!==void 0?Y:ne;ae&&(B||(B={}),B.dtx===void 0&&q.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},q.logContext),getLogContextFromTrack(F))),B.red===void 0&&q.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(Q=B.dtx)!==null&&Q!==void 0||(B.dtx=!1),(W=B.red)!==null&&W!==void 0||(B.red=!1));const se=Object.assign(Object.assign({},q.roomOptions.publishDefaults),B);!isE2EESimulcastSupported()&&q.roomOptions.e2ee&&(q.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},q.logContext)),se.simulcast=!1),se.source&&(F.source=se.source);const de=new Promise((oe,ue)=>__awaiter$1(q,void 0,void 0,function*(){try{if(this.engine.client.currentState!==SignalConnectionState.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:getLogContextFromTrack(F)}));const he=setTimeout(()=>{ue(new PublishTrackError("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(he);const ye=yield this.publish(F,se,ae);oe(ye)}else try{const he=yield this.publish(F,se,ae);oe(he)}catch(he){ue(he)}}catch(he){ue(he)}}));q.pendingPublishPromises.set(F,de);try{return yield de}catch(oe){throw oe}finally{q.pendingPublishPromises.delete(F)}})()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Future),this.signalConnectedFuture.promise}hasPermissionsToPublish(j){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j))),!1;const{canPublish:U,canPublishSources:F}=this.permissions;return U&&(F.length===0||F.map(B=>getTrackSourceFromProto(B)).includes(j.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j))),!1)}publish(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){var B,q,z,G,Y,Q,W,Z,ee,ne;if(!this.hasPermissionsToPublish(j))throw new PublishTrackError("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(ke=>isLocalTrack(j)&&ke.source===j.source)&&j.source!==Track.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(j.source),Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j))),U.stopMicTrackOnMute&&isAudioTrack(j)&&(j.stopOnMute=!0),j.source===Track.Source.ScreenShare&&isFireFox()&&(U.simulcast=!1),U.videoCodec==="av1"&&!supportsAV1()&&(U.videoCodec=void 0),U.videoCodec==="vp9"&&!supportsVP9()&&(U.videoCodec=void 0),U.videoCodec===void 0&&(U.videoCodec=defaultVideoCodec),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(ke=>U.videoCodec===mimeTypeToVideoCodecString(ke.mime))||(U.videoCodec=mimeTypeToVideoCodecString(this.enabledPublishVideoCodecs[0].mime)));const se=U.videoCodec;j.on(TrackEvent.Muted,this.onTrackMuted),j.on(TrackEvent.Unmuted,this.onTrackUnmuted),j.on(TrackEvent.Ended,this.handleTrackEnded),j.on(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),j.on(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed),j.on(TrackEvent.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const de=[],oe=!(!((B=U.dtx)!==null&&B!==void 0)||B),ue=j.getSourceTrackSettings();ue.autoGainControl&&de.push(AudioTrackFeature.TF_AUTO_GAIN_CONTROL),ue.echoCancellation&&de.push(AudioTrackFeature.TF_ECHO_CANCELLATION),ue.noiseSuppression&&de.push(AudioTrackFeature.TF_NOISE_SUPPRESSION),ue.channelCount&&ue.channelCount>1&&de.push(AudioTrackFeature.TF_STEREO),oe&&de.push(AudioTrackFeature.TF_NO_DTX),isLocalAudioTrack(j)&&j.hasPreConnectBuffer&&de.push(AudioTrackFeature.TF_PRECONNECT_BUFFER);const he=new AddTrackRequest({cid:j.mediaStreamTrack.id,name:U.name,type:Track.kindToProto(j.kind),muted:j.isMuted,source:Track.sourceToProto(j.source),disableDtx:oe,encryption:this.encryptionType,stereo:F,disableRed:this.isE2EEEnabled||!(!((q=U.red)!==null&&q!==void 0)||q),stream:U?.stream,backupCodecPolicy:U?.backupCodecPolicy,audioFeatures:de});let ye;if(j.kind===Track.Kind.Video){let ke={width:0,height:0};try{ke=yield j.waitForDimensions()}catch{const be=(G=(z=this.roomOptions.videoCaptureDefaults)===null||z===void 0?void 0:z.resolution)!==null&&G!==void 0?G:VideoPresets.h720.resolution;ke={width:be.width,height:be.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)),{dims:ke}))}he.width=ke.width,he.height=ke.height,isLocalVideoTrack(j)&&(isSVCCodec(se)&&(j.source===Track.Source.ScreenShare&&(U.scalabilityMode="L1T3","contentHint"in j.mediaStreamTrack&&(j.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j))))),U.scalabilityMode=(Y=U.scalabilityMode)!==null&&Y!==void 0?Y:"L3T3_KEY"),he.simulcastCodecs=[new SimulcastCodec({codec:se,cid:j.mediaStreamTrack.id})],U.backupCodec===!0&&(U.backupCodec={codec:defaultVideoCodec}),U.backupCodec&&se!==U.backupCodec.codec&&he.encryption===Encryption_Type.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),he.simulcastCodecs.push(new SimulcastCodec({codec:U.backupCodec.codec,cid:""})))),ye=computeVideoEncodings(j.source===Track.Source.ScreenShare,he.width,he.height,U),he.layers=videoLayersFromEncodings(he.width,he.height,ye,isSVCCodec(U.videoCodec))}else j.kind===Track.Kind.Audio&&(ye=[{maxBitrate:(Q=U.audioPreset)===null||Q===void 0?void 0:Q.maxBitrate,priority:(Z=(W=U.audioPreset)===null||W===void 0?void 0:W.priority)!==null&&Z!==void 0?Z:"high",networkPriority:(ne=(ee=U.audioPreset)===null||ee===void 0?void 0:ee.priority)!==null&&ne!==void 0?ne:"high"}]);if(!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const fe=()=>__awaiter$1(this,void 0,void 0,function*(){var ke,Ae,be;if(!this.engine.pcManager)throw new UnexpectedConnectionState("pcManager is not ready");if(j.sender=yield this.engine.createSender(j,U,ye),this.emit(ParticipantEvent.LocalSenderCreated,j.sender,j),isLocalVideoTrack(j)&&((ke=U.degradationPreference)!==null&&ke!==void 0||(U.degradationPreference=getDefaultDegradationPreference(j)),j.setDegradationPreference(U.degradationPreference)),ye)if(isFireFox()&&j.kind===Track.Kind.Audio){let Le;for(const Fe of this.engine.pcManager.publisher.getTransceivers())if(Fe.sender===j.sender){Le=Fe;break}Le&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:Le,codec:"opus",maxbr:!((Ae=ye[0])===null||Ae===void 0)&&Ae.maxBitrate?ye[0].maxBitrate/1e3:0})}else j.codec&&isSVCCodec(j.codec)&&(!((be=ye[0])===null||be===void 0)&&be.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:he.cid,codec:j.codec,maxbr:ye[0].maxBitrate/1e3});yield this.engine.negotiate()});let pe;const xe=new Promise((ke,Ae)=>__awaiter$1(this,void 0,void 0,function*(){var be;try{pe=yield this.engine.addTrack(he),ke(pe)}catch(Le){j.sender&&(!((be=this.engine.pcManager)===null||be===void 0)&&be.publisher)&&(this.engine.pcManager.publisher.removeTrack(j.sender),yield this.engine.negotiate().catch(Fe=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)),{error:Fe}))})),Ae(Le)}}));if(this.enabledPublishVideoCodecs.length>0)pe=(yield Promise.all([xe,fe()]))[0];else{pe=yield xe;let ke;if(pe.codecs.forEach(Ae=>{ke===void 0&&(ke=Ae.mimeType)}),ke&&j.kind===Track.Kind.Video){const Ae=mimeTypeToVideoCodecString(ke);Ae!==se&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)),{codec:Ae})),U.videoCodec=Ae,ye=computeVideoEncodings(j.source===Track.Source.ScreenShare,he.width,he.height,U))}yield fe()}const Ee=new LocalTrackPublication(j.kind,pe,j,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(Ee.on(TrackEvent.CpuConstrained,ke=>this.onTrackCpuConstrained(ke,Ee)),Ee.options=U,j.sid=pe.sid,this.log.debug("publishing ".concat(j.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:ye,trackInfo:pe})),isLocalVideoTrack(j)?j.startMonitor(this.engine.client):isLocalAudioTrack(j)&&j.startMonitor(),this.addTrackPublication(Ee),this.emit(ParticipantEvent.LocalTrackPublished,Ee),isLocalAudioTrack(j)&&pe.audioFeatures.includes(AudioTrackFeature.TF_PRECONNECT_BUFFER)){const ke=j.getPreConnectBuffer(),Ae=j.getPreConnectBufferMimeType();this.on(ParticipantEvent.LocalTrackSubscribed,be=>{if(be.trackSid===pe.sid){if(!j.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j))),j.stopPreConnectBuffer()}}),ke&&new Promise((Le,Fe)=>__awaiter$1(this,void 0,void 0,function*(){var Ne,Ve,Te,Oe,Ue,Ye;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)));const ge=setTimeout(()=>{Fe(new Error("agent not active within 10 seconds"))},1e4),We=yield this.waitUntilActiveAgentPresent();clearTimeout(ge),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)));const at=yield this.streamBytes({name:"preconnect-buffer",mimeType:Ae,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[We.identity],attributes:{trackId:Ee.trackSid,sampleRate:String((Ue=ue.sampleRate)!==null&&Ue!==void 0?Ue:"48000"),channels:String((Ye=ue.channelCount)!==null&&Ye!==void 0?Ye:"1")}});try{for(var le=!0,we=__asyncValues(ke),He;He=yield we.next(),Ne=He.done,!Ne;le=!0){Oe=He.value,le=!1;const $e=Oe;yield at.write($e)}}catch($e){Ve={error:$e}}finally{try{!le&&!Ne&&(Te=we.return)&&(yield Te.call(we))}finally{if(Ve)throw Ve.error}}yield at.close(),Le()}catch(ge){Fe(ge)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)))}).catch(Le=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)),{error:Le}))})}return Ee})}get isLocal(){return!0}publishAdditionalCodecForTrack(j,U,F){return __awaiter$1(this,void 0,void 0,function*(){var B;if(this.encryptionType!==Encryption_Type.NONE)return;let q;if(this.trackPublications.forEach(ne=>{ne.track&&ne.track===j&&(q=ne)}),!q)throw new TrackInvalidError("track is not published");if(!isLocalVideoTrack(j))throw new TrackInvalidError("track is not a video track");const z=Object.assign(Object.assign({},(B=this.roomOptions)===null||B===void 0?void 0:B.publishDefaults),F),G=computeTrackBackupEncodings(j,U,z);if(!G){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)));return}const Y=j.addSimulcastTrack(U,G);if(!Y)return;const Q=new AddTrackRequest({cid:Y.mediaStreamTrack.id,type:Track.kindToProto(j.kind),muted:j.isMuted,source:Track.sourceToProto(j.source),sid:j.sid,simulcastCodecs:[{codec:z.videoCodec,cid:Y.mediaStreamTrack.id}]});if(Q.layers=videoLayersFromEncodings(Q.width,Q.height,G),!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const W=()=>__awaiter$1(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(j,Y,z,G),yield this.engine.negotiate()}),ee=(yield Promise.all([this.engine.addTrack(Q),W()]))[0];this.log.debug("published ".concat(U," for track ").concat(j.sid),Object.assign(Object.assign({},this.logContext),{encodings:G,trackInfo:ee}))})}unpublishTrack(j,U){return __awaiter$1(this,void 0,void 0,function*(){var F,B;if(isLocalTrack(j)){const Q=this.pendingPublishPromises.get(j);Q&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j))),yield Q)}const q=this.getPublicationForTrack(j),z=q?getLogContextFromTrack(q):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),z)),!q||!q.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),z));return}j=q.track,j.off(TrackEvent.Muted,this.onTrackMuted),j.off(TrackEvent.Unmuted,this.onTrackUnmuted),j.off(TrackEvent.Ended,this.handleTrackEnded),j.off(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),j.off(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed),j.off(TrackEvent.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),U===void 0&&(U=(B=(F=this.roomOptions)===null||F===void 0?void 0:F.stopLocalTrackOnUnpublish)!==null&&B!==void 0?B:!0),U?j.stop():j.stopMonitor();let G=!1;const Y=j.sender;if(j.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<PCTransportState.FAILED&&Y)try{for(const Q of this.engine.pcManager.publisher.getTransceivers())Q.sender===Y&&(Q.direction="inactive",G=!0);if(this.engine.removeTrack(Y)&&(G=!0),isLocalVideoTrack(j)){for(const[,Q]of j.simulcastCodecs)Q.sender&&(this.engine.removeTrack(Q.sender)&&(G=!0),Q.sender=void 0);j.simulcastCodecs.clear()}}catch(Q){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),z),{error:Q}))}switch(this.trackPublications.delete(q.trackSid),q.kind){case Track.Kind.Audio:this.audioTrackPublications.delete(q.trackSid);break;case Track.Kind.Video:this.videoTrackPublications.delete(q.trackSid);break}return this.emit(ParticipantEvent.LocalTrackUnpublished,q),q.setTrack(void 0),G&&(yield this.engine.negotiate()),q})}unpublishTracks(j){return __awaiter$1(this,void 0,void 0,function*(){return(yield Promise.all(j.map(F=>this.unpublishTrack(F)))).filter(F=>!!F)})}republishAllTracks(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){F.republishPromise&&(yield F.republishPromise),F.republishPromise=new Promise((q,z)=>__awaiter$1(F,void 0,void 0,function*(){try{const G=[];this.trackPublications.forEach(Y=>{Y.track&&(U&&(Y.options=Object.assign(Object.assign({},Y.options),U)),G.push(Y))}),yield Promise.all(G.map(Y=>__awaiter$1(this,void 0,void 0,function*(){const Q=Y.track;yield this.unpublishTrack(Q,!1),B&&!Q.isMuted&&Q.source!==Track.Source.ScreenShare&&Q.source!==Track.Source.ScreenShareAudio&&(isLocalAudioTrack(Q)||isLocalVideoTrack(Q))&&!Q.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:Y.trackSid})),yield Q.restartTrack()),yield this.publishOrRepublishTrack(Q,Y.options,!0)}))),q()}catch(G){z(G)}finally{this.republishPromise=void 0}})),yield F.republishPromise})()})}publishData(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const q=B.reliable?DataPacket_Kind.RELIABLE:DataPacket_Kind.LOSSY,z=B.destinationIdentities,G=B.topic,Y=new DataPacket({kind:q,value:{case:"user",value:new UserPacket({participantIdentity:F.identity,payload:U,destinationIdentities:z,topic:G})}});yield F.engine.sendDataPacket(Y,q)})()})}publishDtmf(j,U){return __awaiter$1(this,void 0,void 0,function*(){const F=new DataPacket({kind:DataPacket_Kind.RELIABLE,value:{case:"sipDtmf",value:new SipDTMF({code:j,digit:U})}});yield this.engine.sendDataPacket(F,DataPacket_Kind.RELIABLE)})}sendChatMessage(j,U){return __awaiter$1(this,void 0,void 0,function*(){const F={id:crypto.randomUUID(),message:j,timestamp:Date.now(),attachedFiles:U?.attachments},B=new DataPacket({value:{case:"chatMessage",value:new ChatMessage(Object.assign(Object.assign({},F),{timestamp:protoInt64.parse(F.timestamp)}))}});return yield this.engine.sendDataPacket(B,DataPacket_Kind.RELIABLE),this.emit(ParticipantEvent.ChatMessage,F),F})}editChatMessage(j,U){return __awaiter$1(this,void 0,void 0,function*(){const F=Object.assign(Object.assign({},U),{message:j,editTimestamp:Date.now()}),B=new DataPacket({value:{case:"chatMessage",value:new ChatMessage(Object.assign(Object.assign({},F),{timestamp:protoInt64.parse(F.timestamp),editTimestamp:protoInt64.parse(F.editTimestamp)}))}});return yield this.engine.sendDataPacket(B,DataPacket_Kind.RELIABLE),this.emit(ParticipantEvent.ChatMessage,F),F})}sendText(j,U){return __awaiter$1(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(j,U)})}streamText(j){return __awaiter$1(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(j)})}sendFile(j,U){return __awaiter$1(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(j,U)})}streamBytes(j){return __awaiter$1(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(j)})}performRpc(j){return __awaiter$1(this,arguments,void 0,function(U){var F=this;let{destinationIdentity:B,method:q,payload:z,responseTimeout:G=1e4}=U;return(function*(){return new Promise((Q,W)=>__awaiter$1(F,void 0,void 0,function*(){var Z,ee,ne,ae;if(byteLength(z)>MAX_PAYLOAD_BYTES){W(RpcError.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((ee=(Z=this.engine.latestJoinResponse)===null||Z===void 0?void 0:Z.serverInfo)===null||ee===void 0)&&ee.version&&compareVersions((ae=(ne=this.engine.latestJoinResponse)===null||ne===void 0?void 0:ne.serverInfo)===null||ae===void 0?void 0:ae.version,"1.8.0")<0){W(RpcError.builtIn("UNSUPPORTED_SERVER"));return}const se=crypto.randomUUID();yield this.publishRpcRequest(B,se,q,z,G-2e3);const de=setTimeout(()=>{this.pendingAcks.delete(se),W(RpcError.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(se),clearTimeout(oe)},2e3);this.pendingAcks.set(se,{resolve:()=>{clearTimeout(de)},participantIdentity:B});const oe=setTimeout(()=>{this.pendingResponses.delete(se),W(RpcError.builtIn("RESPONSE_TIMEOUT"))},G);this.pendingResponses.set(se,{resolve:(ue,he)=>{clearTimeout(oe),this.pendingAcks.has(se)&&(console.warn("RPC response received before ack",se),this.pendingAcks.delete(se),clearTimeout(de)),he?W(he):Q(ue??"")},participantIdentity:B})}))})()})}registerRpcMethod(j,U){this.rpcHandlers.has(j)&&this.log.warn("you're overriding the RPC handler for method ".concat(j,", in the future this will throw an error")),this.rpcHandlers.set(j,U)}unregisterRpcMethod(j){this.rpcHandlers.delete(j)}setTrackSubscriptionPermissions(j){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=U,this.allParticipantsAllowedToSubscribe=j,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(j){const U=this.pendingAcks.get(j);U?(U.resolve(),this.pendingAcks.delete(j)):console.error("Ack received for unexpected RPC request",j)}handleIncomingRpcResponse(j,U,F){const B=this.pendingResponses.get(j);B?(B.resolve(U,F),this.pendingResponses.delete(j)):console.error("Response received for unexpected RPC request",j)}publishRpcRequest(j,U,F,B,q){return __awaiter$1(this,void 0,void 0,function*(){const z=new DataPacket({destinationIdentities:[j],kind:DataPacket_Kind.RELIABLE,value:{case:"rpcRequest",value:new RpcRequest({id:U,method:F,payload:B,responseTimeoutMs:q,version:1})}});yield this.engine.sendDataPacket(z,DataPacket_Kind.RELIABLE)})}handleParticipantDisconnected(j){for(const[U,{participantIdentity:F}]of this.pendingAcks)F===j&&this.pendingAcks.delete(U);for(const[U,{participantIdentity:F,resolve:B}]of this.pendingResponses)F===j&&(B(null,RpcError.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(U))}setEnabledPublishCodecs(j){this.enabledPublishVideoCodecs=j.filter(U=>U.mime.split("/")[0].toLowerCase()==="video")}updateInfo(j){return super.updateInfo(j)?(j.tracks.forEach(U=>{var F,B;const q=this.trackPublications.get(U.sid);if(q){const z=q.isMuted||((B=(F=q.track)===null||F===void 0?void 0:F.isUpstreamPaused)!==null&&B!==void 0?B:!1);z!==U.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(q)),{mutedOnServer:z})),this.engine.client.sendMuteTrack(U.sid,z))}}),!0):!1}setActiveAgent(j){var U,F,B,q;this.firstActiveAgent=j,j&&!this.firstActiveAgent&&(this.firstActiveAgent=j),j?(F=(U=this.activeAgentFuture)===null||U===void 0?void 0:U.resolve)===null||F===void 0||F.call(U,j):(q=(B=this.activeAgentFuture)===null||B===void 0?void 0:B.reject)===null||q===void 0||q.call(B,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Future),this.activeAgentFuture.promise)}getPublicationForTrack(j){let U;return this.trackPublications.forEach(F=>{const B=F.track;B&&(j instanceof MediaStreamTrack?(isLocalAudioTrack(B)||isLocalVideoTrack(B))&&B.mediaStreamTrack===j&&(U=F):j===B&&(U=F))}),U}waitForPendingPublicationOfSource(j){return __awaiter$1(this,void 0,void 0,function*(){const F=Date.now();for(;Date.now()<F+1e4;){const B=Array.from(this.pendingPublishPromises.entries()).find(q=>{let[z]=q;return z.source===j});if(B)return B[1];yield sleep$1(20)}})}}class RemoteTrackPublication extends TrackPublication{constructor(j,U,F,B){super(j,U.sid,U.name,B),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=q=>{this.setTrack(void 0),this.emit(TrackEvent.Ended,q)},this.handleVisibilityChange=q=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(q),this.logContext),this.visible=q,this.emitTrackUpdate()},this.handleVideoDimensionsChange=q=>{this.log.debug("adaptivestream video dimensions ".concat(q.width,"x").concat(q.height),this.logContext),this.videoDimensionsAdaptiveStream=q,this.emitTrackUpdate()},this.subscribed=F,this.updateInfo(U)}setSubscribed(j){const U=this.subscriptionStatus,F=this.permissionStatus;this.subscribed=j,j&&(this.allowed=!0);const B=new UpdateSubscription({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new ParticipantTracks({participantSid:"",trackSids:[this.trackSid]})]});this.emit(TrackEvent.UpdateSubscription,B),this.emitSubscriptionUpdateIfChanged(U),this.emitPermissionUpdateIfChanged(F)}get subscriptionStatus(){return this.subscribed===!1?TrackPublication.SubscriptionStatus.Unsubscribed:super.isSubscribed?TrackPublication.SubscriptionStatus.Subscribed:TrackPublication.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?TrackPublication.PermissionStatus.Allowed:TrackPublication.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(j){!this.isManualOperationAllowed()||this.requestedDisabled===!j||(this.requestedDisabled=!j,this.emitTrackUpdate())}setVideoQuality(j){!this.isManualOperationAllowed()||this.requestedMaxQuality===j||(this.requestedMaxQuality=j,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(j){var U,F;this.isManualOperationAllowed()&&(((U=this.requestedVideoDimensions)===null||U===void 0?void 0:U.width)===j.width&&((F=this.requestedVideoDimensions)===null||F===void 0?void 0:F.height)===j.height||(isRemoteVideoTrack(this.track)&&(this.requestedVideoDimensions=j),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(j){this.isManualOperationAllowed()&&isRemoteVideoTrack(this.track)&&this.fps!==j&&(this.fps=j,this.emitTrackUpdate())}get videoQuality(){var j;return(j=this.requestedMaxQuality)!==null&&j!==void 0?j:VideoQuality.HIGH}setTrack(j){const U=this.subscriptionStatus,F=this.permissionStatus,B=this.track;B!==j&&(B&&(B.off(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),B.off(TrackEvent.VisibilityChanged,this.handleVisibilityChange),B.off(TrackEvent.Ended,this.handleEnded),B.detach(),B.stopMonitor(),this.emit(TrackEvent.Unsubscribed,B)),super.setTrack(j),j&&(j.sid=this.trackSid,j.on(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),j.on(TrackEvent.VisibilityChanged,this.handleVisibilityChange),j.on(TrackEvent.Ended,this.handleEnded),this.emit(TrackEvent.Subscribed,j)),this.emitPermissionUpdateIfChanged(F),this.emitSubscriptionUpdateIfChanged(U))}setAllowed(j){const U=this.subscriptionStatus,F=this.permissionStatus;this.allowed=j,this.emitPermissionUpdateIfChanged(F),this.emitSubscriptionUpdateIfChanged(U)}setSubscriptionError(j){this.emit(TrackEvent.SubscriptionFailed,j)}updateInfo(j){super.updateInfo(j);const U=this.metadataMuted;this.metadataMuted=j.muted,this.track?this.track.setMuted(j.muted):U!==j.muted&&this.emit(j.muted?TrackEvent.Muted:TrackEvent.Unmuted)}emitSubscriptionUpdateIfChanged(j){const U=this.subscriptionStatus;j!==U&&this.emit(TrackEvent.SubscriptionStatusChanged,U,j)}emitPermissionUpdateIfChanged(j){this.permissionStatus!==j&&this.emit(TrackEvent.SubscriptionPermissionChanged,this.permissionStatus,j)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return isRemoteVideoTrack(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const j=new UpdateTrackSettings({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Track.Kind.Video){let U=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(U)areDimensionsSmaller(this.videoDimensionsAdaptiveStream,U)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),U=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const F=layerDimensionsFor(this.trackInfo,this.requestedMaxQuality);F&&areDimensionsSmaller(this.videoDimensionsAdaptiveStream,F)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),U=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),U=this.videoDimensionsAdaptiveStream;U?(j.width=Math.ceil(U.width),j.height=Math.ceil(U.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),j.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:VideoQuality.HIGH})),j.quality=VideoQuality.HIGH)}this.emit(TrackEvent.UpdateSettings,j)}}class RemoteParticipant extends Participant{static fromParticipantInfo(j,U,F){return new RemoteParticipant(j,U.sid,U.identity,U.name,U.metadata,U.attributes,F,U.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(j,U,F,B,q,z,G){let Y=arguments.length>7&&arguments[7]!==void 0?arguments[7]:ParticipantInfo_Kind.STANDARD;super(U,F||"",B,q,z,G,Y),this.signalClient=j,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(j){super.addTrackPublication(j),j.on(TrackEvent.UpdateSettings,U=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(j)),{settings:U})),this.signalClient.sendUpdateTrackSettings(U)}),j.on(TrackEvent.UpdateSubscription,U=>{U.participantTracks.forEach(F=>{F.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(U)}),j.on(TrackEvent.SubscriptionPermissionChanged,U=>{this.emit(ParticipantEvent.TrackSubscriptionPermissionChanged,j,U)}),j.on(TrackEvent.SubscriptionStatusChanged,U=>{this.emit(ParticipantEvent.TrackSubscriptionStatusChanged,j,U)}),j.on(TrackEvent.Subscribed,U=>{this.emit(ParticipantEvent.TrackSubscribed,U,j)}),j.on(TrackEvent.Unsubscribed,U=>{this.emit(ParticipantEvent.TrackUnsubscribed,U,j)}),j.on(TrackEvent.SubscriptionFailed,U=>{this.emit(ParticipantEvent.TrackSubscriptionFailed,j.trackSid,U)})}getTrackPublication(j){const U=super.getTrackPublication(j);if(U)return U}getTrackPublicationByName(j){const U=super.getTrackPublicationByName(j);if(U)return U}setVolume(j){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Track.Source.Microphone;this.volumeMap.set(U,j);const F=this.getTrackPublication(U);F&&F.track&&F.track.setVolume(j)}getVolume(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Track.Source.Microphone;const U=this.getTrackPublication(j);return U&&U.track?U.track.getVolume():this.volumeMap.get(j)}addSubscribedMediaTrack(j,U,F,B,q,z){let G=this.getTrackPublicationBySid(U);if(G||U.startsWith("TR")||this.trackPublications.forEach(W=>{!G&&j.kind===W.kind.toString()&&(G=W)}),!G){if(z===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:U})),this.emit(ParticipantEvent.TrackSubscriptionFailed,U);return}z===void 0&&(z=20),setTimeout(()=>{this.addSubscribedMediaTrack(j,U,F,B,q,z-1)},150);return}if(j.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(G))),this.emit(ParticipantEvent.TrackSubscriptionFailed,U);return}const Y=j.kind==="video";let Q;return Y?Q=new RemoteVideoTrack(j,U,B,q):Q=new RemoteAudioTrack(j,U,B,this.audioContext,this.audioOutput),Q.source=G.source,Q.isMuted=G.isMuted,Q.setMediaStream(F),Q.start(),G.setTrack(Q),this.volumeMap.has(G.source)&&isRemoteTrack(Q)&&isAudioTrack(Q)&&Q.setVolume(this.volumeMap.get(G.source)),G}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(j){return this.trackPublications.get(j)}updateInfo(j){if(!super.updateInfo(j))return!1;const U=new Map,F=new Map;return j.tracks.forEach(B=>{var q,z;let G=this.getTrackPublicationBySid(B.sid);if(G)G.updateInfo(B);else{const Y=Track.kindFromProto(B.type);if(!Y)return;G=new RemoteTrackPublication(Y,B,(q=this.signalClient.connectOptions)===null||q===void 0?void 0:q.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(z=this.loggerOptions)===null||z===void 0?void 0:z.loggerName}),G.updateInfo(B),F.set(B.sid,G);const Q=Array.from(this.trackPublications.values()).find(W=>W.source===G?.source);Q&&G.source!==Track.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(G.source),Object.assign(Object.assign({},this.logContext),{oldTrack:getLogContextFromTrack(Q),newTrack:getLogContextFromTrack(G)})),this.addTrackPublication(G)}U.set(B.sid,G)}),this.trackPublications.forEach(B=>{U.has(B.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),getLogContextFromTrack(B))),this.unpublishTrack(B.trackSid,!0))}),F.forEach(B=>{this.emit(ParticipantEvent.TrackPublished,B)}),!0}unpublishTrack(j,U){const F=this.trackPublications.get(j);if(!F)return;const{track:B}=F;switch(B&&(B.stop(),F.setTrack(void 0)),this.trackPublications.delete(j),F.kind){case Track.Kind.Audio:this.audioTrackPublications.delete(j);break;case Track.Kind.Video:this.videoTrackPublications.delete(j);break}U&&this.emit(ParticipantEvent.TrackUnpublished,F)}setAudioOutput(j){return __awaiter$1(this,void 0,void 0,function*(){this.audioOutput=j;const U=[];this.audioTrackPublications.forEach(F=>{var B;isAudioTrack(F.track)&&isRemoteTrack(F.track)&&U.push(F.track.setSinkId((B=j.deviceId)!==null&&B!==void 0?B:"default"))}),yield Promise.all(U)})}emit(j){for(var U=arguments.length,F=new Array(U>1?U-1:0),B=1;B<U;B++)F[B-1]=arguments[B];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:j,args:F})),super.emit(j,...F)}}var ConnectionState;(function(V){V.Disconnected="disconnected",V.Connecting="connecting",V.Connected="connected",V.Reconnecting="reconnecting",V.SignalReconnecting="signalReconnecting"})(ConnectionState||(ConnectionState={}));const connectionReconcileFrequency=4*1e3;class Room extends eventsExports.EventEmitter{constructor(j){var U,F,B,q;if(super(),U=this,this.state=ConnectionState.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=livekitLogger,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(z,G,Y)=>__awaiter$1(this,void 0,void 0,function*(){var Q;if(!isBrowserSupported())throw isReactNative()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const W=yield this.disconnectLock.lock();if(this.state===ConnectionState.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),W(),Promise.resolve();if(this.connectFuture)return W(),this.connectFuture.promise;this.setAndEmitConnectionState(ConnectionState.Connecting),((Q=this.regionUrlProvider)===null||Q===void 0?void 0:Q.getServerUrl().toString())!==z&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),isCloud(new URL(z))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new RegionUrlProvider(z,G):this.regionUrlProvider.updateToken(G),this.regionUrlProvider.fetchRegionSettings().then(ne=>{var ae;(ae=this.regionUrlProvider)===null||ae===void 0||ae.setServerReportedRegions(ne)}).catch(ne=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:ne}))}));const Z=(ne,ae,se)=>__awaiter$1(this,void 0,void 0,function*(){var de,oe;this.abortController&&this.abortController.abort();const ue=new AbortController;this.abortController=ue,W?.();try{yield this.attemptConnection(se??z,G,Y,ue),this.abortController=void 0,ne()}catch(he){if(this.regionUrlProvider&&he instanceof ConnectionError&&he.reason!==ConnectionErrorReason.Cancelled&&he.reason!==ConnectionErrorReason.NotAllowed){let ye=null;try{ye=yield this.regionUrlProvider.getNextBestRegionUrl((de=this.abortController)===null||de===void 0?void 0:de.signal)}catch(fe){if(fe instanceof ConnectionError&&(fe.status===401||fe.reason===ConnectionErrorReason.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),ae(fe);return}}ye&&!(!((oe=this.abortController)===null||oe===void 0)&&oe.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(he.message,". Retrying with another region: ").concat(ye),this.logContext),this.recreateEngine(),yield Z(ne,ae,ye)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,getDisconnectReasonFromConnectionError(he)),ae(he))}else{let ye=DisconnectReason.UNKNOWN_REASON;he instanceof ConnectionError&&(ye=getDisconnectReasonFromConnectionError(he)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ye),ae(he)}}}),ee=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Future((ne,ae)=>{Z(ne,ae,ee)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(z,G,Y,Q,W,Z)=>__awaiter$1(this,void 0,void 0,function*(){var ee,ne,ae;const se=yield Y.join(z,G,{autoSubscribe:Q.autoSubscribe,adaptiveStream:typeof W.adaptiveStream=="object"?!0:W.adaptiveStream,maxRetries:Q.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:Q.websocketTimeout},Z.signal);let de=se.serverInfo;if(de||(de={version:se.serverVersion,region:se.serverRegion}),this.serverInfo=de,this.log.debug("connected to Livekit Server ".concat(Object.entries(de).map(oe=>{let[ue,he]=oe;return"".concat(ue,": ").concat(he)}).join(", ")),{room:(ee=se.room)===null||ee===void 0?void 0:ee.name,roomSid:(ne=se.room)===null||ne===void 0?void 0:ne.sid,identity:(ae=se.participant)===null||ae===void 0?void 0:ae.identity}),!de.version)throw new UnsupportedServer("unknown server version");return de.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),W.dynacast=!1),se}),this.applyJoinResponse=z=>{const G=z.participant;if(this.localParticipant.sid=G.sid,this.localParticipant.identity=G.identity,this.localParticipant.setEnabledPublishCodecs(z.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(z.sifTrailer)}catch(Y){this.log.error(Y instanceof Error?Y.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:Y}))}this.handleParticipantUpdates([G,...z.otherParticipants]),z.room&&this.handleRoomUpdate(z.room)},this.attemptConnection=(z,G,Y,Q)=>__awaiter$1(this,void 0,void 0,function*(){var W,Z;this.state===ConnectionState.Reconnecting||this.isResuming||!((W=this.engine)===null||W===void 0)&&W.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((Z=this.regionUrlProvider)===null||Z===void 0)&&Z.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},roomConnectOptionDefaults),Y),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const ee=yield this.connectSignal(z,G,this.engine,this.connOptions,this.options,Q);this.applyJoinResponse(ee),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected)}catch(ee){yield this.engine.close(),this.recreateEngine();const ne=new ConnectionError("could not establish signal connection",ConnectionErrorReason.ServerUnreachable);throw ee instanceof Error&&(ne.message="".concat(ne.message,": ").concat(ee.message)),ee instanceof ConnectionError&&(ne.reason=ee.reason,ne.status=ee.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:ee})),ne}if(Q.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new ConnectionError("Connection attempt aborted",ConnectionErrorReason.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,Q)}catch(ee){throw yield this.engine.close(),this.recreateEngine(),ee}isWeb()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),isWeb()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var z=arguments.length,G=new Array(z),Y=0;Y<z;Y++)G[Y]=arguments[Y];return __awaiter$1(U,[...G],void 0,function(){var Q=this;let W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var Z,ee,ne,ae;const se=yield Q.disconnectLock.lock();try{if(Q.state===ConnectionState.Disconnected){Q.log.debug("already disconnected",Q.logContext);return}Q.log.info("disconnect from room",Object.assign({},Q.logContext)),(Q.state===ConnectionState.Connecting||Q.state===ConnectionState.Reconnecting||Q.isResuming)&&(Q.log.warn("abort connection attempt",Q.logContext),(Z=Q.abortController)===null||Z===void 0||Z.abort(),(ne=(ee=Q.connectFuture)===null||ee===void 0?void 0:ee.reject)===null||ne===void 0||ne.call(ee,new ConnectionError("Client initiated disconnect",ConnectionErrorReason.Cancelled)),Q.connectFuture=void 0),!((ae=Q.engine)===null||ae===void 0)&&ae.client.isDisconnected||(yield Q.engine.client.sendLeave()),Q.engine&&(yield Q.engine.close()),Q.handleDisconnect(W,DisconnectReason.CLIENT_INITIATED),Q.engine=void 0}finally{se()}})()})},this.onPageLeave=()=>__awaiter$1(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>__awaiter$1(this,void 0,void 0,function*(){const z=[],G=getBrowser();if(G&&G.os==="iOS"){const Y="livekit-dummy-audio-el";let Q=document.getElementById(Y);if(!Q){Q=document.createElement("audio"),Q.id=Y,Q.autoplay=!0,Q.hidden=!0;const W=getEmptyAudioStreamTrack();W.enabled=!0;const Z=new MediaStream([W]);Q.srcObject=Z,document.addEventListener("visibilitychange",()=>{Q&&(Q.srcObject=document.hidden?null:Z,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(Q),this.once(RoomEvent.Disconnected,()=>{Q?.remove(),Q=null})}z.push(Q)}this.remoteParticipants.forEach(Y=>{Y.audioTrackPublications.forEach(Q=>{Q.track&&Q.track.attachedElements.forEach(W=>{z.push(W)})})});try{yield Promise.all([this.acquireAudioContext(),...z.map(Y=>(Y.muted=!1,Y.play()))]),this.handleAudioPlaybackStarted()}catch(Y){throw this.handleAudioPlaybackFailed(Y),Y}}),this.startVideo=()=>__awaiter$1(this,void 0,void 0,function*(){const z=[];for(const G of this.remoteParticipants.values())G.videoTrackPublications.forEach(Y=>{var Q;(Q=Y.track)===null||Q===void 0||Q.attachedElements.forEach(W=>{z.includes(W)||z.push(W)})});yield Promise.all(z.map(G=>G.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(G=>{G.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const z of this.remoteParticipants.values())this.handleParticipantDisconnected(z.identity,z);this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)},this.handleSignalRestarted=z=>__awaiter$1(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(z.serverRegion),Object.assign(Object.assign({},this.logContext),{region:z.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(z);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(G){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:G}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:z.serverRegion}))}catch{return}this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=z=>{z.forEach(G=>{var Y;if(G.identity===this.localParticipant.identity){this.localParticipant.updateInfo(G);return}G.identity===""&&(G.identity=(Y=this.sidToIdentity.get(G.sid))!==null&&Y!==void 0?Y:"");let Q=this.remoteParticipants.get(G.identity);G.state===ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(G.identity,Q):Q=this.getOrCreateParticipant(G.identity,G)})},this.handleActiveSpeakersUpdate=z=>{const G=[],Y={};z.forEach(Q=>{if(Y[Q.sid]=!0,Q.sid===this.localParticipant.sid)this.localParticipant.audioLevel=Q.level,this.localParticipant.setIsSpeaking(!0),G.push(this.localParticipant);else{const W=this.getRemoteParticipantBySid(Q.sid);W&&(W.audioLevel=Q.level,W.setIsSpeaking(!0),G.push(W))}}),Y[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(Q=>{Y[Q.sid]||(Q.audioLevel=0,Q.setIsSpeaking(!1))}),this.activeSpeakers=G,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,G)},this.handleSpeakersChanged=z=>{const G=new Map;this.activeSpeakers.forEach(Q=>{const W=this.remoteParticipants.get(Q.identity);W&&W.sid!==Q.sid||G.set(Q.sid,Q)}),z.forEach(Q=>{let W=this.getRemoteParticipantBySid(Q.sid);Q.sid===this.localParticipant.sid&&(W=this.localParticipant),W&&(W.audioLevel=Q.level,W.setIsSpeaking(Q.active),Q.active?G.set(Q.sid,W):G.delete(Q.sid))});const Y=Array.from(G.values());Y.sort((Q,W)=>W.audioLevel-Q.audioLevel),this.activeSpeakers=Y,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,Y)},this.handleStreamStateUpdate=z=>{z.streamStates.forEach(G=>{const Y=this.getRemoteParticipantBySid(G.participantSid);if(!Y)return;const Q=Y.getTrackPublicationBySid(G.trackSid);if(!Q||!Q.track)return;const W=Track.streamStateFromProto(G.state);W!==Q.track.streamState&&(Q.track.streamState=W,Y.emit(ParticipantEvent.TrackStreamStateChanged,Q,Q.track.streamState),this.emitWhenConnected(RoomEvent.TrackStreamStateChanged,Q,Q.track.streamState,Y))})},this.handleSubscriptionPermissionUpdate=z=>{const G=this.getRemoteParticipantBySid(z.participantSid);if(!G)return;const Y=G.getTrackPublicationBySid(z.trackSid);Y&&Y.setAllowed(z.allowed)},this.handleSubscriptionError=z=>{const G=Array.from(this.remoteParticipants.values()).find(Q=>Q.trackPublications.has(z.trackSid));if(!G)return;const Y=G.getTrackPublicationBySid(z.trackSid);Y&&Y.setSubscriptionError(z.err)},this.handleDataPacket=z=>{const G=this.remoteParticipants.get(z.participantIdentity);if(z.value.case==="user")this.handleUserPacket(G,z.value.value,z.kind);else if(z.value.case==="transcription")this.handleTranscription(G,z.value.value);else if(z.value.case==="sipDtmf")this.handleSipDtmf(G,z.value.value);else if(z.value.case==="chatMessage")this.handleChatMessage(G,z.value.value);else if(z.value.case==="metrics")this.handleMetrics(z.value.value,G);else if(z.value.case==="streamHeader"||z.value.case==="streamChunk"||z.value.case==="streamTrailer")this.handleDataStream(z);else if(z.value.case==="rpcRequest"){const Y=z.value.value;this.handleIncomingRpcRequest(z.participantIdentity,Y.id,Y.method,Y.payload,Y.responseTimeoutMs,Y.version)}},this.handleUserPacket=(z,G,Y)=>{this.emit(RoomEvent.DataReceived,G.payload,z,Y,G.topic),z?.emit(ParticipantEvent.DataReceived,G.payload,Y)},this.handleSipDtmf=(z,G)=>{this.emit(RoomEvent.SipDTMFReceived,G,z),z?.emit(ParticipantEvent.SipDTMFReceived,G)},this.handleTranscription=(z,G)=>{const Y=G.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(G.transcribedParticipantIdentity),Q=Y?.trackPublications.get(G.trackId),W=extractTranscriptionSegments(G,this.transcriptionReceivedTimes);Q?.emit(TrackEvent.TranscriptionReceived,W),Y?.emit(ParticipantEvent.TranscriptionReceived,W,Q),this.emit(RoomEvent.TranscriptionReceived,W,Y,Q)},this.handleChatMessage=(z,G)=>{const Y=extractChatMessage(G);this.emit(RoomEvent.ChatMessage,Y,z)},this.handleMetrics=(z,G)=>{this.emit(RoomEvent.MetricsReceived,z,G)},this.handleDataStream=z=>{this.incomingDataStreamManager.handleDataStreamPacket(z)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=z=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:z})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(RoomEvent.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(RoomEvent.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>__awaiter$1(this,void 0,void 0,function*(){var z;((z=getBrowser())===null||z===void 0?void 0:z.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(RoomEvent.MediaDevicesChanged)}),this.handleRoomUpdate=z=>{const G=this.roomInfo;this.roomInfo=z,G&&G.metadata!==z.metadata&&this.emitWhenConnected(RoomEvent.RoomMetadataChanged,z.metadata),G?.activeRecording!==z.activeRecording&&this.emitWhenConnected(RoomEvent.RecordingStatusChanged,z.activeRecording)},this.handleConnectionQualityUpdate=z=>{z.updates.forEach(G=>{if(G.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(G.quality);return}const Y=this.getRemoteParticipantBySid(G.participantSid);Y&&Y.setConnectionQuality(G.quality)})},this.onLocalParticipantMetadataChanged=z=>{this.emit(RoomEvent.ParticipantMetadataChanged,z,this.localParticipant)},this.onLocalParticipantNameChanged=z=>{this.emit(RoomEvent.ParticipantNameChanged,z,this.localParticipant)},this.onLocalAttributesChanged=z=>{this.emit(RoomEvent.ParticipantAttributesChanged,z,this.localParticipant)},this.onLocalTrackMuted=z=>{this.emit(RoomEvent.TrackMuted,z,this.localParticipant)},this.onLocalTrackUnmuted=z=>{this.emit(RoomEvent.TrackUnmuted,z,this.localParticipant)},this.onTrackProcessorUpdate=z=>{var G;(G=z?.onPublish)===null||G===void 0||G.call(z,this)},this.onLocalTrackPublished=z=>__awaiter$1(this,void 0,void 0,function*(){var G,Y,Q,W,Z,ee;(G=z.track)===null||G===void 0||G.on(TrackEvent.TrackProcessorUpdate,this.onTrackProcessorUpdate),(Y=z.track)===null||Y===void 0||Y.on(TrackEvent.Restarted,this.onLocalTrackRestarted),(Z=(W=(Q=z.track)===null||Q===void 0?void 0:Q.getProcessor())===null||W===void 0?void 0:W.onPublish)===null||Z===void 0||Z.call(W,this),this.emit(RoomEvent.LocalTrackPublished,z,this.localParticipant),isLocalAudioTrack(z.track)&&(yield z.track.checkForSilence())&&this.emit(RoomEvent.LocalAudioSilenceDetected,z);const ne=yield(ee=z.track)===null||ee===void 0?void 0:ee.getDeviceId(!1),ae=sourceToKind(z.source);ae&&ne&&ne!==this.localParticipant.activeDeviceMap.get(ae)&&(this.localParticipant.activeDeviceMap.set(ae,ne),this.emit(RoomEvent.ActiveDeviceChanged,ae,ne))}),this.onLocalTrackUnpublished=z=>{var G,Y;(G=z.track)===null||G===void 0||G.off(TrackEvent.TrackProcessorUpdate,this.onTrackProcessorUpdate),(Y=z.track)===null||Y===void 0||Y.off(TrackEvent.Restarted,this.onLocalTrackRestarted),this.emit(RoomEvent.LocalTrackUnpublished,z,this.localParticipant)},this.onLocalTrackRestarted=z=>__awaiter$1(this,void 0,void 0,function*(){const G=yield z.getDeviceId(!1),Y=sourceToKind(z.source);Y&&G&&G!==this.localParticipant.activeDeviceMap.get(Y)&&(this.log.debug("local track restarted, setting ".concat(Y," ").concat(G," active"),this.logContext),this.localParticipant.activeDeviceMap.set(Y,G),this.emit(RoomEvent.ActiveDeviceChanged,Y,G))}),this.onLocalConnectionQualityChanged=z=>{this.emit(RoomEvent.ConnectionQualityChanged,z,this.localParticipant)},this.onMediaDevicesError=(z,G)=>{this.emit(RoomEvent.MediaDevicesError,z,G)},this.onLocalParticipantPermissionsChanged=z=>{this.emit(RoomEvent.ParticipantPermissionsChanged,z,this.localParticipant)},this.onLocalChatMessageSent=z=>{this.emit(RoomEvent.ChatMessage,z,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},roomOptionDefaults),j),this.log=getLogger((F=this.options.loggerName)!==null&&F!==void 0?F:LoggerNames.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},audioDefaults),j?.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},videoDefaults),j?.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},publishDefaults),j?.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new IncomingDataStreamManager,this.outgoingDataStreamManager=new OutgoingDataStreamManager(this.engine,this.log),this.disconnectLock=new _$1,this.localParticipant=new LocalParticipant("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",unwrapConstraint(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",unwrapConstraint(this.options.audioCaptureDefaults.deviceId)),!((B=this.options.audioOutput)===null||B===void 0)&&B.deviceId&&this.switchActiveDevice("audiooutput",unwrapConstraint(this.options.audioOutput.deviceId)).catch(z=>this.log.warn("Could not set audio output: ".concat(z.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),isWeb()){const z=new AbortController;(q=navigator.mediaDevices)===null||q===void 0||q.addEventListener("devicechange",this.handleDeviceChange,{signal:z.signal}),Room.cleanupRegistry&&Room.cleanupRegistry.register(this,()=>{z.abort()})}}registerTextStreamHandler(j,U){return this.incomingDataStreamManager.registerTextStreamHandler(j,U)}unregisterTextStreamHandler(j){return this.incomingDataStreamManager.unregisterTextStreamHandler(j)}registerByteStreamHandler(j,U){return this.incomingDataStreamManager.registerByteStreamHandler(j,U)}unregisterByteStreamHandler(j){return this.incomingDataStreamManager.unregisterByteStreamHandler(j)}registerRpcMethod(j,U){if(this.rpcHandlers.has(j))throw Error("RPC handler already registered for method ".concat(j,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(j,U)}unregisterRpcMethod(j){this.rpcHandlers.delete(j)}setE2EEEnabled(j){return __awaiter$1(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(j)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(j,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var j;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new E2EEManager(this.options.e2ee),this.e2eeManager.on(EncryptionEvent.ParticipantEncryptionStatusChanged,(U,F)=>{isLocalParticipant(F)&&(this.isE2EEEnabled=U),this.emit(RoomEvent.ParticipantEncryptionStatusChanged,U,F)}),this.e2eeManager.on(EncryptionEvent.EncryptionError,U=>this.emit(RoomEvent.EncryptionError,U)),(j=this.e2eeManager)===null||j===void 0||j.setup(this))}get logContext(){var j;return{room:this.name,roomID:(j=this.roomInfo)===null||j===void 0?void 0:j.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var j,U;return(U=(j=this.roomInfo)===null||j===void 0?void 0:j.activeRecording)!==null&&U!==void 0?U:!1}getSid(){return __awaiter$1(this,void 0,void 0,function*(){return this.state===ConnectionState.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((j,U)=>{const F=B=>{B.sid!==""&&(this.engine.off(EngineEvent.RoomUpdate,F),j(B.sid))};this.engine.on(EngineEvent.RoomUpdate,F),this.once(RoomEvent.Disconnected,()=>{this.engine.off(EngineEvent.RoomUpdate,F),U("Room disconnected before room server id was available")})})})}get name(){var j,U;return(U=(j=this.roomInfo)===null||j===void 0?void 0:j.name)!==null&&U!==void 0?U:""}get metadata(){var j;return(j=this.roomInfo)===null||j===void 0?void 0:j.metadata}get numParticipants(){var j,U;return(U=(j=this.roomInfo)===null||j===void 0?void 0:j.numParticipants)!==null&&U!==void 0?U:0}get numPublishers(){var j,U;return(U=(j=this.roomInfo)===null||j===void 0?void 0:j.numPublishers)!==null&&U!==void 0?U:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new RTCEngine(this.options),this.engine.on(EngineEvent.ParticipantUpdate,this.handleParticipantUpdates).on(EngineEvent.RoomUpdate,this.handleRoomUpdate).on(EngineEvent.SpeakersChanged,this.handleSpeakersChanged).on(EngineEvent.StreamStateChanged,this.handleStreamStateUpdate).on(EngineEvent.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(EngineEvent.SubscriptionError,this.handleSubscriptionError).on(EngineEvent.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(EngineEvent.MediaTrackAdded,(j,U,F)=>{this.onTrackAdded(j,U,F)}).on(EngineEvent.Disconnected,j=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,j)}).on(EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(EngineEvent.DataPacketReceived,this.handleDataPacket).on(EngineEvent.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(ConnectionState.SignalReconnecting)&&this.emit(RoomEvent.SignalReconnecting)}).on(EngineEvent.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(ConnectionState.Connected)&&this.emit(RoomEvent.Reconnected)}).on(EngineEvent.SignalResumed,()=>{this.bufferedEvents=[],(this.state===ConnectionState.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(EngineEvent.Restarting,this.handleRestarting).on(EngineEvent.SignalRestarted,this.handleSignalRestarted).on(EngineEvent.Offline,()=>{this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)}).on(EngineEvent.DCBufferStatusChanged,(j,U)=>{this.emit(RoomEvent.DCBufferStatusChanged,j,U)}).on(EngineEvent.LocalTrackSubscribed,j=>{const U=this.localParticipant.getTrackPublications().find(F=>{let{trackSid:B}=F;return B===j});if(!U){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ParticipantEvent.LocalTrackSubscribed,U),this.emitWhenConnected(RoomEvent.LocalTrackSubscribed,U,this.localParticipant)}).on(EngineEvent.RoomMoved,j=>{this.log.debug("room moved",j),j.room&&this.handleRoomUpdate(j.room),this.remoteParticipants.forEach((U,F)=>{this.handleParticipantDisconnected(F,U)}),this.emit(RoomEvent.Moved,j.room.name),j.participant?this.handleParticipantUpdates([j.participant,...j.otherParticipants]):this.handleParticipantUpdates(j.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(j){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return DeviceManager.getInstance().getDevices(j,U)}prepareConnection(j,U){return __awaiter$1(this,void 0,void 0,function*(){if(this.state===ConnectionState.Disconnected){this.log.debug("prepareConnection to ".concat(j),this.logContext);try{if(isCloud(new URL(j))&&U){this.regionUrlProvider=new RegionUrlProvider(j,U);const F=yield this.regionUrlProvider.getNextBestRegionUrl();F&&this.state===ConnectionState.Disconnected&&(this.regionUrl=F,yield fetch(toHttpUrl(F),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(F),this.logContext))}else yield fetch(toHttpUrl(j),{method:"HEAD"})}catch(F){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:F}))}}})}getParticipantByIdentity(j){return this.localParticipant.identity===j?this.localParticipant:this.remoteParticipants.get(j)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(j,U){return __awaiter$1(this,void 0,void 0,function*(){let F=()=>{},B;switch(j){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":B=new SimulateScenario({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":B=new SimulateScenario({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":B=new SimulateScenario({scenario:{case:"serverLeave",value:!0}});break;case"migration":B=new SimulateScenario({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":F=()=>__awaiter$1(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),B=new SimulateScenario({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":F=()=>__awaiter$1(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),B=new SimulateScenario({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":B=new SimulateScenario({scenario:{case:"switchCandidateProtocol",value:j==="force-tls"?2:1}}),F=()=>__awaiter$1(this,void 0,void 0,function*(){const q=this.engine.client.onLeave;q&&q(new LeaveRequest({reason:DisconnectReason.CLIENT_INITIATED,action:LeaveRequest_Action.RECONNECT}))});break;case"subscriber-bandwidth":if(U===void 0||typeof U!="number")throw new Error("subscriber-bandwidth requires a number as argument");B=new SimulateScenario({scenario:{case:"subscriberBandwidth",value:numberToBigInt(U)}});break;case"leave-full-reconnect":B=new SimulateScenario({scenario:{case:"leaveRequestFullReconnect",value:!0}})}B&&(yield this.engine.client.sendSimulateScenario(B),yield F())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(j){return this.localParticipant.activeDeviceMap.get(j)}switchActiveDevice(j,U){return __awaiter$1(this,arguments,void 0,function(F,B){var q=this;let z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(function*(){var G,Y,Q,W,Z,ee,ne;let ae=!0,se=!1;const de=z?{exact:B}:B;if(F==="audioinput"){se=q.localParticipant.audioTrackPublications.size===0;const oe=(G=q.getActiveDevice(F))!==null&&G!==void 0?G:q.options.audioCaptureDefaults.deviceId;q.options.audioCaptureDefaults.deviceId=de;const ue=Array.from(q.localParticipant.audioTrackPublications.values()).filter(ye=>ye.source===Track.Source.Microphone);try{ae=(yield Promise.all(ue.map(ye=>{var fe;return(fe=ye.audioTrack)===null||fe===void 0?void 0:fe.setDeviceId(de)}))).every(ye=>ye===!0)}catch(ye){throw q.options.audioCaptureDefaults.deviceId=oe,ye}const he=ue.some(ye=>{var fe,pe;return(pe=(fe=ye.track)===null||fe===void 0?void 0:fe.isMuted)!==null&&pe!==void 0?pe:!1});ae&&he&&(se=!0)}else if(F==="videoinput"){se=q.localParticipant.videoTrackPublications.size===0;const oe=(Y=q.getActiveDevice(F))!==null&&Y!==void 0?Y:q.options.videoCaptureDefaults.deviceId;q.options.videoCaptureDefaults.deviceId=de;const ue=Array.from(q.localParticipant.videoTrackPublications.values()).filter(ye=>ye.source===Track.Source.Camera);try{ae=(yield Promise.all(ue.map(ye=>{var fe;return(fe=ye.videoTrack)===null||fe===void 0?void 0:fe.setDeviceId(de)}))).every(ye=>ye===!0)}catch(ye){throw q.options.videoCaptureDefaults.deviceId=oe,ye}const he=ue.some(ye=>{var fe,pe;return(pe=(fe=ye.track)===null||fe===void 0?void 0:fe.isMuted)!==null&&pe!==void 0?pe:!1});ae&&he&&(se=!0)}else if(F==="audiooutput"){if(se=!0,!supportsSetSinkId()&&!q.options.webAudioMix||q.options.webAudioMix&&q.audioContext&&!("setSinkId"in q.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");q.options.webAudioMix&&(B=(Q=yield DeviceManager.getInstance().normalizeDeviceId("audiooutput",B))!==null&&Q!==void 0?Q:""),(W=(ne=q.options).audioOutput)!==null&&W!==void 0||(ne.audioOutput={});const oe=(Z=q.getActiveDevice(F))!==null&&Z!==void 0?Z:q.options.audioOutput.deviceId;q.options.audioOutput.deviceId=B;try{q.options.webAudioMix&&((ee=q.audioContext)===null||ee===void 0||ee.setSinkId(B)),yield Promise.all(Array.from(q.remoteParticipants.values()).map(ue=>ue.setAudioOutput({deviceId:B})))}catch(ue){throw q.options.audioOutput.deviceId=oe,ue}}return se&&(q.localParticipant.activeDeviceMap.set(F,B),q.emit(RoomEvent.ActiveDeviceChanged,F,B)),ae})()})}setupLocalParticipantEvents(){this.localParticipant.on(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ParticipantEvent.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ParticipantEvent.AttributesChanged,this.onLocalAttributesChanged).on(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).on(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).on(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).on(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).on(ParticipantEvent.AudioStreamAcquired,this.startAudio).on(ParticipantEvent.ChatMessage,this.onLocalChatMessageSent).on(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var j;(j=this.engine)===null||j===void 0||j.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(j,U,F){if(this.state===ConnectionState.Connecting||this.state===ConnectionState.Reconnecting){const W=()=>{this.onTrackAdded(j,U,F),Z()},Z=()=>{this.off(RoomEvent.Reconnected,W),this.off(RoomEvent.Connected,W),this.off(RoomEvent.Disconnected,Z)};this.once(RoomEvent.Reconnected,W),this.once(RoomEvent.Connected,W),this.once(RoomEvent.Disconnected,Z);return}if(this.state===ConnectionState.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(j.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const B=unpackStreamId(U.id),q=B[0];let z=B[1],G=j.id;if(z&&z.startsWith("TR")&&(G=z),q===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const Y=Array.from(this.remoteParticipants.values()).find(W=>W.sid===q);if(!Y){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(q),this.logContext);return}let Q;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?Q=this.options.adaptiveStream:Q={}),Y.addSubscribedMediaTrack(j,G,U,F,Q)}handleDisconnect(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,U=arguments.length>1?arguments[1]:void 0;var F;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==ConnectionState.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(B=>{B.trackPublications.forEach(q=>{B.unpublishTrack(q.trackSid)})}),this.localParticipant.trackPublications.forEach(B=>{var q,z,G;B.track&&this.localParticipant.unpublishTrack(B.track,j),j?((q=B.track)===null||q===void 0||q.detach(),(z=B.track)===null||z===void 0||z.stop()):(G=B.track)===null||G===void 0||G.stopMonitor()}),this.localParticipant.off(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ParticipantEvent.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ParticipantEvent.AttributesChanged,this.onLocalAttributesChanged).off(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).off(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).off(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).off(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).off(ParticipantEvent.AudioStreamAcquired,this.startAudio).off(ParticipantEvent.ChatMessage,this.onLocalChatMessageSent).off(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),isWeb()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(F=navigator.mediaDevices)===null||F===void 0||F.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ConnectionState.Disconnected),this.emit(RoomEvent.Disconnected,U)}}}handleParticipantDisconnected(j,U){var F;this.remoteParticipants.delete(j),U&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(j),U.trackPublications.forEach(B=>{U.unpublishTrack(B.trackSid,!0)}),this.emit(RoomEvent.ParticipantDisconnected,U),U.setDisconnected(),(F=this.localParticipant)===null||F===void 0||F.handleParticipantDisconnected(U.identity))}handleIncomingRpcRequest(j,U,F,B,q,z){return __awaiter$1(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(j,U),z!==1){yield this.engine.publishRpcResponse(j,U,null,RpcError.builtIn("UNSUPPORTED_VERSION"));return}const G=this.rpcHandlers.get(F);if(!G){yield this.engine.publishRpcResponse(j,U,null,RpcError.builtIn("UNSUPPORTED_METHOD"));return}let Y=null,Q=null;try{const W=yield G({requestId:U,callerIdentity:j,payload:B,responseTimeout:q});byteLength(W)>MAX_PAYLOAD_BYTES?(Y=RpcError.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(F))):Q=W}catch(W){W instanceof RpcError?Y=W:(console.warn("Uncaught error returned by RPC handler for ".concat(F,". Returning APPLICATION_ERROR instead."),W),Y=RpcError.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(j,U,Q,Y)})}selectDefaultDevices(){return __awaiter$1(this,void 0,void 0,function*(){var j,U,F;const B=DeviceManager.getInstance().previousDevices,q=yield DeviceManager.getInstance().getDevices(void 0,!1),z=getBrowser();if(z?.name==="Chrome"&&z.os!=="iOS")for(let Y of q){const Q=B.find(W=>W.deviceId===Y.deviceId);Q&&Q.label!==""&&Q.kind===Y.kind&&Q.label!==Y.label&&this.getActiveDevice(Y.kind)==="default"&&this.emit(RoomEvent.ActiveDeviceChanged,Y.kind,Y.deviceId)}const G=["audiooutput","audioinput","videoinput"];for(let Y of G){const Q=kindToSource(Y),W=this.localParticipant.getTrackPublication(Q);if(W&&(!((j=W.track)===null||j===void 0)&&j.isUserProvided))continue;const Z=q.filter(ne=>ne.kind===Y),ee=this.getActiveDevice(Y);if(ee===((U=B.filter(ne=>ne.kind===Y)[0])===null||U===void 0?void 0:U.deviceId)&&Z.length>0&&((F=Z[0])===null||F===void 0?void 0:F.deviceId)!==ee){yield this.switchActiveDevice(Y,Z[0].deviceId);continue}Y==="audioinput"&&!isSafariBased()||Y==="videoinput"||Z.length>0&&!Z.find(ne=>ne.deviceId===this.getActiveDevice(Y))&&(Y!=="audiooutput"||!isSafariBased())&&(yield this.switchActiveDevice(Y,Z[0].deviceId))}})}acquireAudioContext(){return __awaiter$1(this,void 0,void 0,function*(){var j,U;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(j=getNewAudioContext())!==null&&j!==void 0?j:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(B=>B.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),sleep$1(200)])}catch(B){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:B}))}const F=((U=this.audioContext)===null||U===void 0?void 0:U.state)==="running";F!==this.canPlaybackAudio&&(this.audioEnabled=F,this.emit(RoomEvent.AudioPlaybackStatusChanged,F))})}createParticipant(j,U){var F;let B;return U?B=RemoteParticipant.fromParticipantInfo(this.engine.client,U,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):B=new RemoteParticipant(this.engine.client,"",j,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&B.setAudioContext(this.audioContext),!((F=this.options.audioOutput)===null||F===void 0)&&F.deviceId&&B.setAudioOutput(this.options.audioOutput).catch(q=>this.log.warn("Could not set audio output: ".concat(q.message),this.logContext)),B}getOrCreateParticipant(j,U){if(this.remoteParticipants.has(j)){const B=this.remoteParticipants.get(j);return U&&B.updateInfo(U)&&this.sidToIdentity.set(U.sid,U.identity),B}const F=this.createParticipant(j,U);return this.remoteParticipants.set(j,F),this.sidToIdentity.set(U.sid,U.identity),this.emitWhenConnected(RoomEvent.ParticipantConnected,F),F.on(ParticipantEvent.TrackPublished,B=>{this.emitWhenConnected(RoomEvent.TrackPublished,B,F)}).on(ParticipantEvent.TrackSubscribed,(B,q)=>{B.kind===Track.Kind.Audio?(B.on(TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),B.on(TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):B.kind===Track.Kind.Video&&(B.on(TrackEvent.VideoPlaybackFailed,this.handleVideoPlaybackFailed),B.on(TrackEvent.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(RoomEvent.TrackSubscribed,B,q,F)}).on(ParticipantEvent.TrackUnpublished,B=>{this.emit(RoomEvent.TrackUnpublished,B,F)}).on(ParticipantEvent.TrackUnsubscribed,(B,q)=>{this.emit(RoomEvent.TrackUnsubscribed,B,q,F)}).on(ParticipantEvent.TrackMuted,B=>{this.emitWhenConnected(RoomEvent.TrackMuted,B,F)}).on(ParticipantEvent.TrackUnmuted,B=>{this.emitWhenConnected(RoomEvent.TrackUnmuted,B,F)}).on(ParticipantEvent.ParticipantMetadataChanged,B=>{this.emitWhenConnected(RoomEvent.ParticipantMetadataChanged,B,F)}).on(ParticipantEvent.ParticipantNameChanged,B=>{this.emitWhenConnected(RoomEvent.ParticipantNameChanged,B,F)}).on(ParticipantEvent.AttributesChanged,B=>{this.emitWhenConnected(RoomEvent.ParticipantAttributesChanged,B,F)}).on(ParticipantEvent.ConnectionQualityChanged,B=>{this.emitWhenConnected(RoomEvent.ConnectionQualityChanged,B,F)}).on(ParticipantEvent.ParticipantPermissionsChanged,B=>{this.emitWhenConnected(RoomEvent.ParticipantPermissionsChanged,B,F)}).on(ParticipantEvent.TrackSubscriptionStatusChanged,(B,q)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionStatusChanged,B,q,F)}).on(ParticipantEvent.TrackSubscriptionFailed,(B,q)=>{this.emit(RoomEvent.TrackSubscriptionFailed,B,F,q)}).on(ParticipantEvent.TrackSubscriptionPermissionChanged,(B,q)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionPermissionChanged,B,q,F)}).on(ParticipantEvent.Active,()=>{this.emitWhenConnected(RoomEvent.ParticipantActive,F),F.kind===ParticipantInfo_Kind.AGENT&&this.localParticipant.setActiveAgent(F)}),U&&F.updateInfo(U),F}sendSyncState(){const j=Array.from(this.remoteParticipants.values()).reduce((F,B)=>(F.push(...B.getTrackPublications()),F),[]),U=this.localParticipant.getTrackPublications();this.engine.sendSyncState(j,U)}updateSubscriptions(){for(const j of this.remoteParticipants.values())for(const U of j.videoTrackPublications.values())U.isSubscribed&&isRemotePub(U)&&U.emitTrackUpdate()}getRemoteParticipantBySid(j){const U=this.sidToIdentity.get(j);if(U)return this.remoteParticipants.get(U)}registerConnectionReconcile(){this.clearConnectionReconcile();let j=0;this.connectionReconcileInterval=CriticalTimers.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(j++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:j,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),j>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,DisconnectReason.STATE_MISMATCH))):j=0},connectionReconcileFrequency)}clearConnectionReconcile(){this.connectionReconcileInterval&&CriticalTimers.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(j){return j===this.state?!1:(this.state=j,this.emit(RoomEvent.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(j=>{let[U,F]=j;this.emit(U,...F)}),this.bufferedEvents=[]}emitWhenConnected(j){for(var U=arguments.length,F=new Array(U>1?U-1:0),B=1;B<U;B++)F[B-1]=arguments[B];if(this.state===ConnectionState.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([j,F]);else if(this.state===ConnectionState.Connected)return this.emit(j,...F);return!1}simulateParticipants(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F;const B=Object.assign({audio:!0,video:!0,useRealTracks:!1},j.publish),q=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},j.participants);if(this.handleDisconnect(),this.roomInfo=new Room$1({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:protoInt64.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new ParticipantInfo({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected),this.emit(RoomEvent.Connected),this.setAndEmitConnectionState(ConnectionState.Connected),B.video){const z=new LocalTrackPublication(Track.Kind.Video,new TrackInfo({source:TrackSource.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO,name:"video-dummy"}),new LocalVideoTrack(B.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:createDummyVideoStreamTrack(160*((U=q.aspectRatios[0])!==null&&U!==void 0?U:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(z),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,z)}if(B.audio){const z=new LocalTrackPublication(Track.Kind.Audio,new TrackInfo({source:TrackSource.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO}),new LocalAudioTrack(B.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:getEmptyAudioStreamTrack(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(z),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,z)}for(let z=0;z<q.count-1;z+=1){let G=new ParticipantInfo({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(z),state:ParticipantInfo_State.ACTIVE,tracks:[],joinedAt:protoInt64.parse(Date.now())});const Y=this.getOrCreateParticipant(G.identity,G);if(q.video){const Q=createDummyVideoStreamTrack(160*((F=q.aspectRatios[z%q.aspectRatios.length])!==null&&F!==void 0?F:1),160,!1,!0),W=new TrackInfo({source:TrackSource.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO});Y.addSubscribedMediaTrack(Q,W.sid,new MediaStream([Q]),new RTCRtpReceiver),G.tracks=[...G.tracks,W]}if(q.audio){const Q=getEmptyAudioStreamTrack(),W=new TrackInfo({source:TrackSource.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType.AUDIO});Y.addSubscribedMediaTrack(Q,W.sid,new MediaStream([Q]),new RTCRtpReceiver),G.tracks=[...G.tracks,W]}Y.updateInfo(G)}})}emit(j){for(var U=arguments.length,F=new Array(U>1?U-1:0),B=1;B<U;B++)F[B-1]=arguments[B];if(j!==RoomEvent.ActiveSpeakersChanged&&j!==RoomEvent.TranscriptionReceived){const q=mapArgs(F).filter(z=>z!==void 0);this.log.debug("room event ".concat(j),Object.assign(Object.assign({},this.logContext),{event:j,args:q}))}return super.emit(j,...F)}}Room.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(V=>{V()});function mapArgs(V){return V.map(j=>{if(j)return Array.isArray(j)?mapArgs(j):typeof j=="object"?"logContext"in j?j.logContext:void 0:j})}var CheckStatus;(function(V){V[V.IDLE=0]="IDLE",V[V.RUNNING=1]="RUNNING",V[V.SKIPPED=2]="SKIPPED",V[V.SUCCESS=3]="SUCCESS",V[V.FAILED=4]="FAILED"})(CheckStatus||(CheckStatus={}));class Checker extends eventsExports.EventEmitter{constructor(j,U){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=CheckStatus.IDLE,this.logs=[],this.options={},this.url=j,this.token=U,this.name=this.constructor.name,this.room=new Room(F.roomOptions),this.connectOptions=F.connectOptions,this.options=F}run(j){return __awaiter$1(this,void 0,void 0,function*(){if(this.status!==CheckStatus.IDLE)throw Error("check is running already");this.setStatus(CheckStatus.RUNNING);try{yield this.perform()}catch(U){U instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(U.message):this.appendError(U.message))}return yield this.disconnect(),yield new Promise(U=>setTimeout(U,500)),this.status!==CheckStatus.SKIPPED&&this.setStatus(this.isSuccess()?CheckStatus.SUCCESS:CheckStatus.FAILED),j&&j(),this.getInfo()})}isSuccess(){return!this.logs.some(j=>j.level==="error")}connect(j){return __awaiter$1(this,void 0,void 0,function*(){return this.room.state===ConnectionState.Connected?this.room:(j||(j=this.url),yield this.room.connect(j,this.token,this.connectOptions),this.room)})}disconnect(){return __awaiter$1(this,void 0,void 0,function*(){this.room&&this.room.state!==ConnectionState.Disconnected&&(yield this.room.disconnect(),yield new Promise(j=>setTimeout(j,500)))})}skip(){this.setStatus(CheckStatus.SKIPPED)}switchProtocol(j){return __awaiter$1(this,void 0,void 0,function*(){let U=!1,F=!1;if(this.room.on(RoomEvent.Reconnecting,()=>{U=!0}),this.room.once(RoomEvent.Reconnected,()=>{F=!0}),this.room.simulateScenario("force-".concat(j)),yield new Promise(q=>setTimeout(q,1e3)),!U)return;const B=Date.now()+1e4;for(;Date.now()<B;){if(F)return;yield sleep$1(100)}throw new Error("Could not reconnect using ".concat(j," protocol after 10 seconds"))})}appendMessage(j){this.logs.push({level:"info",message:j}),this.emit("update",this.getInfo())}appendWarning(j){this.logs.push({level:"warning",message:j}),this.emit("update",this.getInfo())}appendError(j){this.logs.push({level:"error",message:j}),this.emit("update",this.getInfo())}setStatus(j){this.status=j,this.emit("update",this.getInfo())}get engine(){var j;return(j=this.room)===null||j===void 0?void 0:j.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class CloudRegionCheck extends Checker{get description(){return"Cloud regions"}perform(){return __awaiter$1(this,void 0,void 0,function*(){const j=new RegionUrlProvider(this.url,this.token);if(!j.isCloud()){this.skip();return}const U=[],F=new Set;for(let q=0;q<3;q++){const z=yield j.getNextBestRegionUrl();if(!z)break;if(F.has(z))continue;F.add(z);const G=yield this.checkCloudRegion(z);this.appendMessage("".concat(G.region," RTT: ").concat(G.rtt,"ms, duration: ").concat(G.duration,"ms")),U.push(G)}U.sort((q,z)=>(q.duration-z.duration)*.5+(q.rtt-z.rtt)*.5);const B=U[0];this.bestStats=B,this.appendMessage("best Cloud region: ".concat(B.region))})}getInfo(){const j=super.getInfo();return j.data=this.bestStats,j}checkCloudRegion(j){return __awaiter$1(this,void 0,void 0,function*(){var U,F;yield this.connect(j),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const B=(U=this.room.serverInfo)===null||U===void 0?void 0:U.region;if(!B)throw new Error("Region not found");const q=yield this.room.localParticipant.streamText({topic:"test"}),z=1e3,Y=1e6/z,Q="A".repeat(z),W=Date.now();for(let ae=0;ae<Y;ae++)yield q.write(Q);yield q.close();const Z=Date.now(),ee=yield(F=this.room.engine.pcManager)===null||F===void 0?void 0:F.publisher.getStats(),ne={region:B,rtt:1e4,duration:Z-W};return ee?.forEach(ae=>{ae.type==="candidate-pair"&&ae.nominated&&(ne.rtt=ae.currentRoundTripTime*1e3)}),yield this.disconnect(),ne})}}const TEST_DURATION=1e4;class ConnectionProtocolCheck extends Checker{get description(){return"Connection via UDP vs TCP"}perform(){return __awaiter$1(this,void 0,void 0,function*(){const j=yield this.checkConnectionProtocol("udp"),U=yield this.checkConnectionProtocol("tcp");this.bestStats=j,j.qualityLimitationDurations.bandwidth-U.qualityLimitationDurations.bandwidth>.5||(j.packetsLost-U.packetsLost)/j.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=U):this.appendMessage("best connection quality via udp");const F=this.bestStats;this.appendMessage("upstream bitrate: ".concat((F.bitrateTotal/F.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((F.rttTotal/F.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((F.jitterTotal/F.count*1e3).toFixed(2)," ms")),F.packetsLost>0&&this.appendWarning("packets lost: ".concat((F.packetsLost/F.packetsSent*100).toFixed(2),"%")),F.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((F.qualityLimitationDurations.bandwidth/(TEST_DURATION/1e3)*100).toFixed(2),"%")),F.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((F.qualityLimitationDurations.cpu/(TEST_DURATION/1e3)*100).toFixed(2),"%"))})}getInfo(){const j=super.getInfo();return j.data=this.bestStats,j}checkConnectionProtocol(j){return __awaiter$1(this,void 0,void 0,function*(){yield this.connect(),j==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const U=document.createElement("canvas");U.width=1280,U.height=720;const F=U.getContext("2d");if(!F)throw new Error("Could not get canvas context");let B=0;const q=()=>{B=(B+1)%360,F.fillStyle="hsl(".concat(B,", 100%, 50%)"),F.fillRect(0,0,U.width,U.height),requestAnimationFrame(q)};q();const G=U.captureStream(30).getVideoTracks()[0],Q=(yield this.room.localParticipant.publishTrack(G,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,W={protocol:j,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},Z=setInterval(()=>__awaiter$1(this,void 0,void 0,function*(){const ee=yield Q.getRTCStatsReport();ee?.forEach(ne=>{ne.type==="outbound-rtp"?(W.packetsSent=ne.packetsSent,W.qualityLimitationDurations=ne.qualityLimitationDurations,W.bitrateTotal+=ne.targetBitrate,W.count++):ne.type==="remote-inbound-rtp"&&(W.packetsLost=ne.packetsLost,W.rttTotal+=ne.roundTripTime,W.jitterTotal+=ne.jitter)})}),1e3);return yield new Promise(ee=>setTimeout(ee,TEST_DURATION)),clearInterval(Z),G.stop(),U.remove(),yield this.disconnect(),W})}}class PublishAudioCheck extends Checker{get description(){return"Can publish audio"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var j;const U=yield this.connect(),F=yield createLocalAudioTrack();if(yield detectSilence(F,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),U.localParticipant.publishTrack(F),yield new Promise(G=>setTimeout(G,3e3));const q=yield(j=F.sender)===null||j===void 0?void 0:j.getStats();if(!q)throw new Error("Could not get RTCStats");let z=0;if(q.forEach(G=>{G.type==="outbound-rtp"&&(G.kind==="audio"||!G.kind&&G.mediaType==="audio")&&(z=G.packetsSent)}),z===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(z," audio packets"))})}}class PublishVideoCheck extends Checker{get description(){return"Can publish video"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var j;const U=yield this.connect(),F=yield createLocalVideoTrack();yield this.checkForVideo(F.mediaStreamTrack),U.localParticipant.publishTrack(F),yield new Promise(z=>setTimeout(z,5e3));const B=yield(j=F.sender)===null||j===void 0?void 0:j.getStats();if(!B)throw new Error("Could not get RTCStats");let q=0;if(B.forEach(z=>{z.type==="outbound-rtp"&&(z.kind==="video"||!z.kind&&z.mediaType==="video")&&(q+=z.packetsSent)}),q===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(q," video packets"))})}checkForVideo(j){return __awaiter$1(this,void 0,void 0,function*(){const U=new MediaStream;U.addTrack(j.clone());const F=document.createElement("video");F.srcObject=U,F.muted=!0,yield new Promise(B=>{F.onplay=()=>{setTimeout(()=>{var q,z,G,Y;const Q=document.createElement("canvas"),W=j.getSettings(),Z=(z=(q=W.width)!==null&&q!==void 0?q:F.videoWidth)!==null&&z!==void 0?z:1280,ee=(Y=(G=W.height)!==null&&G!==void 0?G:F.videoHeight)!==null&&Y!==void 0?Y:720;Q.width=Z,Q.height=ee;const ne=Q.getContext("2d");ne.drawImage(F,0,0);const se=ne.getImageData(0,0,Q.width,Q.height).data;let de=!0;for(let oe=0;oe<se.length;oe+=4)if(se[oe]!==0||se[oe+1]!==0||se[oe+2]!==0){de=!1;break}de?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),B()},1e3)},F.play()}),U.getTracks().forEach(B=>B.stop()),F.remove()})}}class ReconnectCheck extends Checker{get description(){return"Resuming connection after interruption"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var j;const U=yield this.connect();let F=!1,B=!1,q;const z=new Promise(Q=>{setTimeout(Q,5e3),q=Q}),G=()=>{F=!0};U.on(RoomEvent.SignalReconnecting,G).on(RoomEvent.Reconnecting,G).on(RoomEvent.Reconnected,()=>{B=!0,q(!0)}),(j=U.engine.client.ws)===null||j===void 0||j.close();const Y=U.engine.client.onClose;if(Y&&Y(""),yield z,F){if(!B||U.state!==ConnectionState.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class TURNCheck extends Checker{get description(){return"Can connect via TURN"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var j,U;const F=new SignalClient,B=yield F.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let q=!1,z=!1,G=!1;for(let Y of B.iceServers)for(let Q of Y.urls)Q.startsWith("turn:")?(z=!0,G=!0):Q.startsWith("turns:")&&(z=!0,G=!0,q=!0),Q.startsWith("stun:")&&(G=!0);G?z&&!q&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield F.close(),!((U=(j=this.connectOptions)===null||j===void 0?void 0:j.rtcConfig)===null||U===void 0)&&U.iceServers||z?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(Y=>setTimeout(Y,0)))})}}class WebRTCCheck extends Checker{get description(){return"Establishing WebRTC connection"}perform(){return __awaiter$1(this,void 0,void 0,function*(){let j=!1,U=!1;this.room.on(RoomEvent.SignalConnected,()=>{const F=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(B,q)=>{if(B.candidate){const z=new RTCIceCandidate(B);let G="".concat(z.protocol," ").concat(z.address,":").concat(z.port," ").concat(z.type);z.address&&(isIPPrivate(z.address)?G+=" (private)":z.protocol==="tcp"&&z.tcpType==="passive"?(j=!0,G+=" (passive)"):z.protocol==="udp"&&(U=!0)),this.appendMessage(G)}F&&F(B,q)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=B=>{B instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(B.errorCode," ").concat(B.errorText," ").concat(B.url))})});try{yield this.connect(),livekitLogger.info("now the room is connected")}catch(F){throw this.appendWarning("ports need to be open on firewall in order to connect."),F}j||this.appendWarning("Server is not configured for ICE/TCP"),U||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function isIPPrivate(V){const j=V.split(".");if(j.length===4){if(j[0]==="10")return!0;if(j[0]==="192"&&j[1]==="168")return!0;if(j[0]==="172"){const U=parseInt(j[1],10);if(U>=16&&U<=31)return!0}}return!1}class WebSocketCheck extends Checker{get description(){return"Connecting to signal connection via WebSocket"}perform(){return __awaiter$1(this,void 0,void 0,function*(){var j,U,F;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let B=new SignalClient;const q=yield B.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(q.serverVersion,".")),((j=q.serverInfo)===null||j===void 0?void 0:j.edition)===ServerInfo_Edition.Cloud&&(!((U=q.serverInfo)===null||U===void 0)&&U.region)&&this.appendMessage("LiveKit Cloud: ".concat((F=q.serverInfo)===null||F===void 0?void 0:F.region)),yield B.close()})}}class ConnectionCheck extends eventsExports.EventEmitter{constructor(j,U){let F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=j,this.token=U,this.options=F}getNextCheckId(){const j=this.checkResults.size;return this.checkResults.set(j,{logs:[],status:CheckStatus.IDLE,name:"",description:""}),j}updateCheck(j,U){this.checkResults.set(j,U),this.emit("checkUpdate",j,U)}isSuccess(){return Array.from(this.checkResults.values()).every(j=>j.status!==CheckStatus.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(j){return __awaiter$1(this,void 0,void 0,function*(){const U=this.getNextCheckId(),F=new j(this.url,this.token,this.options),B=z=>{this.updateCheck(U,z)};F.on("update",B);const q=yield F.run();return F.off("update",B),q})}checkWebsocket(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(WebSocketCheck)})}checkWebRTC(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(WebRTCCheck)})}checkTURN(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(TURNCheck)})}checkReconnect(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(ReconnectCheck)})}checkPublishAudio(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(PublishAudioCheck)})}checkPublishVideo(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(PublishVideoCheck)})}checkConnectionProtocol(){return __awaiter$1(this,void 0,void 0,function*(){const j=yield this.createAndRunCheck(ConnectionProtocolCheck);if(j.data&&"protocol"in j.data){const U=j.data;this.options.protocol=U.protocol}return j})}checkCloudRegion(){return __awaiter$1(this,void 0,void 0,function*(){return this.createAndRunCheck(CloudRegionCheck)})}}var src={exports:{}},indexLight={exports:{}},indexMinimal={},minimal={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=V;function V(j,U){for(var F=new Array(arguments.length-1),B=0,q=2,z=!0;q<arguments.length;)F[B++]=arguments[q++];return new Promise(function(Y,Q){F[B]=function(Z){if(z)if(z=!1,Z)Q(Z);else{for(var ee=new Array(arguments.length-1),ne=0;ne<ee.length;)ee[ne++]=arguments[ne];Y.apply(null,ee)}};try{j.apply(U||null,F)}catch(W){z&&(z=!1,Q(W))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,(function(V){var j=V;j.length=function(G){var Y=G.length;if(!Y)return 0;for(var Q=0;--Y%4>1&&G.charAt(Y)==="=";)++Q;return Math.ceil(G.length*3)/4-Q};for(var U=new Array(64),F=new Array(123),B=0;B<64;)F[U[B]=B<26?B+65:B<52?B+71:B<62?B-4:B-59|43]=B++;j.encode=function(G,Y,Q){for(var W=null,Z=[],ee=0,ne=0,ae;Y<Q;){var se=G[Y++];switch(ne){case 0:Z[ee++]=U[se>>2],ae=(se&3)<<4,ne=1;break;case 1:Z[ee++]=U[ae|se>>4],ae=(se&15)<<2,ne=2;break;case 2:Z[ee++]=U[ae|se>>6],Z[ee++]=U[se&63],ne=0;break}ee>8191&&((W||(W=[])).push(String.fromCharCode.apply(String,Z)),ee=0)}return ne&&(Z[ee++]=U[ae],Z[ee++]=61,ne===1&&(Z[ee++]=61)),W?(ee&&W.push(String.fromCharCode.apply(String,Z.slice(0,ee))),W.join("")):String.fromCharCode.apply(String,Z.slice(0,ee))};var q="invalid encoding";j.decode=function(G,Y,Q){for(var W=Q,Z=0,ee,ne=0;ne<G.length;){var ae=G.charCodeAt(ne++);if(ae===61&&Z>1)break;if((ae=F[ae])===void 0)throw Error(q);switch(Z){case 0:ee=ae,Z=1;break;case 1:Y[Q++]=ee<<2|(ae&48)>>4,ee=ae,Z=2;break;case 2:Y[Q++]=(ee&15)<<4|(ae&60)>>2,ee=ae,Z=3;break;case 3:Y[Q++]=(ee&3)<<6|ae,Z=0;break}}if(Z===1)throw Error(q);return Q-W},j.test=function(G){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(G)}})(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=V;function V(){this._listeners={}}return V.prototype.on=function(U,F,B){return(this._listeners[U]||(this._listeners[U]=[])).push({fn:F,ctx:B||this}),this},V.prototype.off=function(U,F){if(U===void 0)this._listeners={};else if(F===void 0)this._listeners[U]=[];else for(var B=this._listeners[U],q=0;q<B.length;)B[q].fn===F?B.splice(q,1):++q;return this},V.prototype.emit=function(U){var F=this._listeners[U];if(F){for(var B=[],q=1;q<arguments.length;)B.push(arguments[q++]);for(q=0;q<F.length;)F[q].fn.apply(F[q++].ctx,B)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=V(V);function V(q){return typeof Float32Array<"u"?(function(){var z=new Float32Array([-0]),G=new Uint8Array(z.buffer),Y=G[3]===128;function Q(ne,ae,se){z[0]=ne,ae[se]=G[0],ae[se+1]=G[1],ae[se+2]=G[2],ae[se+3]=G[3]}function W(ne,ae,se){z[0]=ne,ae[se]=G[3],ae[se+1]=G[2],ae[se+2]=G[1],ae[se+3]=G[0]}q.writeFloatLE=Y?Q:W,q.writeFloatBE=Y?W:Q;function Z(ne,ae){return G[0]=ne[ae],G[1]=ne[ae+1],G[2]=ne[ae+2],G[3]=ne[ae+3],z[0]}function ee(ne,ae){return G[3]=ne[ae],G[2]=ne[ae+1],G[1]=ne[ae+2],G[0]=ne[ae+3],z[0]}q.readFloatLE=Y?Z:ee,q.readFloatBE=Y?ee:Z})():(function(){function z(Y,Q,W,Z){var ee=Q<0?1:0;if(ee&&(Q=-Q),Q===0)Y(1/Q>0?0:2147483648,W,Z);else if(isNaN(Q))Y(2143289344,W,Z);else if(Q>34028234663852886e22)Y((ee<<31|2139095040)>>>0,W,Z);else if(Q<11754943508222875e-54)Y((ee<<31|Math.round(Q/1401298464324817e-60))>>>0,W,Z);else{var ne=Math.floor(Math.log(Q)/Math.LN2),ae=Math.round(Q*Math.pow(2,-ne)*8388608)&8388607;Y((ee<<31|ne+127<<23|ae)>>>0,W,Z)}}q.writeFloatLE=z.bind(null,j),q.writeFloatBE=z.bind(null,U);function G(Y,Q,W){var Z=Y(Q,W),ee=(Z>>31)*2+1,ne=Z>>>23&255,ae=Z&8388607;return ne===255?ae?NaN:ee*(1/0):ne===0?ee*1401298464324817e-60*ae:ee*Math.pow(2,ne-150)*(ae+8388608)}q.readFloatLE=G.bind(null,F),q.readFloatBE=G.bind(null,B)})(),typeof Float64Array<"u"?(function(){var z=new Float64Array([-0]),G=new Uint8Array(z.buffer),Y=G[7]===128;function Q(ne,ae,se){z[0]=ne,ae[se]=G[0],ae[se+1]=G[1],ae[se+2]=G[2],ae[se+3]=G[3],ae[se+4]=G[4],ae[se+5]=G[5],ae[se+6]=G[6],ae[se+7]=G[7]}function W(ne,ae,se){z[0]=ne,ae[se]=G[7],ae[se+1]=G[6],ae[se+2]=G[5],ae[se+3]=G[4],ae[se+4]=G[3],ae[se+5]=G[2],ae[se+6]=G[1],ae[se+7]=G[0]}q.writeDoubleLE=Y?Q:W,q.writeDoubleBE=Y?W:Q;function Z(ne,ae){return G[0]=ne[ae],G[1]=ne[ae+1],G[2]=ne[ae+2],G[3]=ne[ae+3],G[4]=ne[ae+4],G[5]=ne[ae+5],G[6]=ne[ae+6],G[7]=ne[ae+7],z[0]}function ee(ne,ae){return G[7]=ne[ae],G[6]=ne[ae+1],G[5]=ne[ae+2],G[4]=ne[ae+3],G[3]=ne[ae+4],G[2]=ne[ae+5],G[1]=ne[ae+6],G[0]=ne[ae+7],z[0]}q.readDoubleLE=Y?Z:ee,q.readDoubleBE=Y?ee:Z})():(function(){function z(Y,Q,W,Z,ee,ne){var ae=Z<0?1:0;if(ae&&(Z=-Z),Z===0)Y(0,ee,ne+Q),Y(1/Z>0?0:2147483648,ee,ne+W);else if(isNaN(Z))Y(0,ee,ne+Q),Y(2146959360,ee,ne+W);else if(Z>17976931348623157e292)Y(0,ee,ne+Q),Y((ae<<31|2146435072)>>>0,ee,ne+W);else{var se;if(Z<22250738585072014e-324)se=Z/5e-324,Y(se>>>0,ee,ne+Q),Y((ae<<31|se/4294967296)>>>0,ee,ne+W);else{var de=Math.floor(Math.log(Z)/Math.LN2);de===1024&&(de=1023),se=Z*Math.pow(2,-de),Y(se*4503599627370496>>>0,ee,ne+Q),Y((ae<<31|de+1023<<20|se*1048576&1048575)>>>0,ee,ne+W)}}}q.writeDoubleLE=z.bind(null,j,0,4),q.writeDoubleBE=z.bind(null,U,4,0);function G(Y,Q,W,Z,ee){var ne=Y(Z,ee+Q),ae=Y(Z,ee+W),se=(ae>>31)*2+1,de=ae>>>20&2047,oe=4294967296*(ae&1048575)+ne;return de===2047?oe?NaN:se*(1/0):de===0?se*5e-324*oe:se*Math.pow(2,de-1075)*(oe+4503599627370496)}q.readDoubleLE=G.bind(null,F,0,4),q.readDoubleBE=G.bind(null,B,4,0)})(),q}function j(q,z,G){z[G]=q&255,z[G+1]=q>>>8&255,z[G+2]=q>>>16&255,z[G+3]=q>>>24}function U(q,z,G){z[G]=q>>>24,z[G+1]=q>>>16&255,z[G+2]=q>>>8&255,z[G+3]=q&255}function F(q,z){return(q[z]|q[z+1]<<8|q[z+2]<<16|q[z+3]<<24)>>>0}function B(q,z){return(q[z]<<24|q[z+1]<<16|q[z+2]<<8|q[z+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(V){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,(function(V){var j=V;j.length=function(F){for(var B=0,q=0,z=0;z<F.length;++z)q=F.charCodeAt(z),q<128?B+=1:q<2048?B+=2:(q&64512)===55296&&(F.charCodeAt(z+1)&64512)===56320?(++z,B+=4):B+=3;return B},j.read=function(F,B,q){var z=q-B;if(z<1)return"";for(var G=null,Y=[],Q=0,W;B<q;)W=F[B++],W<128?Y[Q++]=W:W>191&&W<224?Y[Q++]=(W&31)<<6|F[B++]&63:W>239&&W<365?(W=((W&7)<<18|(F[B++]&63)<<12|(F[B++]&63)<<6|F[B++]&63)-65536,Y[Q++]=55296+(W>>10),Y[Q++]=56320+(W&1023)):Y[Q++]=(W&15)<<12|(F[B++]&63)<<6|F[B++]&63,Q>8191&&((G||(G=[])).push(String.fromCharCode.apply(String,Y)),Q=0);return G?(Q&&G.push(String.fromCharCode.apply(String,Y.slice(0,Q))),G.join("")):String.fromCharCode.apply(String,Y.slice(0,Q))},j.write=function(F,B,q){for(var z=q,G,Y,Q=0;Q<F.length;++Q)G=F.charCodeAt(Q),G<128?B[q++]=G:G<2048?(B[q++]=G>>6|192,B[q++]=G&63|128):(G&64512)===55296&&((Y=F.charCodeAt(Q+1))&64512)===56320?(G=65536+((G&1023)<<10)+(Y&1023),++Q,B[q++]=G>>18|240,B[q++]=G>>12&63|128,B[q++]=G>>6&63|128,B[q++]=G&63|128):(B[q++]=G>>12|224,B[q++]=G>>6&63|128,B[q++]=G&63|128);return q-z}})(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=V;function V(j,U,F){var B=F||8192,q=B>>>1,z=null,G=B;return function(Q){if(Q<1||Q>q)return j(Q);G+Q>B&&(z=j(B),G=0);var W=U.call(z,G,G+=Q);return G&7&&(G=(G|7)+1),W}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=j;var V=requireMinimal();function j(q,z){this.lo=q>>>0,this.hi=z>>>0}var U=j.zero=new j(0,0);U.toNumber=function(){return 0},U.zzEncode=U.zzDecode=function(){return this},U.length=function(){return 1};var F=j.zeroHash="\0\0\0\0\0\0\0\0";j.fromNumber=function(z){if(z===0)return U;var G=z<0;G&&(z=-z);var Y=z>>>0,Q=(z-Y)/4294967296>>>0;return G&&(Q=~Q>>>0,Y=~Y>>>0,++Y>4294967295&&(Y=0,++Q>4294967295&&(Q=0))),new j(Y,Q)},j.from=function(z){if(typeof z=="number")return j.fromNumber(z);if(V.isString(z))if(V.Long)z=V.Long.fromString(z);else return j.fromNumber(parseInt(z,10));return z.low||z.high?new j(z.low>>>0,z.high>>>0):U},j.prototype.toNumber=function(z){if(!z&&this.hi>>>31){var G=~this.lo+1>>>0,Y=~this.hi>>>0;return G||(Y=Y+1>>>0),-(G+Y*4294967296)}return this.lo+this.hi*4294967296},j.prototype.toLong=function(z){return V.Long?new V.Long(this.lo|0,this.hi|0,!!z):{low:this.lo|0,high:this.hi|0,unsigned:!!z}};var B=String.prototype.charCodeAt;return j.fromHash=function(z){return z===F?U:new j((B.call(z,0)|B.call(z,1)<<8|B.call(z,2)<<16|B.call(z,3)<<24)>>>0,(B.call(z,4)|B.call(z,5)<<8|B.call(z,6)<<16|B.call(z,7)<<24)>>>0)},j.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},j.prototype.zzEncode=function(){var z=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^z)>>>0,this.lo=(this.lo<<1^z)>>>0,this},j.prototype.zzDecode=function(){var z=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^z)>>>0,this.hi=(this.hi>>>1^z)>>>0,this},j.prototype.length=function(){var z=this.lo,G=(this.lo>>>28|this.hi<<4)>>>0,Y=this.hi>>>24;return Y===0?G===0?z<16384?z<128?1:2:z<2097152?3:4:G<16384?G<128?5:6:G<2097152?7:8:Y<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,(function(V){var j=V;j.asPromise=requireAspromise(),j.base64=requireBase64(),j.EventEmitter=requireEventemitter(),j.float=requireFloat(),j.inquire=requireInquire(),j.utf8=requireUtf8(),j.pool=requirePool(),j.LongBits=requireLongbits(),j.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),j.global=j.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal,j.emptyArray=Object.freeze?Object.freeze([]):[],j.emptyObject=Object.freeze?Object.freeze({}):{},j.isInteger=Number.isInteger||function(q){return typeof q=="number"&&isFinite(q)&&Math.floor(q)===q},j.isString=function(q){return typeof q=="string"||q instanceof String},j.isObject=function(q){return q&&typeof q=="object"},j.isset=j.isSet=function(q,z){var G=q[z];return G!=null&&q.hasOwnProperty(z)?typeof G!="object"||(Array.isArray(G)?G.length:Object.keys(G).length)>0:!1},j.Buffer=(function(){try{var B=j.inquire("buffer").Buffer;return B.prototype.utf8Write?B:null}catch{return null}})(),j._Buffer_from=null,j._Buffer_allocUnsafe=null,j.newBuffer=function(q){return typeof q=="number"?j.Buffer?j._Buffer_allocUnsafe(q):new j.Array(q):j.Buffer?j._Buffer_from(q):typeof Uint8Array>"u"?q:new Uint8Array(q)},j.Array=typeof Uint8Array<"u"?Uint8Array:Array,j.Long=j.global.dcodeIO&&j.global.dcodeIO.Long||j.global.Long||j.inquire("long"),j.key2Re=/^true|false|0|1$/,j.key32Re=/^-?(?:0|[1-9][0-9]*)$/,j.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,j.longToHash=function(q){return q?j.LongBits.from(q).toHash():j.LongBits.zeroHash},j.longFromHash=function(q,z){var G=j.LongBits.fromHash(q);return j.Long?j.Long.fromBits(G.lo,G.hi,z):G.toNumber(!!z)};function U(B,q,z){for(var G=Object.keys(q),Y=0;Y<G.length;++Y)(B[G[Y]]===void 0||!z)&&(B[G[Y]]=q[G[Y]]);return B}j.merge=U,j.lcFirst=function(q){return q.charAt(0).toLowerCase()+q.substring(1)};function F(B){function q(z,G){if(!(this instanceof q))return new q(z,G);Object.defineProperty(this,"message",{get:function(){return z}}),Error.captureStackTrace?Error.captureStackTrace(this,q):Object.defineProperty(this,"stack",{value:new Error().stack||""}),G&&U(this,G)}return q.prototype=Object.create(Error.prototype,{constructor:{value:q,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return B},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),q}j.newError=F,j.ProtocolError=F("ProtocolError"),j.oneOfGetter=function(q){for(var z={},G=0;G<q.length;++G)z[q[G]]=1;return function(){for(var Y=Object.keys(this),Q=Y.length-1;Q>-1;--Q)if(z[Y[Q]]===1&&this[Y[Q]]!==void 0&&this[Y[Q]]!==null)return Y[Q]}},j.oneOfSetter=function(q){return function(z){for(var G=0;G<q.length;++G)q[G]!==z&&delete this[q[G]]}},j.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},j._configure=function(){var B=j.Buffer;if(!B){j._Buffer_from=j._Buffer_allocUnsafe=null;return}j._Buffer_from=B.from!==Uint8Array.from&&B.from||function(z,G){return new B(z,G)},j._Buffer_allocUnsafe=B.allocUnsafe||function(z){return new B(z)}}})(minimal)),minimal}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=Y;var V=requireMinimal(),j,U=V.LongBits,F=V.base64,B=V.utf8;function q(de,oe,ue){this.fn=de,this.len=oe,this.next=void 0,this.val=ue}function z(){}function G(de){this.head=de.head,this.tail=de.tail,this.len=de.len,this.next=de.states}function Y(){this.len=0,this.head=new q(z,0,0),this.tail=this.head,this.states=null}var Q=function(){return V.Buffer?function(){return(Y.create=function(){return new j})()}:function(){return new Y}};Y.create=Q(),Y.alloc=function(oe){return new V.Array(oe)},V.Array!==Array&&(Y.alloc=V.pool(Y.alloc,V.Array.prototype.subarray)),Y.prototype._push=function(oe,ue,he){return this.tail=this.tail.next=new q(oe,ue,he),this.len+=ue,this};function W(de,oe,ue){oe[ue]=de&255}function Z(de,oe,ue){for(;de>127;)oe[ue++]=de&127|128,de>>>=7;oe[ue]=de}function ee(de,oe){this.len=de,this.next=void 0,this.val=oe}ee.prototype=Object.create(q.prototype),ee.prototype.fn=Z,Y.prototype.uint32=function(oe){return this.len+=(this.tail=this.tail.next=new ee((oe=oe>>>0)<128?1:oe<16384?2:oe<2097152?3:oe<268435456?4:5,oe)).len,this},Y.prototype.int32=function(oe){return oe<0?this._push(ne,10,U.fromNumber(oe)):this.uint32(oe)},Y.prototype.sint32=function(oe){return this.uint32((oe<<1^oe>>31)>>>0)};function ne(de,oe,ue){for(;de.hi;)oe[ue++]=de.lo&127|128,de.lo=(de.lo>>>7|de.hi<<25)>>>0,de.hi>>>=7;for(;de.lo>127;)oe[ue++]=de.lo&127|128,de.lo=de.lo>>>7;oe[ue++]=de.lo}Y.prototype.uint64=function(oe){var ue=U.from(oe);return this._push(ne,ue.length(),ue)},Y.prototype.int64=Y.prototype.uint64,Y.prototype.sint64=function(oe){var ue=U.from(oe).zzEncode();return this._push(ne,ue.length(),ue)},Y.prototype.bool=function(oe){return this._push(W,1,oe?1:0)};function ae(de,oe,ue){oe[ue]=de&255,oe[ue+1]=de>>>8&255,oe[ue+2]=de>>>16&255,oe[ue+3]=de>>>24}Y.prototype.fixed32=function(oe){return this._push(ae,4,oe>>>0)},Y.prototype.sfixed32=Y.prototype.fixed32,Y.prototype.fixed64=function(oe){var ue=U.from(oe);return this._push(ae,4,ue.lo)._push(ae,4,ue.hi)},Y.prototype.sfixed64=Y.prototype.fixed64,Y.prototype.float=function(oe){return this._push(V.float.writeFloatLE,4,oe)},Y.prototype.double=function(oe){return this._push(V.float.writeDoubleLE,8,oe)};var se=V.Array.prototype.set?function(oe,ue,he){ue.set(oe,he)}:function(oe,ue,he){for(var ye=0;ye<oe.length;++ye)ue[he+ye]=oe[ye]};return Y.prototype.bytes=function(oe){var ue=oe.length>>>0;if(!ue)return this._push(W,1,0);if(V.isString(oe)){var he=Y.alloc(ue=F.length(oe));F.decode(oe,he,0),oe=he}return this.uint32(ue)._push(se,ue,oe)},Y.prototype.string=function(oe){var ue=B.length(oe);return ue?this.uint32(ue)._push(B.write,ue,oe):this._push(W,1,0)},Y.prototype.fork=function(){return this.states=new G(this),this.head=this.tail=new q(z,0,0),this.len=0,this},Y.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new q(z,0,0),this.len=0),this},Y.prototype.ldelim=function(){var oe=this.head,ue=this.tail,he=this.len;return this.reset().uint32(he),he&&(this.tail.next=oe.next,this.tail=ue,this.len+=he),this},Y.prototype.finish=function(){for(var oe=this.head.next,ue=this.constructor.alloc(this.len),he=0;oe;)oe.fn(oe.val,ue,he),he+=oe.len,oe=oe.next;return ue},Y._configure=function(de){j=de,Y.create=Q(),j._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=U;var V=requireWriter();(U.prototype=Object.create(V.prototype)).constructor=U;var j=requireMinimal();function U(){V.call(this)}U._configure=function(){U.alloc=j._Buffer_allocUnsafe,U.writeBytesBuffer=j.Buffer&&j.Buffer.prototype instanceof Uint8Array&&j.Buffer.prototype.set.name==="set"?function(q,z,G){z.set(q,G)}:function(q,z,G){if(q.copy)q.copy(z,G,0,q.length);else for(var Y=0;Y<q.length;)z[G++]=q[Y++]}},U.prototype.bytes=function(q){j.isString(q)&&(q=j._Buffer_from(q,"base64"));var z=q.length>>>0;return this.uint32(z),z&&this._push(U.writeBytesBuffer,z,q),this};function F(B,q,z){B.length<40?j.utf8.write(B,q,z):q.utf8Write?q.utf8Write(B,z):q.write(B,z)}return U.prototype.string=function(q){var z=j.Buffer.byteLength(q);return this.uint32(z),z&&this._push(F,z,q),this},U._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=q;var V=requireMinimal(),j,U=V.LongBits,F=V.utf8;function B(Z,ee){return RangeError("index out of range: "+Z.pos+" + "+(ee||1)+" > "+Z.len)}function q(Z){this.buf=Z,this.pos=0,this.len=Z.length}var z=typeof Uint8Array<"u"?function(ee){if(ee instanceof Uint8Array||Array.isArray(ee))return new q(ee);throw Error("illegal buffer")}:function(ee){if(Array.isArray(ee))return new q(ee);throw Error("illegal buffer")},G=function(){return V.Buffer?function(ne){return(q.create=function(se){return V.Buffer.isBuffer(se)?new j(se):z(se)})(ne)}:z};q.create=G(),q.prototype._slice=V.Array.prototype.subarray||V.Array.prototype.slice,q.prototype.uint32=(function(){var ee=4294967295;return function(){if(ee=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(ee=(ee|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(ee=(ee|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(ee=(ee|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(ee=(ee|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return ee;if((this.pos+=5)>this.len)throw this.pos=this.len,B(this,10);return ee}})(),q.prototype.int32=function(){return this.uint32()|0},q.prototype.sint32=function(){var ee=this.uint32();return ee>>>1^-(ee&1)|0};function Y(){var Z=new U(0,0),ee=0;if(this.len-this.pos>4){for(;ee<4;++ee)if(Z.lo=(Z.lo|(this.buf[this.pos]&127)<<ee*7)>>>0,this.buf[this.pos++]<128)return Z;if(Z.lo=(Z.lo|(this.buf[this.pos]&127)<<28)>>>0,Z.hi=(Z.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return Z;ee=0}else{for(;ee<3;++ee){if(this.pos>=this.len)throw B(this);if(Z.lo=(Z.lo|(this.buf[this.pos]&127)<<ee*7)>>>0,this.buf[this.pos++]<128)return Z}return Z.lo=(Z.lo|(this.buf[this.pos++]&127)<<ee*7)>>>0,Z}if(this.len-this.pos>4){for(;ee<5;++ee)if(Z.hi=(Z.hi|(this.buf[this.pos]&127)<<ee*7+3)>>>0,this.buf[this.pos++]<128)return Z}else for(;ee<5;++ee){if(this.pos>=this.len)throw B(this);if(Z.hi=(Z.hi|(this.buf[this.pos]&127)<<ee*7+3)>>>0,this.buf[this.pos++]<128)return Z}throw Error("invalid varint encoding")}q.prototype.bool=function(){return this.uint32()!==0};function Q(Z,ee){return(Z[ee-4]|Z[ee-3]<<8|Z[ee-2]<<16|Z[ee-1]<<24)>>>0}q.prototype.fixed32=function(){if(this.pos+4>this.len)throw B(this,4);return Q(this.buf,this.pos+=4)},q.prototype.sfixed32=function(){if(this.pos+4>this.len)throw B(this,4);return Q(this.buf,this.pos+=4)|0};function W(){if(this.pos+8>this.len)throw B(this,8);return new U(Q(this.buf,this.pos+=4),Q(this.buf,this.pos+=4))}return q.prototype.float=function(){if(this.pos+4>this.len)throw B(this,4);var ee=V.float.readFloatLE(this.buf,this.pos);return this.pos+=4,ee},q.prototype.double=function(){if(this.pos+8>this.len)throw B(this,4);var ee=V.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,ee},q.prototype.bytes=function(){var ee=this.uint32(),ne=this.pos,ae=this.pos+ee;if(ae>this.len)throw B(this,ee);if(this.pos+=ee,Array.isArray(this.buf))return this.buf.slice(ne,ae);if(ne===ae){var se=V.Buffer;return se?se.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,ne,ae)},q.prototype.string=function(){var ee=this.bytes();return F.read(ee,0,ee.length)},q.prototype.skip=function(ee){if(typeof ee=="number"){if(this.pos+ee>this.len)throw B(this,ee);this.pos+=ee}else do if(this.pos>=this.len)throw B(this);while(this.buf[this.pos++]&128);return this},q.prototype.skipType=function(Z){switch(Z){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(Z=this.uint32()&7)!==4;)this.skipType(Z);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+Z+" at offset "+this.pos)}return this},q._configure=function(Z){j=Z,q.create=G(),j._configure();var ee=V.Long?"toLong":"toNumber";V.merge(q.prototype,{int64:function(){return Y.call(this)[ee](!1)},uint64:function(){return Y.call(this)[ee](!0)},sint64:function(){return Y.call(this).zzDecode()[ee](!1)},fixed64:function(){return W.call(this)[ee](!0)},sfixed64:function(){return W.call(this)[ee](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=U;var V=requireReader();(U.prototype=Object.create(V.prototype)).constructor=U;var j=requireMinimal();function U(F){V.call(this,F)}return U._configure=function(){j.Buffer&&(U.prototype._slice=j.Buffer.prototype.slice)},U.prototype.string=function(){var B=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+B,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+B,this.len))},U._configure(),reader_buffer}var rpc={},service$1,hasRequiredService$1;function requireService$1(){if(hasRequiredService$1)return service$1;hasRequiredService$1=1,service$1=j;var V=requireMinimal();(j.prototype=Object.create(V.EventEmitter.prototype)).constructor=j;function j(U,F,B){if(typeof U!="function")throw TypeError("rpcImpl must be a function");V.EventEmitter.call(this),this.rpcImpl=U,this.requestDelimited=!!F,this.responseDelimited=!!B}return j.prototype.rpcCall=function U(F,B,q,z,G){if(!z)throw TypeError("request must be specified");var Y=this;if(!G)return V.asPromise(U,Y,F,B,q,z);if(!Y.rpcImpl){setTimeout(function(){G(Error("already ended"))},0);return}try{return Y.rpcImpl(F,B[Y.requestDelimited?"encodeDelimited":"encode"](z).finish(),function(W,Z){if(W)return Y.emit("error",W,F),G(W);if(Z===null){Y.end(!0);return}if(!(Z instanceof q))try{Z=q[Y.responseDelimited?"decodeDelimited":"decode"](Z)}catch(ee){return Y.emit("error",ee,F),G(ee)}return Y.emit("data",Z,F),G(null,Z)})}catch(Q){Y.emit("error",Q,F),setTimeout(function(){G(Q)},0);return}},j.prototype.end=function(F){return this.rpcImpl&&(F||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service$1}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,(function(V){var j=V;j.Service=requireService$1()})(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,(function(V){var j=V;j.build="minimal",j.Writer=requireWriter(),j.BufferWriter=requireWriter_buffer(),j.Reader=requireReader(),j.BufferReader=requireReader_buffer(),j.util=requireMinimal(),j.rpc=requireRpc(),j.roots=requireRoots(),j.configure=U;function U(){j.util._configure(),j.Writer._configure(j.BufferWriter),j.Reader._configure(j.BufferReader)}U()})(indexMinimal)),indexMinimal}var types$1={},util={exports:{}},codegen_1,hasRequiredCodegen;function requireCodegen(){if(hasRequiredCodegen)return codegen_1;hasRequiredCodegen=1,codegen_1=V;function V(j,U){typeof j=="string"&&(U=j,j=void 0);var F=[];function B(z){if(typeof z!="string"){var G=q();if(V.verbose&&console.log("codegen: "+G),G="return "+G,z){for(var Y=Object.keys(z),Q=new Array(Y.length+1),W=new Array(Y.length),Z=0;Z<Y.length;)Q[Z]=Y[Z],W[Z]=z[Y[Z++]];return Q[Z]=G,Function.apply(null,Q).apply(null,W)}return Function(G)()}for(var ee=new Array(arguments.length-1),ne=0;ne<ee.length;)ee[ne]=arguments[++ne];if(ne=0,z=z.replace(/%([%dfijs])/g,function(se,de){var oe=ee[ne++];switch(de){case"d":case"f":return String(Number(oe));case"i":return String(Math.floor(oe));case"j":return JSON.stringify(oe);case"s":return String(oe)}return"%"}),ne!==ee.length)throw Error("parameter count mismatch");return F.push(z),B}function q(z){return"function "+(z||U||"")+"("+(j&&j.join(",")||"")+`){
  `+F.join(`
  `)+`
}`}return B.toString=q,B}return V.verbose=!1,codegen_1}var fetch_1,hasRequiredFetch;function requireFetch(){if(hasRequiredFetch)return fetch_1;hasRequiredFetch=1,fetch_1=F;var V=requireAspromise(),j=requireInquire(),U=j("fs");function F(B,q,z){return typeof q=="function"?(z=q,q={}):q||(q={}),z?!q.xhr&&U&&U.readFile?U.readFile(B,function(Y,Q){return Y&&typeof XMLHttpRequest<"u"?F.xhr(B,q,z):Y?z(Y):z(null,q.binary?Q:Q.toString("utf8"))}):F.xhr(B,q,z):V(F,this,B,q)}return F.xhr=function(q,z,G){var Y=new XMLHttpRequest;Y.onreadystatechange=function(){if(Y.readyState===4){if(Y.status!==0&&Y.status!==200)return G(Error("status "+Y.status));if(z.binary){var W=Y.response;if(!W){W=[];for(var Z=0;Z<Y.responseText.length;++Z)W.push(Y.responseText.charCodeAt(Z)&255)}return G(null,typeof Uint8Array<"u"?new Uint8Array(W):W)}return G(null,Y.responseText)}},z.binary&&("overrideMimeType"in Y&&Y.overrideMimeType("text/plain; charset=x-user-defined"),Y.responseType="arraybuffer"),Y.open("GET",q),Y.send()},fetch_1}var path={},hasRequiredPath;function requirePath(){return hasRequiredPath||(hasRequiredPath=1,(function(V){var j=V,U=j.isAbsolute=function(q){return/^(?:\/|\w+:)/.test(q)},F=j.normalize=function(q){q=q.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var z=q.split("/"),G=U(q),Y="";G&&(Y=z.shift()+"/");for(var Q=0;Q<z.length;)z[Q]===".."?Q>0&&z[Q-1]!==".."?z.splice(--Q,2):G?z.splice(Q,1):++Q:z[Q]==="."?z.splice(Q,1):++Q;return Y+z.join("/")};j.resolve=function(q,z,G){return G||(z=F(z)),U(z)?z:(G||(q=F(q)),(q=q.replace(/(?:\/|^)[^/]+$/,"")).length?F(q+"/"+z):z)}})(path)),path}var namespace,hasRequiredNamespace;function requireNamespace(){if(hasRequiredNamespace)return namespace;hasRequiredNamespace=1,namespace=Y;var V=requireObject();((Y.prototype=Object.create(V.prototype)).constructor=Y).className="Namespace";var j=requireField(),U=requireUtil(),F=requireOneof(),B,q,z;Y.fromJSON=function(Z,ee){return new Y(Z,ee.options).addJSON(ee.nested)};function G(W,Z){if(W&&W.length){for(var ee={},ne=0;ne<W.length;++ne)ee[W[ne].name]=W[ne].toJSON(Z);return ee}}Y.arrayToJSON=G,Y.isReservedId=function(Z,ee){if(Z){for(var ne=0;ne<Z.length;++ne)if(typeof Z[ne]!="string"&&Z[ne][0]<=ee&&Z[ne][1]>ee)return!0}return!1},Y.isReservedName=function(Z,ee){if(Z){for(var ne=0;ne<Z.length;++ne)if(Z[ne]===ee)return!0}return!1};function Y(W,Z){V.call(this,W,Z),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function Q(W){W._nestedArray=null,W._lookupCache={};for(var Z=W;Z=Z.parent;)Z._lookupCache={};return W}return Object.defineProperty(Y.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=U.toArray(this.nested))}}),Y.prototype.toJSON=function(Z){return U.toObject(["options",this.options,"nested",G(this.nestedArray,Z)])},Y.prototype.addJSON=function(Z){var ee=this;if(Z)for(var ne=Object.keys(Z),ae=0,se;ae<ne.length;++ae)se=Z[ne[ae]],ee.add((se.fields!==void 0?B.fromJSON:se.values!==void 0?z.fromJSON:se.methods!==void 0?q.fromJSON:se.id!==void 0?j.fromJSON:Y.fromJSON)(ne[ae],se));return this},Y.prototype.get=function(Z){return this.nested&&this.nested[Z]||null},Y.prototype.getEnum=function(Z){if(this.nested&&this.nested[Z]instanceof z)return this.nested[Z].values;throw Error("no such enum: "+Z)},Y.prototype.add=function(Z){if(!(Z instanceof j&&Z.extend!==void 0||Z instanceof B||Z instanceof F||Z instanceof z||Z instanceof q||Z instanceof Y))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var ee=this.get(Z.name);if(ee)if(ee instanceof Y&&Z instanceof Y&&!(ee instanceof B||ee instanceof q)){for(var ne=ee.nestedArray,ae=0;ae<ne.length;++ae)Z.add(ne[ae]);this.remove(ee),this.nested||(this.nested={}),Z.setOptions(ee.options,!0)}else throw Error("duplicate name '"+Z.name+"' in "+this)}this.nested[Z.name]=Z,this instanceof B||this instanceof q||this instanceof z||this instanceof j||Z._edition||(Z._edition=Z._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var se=this;se=se.parent;)se._needsRecursiveFeatureResolution=!0,se._needsRecursiveResolve=!0;return Z.onAdd(this),Q(this)},Y.prototype.remove=function(Z){if(!(Z instanceof V))throw TypeError("object must be a ReflectionObject");if(Z.parent!==this)throw Error(Z+" is not a member of "+this);return delete this.nested[Z.name],Object.keys(this.nested).length||(this.nested=void 0),Z.onRemove(this),Q(this)},Y.prototype.define=function(Z,ee){if(U.isString(Z))Z=Z.split(".");else if(!Array.isArray(Z))throw TypeError("illegal path");if(Z&&Z.length&&Z[0]==="")throw Error("path must be relative");for(var ne=this;Z.length>0;){var ae=Z.shift();if(ne.nested&&ne.nested[ae]){if(ne=ne.nested[ae],!(ne instanceof Y))throw Error("path conflicts with non-namespace objects")}else ne.add(ne=new Y(ae))}return ee&&ne.addJSON(ee),ne},Y.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var Z=this.nestedArray,ee=0;for(this.resolve();ee<Z.length;)Z[ee]instanceof Y?Z[ee++].resolveAll():Z[ee++].resolve();return this._needsRecursiveResolve=!1,this},Y.prototype._resolveFeaturesRecursive=function(Z){return this._needsRecursiveFeatureResolution?(this._needsRecursiveFeatureResolution=!1,Z=this._edition||Z,V.prototype._resolveFeaturesRecursive.call(this,Z),this.nestedArray.forEach(ee=>{ee._resolveFeaturesRecursive(Z)}),this):this},Y.prototype.lookup=function(Z,ee,ne){if(typeof ee=="boolean"?(ne=ee,ee=void 0):ee&&!Array.isArray(ee)&&(ee=[ee]),U.isString(Z)&&Z.length){if(Z===".")return this.root;Z=Z.split(".")}else if(!Z.length)return this;var ae=Z.join(".");if(Z[0]==="")return this.root.lookup(Z.slice(1),ee);var se=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+ae];if(se&&(!ee||ee.indexOf(se.constructor)>-1)||(se=this._lookupImpl(Z,ae),se&&(!ee||ee.indexOf(se.constructor)>-1)))return se;if(ne)return null;for(var de=this;de.parent;){if(se=de.parent._lookupImpl(Z,ae),se&&(!ee||ee.indexOf(se.constructor)>-1))return se;de=de.parent}return null},Y.prototype._lookupImpl=function(Z,ee){if(Object.prototype.hasOwnProperty.call(this._lookupCache,ee))return this._lookupCache[ee];var ne=this.get(Z[0]),ae=null;if(ne)Z.length===1?ae=ne:ne instanceof Y&&(Z=Z.slice(1),ae=ne._lookupImpl(Z,Z.join(".")));else for(var se=0;se<this.nestedArray.length;++se)this._nestedArray[se]instanceof Y&&(ne=this._nestedArray[se]._lookupImpl(Z,ee))&&(ae=ne);return this._lookupCache[ee]=ae,ae},Y.prototype.lookupType=function(Z){var ee=this.lookup(Z,[B]);if(!ee)throw Error("no such type: "+Z);return ee},Y.prototype.lookupEnum=function(Z){var ee=this.lookup(Z,[z]);if(!ee)throw Error("no such Enum '"+Z+"' in "+this);return ee},Y.prototype.lookupTypeOrEnum=function(Z){var ee=this.lookup(Z,[B,z]);if(!ee)throw Error("no such Type or Enum '"+Z+"' in "+this);return ee},Y.prototype.lookupService=function(Z){var ee=this.lookup(Z,[q]);if(!ee)throw Error("no such Service '"+Z+"' in "+this);return ee},Y._configure=function(W,Z,ee){B=W,q=Z,z=ee},namespace}var mapfield,hasRequiredMapfield;function requireMapfield(){if(hasRequiredMapfield)return mapfield;hasRequiredMapfield=1,mapfield=F;var V=requireField();((F.prototype=Object.create(V.prototype)).constructor=F).className="MapField";var j=requireTypes(),U=requireUtil();function F(B,q,z,G,Y,Q){if(V.call(this,B,q,G,void 0,void 0,Y,Q),!U.isString(z))throw TypeError("keyType must be a string");this.keyType=z,this.resolvedKeyType=null,this.map=!0}return F.fromJSON=function(q,z){return new F(q,z.id,z.keyType,z.type,z.options,z.comment)},F.prototype.toJSON=function(q){var z=q?!!q.keepComments:!1;return U.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",z?this.comment:void 0])},F.prototype.resolve=function(){if(this.resolved)return this;if(j.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return V.prototype.resolve.call(this)},F.d=function(q,z,G){return typeof G=="function"?G=U.decorateType(G).name:G&&typeof G=="object"&&(G=U.decorateEnum(G).name),function(Q,W){U.decorateType(Q.constructor).add(new F(W,q,z,G))}},mapfield}var method,hasRequiredMethod;function requireMethod(){if(hasRequiredMethod)return method;hasRequiredMethod=1,method=U;var V=requireObject();((U.prototype=Object.create(V.prototype)).constructor=U).className="Method";var j=requireUtil();function U(F,B,q,z,G,Y,Q,W,Z){if(j.isObject(G)?(Q=G,G=Y=void 0):j.isObject(Y)&&(Q=Y,Y=void 0),!(B===void 0||j.isString(B)))throw TypeError("type must be a string");if(!j.isString(q))throw TypeError("requestType must be a string");if(!j.isString(z))throw TypeError("responseType must be a string");V.call(this,F,Q),this.type=B||"rpc",this.requestType=q,this.requestStream=G?!0:void 0,this.responseType=z,this.responseStream=Y?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=W,this.parsedOptions=Z}return U.fromJSON=function(B,q){return new U(B,q.type,q.requestType,q.responseType,q.requestStream,q.responseStream,q.options,q.comment,q.parsedOptions)},U.prototype.toJSON=function(B){var q=B?!!B.keepComments:!1;return j.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",q?this.comment:void 0,"parsedOptions",this.parsedOptions])},U.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),V.prototype.resolve.call(this))},method}var service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=B;var V=requireNamespace();((B.prototype=Object.create(V.prototype)).constructor=B).className="Service";var j=requireMethod(),U=requireUtil(),F=requireRpc();function B(z,G){V.call(this,z,G),this.methods={},this._methodsArray=null}B.fromJSON=function(G,Y){var Q=new B(G,Y.options);if(Y.methods)for(var W=Object.keys(Y.methods),Z=0;Z<W.length;++Z)Q.add(j.fromJSON(W[Z],Y.methods[W[Z]]));return Y.nested&&Q.addJSON(Y.nested),Y.edition&&(Q._edition=Y.edition),Q.comment=Y.comment,Q._defaultEdition="proto3",Q},B.prototype.toJSON=function(G){var Y=V.prototype.toJSON.call(this,G),Q=G?!!G.keepComments:!1;return U.toObject(["edition",this._editionToJSON(),"options",Y&&Y.options||void 0,"methods",V.arrayToJSON(this.methodsArray,G)||{},"nested",Y&&Y.nested||void 0,"comment",Q?this.comment:void 0])},Object.defineProperty(B.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=U.toArray(this.methods))}});function q(z){return z._methodsArray=null,z}return B.prototype.get=function(G){return this.methods[G]||V.prototype.get.call(this,G)},B.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;V.prototype.resolve.call(this);for(var G=this.methodsArray,Y=0;Y<G.length;++Y)G[Y].resolve();return this},B.prototype._resolveFeaturesRecursive=function(G){return this._needsRecursiveFeatureResolution?(G=this._edition||G,V.prototype._resolveFeaturesRecursive.call(this,G),this.methodsArray.forEach(Y=>{Y._resolveFeaturesRecursive(G)}),this):this},B.prototype.add=function(G){if(this.get(G.name))throw Error("duplicate name '"+G.name+"' in "+this);return G instanceof j?(this.methods[G.name]=G,G.parent=this,q(this)):V.prototype.add.call(this,G)},B.prototype.remove=function(G){if(G instanceof j){if(this.methods[G.name]!==G)throw Error(G+" is not a member of "+this);return delete this.methods[G.name],G.parent=null,q(this)}return V.prototype.remove.call(this,G)},B.prototype.create=function(G,Y,Q){for(var W=new F.Service(G,Y,Q),Z=0,ee;Z<this.methodsArray.length;++Z){var ne=U.lcFirst((ee=this._methodsArray[Z]).resolve().name).replace(/[^$\w_]/g,"");W[ne]=U.codegen(["r","c"],U.isReserved(ne)?ne+"_":ne)("return this.rpcCall(m,q,s,r,c)")({m:ee,q:ee.resolvedRequestType.ctor,s:ee.resolvedResponseType.ctor})}return W},service}var message,hasRequiredMessage;function requireMessage(){if(hasRequiredMessage)return message;hasRequiredMessage=1,message=j;var V=requireMinimal();function j(U){if(U)for(var F=Object.keys(U),B=0;B<F.length;++B)this[F[B]]=U[F[B]]}return j.create=function(F){return this.$type.create(F)},j.encode=function(F,B){return this.$type.encode(F,B)},j.encodeDelimited=function(F,B){return this.$type.encodeDelimited(F,B)},j.decode=function(F){return this.$type.decode(F)},j.decodeDelimited=function(F){return this.$type.decodeDelimited(F)},j.verify=function(F){return this.$type.verify(F)},j.fromObject=function(F){return this.$type.fromObject(F)},j.toObject=function(F,B){return this.$type.toObject(F,B)},j.prototype.toJSON=function(){return this.$type.toObject(this,V.toJSONOptions)},message}var decoder_1,hasRequiredDecoder;function requireDecoder(){if(hasRequiredDecoder)return decoder_1;hasRequiredDecoder=1,decoder_1=B;var V=require_enum(),j=requireTypes(),U=requireUtil();function F(q){return"missing required '"+q.name+"'"}function B(q){for(var z=U.codegen(["r","l","e"],q.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(q.fieldsArray.filter(function(ee){return ee.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),G=0;G<q.fieldsArray.length;++G){var Y=q._fieldsArray[G].resolve(),Q=Y.resolvedType instanceof V?"int32":Y.type,W="m"+U.safeProp(Y.name);z("case %i: {",Y.id),Y.map?(z("if(%s===util.emptyObject)",W)("%s={}",W)("var c2 = r.uint32()+r.pos"),j.defaults[Y.keyType]!==void 0?z("k=%j",j.defaults[Y.keyType]):z("k=null"),j.defaults[Q]!==void 0?z("value=%j",j.defaults[Q]):z("value=null"),z("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",Y.keyType)("case 2:"),j.basic[Q]===void 0?z("value=types[%i].decode(r,r.uint32())",G):z("value=r.%s()",Q),z("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),j.long[Y.keyType]!==void 0?z('%s[typeof k==="object"?util.longToHash(k):k]=value',W):z("%s[k]=value",W)):Y.repeated?(z("if(!(%s&&%s.length))",W,W)("%s=[]",W),j.packed[Q]!==void 0&&z("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",W,Q)("}else"),j.basic[Q]===void 0?z(Y.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",W,G):z("%s.push(r.%s())",W,Q)):j.basic[Q]===void 0?z(Y.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",W,G):z("%s=r.%s()",W,Q),z("break")("}")}for(z("default:")("r.skipType(t&7)")("break")("}")("}"),G=0;G<q._fieldsArray.length;++G){var Z=q._fieldsArray[G];Z.required&&z("if(!m.hasOwnProperty(%j))",Z.name)("throw util.ProtocolError(%j,{instance:m})",F(Z))}return z("return m")}return decoder_1}var verifier_1,hasRequiredVerifier;function requireVerifier(){if(hasRequiredVerifier)return verifier_1;hasRequiredVerifier=1,verifier_1=q;var V=require_enum(),j=requireUtil();function U(z,G){return z.name+": "+G+(z.repeated&&G!=="array"?"[]":z.map&&G!=="object"?"{k:"+z.keyType+"}":"")+" expected"}function F(z,G,Y,Q){if(G.resolvedType)if(G.resolvedType instanceof V){z("switch(%s){",Q)("default:")("return%j",U(G,"enum value"));for(var W=Object.keys(G.resolvedType.values),Z=0;Z<W.length;++Z)z("case %i:",G.resolvedType.values[W[Z]]);z("break")("}")}else z("{")("var e=types[%i].verify(%s);",Y,Q)("if(e)")("return%j+e",G.name+".")("}");else switch(G.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":z("if(!util.isInteger(%s))",Q)("return%j",U(G,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":z("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",Q,Q,Q,Q)("return%j",U(G,"integer|Long"));break;case"float":case"double":z('if(typeof %s!=="number")',Q)("return%j",U(G,"number"));break;case"bool":z('if(typeof %s!=="boolean")',Q)("return%j",U(G,"boolean"));break;case"string":z("if(!util.isString(%s))",Q)("return%j",U(G,"string"));break;case"bytes":z('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',Q,Q,Q)("return%j",U(G,"buffer"));break}return z}function B(z,G,Y){switch(G.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":z("if(!util.key32Re.test(%s))",Y)("return%j",U(G,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":z("if(!util.key64Re.test(%s))",Y)("return%j",U(G,"integer|Long key"));break;case"bool":z("if(!util.key2Re.test(%s))",Y)("return%j",U(G,"boolean key"));break}return z}function q(z){var G=j.codegen(["m"],z.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),Y=z.oneofsArray,Q={};Y.length&&G("var p={}");for(var W=0;W<z.fieldsArray.length;++W){var Z=z._fieldsArray[W].resolve(),ee="m"+j.safeProp(Z.name);if(Z.optional&&G("if(%s!=null&&m.hasOwnProperty(%j)){",ee,Z.name),Z.map)G("if(!util.isObject(%s))",ee)("return%j",U(Z,"object"))("var k=Object.keys(%s)",ee)("for(var i=0;i<k.length;++i){"),B(G,Z,"k[i]"),F(G,Z,W,ee+"[k[i]]")("}");else if(Z.repeated)G("if(!Array.isArray(%s))",ee)("return%j",U(Z,"array"))("for(var i=0;i<%s.length;++i){",ee),F(G,Z,W,ee+"[i]")("}");else{if(Z.partOf){var ne=j.safeProp(Z.partOf.name);Q[Z.partOf.name]===1&&G("if(p%s===1)",ne)("return%j",Z.partOf.name+": multiple values"),Q[Z.partOf.name]=1,G("p%s=1",ne)}F(G,Z,W,ee)}Z.optional&&G("}")}return G("return null")}return verifier_1}var converter={},hasRequiredConverter;function requireConverter(){return hasRequiredConverter||(hasRequiredConverter=1,(function(V){var j=V,U=require_enum(),F=requireUtil();function B(z,G,Y,Q){var W=!1;if(G.resolvedType)if(G.resolvedType instanceof U){z("switch(d%s){",Q);for(var Z=G.resolvedType.values,ee=Object.keys(Z),ne=0;ne<ee.length;++ne)Z[ee[ne]]===G.typeDefault&&!W&&(z("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',Q,Q,Q),G.repeated||z("break"),W=!0),z("case%j:",ee[ne])("case %i:",Z[ee[ne]])("m%s=%j",Q,Z[ee[ne]])("break");z("}")}else z('if(typeof d%s!=="object")',Q)("throw TypeError(%j)",G.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",Q,Y,Q);else{var ae=!1;switch(G.type){case"double":case"float":z("m%s=Number(d%s)",Q,Q);break;case"uint32":case"fixed32":z("m%s=d%s>>>0",Q,Q);break;case"int32":case"sint32":case"sfixed32":z("m%s=d%s|0",Q,Q);break;case"uint64":ae=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":z("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",Q,Q,ae)('else if(typeof d%s==="string")',Q)("m%s=parseInt(d%s,10)",Q,Q)('else if(typeof d%s==="number")',Q)("m%s=d%s",Q,Q)('else if(typeof d%s==="object")',Q)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",Q,Q,Q,ae?"true":"");break;case"bytes":z('if(typeof d%s==="string")',Q)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",Q,Q,Q)("else if(d%s.length >= 0)",Q)("m%s=d%s",Q,Q);break;case"string":z("m%s=String(d%s)",Q,Q);break;case"bool":z("m%s=Boolean(d%s)",Q,Q);break}}return z}j.fromObject=function(G){var Y=G.fieldsArray,Q=F.codegen(["d"],G.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!Y.length)return Q("return new this.ctor");Q("var m=new this.ctor");for(var W=0;W<Y.length;++W){var Z=Y[W].resolve(),ee=F.safeProp(Z.name);Z.map?(Q("if(d%s){",ee)('if(typeof d%s!=="object")',ee)("throw TypeError(%j)",Z.fullName+": object expected")("m%s={}",ee)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",ee),B(Q,Z,W,ee+"[ks[i]]")("}")("}")):Z.repeated?(Q("if(d%s){",ee)("if(!Array.isArray(d%s))",ee)("throw TypeError(%j)",Z.fullName+": array expected")("m%s=[]",ee)("for(var i=0;i<d%s.length;++i){",ee),B(Q,Z,W,ee+"[i]")("}")("}")):(Z.resolvedType instanceof U||Q("if(d%s!=null){",ee),B(Q,Z,W,ee),Z.resolvedType instanceof U||Q("}"))}return Q("return m")};function q(z,G,Y,Q){if(G.resolvedType)G.resolvedType instanceof U?z("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",Q,Y,Q,Q,Y,Q,Q):z("d%s=types[%i].toObject(m%s,o)",Q,Y,Q);else{var W=!1;switch(G.type){case"double":case"float":z("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",Q,Q,Q,Q);break;case"uint64":W=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":z('if(typeof m%s==="number")',Q)("d%s=o.longs===String?String(m%s):m%s",Q,Q,Q)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",Q,Q,Q,Q,W?"true":"",Q);break;case"bytes":z("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",Q,Q,Q,Q,Q);break;default:z("d%s=m%s",Q,Q);break}}return z}j.toObject=function(G){var Y=G.fieldsArray.slice().sort(F.compareFieldsById);if(!Y.length)return F.codegen()("return {}");for(var Q=F.codegen(["m","o"],G.name+"$toObject")("if(!o)")("o={}")("var d={}"),W=[],Z=[],ee=[],ne=0;ne<Y.length;++ne)Y[ne].partOf||(Y[ne].resolve().repeated?W:Y[ne].map?Z:ee).push(Y[ne]);if(W.length){for(Q("if(o.arrays||o.defaults){"),ne=0;ne<W.length;++ne)Q("d%s=[]",F.safeProp(W[ne].name));Q("}")}if(Z.length){for(Q("if(o.objects||o.defaults){"),ne=0;ne<Z.length;++ne)Q("d%s={}",F.safeProp(Z[ne].name));Q("}")}if(ee.length){for(Q("if(o.defaults){"),ne=0;ne<ee.length;++ne){var ae=ee[ne],se=F.safeProp(ae.name);if(ae.resolvedType instanceof U)Q("d%s=o.enums===String?%j:%j",se,ae.resolvedType.valuesById[ae.typeDefault],ae.typeDefault);else if(ae.long)Q("if(util.Long){")("var n=new util.Long(%i,%i,%j)",ae.typeDefault.low,ae.typeDefault.high,ae.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",se)("}else")("d%s=o.longs===String?%j:%i",se,ae.typeDefault.toString(),ae.typeDefault.toNumber());else if(ae.bytes){var de="["+Array.prototype.slice.call(ae.typeDefault).join(",")+"]";Q("if(o.bytes===String)d%s=%j",se,String.fromCharCode.apply(String,ae.typeDefault))("else{")("d%s=%s",se,de)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",se,se)("}")}else Q("d%s=%j",se,ae.typeDefault)}Q("}")}var oe=!1;for(ne=0;ne<Y.length;++ne){var ae=Y[ne],ue=G._fieldsArray.indexOf(ae),se=F.safeProp(ae.name);ae.map?(oe||(oe=!0,Q("var ks2")),Q("if(m%s&&(ks2=Object.keys(m%s)).length){",se,se)("d%s={}",se)("for(var j=0;j<ks2.length;++j){"),q(Q,ae,ue,se+"[ks2[j]]")("}")):ae.repeated?(Q("if(m%s&&m%s.length){",se,se)("d%s=[]",se)("for(var j=0;j<m%s.length;++j){",se),q(Q,ae,ue,se+"[j]")("}")):(Q("if(m%s!=null&&m.hasOwnProperty(%j)){",se,ae.name),q(Q,ae,ue,se),ae.partOf&&Q("if(o.oneofs)")("d%s=%j",F.safeProp(ae.partOf.name),ae.name)),Q("}")}return Q("return d")}})(converter)),converter}var wrappers={},hasRequiredWrappers;function requireWrappers(){return hasRequiredWrappers||(hasRequiredWrappers=1,(function(V){var j=V,U=requireMessage();j[".google.protobuf.Any"]={fromObject:function(F){if(F&&F["@type"]){var B=F["@type"].substring(F["@type"].lastIndexOf("/")+1),q=this.lookup(B);if(q){var z=F["@type"].charAt(0)==="."?F["@type"].slice(1):F["@type"];return z.indexOf("/")===-1&&(z="/"+z),this.create({type_url:z,value:q.encode(q.fromObject(F)).finish()})}}return this.fromObject(F)},toObject:function(F,B){var q="type.googleapis.com/",z="",G="";if(B&&B.json&&F.type_url&&F.value){G=F.type_url.substring(F.type_url.lastIndexOf("/")+1),z=F.type_url.substring(0,F.type_url.lastIndexOf("/")+1);var Y=this.lookup(G);Y&&(F=Y.decode(F.value))}if(!(F instanceof this.ctor)&&F instanceof U){var Q=F.$type.toObject(F,B),W=F.$type.fullName[0]==="."?F.$type.fullName.slice(1):F.$type.fullName;return z===""&&(z=q),G=z+W,Q["@type"]=G,Q}return this.toObject(F,B)}}})(wrappers)),wrappers}var type,hasRequiredType;function requireType(){if(hasRequiredType)return type;hasRequiredType=1,type=se;var V=requireNamespace();((se.prototype=Object.create(V.prototype)).constructor=se).className="Type";var j=require_enum(),U=requireOneof(),F=requireField(),B=requireMapfield(),q=requireService(),z=requireMessage(),G=requireReader(),Y=requireWriter(),Q=requireUtil(),W=requireEncoder(),Z=requireDecoder(),ee=requireVerifier(),ne=requireConverter(),ae=requireWrappers();function se(oe,ue){V.call(this,oe,ue),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(se.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var oe=Object.keys(this.fields),ue=0;ue<oe.length;++ue){var he=this.fields[oe[ue]],ye=he.id;if(this._fieldsById[ye])throw Error("duplicate id "+ye+" in "+this);this._fieldsById[ye]=he}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Q.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Q.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=se.generateConstructor(this)())},set:function(oe){var ue=oe.prototype;ue instanceof z||((oe.prototype=new z).constructor=oe,Q.merge(oe.prototype,ue)),oe.$type=oe.prototype.$type=this,Q.merge(oe,z,!0),this._ctor=oe;for(var he=0;he<this.fieldsArray.length;++he)this._fieldsArray[he].resolve();var ye={};for(he=0;he<this.oneofsArray.length;++he)ye[this._oneofsArray[he].resolve().name]={get:Q.oneOfGetter(this._oneofsArray[he].oneof),set:Q.oneOfSetter(this._oneofsArray[he].oneof)};he&&Object.defineProperties(oe.prototype,ye)}}}),se.generateConstructor=function(ue){for(var he=Q.codegen(["p"],ue.name),ye=0,fe;ye<ue.fieldsArray.length;++ye)(fe=ue._fieldsArray[ye]).map?he("this%s={}",Q.safeProp(fe.name)):fe.repeated&&he("this%s=[]",Q.safeProp(fe.name));return he("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function de(oe){return oe._fieldsById=oe._fieldsArray=oe._oneofsArray=null,delete oe.encode,delete oe.decode,delete oe.verify,oe}return se.fromJSON=function(ue,he){var ye=new se(ue,he.options);ye.extensions=he.extensions,ye.reserved=he.reserved;for(var fe=Object.keys(he.fields),pe=0;pe<fe.length;++pe)ye.add((typeof he.fields[fe[pe]].keyType<"u"?B.fromJSON:F.fromJSON)(fe[pe],he.fields[fe[pe]]));if(he.oneofs)for(fe=Object.keys(he.oneofs),pe=0;pe<fe.length;++pe)ye.add(U.fromJSON(fe[pe],he.oneofs[fe[pe]]));if(he.nested)for(fe=Object.keys(he.nested),pe=0;pe<fe.length;++pe){var xe=he.nested[fe[pe]];ye.add((xe.id!==void 0?F.fromJSON:xe.fields!==void 0?se.fromJSON:xe.values!==void 0?j.fromJSON:xe.methods!==void 0?q.fromJSON:V.fromJSON)(fe[pe],xe))}return he.extensions&&he.extensions.length&&(ye.extensions=he.extensions),he.reserved&&he.reserved.length&&(ye.reserved=he.reserved),he.group&&(ye.group=!0),he.comment&&(ye.comment=he.comment),he.edition&&(ye._edition=he.edition),ye._defaultEdition="proto3",ye},se.prototype.toJSON=function(ue){var he=V.prototype.toJSON.call(this,ue),ye=ue?!!ue.keepComments:!1;return Q.toObject(["edition",this._editionToJSON(),"options",he&&he.options||void 0,"oneofs",V.arrayToJSON(this.oneofsArray,ue),"fields",V.arrayToJSON(this.fieldsArray.filter(function(fe){return!fe.declaringField}),ue)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",he&&he.nested||void 0,"comment",ye?this.comment:void 0])},se.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;V.prototype.resolveAll.call(this);var ue=this.oneofsArray;for(ye=0;ye<ue.length;)ue[ye++].resolve();for(var he=this.fieldsArray,ye=0;ye<he.length;)he[ye++].resolve();return this},se.prototype._resolveFeaturesRecursive=function(ue){return this._needsRecursiveFeatureResolution?(ue=this._edition||ue,V.prototype._resolveFeaturesRecursive.call(this,ue),this.oneofsArray.forEach(he=>{he._resolveFeatures(ue)}),this.fieldsArray.forEach(he=>{he._resolveFeatures(ue)}),this):this},se.prototype.get=function(ue){return this.fields[ue]||this.oneofs&&this.oneofs[ue]||this.nested&&this.nested[ue]||null},se.prototype.add=function(ue){if(this.get(ue.name))throw Error("duplicate name '"+ue.name+"' in "+this);if(ue instanceof F&&ue.extend===void 0){if(this._fieldsById?this._fieldsById[ue.id]:this.fieldsById[ue.id])throw Error("duplicate id "+ue.id+" in "+this);if(this.isReservedId(ue.id))throw Error("id "+ue.id+" is reserved in "+this);if(this.isReservedName(ue.name))throw Error("name '"+ue.name+"' is reserved in "+this);return ue.parent&&ue.parent.remove(ue),this.fields[ue.name]=ue,ue.message=this,ue.onAdd(this),de(this)}return ue instanceof U?(this.oneofs||(this.oneofs={}),this.oneofs[ue.name]=ue,ue.onAdd(this),de(this)):V.prototype.add.call(this,ue)},se.prototype.remove=function(ue){if(ue instanceof F&&ue.extend===void 0){if(!this.fields||this.fields[ue.name]!==ue)throw Error(ue+" is not a member of "+this);return delete this.fields[ue.name],ue.parent=null,ue.onRemove(this),de(this)}if(ue instanceof U){if(!this.oneofs||this.oneofs[ue.name]!==ue)throw Error(ue+" is not a member of "+this);return delete this.oneofs[ue.name],ue.parent=null,ue.onRemove(this),de(this)}return V.prototype.remove.call(this,ue)},se.prototype.isReservedId=function(ue){return V.isReservedId(this.reserved,ue)},se.prototype.isReservedName=function(ue){return V.isReservedName(this.reserved,ue)},se.prototype.create=function(ue){return new this.ctor(ue)},se.prototype.setup=function(){for(var ue=this.fullName,he=[],ye=0;ye<this.fieldsArray.length;++ye)he.push(this._fieldsArray[ye].resolve().resolvedType);this.encode=W(this)({Writer:Y,types:he,util:Q}),this.decode=Z(this)({Reader:G,types:he,util:Q}),this.verify=ee(this)({types:he,util:Q}),this.fromObject=ne.fromObject(this)({types:he,util:Q}),this.toObject=ne.toObject(this)({types:he,util:Q});var fe=ae[ue];if(fe){var pe=Object.create(this);pe.fromObject=this.fromObject,this.fromObject=fe.fromObject.bind(pe),pe.toObject=this.toObject,this.toObject=fe.toObject.bind(pe)}return this},se.prototype.encode=function(ue,he){return this.setup().encode(ue,he)},se.prototype.encodeDelimited=function(ue,he){return this.encode(ue,he&&he.len?he.fork():he).ldelim()},se.prototype.decode=function(ue,he){return this.setup().decode(ue,he)},se.prototype.decodeDelimited=function(ue){return ue instanceof G||(ue=G.create(ue)),this.decode(ue,ue.uint32())},se.prototype.verify=function(ue){return this.setup().verify(ue)},se.prototype.fromObject=function(ue){return this.setup().fromObject(ue)},se.prototype.toObject=function(ue,he){return this.setup().toObject(ue,he)},se.d=function(ue){return function(ye){Q.decorateType(ye,ue)}},type}var root$3,hasRequiredRoot;function requireRoot(){if(hasRequiredRoot)return root$3;hasRequiredRoot=1,root$3=Y;var V=requireNamespace();((Y.prototype=Object.create(V.prototype)).constructor=Y).className="Root";var j=requireField(),U=require_enum(),F=requireOneof(),B=requireUtil(),q,z,G;function Y(ee){V.call(this,"",ee),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}Y.fromJSON=function(ne,ae){return ae||(ae=new Y),ne.options&&ae.setOptions(ne.options),ae.addJSON(ne.nested).resolveAll()},Y.prototype.resolvePath=B.path.resolve,Y.prototype.fetch=B.fetch;function Q(){}Y.prototype.load=function ee(ne,ae,se){typeof ae=="function"&&(se=ae,ae=void 0);var de=this;if(!se)return B.asPromise(ee,de,ne,ae);var oe=se===Q;function ue(ke,Ae){if(se){if(oe)throw ke;Ae&&Ae.resolveAll();var be=se;se=null,be(ke,Ae)}}function he(ke){var Ae=ke.lastIndexOf("google/protobuf/");if(Ae>-1){var be=ke.substring(Ae);if(be in G)return be}return null}function ye(ke,Ae){try{if(B.isString(Ae)&&Ae.charAt(0)==="{"&&(Ae=JSON.parse(Ae)),!B.isString(Ae))de.setOptions(Ae.options).addJSON(Ae.nested);else{z.filename=ke;var be=z(Ae,de,ae),Le,Fe=0;if(be.imports)for(;Fe<be.imports.length;++Fe)(Le=he(be.imports[Fe])||de.resolvePath(ke,be.imports[Fe]))&&fe(Le);if(be.weakImports)for(Fe=0;Fe<be.weakImports.length;++Fe)(Le=he(be.weakImports[Fe])||de.resolvePath(ke,be.weakImports[Fe]))&&fe(Le,!0)}}catch(Ne){ue(Ne)}!oe&&!pe&&ue(null,de)}function fe(ke,Ae){if(ke=he(ke)||ke,!(de.files.indexOf(ke)>-1)){if(de.files.push(ke),ke in G){oe?ye(ke,G[ke]):(++pe,setTimeout(function(){--pe,ye(ke,G[ke])}));return}if(oe){var be;try{be=B.fs.readFileSync(ke).toString("utf8")}catch(Le){Ae||ue(Le);return}ye(ke,be)}else++pe,de.fetch(ke,function(Le,Fe){if(--pe,!!se){if(Le){Ae?pe||ue(null,de):ue(Le);return}ye(ke,Fe)}})}}var pe=0;B.isString(ne)&&(ne=[ne]);for(var xe=0,Ee;xe<ne.length;++xe)(Ee=de.resolvePath("",ne[xe]))&&fe(Ee);return oe?(de.resolveAll(),de):(pe||ue(null,de),de)},Y.prototype.loadSync=function(ne,ae){if(!B.isNode)throw Error("not supported");return this.load(ne,ae,Q)},Y.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(ne){return"'extend "+ne.extend+"' in "+ne.parent.fullName}).join(", "));return V.prototype.resolveAll.call(this)};var W=/^[A-Z]/;function Z(ee,ne){var ae=ne.parent.lookup(ne.extend);if(ae){var se=new j(ne.fullName,ne.id,ne.type,ne.rule,void 0,ne.options);return ae.get(se.name)||(se.declaringField=ne,ne.extensionField=se,ae.add(se)),!0}return!1}return Y.prototype._handleAdd=function(ne){if(ne instanceof j)ne.extend!==void 0&&!ne.extensionField&&(Z(this,ne)||this.deferred.push(ne));else if(ne instanceof U)W.test(ne.name)&&(ne.parent[ne.name]=ne.values);else if(!(ne instanceof F)){if(ne instanceof q)for(var ae=0;ae<this.deferred.length;)Z(this,this.deferred[ae])?this.deferred.splice(ae,1):++ae;for(var se=0;se<ne.nestedArray.length;++se)this._handleAdd(ne._nestedArray[se]);W.test(ne.name)&&(ne.parent[ne.name]=ne)}(ne instanceof q||ne instanceof U||ne instanceof j)&&(this._fullyQualifiedObjects[ne.fullName]=ne)},Y.prototype._handleRemove=function(ne){if(ne instanceof j){if(ne.extend!==void 0)if(ne.extensionField)ne.extensionField.parent.remove(ne.extensionField),ne.extensionField=null;else{var ae=this.deferred.indexOf(ne);ae>-1&&this.deferred.splice(ae,1)}}else if(ne instanceof U)W.test(ne.name)&&delete ne.parent[ne.name];else if(ne instanceof V){for(var se=0;se<ne.nestedArray.length;++se)this._handleRemove(ne._nestedArray[se]);W.test(ne.name)&&delete ne.parent[ne.name]}delete this._fullyQualifiedObjects[ne.fullName]},Y._configure=function(ee,ne,ae){q=ee,z=ne,G=ae},root$3}var hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util.exports;hasRequiredUtil=1;var V=util.exports=requireMinimal(),j=requireRoots(),U,F;V.codegen=requireCodegen(),V.fetch=requireFetch(),V.path=requirePath(),V.fs=V.inquire("fs"),V.toArray=function(Q){if(Q){for(var W=Object.keys(Q),Z=new Array(W.length),ee=0;ee<W.length;)Z[ee]=Q[W[ee++]];return Z}return[]},V.toObject=function(Q){for(var W={},Z=0;Z<Q.length;){var ee=Q[Z++],ne=Q[Z++];ne!==void 0&&(W[ee]=ne)}return W};var B=/\\/g,q=/"/g;V.isReserved=function(Q){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(Q)},V.safeProp=function(Q){return!/^[$\w_]+$/.test(Q)||V.isReserved(Q)?'["'+Q.replace(B,"\\\\").replace(q,'\\"')+'"]':"."+Q},V.ucFirst=function(Q){return Q.charAt(0).toUpperCase()+Q.substring(1)};var z=/_([a-z])/g;V.camelCase=function(Q){return Q.substring(0,1)+Q.substring(1).replace(z,function(W,Z){return Z.toUpperCase()})},V.compareFieldsById=function(Q,W){return Q.id-W.id},V.decorateType=function(Q,W){if(Q.$type)return W&&Q.$type.name!==W&&(V.decorateRoot.remove(Q.$type),Q.$type.name=W,V.decorateRoot.add(Q.$type)),Q.$type;U||(U=requireType());var Z=new U(W||Q.name);return V.decorateRoot.add(Z),Z.ctor=Q,Object.defineProperty(Q,"$type",{value:Z,enumerable:!1}),Object.defineProperty(Q.prototype,"$type",{value:Z,enumerable:!1}),Z};var G=0;return V.decorateEnum=function(Q){if(Q.$type)return Q.$type;F||(F=require_enum());var W=new F("Enum"+G++,Q);return V.decorateRoot.add(W),Object.defineProperty(Q,"$type",{value:W,enumerable:!1}),W},V.setProperty=function(Q,W,Z,ee){function ne(ae,se,de){var oe=se.shift();if(oe==="__proto__"||oe==="prototype")return ae;if(se.length>0)ae[oe]=ne(ae[oe]||{},se,de);else{var ue=ae[oe];if(ue&&ee)return ae;ue&&(de=[].concat(ue).concat(de)),ae[oe]=de}return ae}if(typeof Q!="object")throw TypeError("dst must be an object");if(!W)throw TypeError("path must be specified");return W=W.split("."),ne(Q,W,Z)},Object.defineProperty(V,"decorateRoot",{get:function(){return j.decorated||(j.decorated=new(requireRoot()))}}),util.exports}var hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,(function(V){var j=V,U=requireUtil(),F=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function B(q,z){var G=0,Y={};for(z|=0;G<q.length;)Y[F[G+z]]=q[G++];return Y}j.basic=B([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),j.defaults=B([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",U.emptyArray,null]),j.long=B([0,0,0,1,1],7),j.mapKey=B([0,0,0,5,5,0,0,0,1,1,0,2],2),j.packed=B([1,5,0,0,0,5,5,0,0,0,1,1,0])})(types$1)),types$1}var field,hasRequiredField;function requireField(){if(hasRequiredField)return field;hasRequiredField=1,field=z;var V=requireObject();((z.prototype=Object.create(V.prototype)).constructor=z).className="Field";var j=require_enum(),U=requireTypes(),F=requireUtil(),B,q=/^required|optional|repeated$/;z.fromJSON=function(Y,Q){var W=new z(Y,Q.id,Q.type,Q.rule,Q.extend,Q.options,Q.comment);return Q.edition&&(W._edition=Q.edition),W._defaultEdition="proto3",W};function z(G,Y,Q,W,Z,ee,ne){if(F.isObject(W)?(ne=Z,ee=W,W=Z=void 0):F.isObject(Z)&&(ne=ee,ee=Z,Z=void 0),V.call(this,G,ee),!F.isInteger(Y)||Y<0)throw TypeError("id must be a non-negative integer");if(!F.isString(Q))throw TypeError("type must be a string");if(W!==void 0&&!q.test(W=W.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(Z!==void 0&&!F.isString(Z))throw TypeError("extend must be a string");W==="proto3_optional"&&(W="optional"),this.rule=W&&W!=="optional"?W:void 0,this.type=Q,this.id=Y,this.extend=Z||void 0,this.repeated=W==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=F.Long?U.long[Q]!==void 0:!1,this.bytes=Q==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=ne}return Object.defineProperty(z.prototype,"required",{get:function(){return this._features.field_presence==="LEGACY_REQUIRED"}}),Object.defineProperty(z.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(z.prototype,"delimited",{get:function(){return this.resolvedType instanceof B&&this._features.message_encoding==="DELIMITED"}}),Object.defineProperty(z.prototype,"packed",{get:function(){return this._features.repeated_field_encoding==="PACKED"}}),Object.defineProperty(z.prototype,"hasPresence",{get:function(){return this.repeated||this.map?!1:this.partOf||this.declaringField||this.extensionField||this._features.field_presence!=="IMPLICIT"}}),z.prototype.setOption=function(Y,Q,W){return V.prototype.setOption.call(this,Y,Q,W)},z.prototype.toJSON=function(Y){var Q=Y?!!Y.keepComments:!1;return F.toObject(["edition",this._editionToJSON(),"rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",Q?this.comment:void 0])},z.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=U.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof B?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof j&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof j)&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=F.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var Y;F.base64.test(this.typeDefault)?F.base64.decode(this.typeDefault,Y=F.newBuffer(F.base64.length(this.typeDefault)),0):F.utf8.write(this.typeDefault,Y=F.newBuffer(F.utf8.length(this.typeDefault)),0),this.typeDefault=Y}return this.map?this.defaultValue=F.emptyObject:this.repeated?this.defaultValue=F.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof B&&(this.parent.ctor.prototype[this.name]=this.defaultValue),V.prototype.resolve.call(this)},z.prototype._inferLegacyProtoFeatures=function(Y){if(Y!=="proto2"&&Y!=="proto3")return{};var Q={};if(this.rule==="required"&&(Q.field_presence="LEGACY_REQUIRED"),this.parent&&U.defaults[this.type]===void 0){var W=this.parent.get(this.type.split(".").pop());W&&W instanceof B&&W.group&&(Q.message_encoding="DELIMITED")}return this.getOption("packed")===!0?Q.repeated_field_encoding="PACKED":this.getOption("packed")===!1&&(Q.repeated_field_encoding="EXPANDED"),Q},z.prototype._resolveFeatures=function(Y){return V.prototype._resolveFeatures.call(this,this._edition||Y)},z.d=function(Y,Q,W,Z){return typeof Q=="function"?Q=F.decorateType(Q).name:Q&&typeof Q=="object"&&(Q=F.decorateEnum(Q).name),function(ne,ae){F.decorateType(ne.constructor).add(new z(ae,Y,Q,W,{default:Z}))}},z._configure=function(Y){B=Y},field}var oneof,hasRequiredOneof;function requireOneof(){if(hasRequiredOneof)return oneof;hasRequiredOneof=1,oneof=F;var V=requireObject();((F.prototype=Object.create(V.prototype)).constructor=F).className="OneOf";var j=requireField(),U=requireUtil();function F(q,z,G,Y){if(Array.isArray(z)||(G=z,z=void 0),V.call(this,q,G),!(z===void 0||Array.isArray(z)))throw TypeError("fieldNames must be an Array");this.oneof=z||[],this.fieldsArray=[],this.comment=Y}F.fromJSON=function(z,G){return new F(z,G.oneof,G.options,G.comment)},F.prototype.toJSON=function(z){var G=z?!!z.keepComments:!1;return U.toObject(["options",this.options,"oneof",this.oneof,"comment",G?this.comment:void 0])};function B(q){if(q.parent)for(var z=0;z<q.fieldsArray.length;++z)q.fieldsArray[z].parent||q.parent.add(q.fieldsArray[z])}return F.prototype.add=function(z){if(!(z instanceof j))throw TypeError("field must be a Field");return z.parent&&z.parent!==this.parent&&z.parent.remove(z),this.oneof.push(z.name),this.fieldsArray.push(z),z.partOf=this,B(this),this},F.prototype.remove=function(z){if(!(z instanceof j))throw TypeError("field must be a Field");var G=this.fieldsArray.indexOf(z);if(G<0)throw Error(z+" is not a member of "+this);return this.fieldsArray.splice(G,1),G=this.oneof.indexOf(z.name),G>-1&&this.oneof.splice(G,1),z.partOf=null,this},F.prototype.onAdd=function(z){V.prototype.onAdd.call(this,z);for(var G=this,Y=0;Y<this.oneof.length;++Y){var Q=z.get(this.oneof[Y]);Q&&!Q.partOf&&(Q.partOf=G,G.fieldsArray.push(Q))}B(this)},F.prototype.onRemove=function(z){for(var G=0,Y;G<this.fieldsArray.length;++G)(Y=this.fieldsArray[G]).parent&&Y.parent.remove(Y);V.prototype.onRemove.call(this,z)},Object.defineProperty(F.prototype,"isProto3Optional",{get:function(){if(this.fieldsArray==null||this.fieldsArray.length!==1)return!1;var q=this.fieldsArray[0];return q.options!=null&&q.options.proto3_optional===!0}}),F.d=function(){for(var z=new Array(arguments.length),G=0;G<arguments.length;)z[G]=arguments[G++];return function(Q,W){U.decorateType(Q.constructor).add(new F(W,z)),Object.defineProperty(Q,W,{get:U.oneOfGetter(z),set:U.oneOfSetter(z)})}},oneof}var object$1,hasRequiredObject;function requireObject(){if(hasRequiredObject)return object$1;hasRequiredObject=1,object$1=z,z.className="ReflectionObject";const V=requireOneof();var j=requireUtil(),U,F={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},B={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},q={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function z(G,Y){if(!j.isString(G))throw TypeError("name must be a string");if(Y&&!j.isObject(Y))throw TypeError("options must be an object");this.options=Y,this.parsedOptions=null,this.name=G,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}return Object.defineProperties(z.prototype,{root:{get:function(){for(var G=this;G.parent!==null;)G=G.parent;return G}},fullName:{get:function(){for(var G=[this.name],Y=this.parent;Y;)G.unshift(Y.name),Y=Y.parent;return G.join(".")}}}),z.prototype.toJSON=function(){throw Error()},z.prototype.onAdd=function(Y){this.parent&&this.parent!==Y&&this.parent.remove(this),this.parent=Y,this.resolved=!1;var Q=Y.root;Q instanceof U&&Q._handleAdd(this)},z.prototype.onRemove=function(Y){var Q=Y.root;Q instanceof U&&Q._handleRemove(this),this.parent=null,this.resolved=!1},z.prototype.resolve=function(){return this.resolved?this:(this.root instanceof U&&(this.resolved=!0),this)},z.prototype._resolveFeaturesRecursive=function(Y){return this._resolveFeatures(this._edition||Y)},z.prototype._resolveFeatures=function(Y){if(!this._featuresResolved){var Q={};if(!Y)throw new Error("Unknown edition for "+this.fullName);var W=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(Y));if(this._edition){if(Y==="proto2")Q=Object.assign({},B);else if(Y==="proto3")Q=Object.assign({},q);else if(Y==="2023")Q=Object.assign({},F);else throw new Error("Unknown edition: "+Y);this._features=Object.assign(Q,W||{}),this._featuresResolved=!0;return}if(this.partOf instanceof V){var Z=Object.assign({},this.partOf._features);this._features=Object.assign(Z,W||{})}else if(!this.declaringField)if(this.parent){var ee=Object.assign({},this.parent._features);this._features=Object.assign(ee,W||{})}else throw new Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},z.prototype._inferLegacyProtoFeatures=function(){return{}},z.prototype.getOption=function(Y){if(this.options)return this.options[Y]},z.prototype.setOption=function(Y,Q,W){return this.options||(this.options={}),/^features\./.test(Y)?j.setProperty(this.options,Y,Q,W):(!W||this.options[Y]===void 0)&&(this.getOption(Y)!==Q&&(this.resolved=!1),this.options[Y]=Q),this},z.prototype.setParsedOption=function(Y,Q,W){this.parsedOptions||(this.parsedOptions=[]);var Z=this.parsedOptions;if(W){var ee=Z.find(function(se){return Object.prototype.hasOwnProperty.call(se,Y)});if(ee){var ne=ee[Y];j.setProperty(ne,W,Q)}else ee={},ee[Y]=j.setProperty({},W,Q),Z.push(ee)}else{var ae={};ae[Y]=Q,Z.push(ae)}return this},z.prototype.setOptions=function(Y,Q){if(Y)for(var W=Object.keys(Y),Z=0;Z<W.length;++Z)this.setOption(W[Z],Y[W[Z]],Q);return this},z.prototype.toString=function(){var Y=this.constructor.className,Q=this.fullName;return Q.length?Y+" "+Q:Y},z.prototype._editionToJSON=function(){if(!(!this._edition||this._edition==="proto3"))return this._edition},z._configure=function(G){U=G},object$1}var _enum,hasRequired_enum;function require_enum(){if(hasRequired_enum)return _enum;hasRequired_enum=1,_enum=F;var V=requireObject();((F.prototype=Object.create(V.prototype)).constructor=F).className="Enum";var j=requireNamespace(),U=requireUtil();function F(B,q,z,G,Y,Q){if(V.call(this,B,z),q&&typeof q!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=G,this.comments=Y||{},this.valuesOptions=Q,this._valuesFeatures={},this.reserved=void 0,q)for(var W=Object.keys(q),Z=0;Z<W.length;++Z)typeof q[W[Z]]=="number"&&(this.valuesById[this.values[W[Z]]=q[W[Z]]]=W[Z])}return F.prototype._resolveFeatures=function(q){return q=this._edition||q,V.prototype._resolveFeatures.call(this,q),Object.keys(this.values).forEach(z=>{var G=Object.assign({},this._features);this._valuesFeatures[z]=Object.assign(G,this.valuesOptions&&this.valuesOptions[z]&&this.valuesOptions[z].features)}),this},F.fromJSON=function(q,z){var G=new F(q,z.values,z.options,z.comment,z.comments);return G.reserved=z.reserved,z.edition&&(G._edition=z.edition),G._defaultEdition="proto3",G},F.prototype.toJSON=function(q){var z=q?!!q.keepComments:!1;return U.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",z?this.comment:void 0,"comments",z?this.comments:void 0])},F.prototype.add=function(q,z,G,Y){if(!U.isString(q))throw TypeError("name must be a string");if(!U.isInteger(z))throw TypeError("id must be an integer");if(this.values[q]!==void 0)throw Error("duplicate name '"+q+"' in "+this);if(this.isReservedId(z))throw Error("id "+z+" is reserved in "+this);if(this.isReservedName(q))throw Error("name '"+q+"' is reserved in "+this);if(this.valuesById[z]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+z+" in "+this);this.values[q]=z}else this.valuesById[this.values[q]=z]=q;return Y&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[q]=Y||null),this.comments[q]=G||null,this},F.prototype.remove=function(q){if(!U.isString(q))throw TypeError("name must be a string");var z=this.values[q];if(z==null)throw Error("name '"+q+"' does not exist in "+this);return delete this.valuesById[z],delete this.values[q],delete this.comments[q],this.valuesOptions&&delete this.valuesOptions[q],this},F.prototype.isReservedId=function(q){return j.isReservedId(this.reserved,q)},F.prototype.isReservedName=function(q){return j.isReservedName(this.reserved,q)},_enum}var encoder_1,hasRequiredEncoder;function requireEncoder(){if(hasRequiredEncoder)return encoder_1;hasRequiredEncoder=1,encoder_1=B;var V=require_enum(),j=requireTypes(),U=requireUtil();function F(q,z,G,Y){return z.delimited?q("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",G,Y,(z.id<<3|3)>>>0,(z.id<<3|4)>>>0):q("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",G,Y,(z.id<<3|2)>>>0)}function B(q){for(var z=U.codegen(["m","w"],q.name+"$encode")("if(!w)")("w=Writer.create()"),G,Y,Q=q.fieldsArray.slice().sort(U.compareFieldsById),G=0;G<Q.length;++G){var W=Q[G].resolve(),Z=q._fieldsArray.indexOf(W),ee=W.resolvedType instanceof V?"int32":W.type,ne=j.basic[ee];Y="m"+U.safeProp(W.name),W.map?(z("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",Y,W.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",Y)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(W.id<<3|2)>>>0,8|j.mapKey[W.keyType],W.keyType),ne===void 0?z("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",Z,Y):z(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|ne,ee,Y),z("}")("}")):W.repeated?(z("if(%s!=null&&%s.length){",Y,Y),W.packed&&j.packed[ee]!==void 0?z("w.uint32(%i).fork()",(W.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",Y)("w.%s(%s[i])",ee,Y)("w.ldelim()"):(z("for(var i=0;i<%s.length;++i)",Y),ne===void 0?F(z,W,Z,Y+"[i]"):z("w.uint32(%i).%s(%s[i])",(W.id<<3|ne)>>>0,ee,Y)),z("}")):(W.optional&&z("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",Y,W.name),ne===void 0?F(z,W,Z,Y):z("w.uint32(%i).%s(%s)",(W.id<<3|ne)>>>0,ee,Y))}return z("return w")}return encoder_1}var hasRequiredIndexLight;function requireIndexLight(){if(hasRequiredIndexLight)return indexLight.exports;hasRequiredIndexLight=1;var V=indexLight.exports=requireIndexMinimal();V.build="light";function j(F,B,q){return typeof B=="function"?(q=B,B=new V.Root):B||(B=new V.Root),B.load(F,q)}V.load=j;function U(F,B){return B||(B=new V.Root),B.loadSync(F)}return V.loadSync=U,V.encoder=requireEncoder(),V.decoder=requireDecoder(),V.verifier=requireVerifier(),V.converter=requireConverter(),V.ReflectionObject=requireObject(),V.Namespace=requireNamespace(),V.Root=requireRoot(),V.Enum=require_enum(),V.Type=requireType(),V.Field=requireField(),V.OneOf=requireOneof(),V.MapField=requireMapfield(),V.Service=requireService(),V.Method=requireMethod(),V.Message=requireMessage(),V.wrappers=requireWrappers(),V.types=requireTypes(),V.util=requireUtil(),V.ReflectionObject._configure(V.Root),V.Namespace._configure(V.Type,V.Service,V.Enum),V.Root._configure(V.Type),V.Field._configure(V.Type),indexLight.exports}var tokenize_1,hasRequiredTokenize;function requireTokenize(){if(hasRequiredTokenize)return tokenize_1;hasRequiredTokenize=1,tokenize_1=W;var V=/[\s{}=;:[\],'"()<>]/g,j=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,U=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,F=/^ *[*/]+ */,B=/^\s*\*?\/*/,q=/\n/g,z=/\s/,G=/\\(.?)/g,Y={0:"\0",r:"\r",n:`
`,t:"	"};function Q(Z){return Z.replace(G,function(ee,ne){switch(ne){case"\\":case"":return ne;default:return Y[ne]||""}})}W.unescape=Q;function W(Z,ee){Z=Z.toString();var ne=0,ae=Z.length,se=1,de=0,oe={},ue=[],he=null;function ye(Ve){return Error("illegal "+Ve+" (line "+se+")")}function fe(){var Ve=he==="'"?U:j;Ve.lastIndex=ne-1;var Te=Ve.exec(Z);if(!Te)throw ye("string");return ne=Ve.lastIndex,be(he),he=null,Q(Te[1])}function pe(Ve){return Z.charAt(Ve)}function xe(Ve,Te,Oe){var Ue={type:Z.charAt(Ve++),lineEmpty:!1,leading:Oe},Ye;ee?Ye=2:Ye=3;var le=Ve-Ye,we;do if(--le<0||(we=Z.charAt(le))===`
`){Ue.lineEmpty=!0;break}while(we===" "||we==="	");for(var He=Z.substring(Ve,Te).split(q),ge=0;ge<He.length;++ge)He[ge]=He[ge].replace(ee?B:F,"").trim();Ue.text=He.join(`
`).trim(),oe[se]=Ue,de=se}function Ee(Ve){var Te=ke(Ve),Oe=Z.substring(Ve,Te),Ue=/^\s*\/\//.test(Oe);return Ue}function ke(Ve){for(var Te=Ve;Te<ae&&pe(Te)!==`
`;)Te++;return Te}function Ae(){if(ue.length>0)return ue.shift();if(he)return fe();var Ve,Te,Oe,Ue,Ye,le=ne===0;do{if(ne===ae)return null;for(Ve=!1;z.test(Oe=pe(ne));)if(Oe===`
`&&(le=!0,++se),++ne===ae)return null;if(pe(ne)==="/"){if(++ne===ae)throw ye("comment");if(pe(ne)==="/")if(ee){if(Ue=ne,Ye=!1,Ee(ne-1)){Ye=!0;do if(ne=ke(ne),ne===ae||(ne++,!le))break;while(Ee(ne))}else ne=Math.min(ae,ke(ne)+1);Ye&&(xe(Ue,ne,le),le=!0),se++,Ve=!0}else{for(Ye=pe(Ue=ne+1)==="/";pe(++ne)!==`
`;)if(ne===ae)return null;++ne,Ye&&(xe(Ue,ne-1,le),le=!0),++se,Ve=!0}else if((Oe=pe(ne))==="*"){Ue=ne+1,Ye=ee||pe(Ue)==="*";do{if(Oe===`
`&&++se,++ne===ae)throw ye("comment");Te=Oe,Oe=pe(ne)}while(Te!=="*"||Oe!=="/");++ne,Ye&&(xe(Ue,ne-2,le),le=!0),Ve=!0}else return"/"}}while(Ve);var we=ne;V.lastIndex=0;var He=V.test(pe(we++));if(!He)for(;we<ae&&!V.test(pe(we));)++we;var ge=Z.substring(ne,ne=we);return(ge==='"'||ge==="'")&&(he=ge),ge}function be(Ve){ue.push(Ve)}function Le(){if(!ue.length){var Ve=Ae();if(Ve===null)return null;be(Ve)}return ue[0]}function Fe(Ve,Te){var Oe=Le(),Ue=Oe===Ve;if(Ue)return Ae(),!0;if(!Te)throw ye("token '"+Oe+"', '"+Ve+"' expected");return!1}function Ne(Ve){var Te=null,Oe;return Ve===void 0?(Oe=oe[se-1],delete oe[se-1],Oe&&(ee||Oe.type==="*"||Oe.lineEmpty)&&(Te=Oe.leading?Oe.text:null)):(de<Ve&&Le(),Oe=oe[Ve],delete oe[Ve],Oe&&!Oe.lineEmpty&&(ee||Oe.type==="/")&&(Te=Oe.leading?null:Oe.text)),Te}return Object.defineProperty({next:Ae,peek:Le,push:be,skip:Fe,cmnt:Ne},"line",{get:function(){return se}})}return tokenize_1}var parse_1,hasRequiredParse;function requireParse(){if(hasRequiredParse)return parse_1;hasRequiredParse=1,parse_1=fe,fe.filename=null,fe.defaults={keepCase:!1};var V=requireTokenize(),j=requireRoot(),U=requireType(),F=requireField(),B=requireMapfield(),q=requireOneof(),z=require_enum(),G=requireService(),Y=requireMethod(),Q=requireObject(),W=requireTypes(),Z=requireUtil(),ee=/^[1-9][0-9]*$/,ne=/^-?[1-9][0-9]*$/,ae=/^0[x][0-9a-fA-F]+$/,se=/^-?0[x][0-9a-fA-F]+$/,de=/^0[0-7]+$/,oe=/^-?0[0-7]+$/,ue=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,he=/^[a-zA-Z_][a-zA-Z_0-9]*$/,ye=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function fe(pe,xe,Ee){xe instanceof j||(Ee=xe,xe=new j),Ee||(Ee=fe.defaults);var ke=Ee.preferTrailingComment||!1,Ae=V(pe,Ee.alternateCommentMode||!1),be=Ae.next,Le=Ae.push,Fe=Ae.peek,Ne=Ae.skip,Ve=Ae.cmnt,Te=!0,Oe,Ue,Ye,le="proto2",we=xe,He=[],ge={},We=Ee.keepCase?function(ze){return ze}:Z.camelCase;function at(){He.forEach(ze=>{ze._edition=le,Object.keys(ge).forEach(Be=>{ze.getOption(Be)===void 0&&ze.setOption(Be,ge[Be],!0)})})}function $e(ze,Be,Ge){var Je=fe.filename;return Ge||(fe.filename=null),Error("illegal "+(Be||"token")+" '"+ze+"' ("+(Je?Je+", ":"")+"line "+Ae.line+")")}function ht(){var ze=[],Be;do{if((Be=be())!=='"'&&Be!=="'")throw $e(Be);ze.push(be()),Ne(Be),Be=Fe()}while(Be==='"'||Be==="'");return ze.join("")}function ut(ze){var Be=be();switch(Be){case"'":case'"':return Le(Be),ht();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return $t(Be,!0)}catch{if(ye.test(Be))return Be;throw $e(Be,"value")}}function ft(ze,Be){var Ge,Je;do if(Be&&((Ge=Fe())==='"'||Ge==="'")){var Ze=ht();if(ze.push(Ze),le>=2023)throw $e(Ze,"id")}else try{ze.push([Je=Mt(be()),Ne("to",!0)?Mt(be()):Je])}catch(Pt){if(Be&&ye.test(Ge)&&le>=2023)ze.push(Ge);else throw Pt}while(Ne(",",!0));var dt={options:void 0};dt.setOption=function(Pt,qt){this.options===void 0&&(this.options={}),this.options[Pt]=qt},bt(dt,function(qt){if(qt==="option")tt(dt,qt),Ne(";");else throw $e(qt)},function(){it(dt)})}function $t(ze,Be){var Ge=1;switch(ze.charAt(0)==="-"&&(Ge=-1,ze=ze.substring(1)),ze){case"inf":case"INF":case"Inf":return Ge*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(ee.test(ze))return Ge*parseInt(ze,10);if(ae.test(ze))return Ge*parseInt(ze,16);if(de.test(ze))return Ge*parseInt(ze,8);if(ue.test(ze))return Ge*parseFloat(ze);throw $e(ze,"number",Be)}function Mt(ze,Be){switch(ze){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!Be&&ze.charAt(0)==="-")throw $e(ze,"id");if(ne.test(ze))return parseInt(ze,10);if(se.test(ze))return parseInt(ze,16);if(oe.test(ze))return parseInt(ze,8);throw $e(ze,"id")}function Nn(){if(Oe!==void 0)throw $e("package");if(Oe=be(),!ye.test(Oe))throw $e(Oe,"name");we=we.define(Oe),Ne(";")}function Qt(){var ze=Fe(),Be;switch(ze){case"weak":Be=Ye||(Ye=[]),be();break;case"public":be();default:Be=Ue||(Ue=[]);break}ze=ht(),Ne(";"),Be.push(ze)}function tn(){if(Ne("="),le=ht(),le<2023)throw $e(le,"syntax");Ne(";")}function Gt(){if(Ne("="),le=ht(),!["2023"].includes(le))throw $e(le,"edition");Ne(";")}function cn(ze,Be){switch(Be){case"option":return tt(ze,Be),Ne(";"),!0;case"message":return dn(ze,Be),!0;case"enum":return Xe(ze,Be),!0;case"service":return pt(ze,Be),!0;case"extend":return yn(ze,Be),!0}return!1}function bt(ze,Be,Ge){var Je=Ae.line;if(ze&&(typeof ze.comment!="string"&&(ze.comment=Ve()),ze.filename=fe.filename),Ne("{",!0)){for(var Ze;(Ze=be())!=="}";)Be(Ze);Ne(";",!0)}else Ge&&Ge(),Ne(";"),ze&&(typeof ze.comment!="string"||ke)&&(ze.comment=Ve(Je)||ze.comment)}function dn(ze,Be){if(!he.test(Be=be()))throw $e(Be,"type name");var Ge=new U(Be);bt(Ge,function(Ze){if(!cn(Ge,Ze))switch(Ze){case"map":nn(Ge);break;case"required":if(le!=="proto2")throw $e(Ze);case"repeated":At(Ge,Ze);break;case"optional":if(le==="proto3")At(Ge,"proto3_optional");else{if(le!=="proto2")throw $e(Ze);At(Ge,"optional")}break;case"oneof":De(Ge,Ze);break;case"extensions":ft(Ge.extensions||(Ge.extensions=[]));break;case"reserved":ft(Ge.reserved||(Ge.reserved=[]),!0);break;default:if(le==="proto2"||!ye.test(Ze))throw $e(Ze);Le(Ze),At(Ge,"optional");break}}),ze.add(Ge),ze===we&&He.push(Ge)}function At(ze,Be,Ge){var Je=be();if(Je==="group"){Wt(ze,Be);return}for(;Je.endsWith(".")||Fe().startsWith(".");)Je+=be();if(!ye.test(Je))throw $e(Je,"type");var Ze=be();if(!he.test(Ze))throw $e(Ze,"name");Ze=We(Ze),Ne("=");var dt=new F(Ze,Mt(be()),Je,Be,Ge);if(bt(dt,function(Ut){if(Ut==="option")tt(dt,Ut),Ne(";");else throw $e(Ut)},function(){it(dt)}),Be==="proto3_optional"){var Pt=new q("_"+Ze);dt.setOption("proto3_optional",!0),Pt.add(dt),ze.add(Pt)}else ze.add(dt);ze===we&&He.push(dt)}function Wt(ze,Be){if(le>=2023)throw $e("group");var Ge=be();if(!he.test(Ge))throw $e(Ge,"name");var Je=Z.lcFirst(Ge);Ge===Je&&(Ge=Z.ucFirst(Ge)),Ne("=");var Ze=Mt(be()),dt=new U(Ge);dt.group=!0;var Pt=new F(Je,Ze,Ge,Be);Pt.filename=fe.filename,bt(dt,function(Ut){switch(Ut){case"option":tt(dt,Ut),Ne(";");break;case"required":case"repeated":At(dt,Ut);break;case"optional":le==="proto3"?At(dt,"proto3_optional"):At(dt,"optional");break;case"message":dn(dt,Ut);break;case"enum":Xe(dt,Ut);break;case"reserved":ft(dt.reserved||(dt.reserved=[]),!0);break;default:throw $e(Ut)}}),ze.add(dt).add(Pt)}function nn(ze){Ne("<");var Be=be();if(W.mapKey[Be]===void 0)throw $e(Be,"type");Ne(",");var Ge=be();if(!ye.test(Ge))throw $e(Ge,"type");Ne(">");var Je=be();if(!he.test(Je))throw $e(Je,"name");Ne("=");var Ze=new B(We(Je),Mt(be()),Be,Ge);bt(Ze,function(Pt){if(Pt==="option")tt(Ze,Pt),Ne(";");else throw $e(Pt)},function(){it(Ze)}),ze.add(Ze)}function De(ze,Be){if(!he.test(Be=be()))throw $e(Be,"name");var Ge=new q(We(Be));bt(Ge,function(Ze){Ze==="option"?(tt(Ge,Ze),Ne(";")):(Le(Ze),At(Ge,"optional"))}),ze.add(Ge)}function Xe(ze,Be){if(!he.test(Be=be()))throw $e(Be,"name");var Ge=new z(Be);bt(Ge,function(Ze){switch(Ze){case"option":tt(Ge,Ze),Ne(";");break;case"reserved":ft(Ge.reserved||(Ge.reserved=[]),!0),Ge.reserved===void 0&&(Ge.reserved=[]);break;default:et(Ge,Ze)}}),ze.add(Ge),ze===we&&He.push(Ge)}function et(ze,Be){if(!he.test(Be))throw $e(Be,"name");Ne("=");var Ge=Mt(be(),!0),Je={options:void 0};Je.getOption=function(Ze){return this.options[Ze]},Je.setOption=function(Ze,dt){Q.prototype.setOption.call(Je,Ze,dt)},Je.setParsedOption=function(){},bt(Je,function(dt){if(dt==="option")tt(Je,dt),Ne(";");else throw $e(dt)},function(){it(Je)}),ze.add(Be,Ge,Je.comment,Je.parsedOptions||Je.options)}function tt(ze,Be){var Ge,Je,Ze=!0;for(Be==="option"&&(Be=be());Be!=="=";){if(Be==="("){var dt=be();Ne(")"),Be="("+dt+")"}if(Ze){if(Ze=!1,Be.includes(".")&&!Be.includes("(")){var Pt=Be.split(".");Ge=Pt[0]+".",Be=Pt[1];continue}Ge=Be}else Je=Je?Je+=Be:Be;Be=be()}var qt=Je?Ge.concat(Je):Ge,Ut=_e(ze,qt);Je=Je&&Je[0]==="."?Je.slice(1):Je,Ge=Ge&&Ge[Ge.length-1]==="."?Ge.slice(0,-1):Ge,nt(ze,Ge,Ut,Je)}function _e(ze,Be){if(Ne("{",!0)){for(var Ge={};!Ne("}",!0);){if(!he.test(xt=be()))throw $e(xt,"name");if(xt===null)throw $e(xt,"end of input");var Je,Ze=xt;if(Ne(":",!0),Fe()==="{")Je=_e(ze,Be+"."+xt);else if(Fe()==="["){Je=[];var dt;if(Ne("[",!0)){do dt=ut(),Je.push(dt);while(Ne(",",!0));Ne("]"),typeof dt<"u"&&je(ze,Be+"."+xt,dt)}}else Je=ut(),je(ze,Be+"."+xt,Je);var Pt=Ge[Ze];Pt&&(Je=[].concat(Pt).concat(Je)),Ge[Ze]=Je,Ne(",",!0),Ne(";",!0)}return Ge}var qt=ut();return je(ze,Be,qt),qt}function je(ze,Be,Ge){if(we===ze&&/^features\./.test(Be)){ge[Be]=Ge;return}ze.setOption&&ze.setOption(Be,Ge)}function nt(ze,Be,Ge,Je){ze.setParsedOption&&ze.setParsedOption(Be,Ge,Je)}function it(ze){if(Ne("[",!0)){do tt(ze,"option");while(Ne(",",!0));Ne("]")}return ze}function pt(ze,Be){if(!he.test(Be=be()))throw $e(Be,"service name");var Ge=new G(Be);bt(Ge,function(Ze){if(!cn(Ge,Ze))if(Ze==="rpc")Vt(Ge,Ze);else throw $e(Ze)}),ze.add(Ge),ze===we&&He.push(Ge)}function Vt(ze,Be){var Ge=Ve(),Je=Be;if(!he.test(Be=be()))throw $e(Be,"name");var Ze=Be,dt,Pt,qt,Ut;if(Ne("("),Ne("stream",!0)&&(Pt=!0),!ye.test(Be=be())||(dt=Be,Ne(")"),Ne("returns"),Ne("("),Ne("stream",!0)&&(Ut=!0),!ye.test(Be=be())))throw $e(Be);qt=Be,Ne(")");var zi=new Y(Ze,Je,dt,qt,Pt,Ut);zi.comment=Ge,bt(zi,function(Hi){if(Hi==="option")tt(zi,Hi),Ne(";");else throw $e(Hi)}),ze.add(zi)}function yn(ze,Be){if(!ye.test(Be=be()))throw $e(Be,"reference");var Ge=Be;bt(null,function(Ze){switch(Ze){case"required":case"repeated":At(ze,Ze,Ge);break;case"optional":le==="proto3"?At(ze,"proto3_optional",Ge):At(ze,"optional",Ge);break;default:if(le==="proto2"||!ye.test(Ze))throw $e(Ze);Le(Ze),At(ze,"optional",Ge);break}})}for(var xt;(xt=be())!==null;)switch(xt){case"package":if(!Te)throw $e(xt);Nn();break;case"import":if(!Te)throw $e(xt);Qt();break;case"syntax":if(!Te)throw $e(xt);tn();break;case"edition":if(!Te)throw $e(xt);Gt();break;case"option":tt(we,xt),Ne(";",!0);break;default:if(cn(we,xt)){Te=!1;continue}throw $e(xt)}return at(),fe.filename=null,{package:Oe,imports:Ue,weakImports:Ye,root:xe}}return parse_1}var common_1,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common_1;hasRequiredCommon=1,common_1=j;var V=/\/|\./;function j(F,B){V.test(F)||(F="google/protobuf/"+F+".proto",B={nested:{google:{nested:{protobuf:{nested:B}}}}}),j[F]=B}j("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var U;return j("duration",{Duration:U={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),j("timestamp",{Timestamp:U}),j("empty",{Empty:{fields:{}}}),j("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),j("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),j("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),j.get=function(B){return j[B]||null},common_1}var hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src.exports;hasRequiredSrc=1;var V=src.exports=requireIndexLight();return V.build="full",V.tokenize=requireTokenize(),V.parse=requireParse(),V.common=requireCommon(),V.Root._configure(V.Type,V.parse,V.common),src.exports}var protobufjs,hasRequiredProtobufjs;function requireProtobufjs(){return hasRequiredProtobufjs||(hasRequiredProtobufjs=1,protobufjs=requireSrc()),protobufjs}var protobufjsExports=requireProtobufjs();const protobuf=getDefaultExportFromCjs$1(protobufjsExports);var extendStatics=function(V,j){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,F){U.__proto__=F}||function(U,F){for(var B in F)Object.prototype.hasOwnProperty.call(F,B)&&(U[B]=F[B])},extendStatics(V,j)};function __extends(V,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");extendStatics(V,j);function U(){this.constructor=V}V.prototype=j===null?Object.create(j):(U.prototype=j.prototype,new U)}var __assign=function(){return __assign=Object.assign||function(j){for(var U,F=1,B=arguments.length;F<B;F++){U=arguments[F];for(var q in U)Object.prototype.hasOwnProperty.call(U,q)&&(j[q]=U[q])}return j},__assign.apply(this,arguments)};function __awaiter(V,j,U,F){function B(q){return q instanceof U?q:new U(function(z){z(q)})}return new(U||(U=Promise))(function(q,z){function G(W){try{Q(F.next(W))}catch(Z){z(Z)}}function Y(W){try{Q(F.throw(W))}catch(Z){z(Z)}}function Q(W){W.done?q(W.value):B(W.value).then(G,Y)}Q((F=F.apply(V,j||[])).next())})}function __generator(V,j){var U={label:0,sent:function(){if(q[0]&1)throw q[1];return q[1]},trys:[],ops:[]},F,B,q,z;return z={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(z[Symbol.iterator]=function(){return this}),z;function G(Q){return function(W){return Y([Q,W])}}function Y(Q){if(F)throw new TypeError("Generator is already executing.");for(;z&&(z=0,Q[0]&&(U=0)),U;)try{if(F=1,B&&(q=Q[0]&2?B.return:Q[0]?B.throw||((q=B.return)&&q.call(B),0):B.next)&&!(q=q.call(B,Q[1])).done)return q;switch(B=0,q&&(Q=[Q[0]&2,q.value]),Q[0]){case 0:case 1:q=Q;break;case 4:return U.label++,{value:Q[1],done:!1};case 5:U.label++,B=Q[1],Q=[0];continue;case 7:Q=U.ops.pop(),U.trys.pop();continue;default:if(q=U.trys,!(q=q.length>0&&q[q.length-1])&&(Q[0]===6||Q[0]===2)){U=0;continue}if(Q[0]===3&&(!q||Q[1]>q[0]&&Q[1]<q[3])){U.label=Q[1];break}if(Q[0]===6&&U.label<q[1]){U.label=q[1],q=Q;break}if(q&&U.label<q[2]){U.label=q[2],U.ops.push(Q);break}q[2]&&U.ops.pop(),U.trys.pop();continue}Q=j.call(V,U)}catch(W){Q=[6,W],B=0}finally{F=q=0}if(Q[0]&5)throw Q[1];return{value:Q[0]?Q[1]:void 0,done:!0}}}typeof SuppressedError=="function"&&SuppressedError;var options={syntax:"proto3"},nested={pipecat:{nested:{TextFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},text:{type:"string",id:3}}},AudioRawFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},audio:{type:"bytes",id:3},sampleRate:{type:"uint32",id:4},numChannels:{type:"uint32",id:5}}},TranscriptionFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},text:{type:"string",id:3},userId:{type:"string",id:4},timestamp:{type:"string",id:5}}},Frame:{oneofs:{frame:{oneof:["text","audio","transcription"]}},fields:{text:{type:"TextFrame",id:1},audio:{type:"AudioRawFrame",id:2},transcription:{type:"TranscriptionFrame",id:3}}}}}},jsonDescriptor={options,nested},ConnectionQuality;(function(V){V.UNKNOWN="UNKNOWN",V.GOOD="GOOD",V.BAD="BAD"})(ConnectionQuality||(ConnectionQuality={}));var AbstractConnectionQualityIndicator=(function(){function V(j){this._connectionQuality=ConnectionQuality.UNKNOWN,this.onConnectionQualityChanged=j}return Object.defineProperty(V.prototype,"connectionQuality",{get:function(){return this._connectionQuality},enumerable:!1,configurable:!0}),V.prototype.handleStatsChanged=function(){var j=this.calculateConnectionQuality();j!==this._connectionQuality&&(this._connectionQuality=j,this.onConnectionQualityChanged(j))},V.prototype.start=function(j){this.stop(!0),this._start(j)},V.prototype.stop=function(j){j===void 0&&(j=!1),this._stop(),this._connectionQuality=ConnectionQuality.UNKNOWN,j||this.onConnectionQualityChanged(ConnectionQuality.UNKNOWN)},V})();function QualityIndicatorMixer(){for(var V=[],j=0;j<arguments.length;j++)V[j]=arguments[j];var U=(function(F){__extends(B,F);function B(q){var z=F.call(this,q)||this;return z.childTrackers=V.map(function(G){var Y=G.getParams,Q=G.TrackerClass;return{tracker:new Q(function(){return z.handleStatsChanged()}),getParams:Y}}),z}return B.prototype.calculateConnectionQuality=function(){var q=this.childTrackers.map(function(z){var G=z.tracker;return G.connectionQuality});return q.some(function(z){return z===ConnectionQuality.BAD})?ConnectionQuality.BAD:q.every(function(z){return z===ConnectionQuality.UNKNOWN})?ConnectionQuality.UNKNOWN:ConnectionQuality.GOOD},B.prototype._start=function(q){this.childTrackers.forEach(function(z){var G=z.tracker,Y=z.getParams;return G.start(Y(q))})},B.prototype._stop=function(){this.childTrackers.forEach(function(q){var z=q.tracker;return z.stop(!0)})},B})(AbstractConnectionQualityIndicator);return U}var LiveKitConnectionQualityIndicator=(function(V){__extends(j,V);function j(){var U=V!==null&&V.apply(this,arguments)||this;return U.room=null,U.liveKitConnectionQuality=ConnectionQuality$2.Unknown,U.liveKitConnectionState=null,U.handleConnectionQualityChanged=function(F){U.liveKitConnectionQuality=F,U.handleStatsChanged()},U.handleConnectionStateChanged=function(F){U.liveKitConnectionState=F,U.handleStatsChanged()},U}return j.prototype._start=function(U){this.room=U,this.room.localParticipant.on(ParticipantEvent.ConnectionQualityChanged,this.handleConnectionQualityChanged),this.room.on(RoomEvent.ConnectionStateChanged,this.handleConnectionStateChanged)},j.prototype._stop=function(){this.room&&(this.room.localParticipant.off(RoomEvent.ConnectionQualityChanged,this.handleConnectionQualityChanged),this.room.off(RoomEvent.ConnectionStateChanged,this.handleConnectionStateChanged))},j.prototype.calculateConnectionQuality=function(){return[ConnectionQuality$2.Lost,ConnectionQuality$2.Poor].includes(this.liveKitConnectionQuality)||this.liveKitConnectionState&&[ConnectionState.Disconnected,ConnectionState.Reconnecting,ConnectionState.SignalReconnecting].includes(this.liveKitConnectionState)?ConnectionQuality.BAD:ConnectionQuality.GOOD},j})(AbstractConnectionQualityIndicator),t,e,s,n;function r(){}function o(){o.init.call(this)}function i(V){return V._maxListeners===void 0?o.defaultMaxListeners:V._maxListeners}function a(V,j,U){if(j)V.call(U);else for(var F=V.length,B=m(V,F),q=0;q<F;++q)B[q].call(U)}function c(V,j,U,F){if(j)V.call(U,F);else for(var B=V.length,q=m(V,B),z=0;z<B;++z)q[z].call(U,F)}function d(V,j,U,F,B){if(j)V.call(U,F,B);else for(var q=V.length,z=m(V,q),G=0;G<q;++G)z[G].call(U,F,B)}function u(V,j,U,F,B,q){if(j)V.call(U,F,B,q);else for(var z=V.length,G=m(V,z),Y=0;Y<z;++Y)G[Y].call(U,F,B,q)}function h(V,j,U,F){if(j)V.apply(U,F);else for(var B=V.length,q=m(V,B),z=0;z<B;++z)q[z].apply(U,F)}function l(V,j,U,F){var B,q,z,G;if(typeof U!="function")throw new TypeError('"listener" argument must be a function');if((q=V._events)?(q.newListener&&(V.emit("newListener",j,U.listener?U.listener:U),q=V._events),z=q[j]):(q=V._events=new r,V._eventsCount=0),z){if(typeof z=="function"?z=q[j]=F?[U,z]:[z,U]:F?z.unshift(U):z.push(U),!z.warned&&(B=i(V))&&B>0&&z.length>B){z.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+z.length+" "+j+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=V,Y.type=j,Y.count=z.length,G=Y,typeof console.warn=="function"?console.warn(G):console.log(G)}}else z=q[j]=U,++V._eventsCount;return V}function p(V,j,U){var F=!1;function B(){V.removeListener(j,B),F||(F=!0,U.apply(V,arguments))}return B.listener=U,B}function f(V){var j=this._events;if(j){var U=j[V];if(typeof U=="function")return 1;if(U)return U.length}return 0}function m(V,j){for(var U=new Array(j);j--;)U[j]=V[j];return U}r.prototype=Object.create(null),o.EventEmitter=o,o.usingDomains=!1,o.prototype.domain=void 0,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.init=function(){this.domain=null,o.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new r,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(V){if(typeof V!="number"||V<0||isNaN(V))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=V,this},o.prototype.getMaxListeners=function(){return i(this)},o.prototype.emit=function(V){var j,U,F,B,q,z,G,Y=V==="error";if(z=this._events)Y=Y&&z.error==null;else if(!Y)return!1;if(G=this.domain,Y){if(j=arguments[1],!G){if(j instanceof Error)throw j;var Q=new Error('Uncaught, unspecified "error" event. ('+j+")");throw Q.context=j,Q}return j||(j=new Error('Uncaught, unspecified "error" event')),j.domainEmitter=this,j.domain=G,j.domainThrown=!1,G.emit("error",j),!1}if(!(U=z[V]))return!1;var W=typeof U=="function";switch(F=arguments.length){case 1:a(U,W,this);break;case 2:c(U,W,this,arguments[1]);break;case 3:d(U,W,this,arguments[1],arguments[2]);break;case 4:u(U,W,this,arguments[1],arguments[2],arguments[3]);break;default:for(B=new Array(F-1),q=1;q<F;q++)B[q-1]=arguments[q];h(U,W,this,B)}return!0},o.prototype.addListener=function(V,j){return l(this,V,j,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(V,j){return l(this,V,j,!0)},o.prototype.once=function(V,j){if(typeof j!="function")throw new TypeError('"listener" argument must be a function');return this.on(V,p(this,V,j)),this},o.prototype.prependOnceListener=function(V,j){if(typeof j!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(V,p(this,V,j)),this},o.prototype.removeListener=function(V,j){var U,F,B,q,z;if(typeof j!="function")throw new TypeError('"listener" argument must be a function');if(!(F=this._events))return this;if(!(U=F[V]))return this;if(U===j||U.listener&&U.listener===j)--this._eventsCount==0?this._events=new r:(delete F[V],F.removeListener&&this.emit("removeListener",V,U.listener||j));else if(typeof U!="function"){for(B=-1,q=U.length;q-- >0;)if(U[q]===j||U[q].listener&&U[q].listener===j){z=U[q].listener,B=q;break}if(B<0)return this;if(U.length===1){if(U[0]=void 0,--this._eventsCount==0)return this._events=new r,this;delete F[V]}else(function(G,Y){for(var Q=Y,W=Q+1,Z=G.length;W<Z;Q+=1,W+=1)G[Q]=G[W];G.pop()})(U,B);F.removeListener&&this.emit("removeListener",V,z||j)}return this},o.prototype.off=function(V,j){return this.removeListener(V,j)},o.prototype.removeAllListeners=function(V){var j,U;if(!(U=this._events))return this;if(!U.removeListener)return arguments.length===0?(this._events=new r,this._eventsCount=0):U[V]&&(--this._eventsCount==0?this._events=new r:delete U[V]),this;if(arguments.length===0){for(var F,B=Object.keys(U),q=0;q<B.length;++q)(F=B[q])!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=new r,this._eventsCount=0,this}if(typeof(j=U[V])=="function")this.removeListener(V,j);else if(j)do this.removeListener(V,j[j.length-1]);while(j[0]);return this},o.prototype.listeners=function(V){var j,U=this._events;return U&&(j=U[V])?typeof j=="function"?[j.listener||j]:(function(F){for(var B=new Array(F.length),q=0;q<B.length;++q)B[q]=F[q].listener||F[q];return B})(j):[]},o.listenerCount=function(V,j){return typeof V.listenerCount=="function"?V.listenerCount(j):f.call(V,j)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};class g extends o{}(function(V){V.Issue="issue",V.NetworkScoresUpdated="network-scores-updated",V.StatsParsingFinished="stats-parsing-finished"})(t||(t={})),(function(V){V.Network="network",V.CPU="cpu",V.Server="server",V.Stream="stream"})(e||(e={})),(function(V){V.OutboundNetworkQuality="outbound-network-quality",V.InboundNetworkQuality="inbound-network-quality",V.OutboundNetworkMediaLatency="outbound-network-media-latency",V.InboundNetworkMediaLatency="inbound-network-media-latency",V.NetworkMediaSyncFailure="network-media-sync-failure",V.OutboundNetworkThroughput="outbound-network-throughput",V.InboundNetworkThroughput="inbound-network-throughput",V.EncoderCPUThrottling="encoder-cpu-throttling",V.DecoderCPUThrottling="decoder-cpu-throttling",V.ServerIssue="server-issue",V.UnknownVideoDecoderIssue="unknown-video-decoder",V.LowInboundMOS="low-inbound-mean-opinion-score",V.LowOutboundMOS="low-outbound-mean-opinion-score",V.FrozenVideoTrack="frozen-video-track",V.MissingVideoStreamData="missing-video-stream-data",V.MissingAudioStreamData="missing-audio-stream-data"})(s||(s={})),(function(V){V[V.BAD=2.1]="BAD",V[V.POOR=2.6]="POOR",V[V.FAIR=3.1]="FAIR",V[V.GOOD=3.8]="GOOD",V[V.EXCELLENT=4.3]="EXCELLENT"})(n||(n={}));class S extends o{static STATS_REPORT_READY_EVENT="stats-report-ready";static STATS_REPORTS_PARSED="stats-reports-parsed";isStopped=!1;reportTimer;getStatsInterval;compositeStatsParser;constructor(j){super(),this.compositeStatsParser=j.compositeStatsParser,this.getStatsInterval=j.getStatsInterval??1e4}get isRunning(){return!!this.reportTimer&&!this.isStopped}startReporting(){if(this.reportTimer)return;const j=()=>setTimeout((()=>{this.isStopped?this.reportTimer=void 0:this.parseReports().finally((()=>{this.reportTimer=j()}))}),this.getStatsInterval);this.isStopped=!1,this.reportTimer=j()}stopReporting(){this.isStopped=!0,this.reportTimer&&(clearTimeout(this.reportTimer),this.reportTimer=void 0)}async parseReports(){const j=Date.now(),U=await this.compositeStatsParser.parse(),F=Date.now()-j;this.emit(S.STATS_REPORTS_PARSED,{timeTaken:F,reportItems:U}),U.forEach((B=>{this.emit(S.STATS_REPORT_READY_EVENT,B)}))}}const v=(()=>{const V=new Map;return j=>{const{taskId:U,delayMs:F,maxJitterMs:B,callback:q}=j,z=Math.ceil(Math.random()*(B||0)),G=V.get(U);G&&clearTimeout(G);const Y=setTimeout((()=>{q(),V.delete(U)}),F+z);V.set(U,Y)}})();class k{#e={};calculate(j){const{connection:{id:U}}=j,{mos:F,stats:B}=this.calculateOutboundScore(j)||{},{mos:q,stats:z}=this.calculateInboundScore(j)||{};return this.#e[U]=j,v({taskId:U,delayMs:35e3,callback:()=>delete this.#e[U]}),{outbound:F,inbound:q,connectionId:U,statsSamples:{inboundStatsSample:z,outboundStatsSample:B}}}calculateOutboundScore(j){const U=[...j.remote?.audio.inbound||[],...j.remote?.video.inbound||[]];if(!U.length)return;const F=this.#e[j.connection.id];if(!F)return;const B=[...F.remote?.audio.inbound||[],...F.remote?.video.inbound||[]],{packetsSent:q}=j.connection,z=F.connection.packetsSent,G=U.reduce(((ae,se)=>{const de=B.find((oe=>oe.ssrc===se.ssrc));return{sumJitter:ae.sumJitter+se.jitter,packetsLost:ae.packetsLost+se.packetsLost,lastPacketsLost:ae.lastPacketsLost+(de?.packetsLost||0)}}),{sumJitter:0,packetsLost:0,lastPacketsLost:0}),Y=1e3*j.connection.currentRoundTripTime||0,{sumJitter:Q}=G,W=Q/U.length,Z=q-z,ee=G.packetsLost-G.lastPacketsLost,ne=Z&&ee?Math.round(100*ee/(Z+ee)):0;return{mos:this.calculateMOS({avgJitter:W,rtt:Y,packetsLoss:ne}),stats:{avgJitter:W,rtt:Y,packetsLoss:ne}}}calculateInboundScore(j){const U=[...j.audio?.inbound,...j.video?.inbound];if(!U.length)return;const F=this.#e[j.connection.id];if(!F)return;const B=[...F.video?.inbound,...F.audio?.inbound],{packetsReceived:q}=j.connection,z=F.connection.packetsReceived,G=U.reduce(((ae,se)=>{const de=B.find((oe=>oe.ssrc===se.ssrc));return{sumJitter:ae.sumJitter+se.jitter,packetsLost:ae.packetsLost+se.packetsLost,lastPacketsLost:ae.lastPacketsLost+(de?.packetsLost||0)}}),{sumJitter:0,packetsLost:0,lastPacketsLost:0}),Y=1e3*j.connection.currentRoundTripTime||0,{sumJitter:Q}=G,W=Q/U.length,Z=q-z,ee=G.packetsLost-G.lastPacketsLost,ne=Z&&ee?Math.round(100*ee/(Z+ee)):0;return{mos:this.calculateMOS({avgJitter:W,rtt:Y,packetsLoss:ne}),stats:{avgJitter:W,rtt:Y,packetsLoss:ne}}}calculateMOS({avgJitter:j,rtt:U,packetsLoss:F}){const B=U+2*j+10;let q=B<160?93.2-B/40:93.2-B/120-10;return q-=2.5*F,1+.035*q+7e-6*q*(q-60)*(100-q)}}class y{#e=new Map;#t;#n;constructor(j={}){this.#t=j.statsCleanupTtlMs??35e3,this.#n=j.maxParsedStatsStorageSize??5}detect(j,U){const F={...j,networkScores:{...U,statsSamples:U?.statsSamples||{}}},B=this.performDetection(F);return this.setLastProcessedStats(j.connection.id,F),this.performPrevStatsCleanup({connectionId:j.connection.id}),B}performPrevStatsCleanup(j){const{connectionId:U,cleanupCallback:F}=j;this.#e.has(U)&&v({taskId:U,delayMs:this.#t,callback:()=>{this.deleteLastProcessedStats(U),typeof F=="function"&&F()}})}setLastProcessedStats(j,U){if(!j||U.connection.id!==j)return;const F=this.#e.get(j)??[];F.push(U),F.length>this.#n&&F.shift(),this.#e.set(j,F)}getLastProcessedStats(j){const U=this.#e.get(j);return U?.[U.length-1]}getAllLastProcessedStats(j){return this.#e.get(j)??[]}deleteLastProcessedStats(j){this.#e.delete(j)}}class w extends y{#e;constructor(j={}){super(j),this.#e=j.availableOutgoingBitrateThreshold??1e5}performDetection(j){const U=[],{availableOutgoingBitrate:F}=j.connection;if(F===void 0)return U;const B=j.audio.outbound.reduce(((G,Y)=>G+Y.targetBitrate),0),q=j.video.outbound.reduce(((G,Y)=>G+Y.bitrate),0);if(!B&&!q)return U;const z={availableOutgoingBitrate:F,videoStreamsTotalBitrate:q,audioStreamsTotalTargetBitrate:B};return(B>F||q>0&&F<this.#e)&&U.push({statsSample:z,type:e.Network,reason:s.OutboundNetworkThroughput}),U}}class b extends y{#e;#t;#n;#i;constructor(j={}){super(),this.#e=j.highPacketLossThresholdPct??5,this.#t=j.highJitterThreshold??200,this.#n=j.highJitterBufferDelayThresholdMs??500,this.#i=j.highRttThresholdMs??250}performDetection(j){return this.processData(j)}processData(j){const U=[],F=[...j.audio?.inbound,...j.video?.inbound];if(!F.length)return U;const B=this.getLastProcessedStats(j.connection.id);if(!B)return U;const q=[...B.video?.inbound,...B.audio?.inbound],{packetsReceived:z}=j.connection,G=B.connection.packetsReceived,Y=F.reduce(((ke,Ae)=>{const be=q.find((Oe=>Oe.ssrc===Ae.ssrc)),Le=be?.jitterBufferDelay||0,Fe=be?.jitterBufferEmittedCount||0,Ne=Ae.jitterBufferDelay-Le,Ve=Ae.jitterBufferEmittedCount-Fe,Te=Ne&&Ve?1e3*Ne/Ve:0;return{sumJitter:ke.sumJitter+Ae.jitter,sumJitterBufferDelayMs:ke.sumJitterBufferDelayMs+Te,packetsLost:ke.packetsLost+Ae.packetsLost,lastPacketsLost:ke.lastPacketsLost+(be?.packetsLost||0)}}),{sumJitter:0,sumJitterBufferDelayMs:0,packetsLost:0,lastPacketsLost:0}),Q=1e3*j.connection.currentRoundTripTime||0,{sumJitter:W,sumJitterBufferDelayMs:Z}=Y,ee=W/F.length,ne=Z/F.length,ae=z-G,se=Y.packetsLost-Y.lastPacketsLost,de=ae&&se?Math.round(100*se/(ae+se)):0,oe=de>this.#e,ue=ee>=this.#t,he=Q>=this.#i,ye=ne>this.#n,fe=he&&!ue&&!oe,pe=oe&&ue,xe=ue&&ye,Ee={rtt:Q,packetLossPct:de,avgJitter:ee,avgJitterBufferDelay:ne};return(ue||oe)&&U.push({statsSample:Ee,type:e.Network,reason:s.InboundNetworkQuality,iceCandidate:j.connection.local.id}),fe&&U.push({statsSample:Ee,type:e.Server,reason:s.ServerIssue,iceCandidate:j.connection.remote.id}),pe&&U.push({statsSample:Ee,type:e.Network,reason:s.InboundNetworkMediaLatency,iceCandidate:j.connection.local.id}),xe&&U.push({statsSample:Ee,type:e.Network,reason:s.NetworkMediaSyncFailure,iceCandidate:j.connection.local.id}),U}}class P extends y{#e;constructor(j={}){super(),this.#e=j.correctedSamplesThresholdPct??5}performDetection(j){return this.processData(j)}processData(j){const U=j.audio.inbound,F=[],B=this.getLastProcessedStats(j.connection.id)?.audio.inbound;return B&&U.forEach((q=>{const z=B.find((ne=>ne.ssrc===q.ssrc));if(!z)return;const G=q.track.insertedSamplesForDeceleration+q.track.removedSamplesForAcceleration,Y=z.track.insertedSamplesForDeceleration+z.track.removedSamplesForAcceleration;if(G===Y)return;const Q=q.track.totalSamplesReceived-z.track.totalSamplesReceived,W=G-Y,Z=Math.round(100*W/Q),ee={correctedSamplesPct:Z};Z>this.#e&&F.push({statsSample:ee,type:e.Network,reason:s.NetworkMediaSyncFailure,ssrc:q.ssrc})})),F}}class T extends y{#e;#t;constructor(j={}){super(),this.#e=j.highPacketLossThresholdPct??5,this.#t=j.highJitterThreshold??200}performDetection(j){return this.processData(j)}processData(j){const U=[],F=[...j.remote?.audio.inbound||[],...j.remote?.video.inbound||[]];if(!F.length)return U;const B=this.getLastProcessedStats(j.connection.id);if(!B)return U;const q=[...B.remote?.audio.inbound||[],...B.remote?.video.inbound||[]],{packetsSent:z}=j.connection,G=B.connection.packetsSent,Y=F.reduce(((he,ye)=>{const fe=q.find((pe=>pe.ssrc===ye.ssrc));return{sumJitter:he.sumJitter+ye.jitter,packetsLost:he.packetsLost+ye.packetsLost,lastPacketsLost:he.lastPacketsLost+(fe?.packetsLost||0)}}),{sumJitter:0,packetsLost:0,lastPacketsLost:0}),Q=1e3*j.connection.currentRoundTripTime||0,{sumJitter:W}=Y,Z=W/F.length,ee=z-G,ne=Y.packetsLost-Y.lastPacketsLost,ae=ee&&ne?Math.round(100*ne/(ee+ne)):0,se=ae>this.#e,de=Z>=this.#t,oe=!se&&de||de||se,ue={rtt:Q,avgJitter:Z,packetLossPct:ae};return se&&de&&U.push({statsSample:ue,type:e.Network,reason:s.OutboundNetworkMediaLatency,iceCandidate:j.connection.local.id}),oe&&U.push({statsSample:ue,type:e.Network,reason:s.OutboundNetworkQuality,iceCandidate:j.connection.local.id}),U}}class L extends y{performDetection(j){return this.processData(j)}processData(j){const U=j.video.outbound.filter((q=>q.qualityLimitationReason!=="none")),F=[],B=this.getLastProcessedStats(j.connection.id)?.video.outbound;return B&&U.forEach((q=>{const z=B.find((Y=>Y.ssrc===q.ssrc));if(!z)return;const G={qualityLimitationReason:q.qualityLimitationReason};q.framesSent>z.framesSent||(q.qualityLimitationReason==="cpu"&&F.push({statsSample:G,type:e.CPU,reason:s.EncoderCPUThrottling,ssrc:q.ssrc}),q.qualityLimitationReason==="bandwidth"&&F.push({statsSample:G,type:e.Network,reason:s.OutboundNetworkThroughput,ssrc:q.ssrc}))})),F}}class D extends y{UNKNOWN_DECODER="unknown";#e={};performDetection(j){return this.processData(j)}performPrevStatsCleanup(j){const{connectionId:U,cleanupCallback:F}=j;super.performPrevStatsCleanup({...j,cleanupCallback:()=>{delete this.#e[U],typeof F=="function"&&F()}})}processData(j){const U=[],{id:F}=j.connection,B=this.getLastProcessedStats(F)?.video.inbound;return j.video.inbound.forEach((q=>{const{decoderImplementation:z,ssrc:G}=q;if(B?.find((Q=>Q.ssrc===G)))if(z===this.UNKNOWN_DECODER){if(!this.hadLastDecoderWithIssue(F,G)){this.setLastDecoderWithIssue(F,G,this.UNKNOWN_DECODER);const Q={mimeType:q.mimeType,decoderImplementation:z};U.push({ssrc:G,statsSample:Q,type:e.Stream,reason:s.UnknownVideoDecoderIssue,trackIdentifier:q.track.trackIdentifier})}}else this.setLastDecoderWithIssue(F,G,void 0)})),U}setLastDecoderWithIssue(j,U,F){const B=this.#e[j]??{};F===void 0?delete B[U]:B[U]=F,this.#e[j]=B}hadLastDecoderWithIssue(j,U){const F=this.#e[j];return(F&&F[U])===this.UNKNOWN_DECODER}}const C=V=>V.reduce(((j,U)=>j+U),0)/V.length,R=(V,j,U=30)=>{const F=[];for(let B=1;B<j.length-1;B+=1){const q=j[B]?.video?.inbound.find((Q=>Q.ssrc===V));if(!q)continue;const z=j[B-1]?.video?.inbound?.find((Q=>Q.ssrc===V));if(!q||!z)continue;const G=q.timestamp-z.timestamp,Y=q.framesDecoded-z.framesDecoded;if(Y>0){const Q=G/Y;F.push(Q)}}return F.length<=1?!1:(B=>{const q=((z,G)=>G.reduce(((Y,Q)=>Y+(Q-z)**2),0)/G.length)(C(B),B);return Math.sqrt(q)})(F)>U},M=(V,j)=>{for(let U=1;U<j.length;U+=1){const F=j[U].video.inbound.find((G=>G.ssrc===V));if(!F)continue;const B=j[U-1].video.inbound.find((G=>G.ssrc===V)),q=F.frameWidth!==B?.frameWidth,z=F.frameHeight!==B?.frameHeight;if(q||z)return!0}return!1};class I extends y{#e;#t;#n;constructor(j={}){super(),this.#e=j.avgFreezeDurationThresholdMs??1e3,this.#t=j.frozenDurationThresholdPct??30,this.#n=j.minMosQuality??n.BAD}performDetection(j){const U=j.networkScores.inbound;return U!==void 0&&U<=this.#n?[]:this.processData(j)}processData(j){const U=[],F=this.getAllLastProcessedStats(j.connection.id);if(F.length===0)return[];const B=j.video.inbound.map((q=>{const z=F[F.length-1].video.inbound.find((Z=>Z.ssrc===q.ssrc));if(!z||M(q.ssrc,[F[F.length-1],j])||R(q.ssrc,F))return;const G=q.freezeCount-(z.freezeCount??0),Y=1e3*(q.totalFreezesDuration-(z.totalFreezesDuration??0)),Q=G>0?Y/G:0,W=Y/(q.timestamp-z.timestamp)*100;return W>this.#t||Q>this.#e?{ssrc:q.ssrc,avgFreezeDurationMs:Q,frozenDurationPct:W}:void 0})).filter((q=>q!==void 0));return B.length>0&&(U.push({type:e.Stream,reason:s.FrozenVideoTrack,statsSample:{ssrcs:B.map((q=>q.ssrc))}}),this.deleteLastProcessedStats(j.connection.id)),U}}class E extends y{#e;#t;#n;constructor(j={}){super(j),this.#e=j.volatilityThreshold??8,this.#t=j.affectedStreamsPercentThreshold??30,this.#n=j.minMosQuality??n.BAD}performDetection(j){return[...this.getAllLastProcessedStats(j.connection.id),j].find((U=>U.networkScores.inbound!==void 0&&U.networkScores.inbound<=this.#n))?[]:this.processData(j)}processData(j){const U=[],F=[...this.getAllLastProcessedStats(j.connection.id),j],B=j.video.inbound.map((z=>{if(F.length<5||M(z.ssrc,F))return;const G=[];for(let Q=0;Q<F.length-1;Q+=1){const W=F[Q].video.inbound.find((Z=>Z.ssrc===z.ssrc));W?.framesPerSecond!==void 0&&G.push(W.framesPerSecond)}if(G.length<5||R(z.ssrc,F))return;const Y=(Q=>{if(Q.length===0)throw new Error("Cannot calculate volatility for empty array");const W=C(Q);return Q.reduce(((Z,ee)=>Z+Math.abs(ee-W)),0)/Q.length*100/W})(G);return Y>this.#e?{ssrc:z.ssrc,allFps:G,volatility:Y}:void 0})).filter((z=>!!z));if(B.length===0)return U;const q=B.length/(j.video.inbound.length/100);return q>this.#t&&(U.push({type:e.CPU,reason:s.DecoderCPUThrottling,statsSample:{affectedStreamsPercent:q,throtthedStreams:B}}),this.deleteLastProcessedStats(j.connection.id)),U}}const N=V=>V.iceConnectionState==="closed"||V.connectionState==="closed",_=(V,j,U)=>8*((F,B,q)=>{if(!B)return 0;const z=F[q],G=B[q];if(z==null||G==null)return 0;const Y=Math.floor(F.timestamp)-Math.floor(B.timestamp);return Y===0?0:(Number(z)-Number(G))/Y*1e3})(V,j,U);class A{connections=[];statsParser;constructor(j){this.statsParser=j.statsParser}listConnections(){return[...this.connections]}addPeerConnection(j){this.connections.push({id:j.id??String(Date.now()+Math.random().toString(32)),pc:j.pc})}removePeerConnection(j){const U=this.connections.findIndex((({pc:F})=>F===j.pc));U>=0&&this.removeConnectionsByIndexes([U])}async parse(){const j=[],U=this.connections.map((async(F,B)=>{if(!N(F.pc))return this.statsParser.parse(F);j.unshift(B)}));return j.length&&this.removeConnectionsByIndexes(j),(await Promise.all(U)).filter((F=>F!==void 0))}removeConnectionsByIndexes(j){j.forEach((U=>{this.connections.splice(U,1)}))}}class O{prevStats=new Map;allowedReportTypes=new Set(["candidate-pair","inbound-rtp","outbound-rtp","remote-outbound-rtp","remote-inbound-rtp","track","transport"]);ignoreSSRCList;logger;constructor(j){this.ignoreSSRCList=j.ignoreSSRCList??[],this.logger=j.logger}get previouslyParsedStatsConnectionsIds(){return[...this.prevStats.keys()]}async parse(j){if(!N(j.pc))return this.getConnectionStats(j);this.logger.debug("Skip stats parsing. Connection is closed.",{connection:j})}async getConnectionStats(j){const{pc:U,id:F}=j;try{const B=Date.now(),q=U.getReceivers().filter((Q=>Q.track?.enabled)),z=U.getSenders().filter((Q=>Q.track?.enabled)),G=await Promise.all(q.map((Q=>Q.getStats()))),Y=await Promise.all(z.map((Q=>Q.getStats())));return{id:F,stats:this.mapReportsStats([...G,...Y],j),timeTaken:Date.now()-B}}catch(B){return void this.logger.error("Failed to get stats for PC",{id:F,pc:U,error:B})}}mapReportsStats(j,U){const F={audio:{inbound:[],outbound:[]},video:{inbound:[],outbound:[]},connection:{},remote:{video:{inbound:[],outbound:[]},audio:{inbound:[],outbound:[]}}};j.forEach((z=>{z.forEach((G=>{this.allowedReportTypes.has(G.type)&&this.updateMappedStatsWithReportItemData(G,F,z)}))}));const{id:B}=U,q=this.prevStats.get(B);return q&&this.propagateStatsWithRateValues(F,q.stats),this.prevStats.set(B,{stats:F,ts:Date.now()}),v({taskId:B,delayMs:35e3,callback:()=>this.prevStats.delete(B)}),F}updateMappedStatsWithReportItemData(j,U,F){const B=j.type;if(B==="candidate-pair"&&j.state==="succeeded"&&j.nominated)return void(U.connection=this.prepareConnectionStats(j,F));const q=this.getMediaType(j);if(!q)return;const z=j.ssrc;if(!z||!this.ignoreSSRCList.includes(z))if(B!=="outbound-rtp")if(B!=="inbound-rtp")B!=="remote-outbound-rtp"?B==="remote-inbound-rtp"&&(this.mapConnectionStatsIfNecessary(U,j,F),U.remote[q].inbound.push({...j})):U.remote[q].outbound.push({...j});else{const G=F.get(j.trackId)||F.get(j.mediaSourceId)||{};this.mapConnectionStatsIfNecessary(U,j,F);const Y={...j,track:{...G}};U[q].inbound.push(Y)}else{const G=F.get(j.trackId)||F.get(j.mediaSourceId)||{},Y={...j,track:{...G}};U[q].outbound.push(Y)}}getMediaType(j){const U=j.mediaType||j.kind;if(!["audio","video"].includes(U)){const{id:F}=j;return F?String(F).includes("Video")?"video":String(F).includes("Audio")?"audio":void 0:void 0}return U}propagateStatsWithRateValues(j,U){j.audio.inbound.forEach((F=>{const B=U.audio.inbound.find((({id:q})=>q===F.id));F.bitrate=_(F,B,"bytesReceived"),F.packetRate=_(F,B,"packetsReceived")})),j.audio.outbound.forEach((F=>{const B=U.audio.outbound.find((({id:q})=>q===F.id));F.bitrate=_(F,B,"bytesSent"),F.packetRate=_(F,B,"packetsSent")})),j.video.inbound.forEach((F=>{const B=U.video.inbound.find((({id:q})=>q===F.id));F.bitrate=_(F,B,"bytesReceived"),F.packetRate=_(F,B,"packetsReceived")})),j.video.outbound.forEach((F=>{const B=U.video.outbound.find((({id:q})=>q===F.id));F.bitrate=_(F,B,"bytesSent"),F.packetRate=_(F,B,"packetsSent")}))}mapConnectionStatsIfNecessary(j,U,F){if(j.connection.id||!U.transportId)return;const B=F.get(U.transportId);if(B&&B.selectedCandidatePairId){const q=F.get(B.selectedCandidatePairId);j.connection=this.prepareConnectionStats(q,F)}}prepareConnectionStats(j,U){if(!j||!U)return{};const F={...j};if(F.remoteCandidateId){const B=U.get(F.remoteCandidateId);F.remote={...B}}if(F.localCandidateId){const B=U.get(F.localCandidateId);F.local={...B}}return F}}class J extends y{#e=new Map;#t;#n;constructor(j={}){super(),this.#t=j.timeoutMs??15e3,this.#n=j.steps??3}performDetection(j){return this.processData(j)}processData(j){const U=[],F=[...this.getAllLastProcessedStats(j.connection.id),j];if(F.length<this.#n)return U;const B=F.slice(-this.#n),q=B.map((G=>G.video.inbound)),z=B.map((G=>G.audio.inbound));return U.push(...this.detectMissingData(z,e.Stream,s.MissingAudioStreamData)),U.push(...this.detectMissingData(q,e.Stream,s.MissingVideoStreamData)),new Set(this.#e.keys()).forEach((G=>{const Y=this.#e.get(G);Y&&Date.now()-Y>this.#t&&this.removeMarkedIssue(G)})),U}detectMissingData(j,U,F){const B=[],q=j.pop(),z=J.mapStatsByTrackId(j);return q.forEach((G=>{const Y=G.track.trackIdentifier,Q=z.get(Y);if(!Array.isArray(Q)||Q.length===0||G.track.detached||G.track.ended)return;if(!J.isAllBytesReceivedDidntChange(G.bytesReceived,Q))return void this.removeMarkedIssue(Y);if(!this.markIssue(Y))return;const W={bytesReceived:G.bytesReceived};B.push({type:U,reason:F,statsSample:W,trackIdentifier:Y})})),B}static mapStatsByTrackId(j){const U=new Map;return j.forEach((F=>{F.forEach((B=>{const q=U.get(B.track.trackIdentifier)||[];q.push(B),U.set(B.track.trackIdentifier,q)}))})),U}static isAllBytesReceivedDidntChange(j,U){for(let F=0;F<U.length;F+=1)if(U[F].bytesReceived!==j)return!1;return!0}markIssue(j){const U=Date.now(),F=this.#e.get(j);return(!F||U-F>this.#t)&&(this.#e.set(j,U),!0)}removeMarkedIssue(j){this.#e.delete(j)}}class x{eventEmitter;#e=!1;detectors=[];networkScoresCalculator;statsReporter;compositeStatsParser;logger;autoAddPeerConnections;constructor(j){this.logger=j.logger??{debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},this.eventEmitter=j.issueEmitter??new g,j.onIssues&&this.eventEmitter.on(t.Issue,j.onIssues),j.onNetworkScoresUpdated&&this.eventEmitter.on(t.NetworkScoresUpdated,j.onNetworkScoresUpdated),this.detectors=j.detectors??[new L,new b,new T,new P,new w,new D,new I,new E,new J],this.networkScoresCalculator=j.networkScoresCalculator??new k,this.compositeStatsParser=j.compositeStatsParser??new A({statsParser:new O({ignoreSSRCList:j.ignoreSSRCList,logger:this.logger})}),this.statsReporter=j.statsReporter??new S({compositeStatsParser:this.compositeStatsParser,getStatsInterval:j.getStatsInterval??5e3}),window.wid=this,this.autoAddPeerConnections=j.autoAddPeerConnections??!0,this.autoAddPeerConnections&&this.wrapRTCPeerConnection(),this.statsReporter.on(S.STATS_REPORT_READY_EVENT,(U=>{const F=this.calculateNetworkScores(U.stats);this.detectIssues({data:U.stats},F)})),this.statsReporter.on(S.STATS_REPORTS_PARSED,(U=>{const F={timeTaken:U.timeTaken,ts:Date.now()};j.onStats&&j.onStats(U.reportItems),this.eventEmitter.emit(t.StatsParsingFinished,F)}))}watchNewPeerConnections(){if(!this.autoAddPeerConnections)throw new Error("Auto add peer connections was disabled in the constructor.");this.#e?this.logger.warn("WebRTCIssueDetector is already started. Skip processing"):(this.logger.info("Start watching peer connections"),this.#e=!0,this.statsReporter.startReporting())}stopWatchingNewPeerConnections(){this.#e?(this.logger.info("Stop watching peer connections"),this.#e=!1,this.statsReporter.stopReporting()):this.logger.warn("WebRTCIssueDetector is already stopped. Skip processing")}handleNewPeerConnection(j,U){this.#e||!this.autoAddPeerConnections?(this.#e||this.autoAddPeerConnections!==!1||(this.logger.info("Starting stats reporting for new peer connection"),this.#e=!0,this.statsReporter.startReporting()),this.logger.debug("Handling new peer connection",j),this.compositeStatsParser.addPeerConnection({pc:j,id:U})):this.logger.debug("Skip handling new peer connection. Detector is not running",j)}emitIssues(j){this.eventEmitter.emit(t.Issue,j)}detectIssues({data:j},U){const F=this.detectors.reduce(((B,q)=>[...B,...q.detect(j,U)]),[]);F.length>0&&this.emitIssues(F)}calculateNetworkScores(j){const U=this.networkScoresCalculator.calculate(j);return this.eventEmitter.emit(t.NetworkScoresUpdated,U),U}wrapRTCPeerConnection(){if(!window.RTCPeerConnection)return void this.logger.warn("No RTCPeerConnection found in browser window. Skipping");const j=window.RTCPeerConnection,U=B=>this.handleNewPeerConnection(B);function F(B){const q=new j(B);return U(q),q}F.prototype=j.prototype,window.RTCPeerConnection=F}}var WebRTCConnectionQualityIndicator=(function(V){__extends(j,V);function j(){var U=V!==null&&V.apply(this,arguments)||this;return U.issueDetector=null,U.mosScores=null,U}return j.prototype._start=function(U){var F=this;this.issueDetector=new x({autoAddPeerConnections:!1,getStatsInterval:3e3,onNetworkScoresUpdated:function(B){F.mosScores=B,F.handleStatsChanged()}}),this.issueDetector.handleNewPeerConnection(U)},j.prototype._stop=function(){this.issueDetector&&(this.issueDetector.stopWatchingNewPeerConnections(),this.issueDetector=null),this.mosScores=null},j.prototype.calculateConnectionQuality=function(){return!this.mosScores||this.mosScores.inbound&&this.mosScores.outbound?ConnectionQuality.UNKNOWN:this.mosScores.inbound&&this.mosScores.inbound<3||this.mosScores.outbound&&this.mosScores.outbound<3?ConnectionQuality.BAD:ConnectionQuality.GOOD},j})(AbstractConnectionQualityIndicator),VoiceChatState;(function(V){V.INACTIVE="inactive",V.STARTING="starting",V.ACTIVE="started",V.STOPPING="stopping"})(VoiceChatState||(VoiceChatState={}));var AbstractVoiceChat=(function(){function V(){}return V})(),AbstractVoiceChatImplementation=(function(V){__extends(j,V);function j(){var U=V!==null&&V.apply(this,arguments)||this;return U._isMuted=!0,U.state=VoiceChatState.INACTIVE,U}return Object.defineProperty(j.prototype,"isMuted",{get:function(){return this._isMuted},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isVoiceChatting",{get:function(){return this.state!==VoiceChatState.INACTIVE},enumerable:!1,configurable:!0}),j.prototype.startVoiceChat=function(U){return __awaiter(this,void 0,void 0,function(){var F;return __generator(this,function(B){switch(B.label){case 0:return this.state===VoiceChatState.INACTIVE?[3,2]:[4,this.stopVoiceChat()];case 1:B.sent(),B.label=2;case 2:return B.trys.push([2,4,,6]),this.state=VoiceChatState.STARTING,[4,this._startVoiceChat(U)];case 3:return B.sent(),this.state=VoiceChatState.ACTIVE,[3,6];case 4:return F=B.sent(),[4,this.stopVoiceChat()];case 5:throw B.sent(),F;case 6:return[2]}})})},j.prototype.stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(U){switch(U.label){case 0:return this.state===VoiceChatState.INACTIVE?[2]:(this.state=VoiceChatState.STOPPING,[4,this._stopVoiceChat()]);case 1:return U.sent(),this._isMuted=!0,this.state=VoiceChatState.INACTIVE,[2]}})})},j.prototype._mute=function(){},j.prototype._unmute=function(){},j.prototype.mute=function(){this.isVoiceChatting&&(this._mute(),this._isMuted=!0)},j.prototype.unmute=function(){this.isVoiceChatting&&(this._unmute(),this._isMuted=!1)},j})(AbstractVoiceChat);function sleep(V){return new Promise(function(j){return setTimeout(j,V)})}function convertFloat32ToS16PCM(V){for(var j=new Int16Array(V.length),U=0;U<V.length;U++){var F=Math.max(-1,Math.min(1,V[U]));j[U]=F<0?F*32768:F*32767}return j}var LivekitVoiceChat=(function(V){__extends(j,V);function j(){var U=V!==null&&V.apply(this,arguments)||this;return U.room=null,U.track=null,U}return j.prototype._startVoiceChat=function(U){return __awaiter(this,void 0,void 0,function(){var F,B;return __generator(this,function(q){switch(q.label){case 0:return this.room=U.room,F=this,[4,createLocalAudioTrack({echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0})];case 1:return F.track=q.sent(),[4,this.room.localParticipant.publishTrack(this.track)];case 2:return q.sent(),!((B=U.config)===null||B===void 0)&&B.defaultMuted?this.mute():this.unmute(),[4,sleep(4e3)];case 3:return q.sent(),[2]}})})},j.prototype._stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){var U;return __generator(this,function(F){return!((U=this.room)===null||U===void 0)&&U.localParticipant&&this.room.localParticipant.getTrackPublications().forEach(function(B){B.track&&B.track.kind===Track.Kind.Audio&&B.track.stop()}),this.track&&(this.track.stop(),this.track=null),[2]})})},j.prototype._mute=function(){this.track&&!this.track.isMuted&&this.track.mute()},j.prototype._unmute=function(){this.track&&this.track.isMuted&&this.track.unmute()},j})(AbstractVoiceChatImplementation),WebSocketVoiceChat=(function(V){__extends(j,V);function j(){var U=V!==null&&V.apply(this,arguments)||this;return U.audioContext=null,U.webSocket=null,U.scriptProcessor=null,U.mediaStreamAudioSource=null,U.mediaDevicesStream=null,U.audioRawFrame=null,U}return j.prototype._startVoiceChat=function(U){return __awaiter(this,void 0,void 0,function(){var F,B=this,q,z,G,Y;return __generator(this,function(Q){switch(Q.label){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Cannot start voice chat without media devices");return this.webSocket=U.webSocket,this.audioRawFrame=U.audioRawFrame,this.audioContext=new window.AudioContext({latencyHint:"interactive",sampleRate:16e3}),!((q=U.config)===null||q===void 0)&&q.defaultMuted||this.unmute(),[4,navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0}})];case 1:return F=Q.sent(),this.mediaDevicesStream=F,this.mediaStreamAudioSource=(z=this.audioContext)===null||z===void 0?void 0:z.createMediaStreamSource(F),this.scriptProcessor=(G=this.audioContext)===null||G===void 0?void 0:G.createScriptProcessor(512,1,1),this.mediaStreamAudioSource.connect(this.scriptProcessor),this.scriptProcessor.connect((Y=this.audioContext)===null||Y===void 0?void 0:Y.destination),this.scriptProcessor.onaudioprocess=function(W){var Z;if(!(!B.webSocket||!B.audioRawFrame)){var ee;B.isMuted?ee=new Float32Array(512):ee=W.inputBuffer.getChannelData(0);var ne=convertFloat32ToS16PCM(ee),ae=new Uint8Array(ne.buffer),se=B.audioRawFrame.create({audio:{audio:Array.from(ae),sampleRate:16e3,numChannels:1}}),de=new Uint8Array(B.audioRawFrame.encode(se).finish());(Z=B.webSocket)===null||Z===void 0||Z.send(de)}},[4,sleep(2e3)];case 2:return Q.sent(),[2]}})})},j.prototype._stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){var U,F;return __generator(this,function(B){return this.audioContext&&(this.audioContext=null),this.scriptProcessor&&(this.scriptProcessor.disconnect(),this.scriptProcessor=null),this.mediaStreamAudioSource&&(this.mediaStreamAudioSource.disconnect(),this.mediaStreamAudioSource=null),this.mediaDevicesStream&&((F=(U=this.mediaDevicesStream)===null||U===void 0?void 0:U.getTracks())===null||F===void 0||F.forEach(function(q){return q.stop()}),this.mediaDevicesStream=null),[2]})})},j})(AbstractVoiceChatImplementation),VoiceChatTransport;(function(V){V.LIVEKIT="livekit",V.WEBSOCKET="websocket"})(VoiceChatTransport||(VoiceChatTransport={}));var VoiceChatFactory=(function(V){__extends(j,V);function j(U){var F=U.voiceChatInstance,B=U.initialConfig,q=V.call(this)||this;return q.initialConfig=B,q.voiceChat=F,q}return Object.defineProperty(j.prototype,"isMuted",{get:function(){return this.voiceChat.isMuted},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isVoiceChatting",{get:function(){return this.voiceChat.isVoiceChatting},enumerable:!1,configurable:!0}),j.prototype.startVoiceChat=function(U){return __awaiter(this,arguments,void 0,function(F){var B=F.config;return __generator(this,function(q){switch(q.label){case 0:return[4,this.voiceChat.startVoiceChat(__assign(__assign({},this.initialConfig),{config:B}))];case 1:return q.sent(),[2]}})})},j.prototype.stopVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(U){switch(U.label){case 0:return[4,this.voiceChat.stopVoiceChat()];case 1:return U.sent(),[2]}})})},j.prototype.mute=function(){this.voiceChat.mute()},j.prototype.unmute=function(){this.voiceChat.unmute()},j.createLiveKitVoiceChat=function(U){return new this({voiceChatInstance:new LivekitVoiceChat,initialConfig:U})},j.createWebSocketVoiceChat=function(U){return new this({voiceChatInstance:new WebSocketVoiceChat,initialConfig:U})},j})(AbstractVoiceChat),AvatarQuality;(function(V){V.Low="low",V.Medium="medium",V.High="high"})(AvatarQuality||(AvatarQuality={}));var VoiceEmotion;(function(V){V.EXCITED="excited",V.SERIOUS="serious",V.FRIENDLY="friendly",V.SOOTHING="soothing",V.BROADCASTER="broadcaster"})(VoiceEmotion||(VoiceEmotion={}));var ElevenLabsModel;(function(V){V.eleven_flash_v2_5="eleven_flash_v2_5",V.eleven_multilingual_v2="eleven_multilingual_v2"})(ElevenLabsModel||(ElevenLabsModel={}));var STTProvider;(function(V){V.DEEPGRAM="deepgram",V.GLADIA="gladia"})(STTProvider||(STTProvider={}));var TaskType;(function(V){V.TALK="talk",V.REPEAT="repeat"})(TaskType||(TaskType={}));var TaskMode;(function(V){V.SYNC="sync",V.ASYNC="async"})(TaskMode||(TaskMode={}));var StreamingEvents;(function(V){V.AVATAR_START_TALKING="avatar_start_talking",V.AVATAR_STOP_TALKING="avatar_stop_talking",V.AVATAR_TALKING_MESSAGE="avatar_talking_message",V.AVATAR_END_MESSAGE="avatar_end_message",V.USER_TALKING_MESSAGE="user_talking_message",V.USER_END_MESSAGE="user_end_message",V.USER_START="user_start",V.USER_STOP="user_stop",V.USER_SILENCE="user_silence",V.STREAM_READY="stream_ready",V.STREAM_DISCONNECTED="stream_disconnected",V.CONNECTION_QUALITY_CHANGED="connection_quality_changed"})(StreamingEvents||(StreamingEvents={}));var APIError=(function(V){__extends(j,V);function j(U,F,B){var q=V.call(this,U)||this;return q.name="APIError",q.status=F,q.responseText=B,q}return j})(Error),ConnectionQualityIndicatorClass=QualityIndicatorMixer({TrackerClass:LiveKitConnectionQualityIndicator,getParams:function(V){return V}},{TrackerClass:WebRTCConnectionQualityIndicator,getParams:function(V){var j;return((j=V.engine.pcManager)===null||j===void 0?void 0:j.subscriber)._pc}}),StreamingAvatar=(function(){function V(j){var U=j.token,F=j.basePath,B=F===void 0?"https://api.heygen.com":F,q=this;this.room=null,this.mediaStream=null,this.eventTarget=new EventTarget,this.webSocket=null,this.sessionId=null,this.voiceChat=null,this.isLiveKitTransport=!1,this.token=U,this.basePath=B,this.connectionQualityIndicator=new ConnectionQualityIndicatorClass(function(z){return q.emit(StreamingEvents.CONNECTION_QUALITY_CHANGED,z)})}return Object.defineProperty(V.prototype,"connectionQuality",{get:function(){return this.connectionQualityIndicator.connectionQuality},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"isInputAudioMuted",{get:function(){var j,U;return(U=(j=this.voiceChat)===null||j===void 0?void 0:j.isMuted)!==null&&U!==void 0?U:!0},enumerable:!1,configurable:!0}),V.prototype.muteInputAudio=function(){var j;(j=this.voiceChat)===null||j===void 0||j.mute()},V.prototype.unmuteInputAudio=function(){var j;(j=this.voiceChat)===null||j===void 0||j.unmute()},V.prototype.createStartAvatar=function(j){return __awaiter(this,void 0,void 0,function(){var U;return __generator(this,function(F){switch(F.label){case 0:return[4,this.newSession(j)];case 1:return U=F.sent(),[2,this.startAvatar(j,U)]}})})},V.prototype.startAvatar=function(j,U){return __awaiter(this,void 0,void 0,function(){var F,B,q=this;return __generator(this,function(z){switch(z.label){case 0:this.sessionId=U.session_id,this.isLiveKitTransport=j.voiceChatTransport===VoiceChatTransport.LIVEKIT,F=new Room({adaptiveStream:!0,dynacast:!0,videoCaptureDefaults:{resolution:VideoPresets.h720.resolution}}),this.room=F,this.mediaStream=null,F.on(RoomEvent.DataReceived,function(G){var Y=null;try{var Q=new TextDecoder().decode(G);Y=JSON.parse(Q)}catch(W){console.error(W)}Y&&q.emit(Y.type,Y)}),B=new MediaStream,F.on(RoomEvent.TrackSubscribed,function(G){if(G.kind==="video"||G.kind==="audio"){B.addTrack(G.mediaStreamTrack);var Y=B.getVideoTracks().length>0,Q=B.getAudioTracks().length>0;Y&&Q&&!q.mediaStream&&(q.mediaStream=B,q.emit(StreamingEvents.STREAM_READY,q.mediaStream))}}),F.on(RoomEvent.TrackUnsubscribed,function(G){var Y=G.mediaStreamTrack;Y&&B.removeTrack(Y)}),F.on(RoomEvent.Disconnected,function(G){q.emit(StreamingEvents.STREAM_DISCONNECTED,G)}),z.label=1;case 1:return z.trys.push([1,3,,4]),[4,F.prepareConnection(U.url,U.access_token)];case 2:return z.sent(),[3,4];case 3:return z.sent(),[3,4];case 4:return[4,this.startSession()];case 5:return z.sent(),[4,F.connect(U.url,U.access_token)];case 6:return z.sent(),[4,this.connectWebSocket({useSilencePrompt:!!j.useSilencePrompt})];case 7:return z.sent(),this.initVoiceChat(j.voiceChatTransport||VoiceChatTransport.WEBSOCKET),this.connectionQualityIndicator.start(F),[2,U]}})})},V.prototype.startVoiceChat=function(){return __awaiter(this,arguments,void 0,function(j){var U,F=j===void 0?{}:j,B=F.isInputAudioMuted;return __generator(this,function(q){switch(q.label){case 0:return[4,(U=this.voiceChat)===null||U===void 0?void 0:U.startVoiceChat({config:{defaultMuted:B}})];case 1:return q.sent(),[2]}})})},V.prototype.closeVoiceChat=function(){return __awaiter(this,void 0,void 0,function(){var j;return __generator(this,function(U){switch(U.label){case 0:return[4,(j=this.voiceChat)===null||j===void 0?void 0:j.stopVoiceChat()];case 1:return U.sent(),[2]}})})},V.prototype.newSession=function(j){return __awaiter(this,void 0,void 0,function(){var U,F,B,q,z;return __generator(this,function(G){return[2,this.request("/v1/streaming.new",{avatar_name:j.avatarName,quality:j.quality,knowledge_base_id:j.knowledgeId,knowledge_base:j.knowledgeBase,voice:{voice_id:(U=j.voice)===null||U===void 0?void 0:U.voiceId,rate:(F=j.voice)===null||F===void 0?void 0:F.rate,emotion:(B=j.voice)===null||B===void 0?void 0:B.emotion,elevenlabs_settings:__assign(__assign({},(q=j?.voice)===null||q===void 0?void 0:q.elevenlabsSettings),{model_id:(z=j.voice)===null||z===void 0?void 0:z.model})},language:j.language,version:"v2",video_encoding:"H264",source:"sdk",disable_idle_timeout:j.disableIdleTimeout,stt_settings:j.sttSettings,ia_is_livekit_transport:j.voiceChatTransport===VoiceChatTransport.LIVEKIT,silence_response:j.useSilencePrompt,activity_idle_timeout:j.activityIdleTimeout})]})})},V.prototype.startSession=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(j){return[2,this.request("/v1/streaming.start",{session_id:this.sessionId})]})})},V.prototype.speak=function(j){return __awaiter(this,void 0,void 0,function(){var U,F;return __generator(this,function(B){if(U=j.taskType||j.task_type||TaskType.TALK,F=j.taskMode||TaskMode.ASYNC,U===TaskType.TALK&&F===TaskMode.ASYNC){if(this.isLiveKitTransport&&this.room)return this.sendLivekitMessage(j.text),[2];if(!this.isLiveKitTransport&&this.webSocket&&this.audioRawFrame)return this.sendWebsocketMessage(j.text),[2]}return[2,this.request("/v1/streaming.task",{text:j.text,session_id:this.sessionId,task_mode:j.taskMode,task_type:j.taskType})]})})},V.prototype.startListening=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(j){return[2,this.request("/v1/streaming.start_listening",{session_id:this.sessionId})]})})},V.prototype.stopListening=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(j){return[2,this.request("/v1/streaming.stop_listening",{session_id:this.sessionId})]})})},V.prototype.interrupt=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(j){return[2,this.request("/v1/streaming.interrupt",{session_id:this.sessionId})]})})},V.prototype.stopAvatar=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(j){return this.closeVoiceChat(),this.connectionQualityIndicator.stop(),this.voiceChat=null,this.webSocket&&(this.webSocket.close(),this.webSocket=null),[2,this.request("/v1/streaming.stop",{session_id:this.sessionId})]})})},V.prototype.keepAlive=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(j){return[2,this.request("/v1/streaming.keep_alive",{session_id:this.sessionId})]})})},V.prototype.on=function(j,U){return this.eventTarget.addEventListener(j,U),this},V.prototype.off=function(j,U){return this.eventTarget.removeEventListener(j,U),this},V.prototype.sendLivekitMessage=function(j){return __awaiter(this,void 0,void 0,function(){var U;return __generator(this,function(F){return this.room?(U=new TextEncoder().encode(JSON.stringify(j)),this.room.localParticipant.publishData(U,{reliable:!0}),[2]):[2]})})},V.prototype.sendWebsocketMessage=function(j){return __awaiter(this,void 0,void 0,function(){var U,F,B,q;return __generator(this,function(z){return!this.webSocket||!this.audioRawFrame?[2]:(U=(B=this.audioRawFrame)===null||B===void 0?void 0:B.create({text:{text:j}}),F=new Uint8Array((q=this.audioRawFrame)===null||q===void 0?void 0:q.encode(U).finish()),this.webSocket.send(F),[2])})})},V.prototype.initVoiceChat=function(j){if(j===VoiceChatTransport.WEBSOCKET){if(this.loadAudioRawFrame(),!this.audioRawFrame||!this.webSocket)return;this.voiceChat=VoiceChatFactory.createWebSocketVoiceChat({webSocket:this.webSocket,audioRawFrame:this.audioRawFrame})}else{if(!this.room)return;this.voiceChat=VoiceChatFactory.createLiveKitVoiceChat({room:this.room})}},V.prototype.request=function(j,U,F){return __awaiter(this,void 0,void 0,function(){var B,q,z,G;return __generator(this,function(Y){switch(Y.label){case 0:return Y.trys.push([0,5,,6]),[4,fetch(this.getRequestUrl(j),{method:"POST",headers:{Authorization:"Bearer ".concat(this.token),"Content-Type":"application/json"},body:JSON.stringify(U)})];case 1:return B=Y.sent(),B.ok?[3,3]:[4,B.text()];case 2:throw q=Y.sent(),new APIError("API request failed with status ".concat(B.status),B.status,q);case 3:return[4,B.json()];case 4:return z=Y.sent(),[2,z.data];case 5:throw G=Y.sent(),G;case 6:return[2]}})})},V.prototype.emit=function(j,U){var F=new CustomEvent(j,{detail:U});this.eventTarget.dispatchEvent(F)},V.prototype.getRequestUrl=function(j){return"".concat(this.basePath).concat(j)},V.prototype.connectWebSocket=function(j){return __awaiter(this,void 0,void 0,function(){var U,F=this;return __generator(this,function(B){return U="wss://".concat(new URL(this.basePath).hostname,"/v1/ws/streaming.chat?session_id=").concat(this.sessionId,"&session_token=").concat(this.token).concat(this.isLiveKitTransport?"&arch_version=v2":"","&silence_response=").concat(j.useSilencePrompt),this.webSocket=new WebSocket(U),this.webSocket.addEventListener("message",function(q){var z=null;try{z=JSON.parse(q.data)}catch(G){console.error(G);return}z&&F.emit(z.event_type,z)}),this.webSocket.addEventListener("close",function(q){F.webSocket=null}),[2,new Promise(function(q,z){var G,Y;(G=F.webSocket)===null||G===void 0||G.addEventListener("error",function(Q){F.webSocket=null,z(Q)}),(Y=F.webSocket)===null||Y===void 0||Y.addEventListener("open",function(){q(!0)})})]})})},V.prototype.loadAudioRawFrame=function(){return __awaiter(this,void 0,void 0,function(){var j;return __generator(this,function(U){return this.audioRawFrame||(j=protobuf.Root.fromJSON(jsonDescriptor),this.audioRawFrame=j?.lookupType("pipecat.Frame")),[2]})})},V})();const getOrStartConversation=async(V,j)=>{const U=sessionStorage.getItem("sessionId");if(U)try{const B=JSON.parse(U);if(B.sessionId)return B.sessionId}catch(B){console.warn("Failed to parse existing sessionId from sessionStorage:",B),sessionStorage.removeItem("sessionId")}let F=localStorage.getItem("userId");if(!F)try{const B=`${Math.random().toString(36).substr(2,10)}${Date.now()}`;localStorage.setItem("userId",B),F=localStorage.getItem("userId")}catch(B){console.error("Error generating-or saving userId in localStorage:",B),F=`${Math.random().toString(36).substr(2,10)}${Date.now()}`}try{const B=await fetch(`${V}/chat/createSession/${j}/${F}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!B.ok){let Y=`Failed to start conversation: HTTP ${B.status}`;try{Y=(await B.json()).message||Y}catch{}throw new Error(Y)}let q;try{q=await B.json()}catch{throw new Error(" Failed  to  parse  JSON  response  from  createSession  endpoint")}const z=q?.data?.session_id;if(!z)throw new Error(" Session  ID  not  returned  from  backend");console.log(" Session ID:",z);const G={sessionId:z};try{sessionStorage.setItem("sessionId",JSON.stringify(G))}catch(Y){console.warn(" Could  not  save  sessionId  to sessionStorage:",Y)}return G.sessionId}catch(B){console.error(" Error  in  getOrStartConversation fetch/create:",B);try{sessionStorage.removeItem("sessionId")}catch(G){console.warn(" Could  not  remove  sessionId  from sessionStorage:",G)}const z={sessionId:`${Math.random().toString(36).substr(2,10)}${Date.now()}`};try{sessionStorage.setItem("sessionId",JSON.stringify(z))}catch(G){console.warn(" Could  not  save  failover  sessionId  to sessionStorage:",G)}return z.sessionId}},storeVoiceCallMessages=async(V,j,U)=>{try{const F=await fetch(`${V}/chat/setMessages/${j}`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!F.ok){const B=await F.json().catch(()=>({}));throw new Error(B.message||" Failed  to  store  voice  call  messages")}return await F.json()}catch(F){throw console.error(" Error  in storeVoiceCallMessages:",F),F}},sendConversationTextMessage=async(V,j,U)=>{try{const F=await fetch(`${V}/chat/sendMessage/${j}`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:U,userId:localStorage.getItem("userId")})});if(!F.ok){const B=await F.json().catch(()=>({}));throw new Error(B.message||" Failed  to  send  message")}return await F.json()}catch(F){throw console.error(" Error  in sendConversationTextMessage:",F),F}},getAssistantById=async(V,j)=>{try{const U=await fetch(`${V}/assistant/${j}`,{method:"GET",credentials:"include"});if(!U.ok){const F=await U.json().catch(()=>({}));throw new Error(F.message||" Failed  to  fetch  assistant")}return await U.json()}catch(U){throw console.error(" Error  in getAssistantById:",U),U}},bookGoogleMeetForAudioCall=async(V,j)=>{try{const F=await(await fetch(`${V}/google-calendar/book-meeting`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).json();return JSON.stringify(F)}catch(U){throw console.error(" Error  calling webhook:",U),new Error(" Webhook  call  failed")}},getVoiceCallTokenForAudioAgent=async(V,j)=>{try{return await(await fetch(`${V}/voice/getToken`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({voice:j})})).json()}catch(U){console.error("Error fetching Open AI Ephemeral Token for Audio Call ",U)}},checkAdminCalendarPermission=async(V,j)=>{try{return await(await fetch(`${V}/google-calendar/get-admin-calendar-permission`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({assistantOwnerId:j})})).json()}catch(U){console.error(" Error  fetching  admin  calendar permission:",U)}},VideoAgent=reactExports.forwardRef(function V({isVideoMode:j,assistant:U,apiUrl:F,onAiSpeakingChange:B,toggleTimer:q,sessionId:z,setMessages:G,audioEnabled:Y,requestEnd:Q=!1,onEnded:W},Z){const[ee,ne]=reactExports.useState(!1),[ae,se]=reactExports.useState(!1),[de,oe]=reactExports.useState(null),ue=reactExports.useRef(null),[he,ye]=reactExports.useState(null),[fe,pe]=reactExports.useState(null),xe=reactExports.useRef(!0),Ee=reactExports.useRef(!1),ke=reactExports.useRef(!1),Ae=reactExports.useRef(0),be=reactExports.useRef(null),Le=()=>Ae.current;reactExports.useEffect(()=>(xe.current=!0,()=>{xe.current=!1}),[]);const Fe=async Ue=>{const Ye=await fetch(`${F}/heyGen/getAccessToken`,{signal:Ue});if(!Ye.ok)throw new Error("Failed to fetch access token");return(await Ye.json()).data.token},Ne=Ue=>{try{Ue.off(StreamingEvents.USER_START,()=>{}),Ue.off(StreamingEvents.USER_STOP,()=>{}),Ue.off(StreamingEvents.USER_TALKING_MESSAGE,()=>{}),Ue.off(StreamingEvents.AVATAR_START_TALKING,()=>{console.log("AVATAR_START_TALKING")}),Ue.off(StreamingEvents.AVATAR_STOP_TALKING,()=>{console.log("AVATAR_STOP_TALKING")}),Ue.off(StreamingEvents.AVATAR_TALKING_MESSAGE,()=>{}),Ue.off(StreamingEvents.STREAM_DISCONNECTED,()=>{}),Ue.off(StreamingEvents.STREAM_READY,()=>{})}catch{}},Ve=async(Ue,Ye)=>{let le;try{return await Promise.race([Ue,new Promise((we,He)=>le=setTimeout(()=>He(new Error(`Timeout ${Ye}ms`)),Ye))])}finally{clearTimeout(le)}},Te=async(Ue="teardown")=>{if(ke.current)return;ke.current=!0;try{be.current?.abort()}catch{}be.current=null;const Ye=he,le=Le();try{if(Ye){Ne(Ye);try{await Ve(Ye.closeVoiceChat(),4e3)}catch{}try{await Ve(Ye.stopAvatar(),6e3)}catch{}}}catch{}finally{try{de?.getTracks().forEach(we=>we.stop())}catch{}try{ue.current&&(ue.current.srcObject=null)}catch{}if(xe.current&&(ye(null),se(!1),oe(null),ne(!1),pe(null)),Ae.current=le+1,ke.current=!1,typeof W=="function")try{W()}catch{}}},Oe=async()=>{if(!j||!xe.current||Ee.current||ke.current)return;Ee.current=!0,ne(!0),be.current?.abort();const Ue=new AbortController;be.current=Ue;const Ye=Ae.current+1;if(Ae.current=Ye,he&&(await Te("prestart_cleanup"),!xe.current||!j)){Ee.current=!1,ne(!1);return}try{const le=await Fe(Ue.signal);if(!xe.current||Ue.signal.aborted||Ae.current!==Ye)return;const we=new StreamingAvatar({token:le});ye(we);const He=()=>xe.current&&Ae.current===Ye;we.on(StreamingEvents.USER_TALKING_MESSAGE,async at=>{if(!He())return;const $e=at.detail?.message,ht={id:Date.now().toString(),content:$e,type:"text",isUser:!0,time:new Date};G(ut=>[...ut,ht]);try{const ut=await sendConversationTextMessage(F,z,$e),ft=typeof ut.data=="string"?ut.data:"";if(ft&&He()){const Mt={text:ft,task_type:TaskType.REPEAT};we.speak(Mt)}const $t={id:(Date.now()+1).toString(),content:ft,type:"text",isUser:!1,time:new Date};G(Mt=>[...Mt,$t])}catch{}}),we.on(StreamingEvents.AVATAR_START_TALKING,()=>{B()}),we.on(StreamingEvents.AVATAR_STOP_TALKING,()=>{B()}),we.on(StreamingEvents.STREAM_DISCONNECTED,()=>{q(),He()&&Te("stream_disconnected")}),we.on(StreamingEvents.STREAM_READY,at=>{if(!He())return;const $e=at.detail;$e&&(oe($e),se(!0),q())});const ge=await we.createStartAvatar({quality:AvatarQuality.High,avatarName:U?.selectedAvatar?.avatar_id||"SilasHR_public",disableIdleTimeout:!1,knowledgeBase:`Simulate a natural 2 to 4 second thinking delay purely do not say anything while thinking through text, as if a human is preparing to respond in a conversation.

Use multiple spaced ellipses or variations (e.g., "...", "...", ".....") to mimic a gradual pause or hesitation  as if the AI is mentally preparing a response.
 **Strictly** Do not answer to users questions, just be silents and act like thinking and waiting for the next user message.

 Do NOT use meaningless sounds like um, uh, hmm, so, etc. like or any such sounds.

 Only return ellipsis-based pauses, No punctuation, no explanations.

Example Input: "How can I speed up a database query?"
Output:
"... ... ... ... ... ... ... ... ... ... ... ... ..."
Example Input: "Can GPT help with debugging code?"
Output:
"... ... ... ... ... ... ... ... ... ... ... ... ... ..." 
Example Input: "Is IVF painful?"
Output:
"... ... ... ... ... ... ... ... ... ... ... ... ... ..." `,language:"en",voice:{voiceId:U?.videoAgentVoice?.voice_id||"76d38d2180e74bf29baf916be2578bac",rate:1,emotion:VoiceEmotion.SOOTHING}});if(!He()||Ue.signal.aborted)return;if(!ge){ne(!1),Ee.current=!1;return}pe(ge);const We={text:U?.personalityData?.greetingMessage||"Hello! I am your exthalpy AI Assistant, here to guide on our platform  feel free to start the conversation!",task_type:TaskType.REPEAT};if(we.speak(We),await we.startVoiceChat({isInputAudioMuted:!Y}),!He())return;ne(!1)}catch(le){console.error("initializeSession error",le),xe.current&&Ae.current===Ye&&ne(!1)}finally{xe.current&&Ae.current===Ye&&(Ee.current=!1)}};return reactExports.useEffect(()=>{ue.current&&de&&(ue.current.srcObject=de,ue.current.play().catch(()=>{}))},[de]),reactExports.useEffect(()=>(j?Oe():Te("leave_video_mode"),()=>{Te("component_unmount")}),[j]),reactExports.useEffect(()=>{Q&&Te("parent_request_end")},[Q]),reactExports.useEffect(()=>{(async()=>{const Ye=he;if(Ye)try{Y?await Ye.unmuteInputAudio():await Ye.muteInputAudio()}catch{}})()},[Y,he]),j?jsxRuntimeExports.jsx(AnimatePresence,{children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",stiffness:300,damping:30},className:"exthalpy-relative exthalpy-w-full exthalpy-h-full exthalpy-rounded-[20px] exthalpy-shadow-2xl exthalpy-overflow-hidden ",children:ae?jsxRuntimeExports.jsx("video",{ref:ue,autoPlay:!0,playsInline:!0,className:"exthalpy-w-full exthalpy-h-full exthalpy-object-cover"}):jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute exthalpy-inset-0 exthalpy-bg-[#1a1a1a] exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:ee?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},className:"exthalpy-flex exthalpy-flex-col exthalpy-items-center exthalpy-text-white exthalpy-gap-4",children:[jsxRuntimeExports.jsx(LoaderCircle,{size:32,className:"exthalpy-animate-spin"}),jsxRuntimeExports.jsx("p",{className:"exthalpy-m-0 exthalpy-text-base",children:"Connecting to AI Assistant..."})]}):jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},className:"exthalpy-flex exthalpy-flex-col exthalpy-items-center exthalpy-text-white exthalpy-gap-4",children:[jsxRuntimeExports.jsx(VideoOff,{size:48,className:"exthalpy-opacity-50"}),jsxRuntimeExports.jsx("p",{className:"exthalpy-m-0 exthalpy-text-sm",children:"AI Assistant video call ready"})]})})})}):null});function ok$1(){}function unreachable(){}function stringify$1(V,j){const U={};return(V[V.length-1]===""?[...V,""]:V).join((U.padRight?" ":"")+","+(U.padLeft===!1?"":" ")).trim()}const nameRe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,nameReJsx=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,emptyOptions$2={};function name(V,j){return(emptyOptions$2.jsx?nameReJsx:nameRe).test(V)}const re=/[ \t\n\f\r]/g;function whitespace(V){return typeof V=="object"?V.type==="text"?empty$1(V.value):!1:empty$1(V)}function empty$1(V){return V.replace(re,"")===""}let Schema$1=class{constructor(j,U,F){this.normal=U,this.property=j,F&&(this.space=F)}};Schema$1.prototype.normal={},Schema$1.prototype.property={},Schema$1.prototype.space=void 0;function merge(V,j){const U={},F={};for(const B of V)Object.assign(U,B.property),Object.assign(F,B.normal);return new Schema$1(U,F,j)}function normalize$1(V){return V.toLowerCase()}class Info{constructor(j,U){this.attribute=U,this.property=j}}Info.prototype.attribute="",Info.prototype.booleanish=!1,Info.prototype.boolean=!1,Info.prototype.commaOrSpaceSeparated=!1,Info.prototype.commaSeparated=!1,Info.prototype.defined=!1,Info.prototype.mustUseProperty=!1,Info.prototype.number=!1,Info.prototype.overloadedBoolean=!1,Info.prototype.property="",Info.prototype.spaceSeparated=!1,Info.prototype.space=void 0;let powers=0;const boolean$1=increment(),booleanish=increment(),overloadedBoolean=increment(),number$1=increment(),spaceSeparated=increment(),commaSeparated=increment(),commaOrSpaceSeparated=increment();function increment(){return 2**++powers}const types=Object.freeze(Object.defineProperty({__proto__:null,boolean:boolean$1,booleanish,commaOrSpaceSeparated,commaSeparated,number:number$1,overloadedBoolean,spaceSeparated},Symbol.toStringTag,{value:"Module"})),checks=Object.keys(types);class DefinedInfo extends Info{constructor(j,U,F,B){let q=-1;if(super(j,U),mark(this,"space",B),typeof F=="number")for(;++q<checks.length;){const z=checks[q];mark(this,checks[q],(F&types[z])===types[z])}}}DefinedInfo.prototype.defined=!0;function mark(V,j,U){U&&(V[j]=U)}function create(V){const j={},U={};for(const[F,B]of Object.entries(V.properties)){const q=new DefinedInfo(F,V.transform(V.attributes||{},F),B,V.space);V.mustUseProperty&&V.mustUseProperty.includes(F)&&(q.mustUseProperty=!0),j[F]=q,U[normalize$1(F)]=F,U[normalize$1(q.attribute)]=F}return new Schema$1(j,U,V.space)}const aria=create({properties:{ariaActiveDescendant:null,ariaAtomic:booleanish,ariaAutoComplete:null,ariaBusy:booleanish,ariaChecked:booleanish,ariaColCount:number$1,ariaColIndex:number$1,ariaColSpan:number$1,ariaControls:spaceSeparated,ariaCurrent:null,ariaDescribedBy:spaceSeparated,ariaDetails:null,ariaDisabled:booleanish,ariaDropEffect:spaceSeparated,ariaErrorMessage:null,ariaExpanded:booleanish,ariaFlowTo:spaceSeparated,ariaGrabbed:booleanish,ariaHasPopup:null,ariaHidden:booleanish,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated,ariaLevel:number$1,ariaLive:null,ariaModal:booleanish,ariaMultiLine:booleanish,ariaMultiSelectable:booleanish,ariaOrientation:null,ariaOwns:spaceSeparated,ariaPlaceholder:null,ariaPosInSet:number$1,ariaPressed:booleanish,ariaReadOnly:booleanish,ariaRelevant:null,ariaRequired:booleanish,ariaRoleDescription:spaceSeparated,ariaRowCount:number$1,ariaRowIndex:number$1,ariaRowSpan:number$1,ariaSelected:booleanish,ariaSetSize:number$1,ariaSort:null,ariaValueMax:number$1,ariaValueMin:number$1,ariaValueNow:number$1,ariaValueText:null,role:null},transform(V,j){return j==="role"?j:"aria-"+j.slice(4).toLowerCase()}});function caseSensitiveTransform(V,j){return j in V?V[j]:j}function caseInsensitiveTransform(V,j){return caseSensitiveTransform(V,j.toLowerCase())}const html$2=create({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated,acceptCharset:spaceSeparated,accessKey:spaceSeparated,action:null,allow:null,allowFullScreen:boolean$1,allowPaymentRequest:boolean$1,allowUserMedia:boolean$1,alt:null,as:null,async:boolean$1,autoCapitalize:null,autoComplete:spaceSeparated,autoFocus:boolean$1,autoPlay:boolean$1,blocking:spaceSeparated,capture:null,charSet:null,checked:boolean$1,cite:null,className:spaceSeparated,cols:number$1,colSpan:null,content:null,contentEditable:booleanish,controls:boolean$1,controlsList:spaceSeparated,coords:number$1|commaSeparated,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean$1,defer:boolean$1,dir:null,dirName:null,disabled:boolean$1,download:overloadedBoolean,draggable:booleanish,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean$1,formTarget:null,headers:spaceSeparated,height:number$1,hidden:overloadedBoolean,high:number$1,href:null,hrefLang:null,htmlFor:spaceSeparated,httpEquiv:spaceSeparated,id:null,imageSizes:null,imageSrcSet:null,inert:boolean$1,inputMode:null,integrity:null,is:null,isMap:boolean$1,itemId:null,itemProp:spaceSeparated,itemRef:spaceSeparated,itemScope:boolean$1,itemType:spaceSeparated,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean$1,low:number$1,manifest:null,max:null,maxLength:number$1,media:null,method:null,min:null,minLength:number$1,multiple:boolean$1,muted:boolean$1,name:null,nonce:null,noModule:boolean$1,noValidate:boolean$1,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean$1,optimum:number$1,pattern:null,ping:spaceSeparated,placeholder:null,playsInline:boolean$1,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean$1,referrerPolicy:null,rel:spaceSeparated,required:boolean$1,reversed:boolean$1,rows:number$1,rowSpan:number$1,sandbox:spaceSeparated,scope:null,scoped:boolean$1,seamless:boolean$1,selected:boolean$1,shadowRootClonable:boolean$1,shadowRootDelegatesFocus:boolean$1,shadowRootMode:null,shape:null,size:number$1,sizes:null,slot:null,span:number$1,spellCheck:booleanish,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number$1,step:null,style:null,tabIndex:number$1,target:null,title:null,translate:null,type:null,typeMustMatch:boolean$1,useMap:null,value:booleanish,width:number$1,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated,axis:null,background:null,bgColor:null,border:number$1,borderColor:null,bottomMargin:number$1,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean$1,declare:boolean$1,event:null,face:null,frame:null,frameBorder:null,hSpace:number$1,leftMargin:number$1,link:null,longDesc:null,lowSrc:null,marginHeight:number$1,marginWidth:number$1,noResize:boolean$1,noHref:boolean$1,noShade:boolean$1,noWrap:boolean$1,object:null,profile:null,prompt:null,rev:null,rightMargin:number$1,rules:null,scheme:null,scrolling:booleanish,standby:null,summary:null,text:null,topMargin:number$1,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number$1,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean$1,disableRemotePlayback:boolean$1,prefix:null,property:null,results:number$1,security:null,unselectable:null},space:"html",transform:caseInsensitiveTransform}),svg$1=create({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:commaOrSpaceSeparated,accentHeight:number$1,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number$1,amplitude:number$1,arabicForm:null,ascent:number$1,attributeName:null,attributeType:null,azimuth:number$1,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number$1,by:null,calcMode:null,capHeight:number$1,className:spaceSeparated,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number$1,diffuseConstant:number$1,direction:null,display:null,dur:null,divisor:number$1,dominantBaseline:null,download:boolean$1,dx:null,dy:null,edgeMode:null,editable:null,elevation:number$1,enableBackground:null,end:null,event:null,exponent:number$1,externalResourcesRequired:null,fill:null,fillOpacity:number$1,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated,g2:commaSeparated,glyphName:commaSeparated,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number$1,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number$1,horizOriginX:number$1,horizOriginY:number$1,id:null,ideographic:number$1,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number$1,k:number$1,k1:number$1,k2:number$1,k3:number$1,k4:number$1,kernelMatrix:commaOrSpaceSeparated,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number$1,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number$1,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number$1,overlineThickness:number$1,paintOrder:null,panose1:null,path:null,pathLength:number$1,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number$1,pointsAtY:number$1,pointsAtZ:number$1,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated,rev:commaOrSpaceSeparated,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated,requiredFeatures:commaOrSpaceSeparated,requiredFonts:commaOrSpaceSeparated,requiredFormats:commaOrSpaceSeparated,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number$1,specularExponent:number$1,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number$1,strikethroughThickness:number$1,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number$1,strokeOpacity:number$1,strokeWidth:null,style:null,surfaceScale:number$1,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated,tabIndex:number$1,tableValues:null,target:null,targetX:number$1,targetY:number$1,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number$1,underlineThickness:number$1,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number$1,values:null,vAlphabetic:number$1,vMathematical:number$1,vectorEffect:null,vHanging:number$1,vIdeographic:number$1,version:null,vertAdvY:number$1,vertOriginX:number$1,vertOriginY:number$1,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number$1,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:caseSensitiveTransform}),xlink=create({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(V,j){return"xlink:"+j.slice(5).toLowerCase()}}),xmlns=create({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:caseInsensitiveTransform}),xml=create({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(V,j){return"xml:"+j.slice(3).toLowerCase()}}),hastToReact={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},cap$1=/[A-Z]/g,dash=/-[a-z]/g,valid=/^data[-\w.:]+$/i;function find(V,j){const U=normalize$1(j);let F=j,B=Info;if(U in V.normal)return V.property[V.normal[U]];if(U.length>4&&U.slice(0,4)==="data"&&valid.test(j)){if(j.charAt(4)==="-"){const q=j.slice(5).replace(dash,camelcase);F="data"+q.charAt(0).toUpperCase()+q.slice(1)}else{const q=j.slice(4);if(!dash.test(q)){let z=q.replace(cap$1,kebab);z.charAt(0)!=="-"&&(z="-"+z),j="data"+z}}B=DefinedInfo}return new B(F,j)}function kebab(V){return"-"+V.toLowerCase()}function camelcase(V){return V.charAt(1).toUpperCase()}const html$1=merge([aria,html$2,xlink,xmlns,xml],"html"),svg=merge([aria,svg$1,xlink,xmlns,xml],"svg");function stringify(V){return V.join(" ").trim()}var cjs$1={},inlineStyleParser,hasRequiredInlineStyleParser;function requireInlineStyleParser(){if(hasRequiredInlineStyleParser)return inlineStyleParser;hasRequiredInlineStyleParser=1;var V=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,j=/\n/g,U=/^\s*/,F=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,B=/^:\s*/,q=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,z=/^[;\s]*/,G=/^\s+|\s+$/g,Y=`
`,Q="/",W="*",Z="",ee="comment",ne="declaration";inlineStyleParser=function(se,de){if(typeof se!="string")throw new TypeError("First argument must be a string");if(!se)return[];de=de||{};var oe=1,ue=1;function he(Fe){var Ne=Fe.match(j);Ne&&(oe+=Ne.length);var Ve=Fe.lastIndexOf(Y);ue=~Ve?Fe.length-Ve:ue+Fe.length}function ye(){var Fe={line:oe,column:ue};return function(Ne){return Ne.position=new fe(Fe),Ee(),Ne}}function fe(Fe){this.start=Fe,this.end={line:oe,column:ue},this.source=de.source}fe.prototype.content=se;function pe(Fe){var Ne=new Error(de.source+":"+oe+":"+ue+": "+Fe);if(Ne.reason=Fe,Ne.filename=de.source,Ne.line=oe,Ne.column=ue,Ne.source=se,!de.silent)throw Ne}function xe(Fe){var Ne=Fe.exec(se);if(Ne){var Ve=Ne[0];return he(Ve),se=se.slice(Ve.length),Ne}}function Ee(){xe(U)}function ke(Fe){var Ne;for(Fe=Fe||[];Ne=Ae();)Ne!==!1&&Fe.push(Ne);return Fe}function Ae(){var Fe=ye();if(!(Q!=se.charAt(0)||W!=se.charAt(1))){for(var Ne=2;Z!=se.charAt(Ne)&&(W!=se.charAt(Ne)||Q!=se.charAt(Ne+1));)++Ne;if(Ne+=2,Z===se.charAt(Ne-1))return pe("End of comment missing");var Ve=se.slice(2,Ne-2);return ue+=2,he(Ve),se=se.slice(Ne),ue+=2,Fe({type:ee,comment:Ve})}}function be(){var Fe=ye(),Ne=xe(F);if(Ne){if(Ae(),!xe(B))return pe("property missing ':'");var Ve=xe(q),Te=Fe({type:ne,property:ae(Ne[0].replace(V,Z)),value:Ve?ae(Ve[0].replace(V,Z)):Z});return xe(z),Te}}function Le(){var Fe=[];ke(Fe);for(var Ne;Ne=be();)Ne!==!1&&(Fe.push(Ne),ke(Fe));return Fe}return Ee(),Le()};function ae(se){return se?se.replace(G,Z):Z}return inlineStyleParser}var hasRequiredCjs$1;function requireCjs$1(){if(hasRequiredCjs$1)return cjs$1;hasRequiredCjs$1=1;var V=cjs$1&&cjs$1.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(cjs$1,"__esModule",{value:!0}),cjs$1.default=U;var j=V(requireInlineStyleParser());function U(F,B){var q=null;if(!F||typeof F!="string")return q;var z=(0,j.default)(F),G=typeof B=="function";return z.forEach(function(Y){if(Y.type==="declaration"){var Q=Y.property,W=Y.value;G?B(Q,W,Y):W&&(q=q||{},q[Q]=W)}}),q}return cjs$1}var utilities={},hasRequiredUtilities;function requireUtilities(){if(hasRequiredUtilities)return utilities;hasRequiredUtilities=1,Object.defineProperty(utilities,"__esModule",{value:!0}),utilities.camelCase=void 0;var V=/^--[a-zA-Z0-9_-]+$/,j=/-([a-z])/g,U=/^[^-]+$/,F=/^-(webkit|moz|ms|o|khtml)-/,B=/^-(ms)-/,q=function(Q){return!Q||U.test(Q)||V.test(Q)},z=function(Q,W){return W.toUpperCase()},G=function(Q,W){return"".concat(W,"-")},Y=function(Q,W){return W===void 0&&(W={}),q(Q)?Q:(Q=Q.toLowerCase(),W.reactCompat?Q=Q.replace(B,G):Q=Q.replace(F,G),Q.replace(j,z))};return utilities.camelCase=Y,utilities}var cjs,hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var V=cjs&&cjs.__importDefault||function(B){return B&&B.__esModule?B:{default:B}},j=V(requireCjs$1()),U=requireUtilities();function F(B,q){var z={};return!B||typeof B!="string"||(0,j.default)(B,function(G,Y){G&&Y&&(z[(0,U.camelCase)(G,q)]=Y)}),z}return F.default=F,cjs=F,cjs}var cjsExports=requireCjs();const styleToJs=getDefaultExportFromCjs$1(cjsExports),pointEnd=point$2("end"),pointStart=point$2("start");function point$2(V){return j;function j(U){const F=U&&U.position&&U.position[V]||{};if(typeof F.line=="number"&&F.line>0&&typeof F.column=="number"&&F.column>0)return{line:F.line,column:F.column,offset:typeof F.offset=="number"&&F.offset>-1?F.offset:void 0}}}function position$1(V){const j=pointStart(V),U=pointEnd(V);if(j&&U)return{start:j,end:U}}function stringifyPosition(V){return!V||typeof V!="object"?"":"position"in V||"type"in V?position(V.position):"start"in V||"end"in V?position(V):"line"in V||"column"in V?point$1(V):""}function point$1(V){return index(V&&V.line)+":"+index(V&&V.column)}function position(V){return point$1(V&&V.start)+"-"+point$1(V&&V.end)}function index(V){return V&&typeof V=="number"?V:1}class VFileMessage extends Error{constructor(j,U,F){super(),typeof U=="string"&&(F=U,U=void 0);let B="",q={},z=!1;if(U&&("line"in U&&"column"in U?q={place:U}:"start"in U&&"end"in U?q={place:U}:"type"in U?q={ancestors:[U],place:U.position}:q={...U}),typeof j=="string"?B=j:!q.cause&&j&&(z=!0,B=j.message,q.cause=j),!q.ruleId&&!q.source&&typeof F=="string"){const Y=F.indexOf(":");Y===-1?q.ruleId=F:(q.source=F.slice(0,Y),q.ruleId=F.slice(Y+1))}if(!q.place&&q.ancestors&&q.ancestors){const Y=q.ancestors[q.ancestors.length-1];Y&&(q.place=Y.position)}const G=q.place&&"start"in q.place?q.place.start:q.place;this.ancestors=q.ancestors||void 0,this.cause=q.cause||void 0,this.column=G?G.column:void 0,this.fatal=void 0,this.file="",this.message=B,this.line=G?G.line:void 0,this.name=stringifyPosition(q.place)||"1:1",this.place=q.place||void 0,this.reason=this.message,this.ruleId=q.ruleId||void 0,this.source=q.source||void 0,this.stack=z&&q.cause&&typeof q.cause.stack=="string"?q.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}VFileMessage.prototype.file="",VFileMessage.prototype.name="",VFileMessage.prototype.reason="",VFileMessage.prototype.message="",VFileMessage.prototype.stack="",VFileMessage.prototype.column=void 0,VFileMessage.prototype.line=void 0,VFileMessage.prototype.ancestors=void 0,VFileMessage.prototype.cause=void 0,VFileMessage.prototype.fatal=void 0,VFileMessage.prototype.place=void 0,VFileMessage.prototype.ruleId=void 0,VFileMessage.prototype.source=void 0;const own$3={}.hasOwnProperty,emptyMap=new Map,cap=/[A-Z]/g,tableElements=new Set(["table","tbody","thead","tfoot","tr"]),tableCellElement=new Set(["td","th"]),docs="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function toJsxRuntime(V,j){if(!j||j.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const U=j.filePath||void 0;let F;if(j.development){if(typeof j.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");F=developmentCreate(U,j.jsxDEV)}else{if(typeof j.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof j.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");F=productionCreate(U,j.jsx,j.jsxs)}const B={Fragment:j.Fragment,ancestors:[],components:j.components||{},create:F,elementAttributeNameCase:j.elementAttributeNameCase||"react",evaluater:j.createEvaluater?j.createEvaluater():void 0,filePath:U,ignoreInvalidStyle:j.ignoreInvalidStyle||!1,passKeys:j.passKeys!==!1,passNode:j.passNode||!1,schema:j.space==="svg"?svg:html$1,stylePropertyNameCase:j.stylePropertyNameCase||"dom",tableCellAlignToStyle:j.tableCellAlignToStyle!==!1},q=one$1(B,V,void 0);return q&&typeof q!="string"?q:B.create(V,B.Fragment,{children:q||void 0},void 0)}function one$1(V,j,U){if(j.type==="element")return element$1(V,j,U);if(j.type==="mdxFlowExpression"||j.type==="mdxTextExpression")return mdxExpression(V,j);if(j.type==="mdxJsxFlowElement"||j.type==="mdxJsxTextElement")return mdxJsxElement(V,j,U);if(j.type==="mdxjsEsm")return mdxEsm(V,j);if(j.type==="root")return root$2(V,j,U);if(j.type==="text")return text$3(V,j)}function element$1(V,j,U){const F=V.schema;let B=F;j.tagName.toLowerCase()==="svg"&&F.space==="html"&&(B=svg,V.schema=B),V.ancestors.push(j);const q=findComponentFromName(V,j.tagName,!1),z=createElementProps(V,j);let G=createChildren(V,j);return tableElements.has(j.tagName)&&(G=G.filter(function(Y){return typeof Y=="string"?!whitespace(Y):!0})),addNode(V,z,q,j),addChildren(z,G),V.ancestors.pop(),V.schema=F,V.create(j,q,z,U)}function mdxExpression(V,j){if(j.data&&j.data.estree&&V.evaluater){const F=j.data.estree.body[0];return F.type,V.evaluater.evaluateExpression(F.expression)}crashEstree(V,j.position)}function mdxEsm(V,j){if(j.data&&j.data.estree&&V.evaluater)return V.evaluater.evaluateProgram(j.data.estree);crashEstree(V,j.position)}function mdxJsxElement(V,j,U){const F=V.schema;let B=F;j.name==="svg"&&F.space==="html"&&(B=svg,V.schema=B),V.ancestors.push(j);const q=j.name===null?V.Fragment:findComponentFromName(V,j.name,!0),z=createJsxElementProps(V,j),G=createChildren(V,j);return addNode(V,z,q,j),addChildren(z,G),V.ancestors.pop(),V.schema=F,V.create(j,q,z,U)}function root$2(V,j,U){const F={};return addChildren(F,createChildren(V,j)),V.create(j,V.Fragment,F,U)}function text$3(V,j){return j.value}function addNode(V,j,U,F){typeof U!="string"&&U!==V.Fragment&&V.passNode&&(j.node=F)}function addChildren(V,j){if(j.length>0){const U=j.length>1?j:j[0];U&&(V.children=U)}}function productionCreate(V,j,U){return F;function F(B,q,z,G){const Q=Array.isArray(z.children)?U:j;return G?Q(q,z,G):Q(q,z)}}function developmentCreate(V,j){return U;function U(F,B,q,z){const G=Array.isArray(q.children),Y=pointStart(F);return j(B,q,z,G,{columnNumber:Y?Y.column-1:void 0,fileName:V,lineNumber:Y?Y.line:void 0},void 0)}}function createElementProps(V,j){const U={};let F,B;for(B in j.properties)if(B!=="children"&&own$3.call(j.properties,B)){const q=createProperty(V,B,j.properties[B]);if(q){const[z,G]=q;V.tableCellAlignToStyle&&z==="align"&&typeof G=="string"&&tableCellElement.has(j.tagName)?F=G:U[z]=G}}if(F){const q=U.style||(U.style={});q[V.stylePropertyNameCase==="css"?"text-align":"textAlign"]=F}return U}function createJsxElementProps(V,j){const U={};for(const F of j.attributes)if(F.type==="mdxJsxExpressionAttribute")if(F.data&&F.data.estree&&V.evaluater){const q=F.data.estree.body[0];q.type;const z=q.expression;z.type;const G=z.properties[0];G.type,Object.assign(U,V.evaluater.evaluateExpression(G.argument))}else crashEstree(V,j.position);else{const B=F.name;let q;if(F.value&&typeof F.value=="object")if(F.value.data&&F.value.data.estree&&V.evaluater){const G=F.value.data.estree.body[0];G.type,q=V.evaluater.evaluateExpression(G.expression)}else crashEstree(V,j.position);else q=F.value===null?!0:F.value;U[B]=q}return U}function createChildren(V,j){const U=[];let F=-1;const B=V.passKeys?new Map:emptyMap;for(;++F<j.children.length;){const q=j.children[F];let z;if(V.passKeys){const Y=q.type==="element"?q.tagName:q.type==="mdxJsxFlowElement"||q.type==="mdxJsxTextElement"?q.name:void 0;if(Y){const Q=B.get(Y)||0;z=Y+"-"+Q,B.set(Y,Q+1)}}const G=one$1(V,q,z);G!==void 0&&U.push(G)}return U}function createProperty(V,j,U){const F=find(V.schema,j);if(!(U==null||typeof U=="number"&&Number.isNaN(U))){if(Array.isArray(U)&&(U=F.commaSeparated?stringify$1(U):stringify(U)),F.property==="style"){let B=typeof U=="object"?U:parseStyle(V,String(U));return V.stylePropertyNameCase==="css"&&(B=transformStylesToCssCasing(B)),["style",B]}return[V.elementAttributeNameCase==="react"&&F.space?hastToReact[F.property]||F.property:F.attribute,U]}}function parseStyle(V,j){try{return styleToJs(j,{reactCompat:!0})}catch(U){if(V.ignoreInvalidStyle)return{};const F=U,B=new VFileMessage("Cannot parse `style` attribute",{ancestors:V.ancestors,cause:F,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw B.file=V.filePath||void 0,B.url=docs+"#cannot-parse-style-attribute",B}}function findComponentFromName(V,j,U){let F;if(!U)F={type:"Literal",value:j};else if(j.includes(".")){const B=j.split(".");let q=-1,z;for(;++q<B.length;){const G=name(B[q])?{type:"Identifier",name:B[q]}:{type:"Literal",value:B[q]};z=z?{type:"MemberExpression",object:z,property:G,computed:!!(q&&G.type==="Literal"),optional:!1}:G}F=z}else F=name(j)&&!/^[a-z]/.test(j)?{type:"Identifier",name:j}:{type:"Literal",value:j};if(F.type==="Literal"){const B=F.value;return own$3.call(V.components,B)?V.components[B]:B}if(V.evaluater)return V.evaluater.evaluateExpression(F);crashEstree(V)}function crashEstree(V,j){const U=new VFileMessage("Cannot handle MDX estrees without `createEvaluater`",{ancestors:V.ancestors,place:j,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw U.file=V.filePath||void 0,U.url=docs+"#cannot-handle-mdx-estrees-without-createevaluater",U}function transformStylesToCssCasing(V){const j={};let U;for(U in V)own$3.call(V,U)&&(j[transformStyleToCssCasing(U)]=V[U]);return j}function transformStyleToCssCasing(V){let j=V.replace(cap,toDash);return j.slice(0,3)==="ms-"&&(j="-"+j),j}function toDash(V){return"-"+V.toLowerCase()}const urlAttributes={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},emptyOptions$1={};function toString$3(V,j){const U=emptyOptions$1,F=typeof U.includeImageAlt=="boolean"?U.includeImageAlt:!0,B=typeof U.includeHtml=="boolean"?U.includeHtml:!0;return one(V,F,B)}function one(V,j,U){if(node(V)){if("value"in V)return V.type==="html"&&!U?"":V.value;if(j&&"alt"in V&&V.alt)return V.alt;if("children"in V)return all(V.children,j,U)}return Array.isArray(V)?all(V,j,U):""}function all(V,j,U){const F=[];let B=-1;for(;++B<V.length;)F[B]=one(V[B],j,U);return F.join("")}function node(V){return!!(V&&typeof V=="object")}const element=document.createElement("i");function decodeNamedCharacterReference(V){const j="&"+V+";";element.innerHTML=j;const U=element.textContent;return U.charCodeAt(U.length-1)===59&&V!=="semi"||U===j?!1:U}function splice$1(V,j,U,F){const B=V.length;let q=0,z;if(j<0?j=-j>B?0:B+j:j=j>B?B:j,U=U>0?U:0,F.length<1e4)z=Array.from(F),z.unshift(j,U),V.splice(...z);else for(U&&V.splice(j,U);q<F.length;)z=F.slice(q,q+1e4),z.unshift(j,0),V.splice(...z),q+=1e4,j+=1e4}function push(V,j){return V.length>0?(splice$1(V,V.length,0,j),V):j}const hasOwnProperty$b={}.hasOwnProperty;function combineExtensions(V){const j={};let U=-1;for(;++U<V.length;)syntaxExtension(j,V[U]);return j}function syntaxExtension(V,j){let U;for(U in j){const B=(hasOwnProperty$b.call(V,U)?V[U]:void 0)||(V[U]={}),q=j[U];let z;if(q)for(z in q){hasOwnProperty$b.call(B,z)||(B[z]=[]);const G=q[z];constructs(B[z],Array.isArray(G)?G:G?[G]:[])}}}function constructs(V,j){let U=-1;const F=[];for(;++U<j.length;)(j[U].add==="after"?V:F).push(j[U]);splice$1(V,0,0,F)}function decodeNumericCharacterReference(V,j){const U=Number.parseInt(V,j);return U<9||U===11||U>13&&U<32||U>126&&U<160||U>55295&&U<57344||U>64975&&U<65008||(U&65535)===65535||(U&65535)===65534||U>1114111?"":String.fromCodePoint(U)}function normalizeIdentifier(V){return V.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const asciiAlpha=regexCheck(/[A-Za-z]/),asciiAlphanumeric=regexCheck(/[\dA-Za-z]/),asciiAtext=regexCheck(/[#-'*+\--9=?A-Z^-~]/);function asciiControl(V){return V!==null&&(V<32||V===127)}const asciiDigit=regexCheck(/\d/),asciiHexDigit=regexCheck(/[\dA-Fa-f]/),asciiPunctuation=regexCheck(/[!-/:-@[-`{-~]/);function markdownLineEnding(V){return V!==null&&V<-2}function markdownLineEndingOrSpace(V){return V!==null&&(V<0||V===32)}function markdownSpace(V){return V===-2||V===-1||V===32}const unicodePunctuation=regexCheck(new RegExp("\\p{P}|\\p{S}","u")),unicodeWhitespace=regexCheck(/\s/);function regexCheck(V){return j;function j(U){return U!==null&&U>-1&&V.test(String.fromCharCode(U))}}function normalizeUri(V){const j=[];let U=-1,F=0,B=0;for(;++U<V.length;){const q=V.charCodeAt(U);let z="";if(q===37&&asciiAlphanumeric(V.charCodeAt(U+1))&&asciiAlphanumeric(V.charCodeAt(U+2)))B=2;else if(q<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(q))||(z=String.fromCharCode(q));else if(q>55295&&q<57344){const G=V.charCodeAt(U+1);q<56320&&G>56319&&G<57344?(z=String.fromCharCode(q,G),B=1):z=""}else z=String.fromCharCode(q);z&&(j.push(V.slice(F,U),encodeURIComponent(z)),F=U+B+1,z=""),B&&(U+=B,B=0)}return j.join("")+V.slice(F)}function factorySpace(V,j,U,F){const B=F?F-1:Number.POSITIVE_INFINITY;let q=0;return z;function z(Y){return markdownSpace(Y)?(V.enter(U),G(Y)):j(Y)}function G(Y){return markdownSpace(Y)&&q++<B?(V.consume(Y),G):(V.exit(U),j(Y))}}const content$1={tokenize:initializeContent};function initializeContent(V){const j=V.attempt(this.parser.constructs.contentInitial,F,B);let U;return j;function F(G){if(G===null){V.consume(G);return}return V.enter("lineEnding"),V.consume(G),V.exit("lineEnding"),factorySpace(V,j,"linePrefix")}function B(G){return V.enter("paragraph"),q(G)}function q(G){const Y=V.enter("chunkText",{contentType:"text",previous:U});return U&&(U.next=Y),U=Y,z(G)}function z(G){if(G===null){V.exit("chunkText"),V.exit("paragraph"),V.consume(G);return}return markdownLineEnding(G)?(V.consume(G),V.exit("chunkText"),q):(V.consume(G),z)}}const document$2={tokenize:initializeDocument},containerConstruct={tokenize:tokenizeContainer};function initializeDocument(V){const j=this,U=[];let F=0,B,q,z;return G;function G(he){if(F<U.length){const ye=U[F];return j.containerState=ye[1],V.attempt(ye[0].continuation,Y,Q)(he)}return Q(he)}function Y(he){if(F++,j.containerState._closeFlow){j.containerState._closeFlow=void 0,B&&ue();const ye=j.events.length;let fe=ye,pe;for(;fe--;)if(j.events[fe][0]==="exit"&&j.events[fe][1].type==="chunkFlow"){pe=j.events[fe][1].end;break}oe(F);let xe=ye;for(;xe<j.events.length;)j.events[xe][1].end={...pe},xe++;return splice$1(j.events,fe+1,0,j.events.slice(ye)),j.events.length=xe,Q(he)}return G(he)}function Q(he){if(F===U.length){if(!B)return ee(he);if(B.currentConstruct&&B.currentConstruct.concrete)return ae(he);j.interrupt=!!(B.currentConstruct&&!B._gfmTableDynamicInterruptHack)}return j.containerState={},V.check(containerConstruct,W,Z)(he)}function W(he){return B&&ue(),oe(F),ee(he)}function Z(he){return j.parser.lazy[j.now().line]=F!==U.length,z=j.now().offset,ae(he)}function ee(he){return j.containerState={},V.attempt(containerConstruct,ne,ae)(he)}function ne(he){return F++,U.push([j.currentConstruct,j.containerState]),ee(he)}function ae(he){if(he===null){B&&ue(),oe(0),V.consume(he);return}return B=B||j.parser.flow(j.now()),V.enter("chunkFlow",{_tokenizer:B,contentType:"flow",previous:q}),se(he)}function se(he){if(he===null){de(V.exit("chunkFlow"),!0),oe(0),V.consume(he);return}return markdownLineEnding(he)?(V.consume(he),de(V.exit("chunkFlow")),F=0,j.interrupt=void 0,G):(V.consume(he),se)}function de(he,ye){const fe=j.sliceStream(he);if(ye&&fe.push(null),he.previous=q,q&&(q.next=he),q=he,B.defineSkip(he.start),B.write(fe),j.parser.lazy[he.start.line]){let pe=B.events.length;for(;pe--;)if(B.events[pe][1].start.offset<z&&(!B.events[pe][1].end||B.events[pe][1].end.offset>z))return;const xe=j.events.length;let Ee=xe,ke,Ae;for(;Ee--;)if(j.events[Ee][0]==="exit"&&j.events[Ee][1].type==="chunkFlow"){if(ke){Ae=j.events[Ee][1].end;break}ke=!0}for(oe(F),pe=xe;pe<j.events.length;)j.events[pe][1].end={...Ae},pe++;splice$1(j.events,Ee+1,0,j.events.slice(xe)),j.events.length=pe}}function oe(he){let ye=U.length;for(;ye-- >he;){const fe=U[ye];j.containerState=fe[1],fe[0].exit.call(j,V)}U.length=he}function ue(){B.write([null]),q=void 0,B=void 0,j.containerState._closeFlow=void 0}}function tokenizeContainer(V,j,U){return factorySpace(V,V.attempt(this.parser.constructs.document,j,U),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function classifyCharacter(V){if(V===null||markdownLineEndingOrSpace(V)||unicodeWhitespace(V))return 1;if(unicodePunctuation(V))return 2}function resolveAll(V,j,U){const F=[];let B=-1;for(;++B<V.length;){const q=V[B].resolveAll;q&&!F.includes(q)&&(j=q(j,U),F.push(q))}return j}const attention={name:"attention",resolveAll:resolveAllAttention,tokenize:tokenizeAttention};function resolveAllAttention(V,j){let U=-1,F,B,q,z,G,Y,Q,W;for(;++U<V.length;)if(V[U][0]==="enter"&&V[U][1].type==="attentionSequence"&&V[U][1]._close){for(F=U;F--;)if(V[F][0]==="exit"&&V[F][1].type==="attentionSequence"&&V[F][1]._open&&j.sliceSerialize(V[F][1]).charCodeAt(0)===j.sliceSerialize(V[U][1]).charCodeAt(0)){if((V[F][1]._close||V[U][1]._open)&&(V[U][1].end.offset-V[U][1].start.offset)%3&&!((V[F][1].end.offset-V[F][1].start.offset+V[U][1].end.offset-V[U][1].start.offset)%3))continue;Y=V[F][1].end.offset-V[F][1].start.offset>1&&V[U][1].end.offset-V[U][1].start.offset>1?2:1;const Z={...V[F][1].end},ee={...V[U][1].start};movePoint(Z,-Y),movePoint(ee,Y),z={type:Y>1?"strongSequence":"emphasisSequence",start:Z,end:{...V[F][1].end}},G={type:Y>1?"strongSequence":"emphasisSequence",start:{...V[U][1].start},end:ee},q={type:Y>1?"strongText":"emphasisText",start:{...V[F][1].end},end:{...V[U][1].start}},B={type:Y>1?"strong":"emphasis",start:{...z.start},end:{...G.end}},V[F][1].end={...z.start},V[U][1].start={...G.end},Q=[],V[F][1].end.offset-V[F][1].start.offset&&(Q=push(Q,[["enter",V[F][1],j],["exit",V[F][1],j]])),Q=push(Q,[["enter",B,j],["enter",z,j],["exit",z,j],["enter",q,j]]),Q=push(Q,resolveAll(j.parser.constructs.insideSpan.null,V.slice(F+1,U),j)),Q=push(Q,[["exit",q,j],["enter",G,j],["exit",G,j],["exit",B,j]]),V[U][1].end.offset-V[U][1].start.offset?(W=2,Q=push(Q,[["enter",V[U][1],j],["exit",V[U][1],j]])):W=0,splice$1(V,F-1,U-F+3,Q),U=F+Q.length-W-2;break}}for(U=-1;++U<V.length;)V[U][1].type==="attentionSequence"&&(V[U][1].type="data");return V}function tokenizeAttention(V,j){const U=this.parser.constructs.attentionMarkers.null,F=this.previous,B=classifyCharacter(F);let q;return z;function z(Y){return q=Y,V.enter("attentionSequence"),G(Y)}function G(Y){if(Y===q)return V.consume(Y),G;const Q=V.exit("attentionSequence"),W=classifyCharacter(Y),Z=!W||W===2&&B||U.includes(Y),ee=!B||B===2&&W||U.includes(F);return Q._open=!!(q===42?Z:Z&&(B||!ee)),Q._close=!!(q===42?ee:ee&&(W||!Z)),j(Y)}}function movePoint(V,j){V.column+=j,V.offset+=j,V._bufferIndex+=j}const autolink={name:"autolink",tokenize:tokenizeAutolink};function tokenizeAutolink(V,j,U){let F=0;return B;function B(ne){return V.enter("autolink"),V.enter("autolinkMarker"),V.consume(ne),V.exit("autolinkMarker"),V.enter("autolinkProtocol"),q}function q(ne){return asciiAlpha(ne)?(V.consume(ne),z):ne===64?U(ne):Q(ne)}function z(ne){return ne===43||ne===45||ne===46||asciiAlphanumeric(ne)?(F=1,G(ne)):Q(ne)}function G(ne){return ne===58?(V.consume(ne),F=0,Y):(ne===43||ne===45||ne===46||asciiAlphanumeric(ne))&&F++<32?(V.consume(ne),G):(F=0,Q(ne))}function Y(ne){return ne===62?(V.exit("autolinkProtocol"),V.enter("autolinkMarker"),V.consume(ne),V.exit("autolinkMarker"),V.exit("autolink"),j):ne===null||ne===32||ne===60||asciiControl(ne)?U(ne):(V.consume(ne),Y)}function Q(ne){return ne===64?(V.consume(ne),W):asciiAtext(ne)?(V.consume(ne),Q):U(ne)}function W(ne){return asciiAlphanumeric(ne)?Z(ne):U(ne)}function Z(ne){return ne===46?(V.consume(ne),F=0,W):ne===62?(V.exit("autolinkProtocol").type="autolinkEmail",V.enter("autolinkMarker"),V.consume(ne),V.exit("autolinkMarker"),V.exit("autolink"),j):ee(ne)}function ee(ne){if((ne===45||asciiAlphanumeric(ne))&&F++<63){const ae=ne===45?ee:Z;return V.consume(ne),ae}return U(ne)}}const blankLine={partial:!0,tokenize:tokenizeBlankLine};function tokenizeBlankLine(V,j,U){return F;function F(q){return markdownSpace(q)?factorySpace(V,B,"linePrefix")(q):B(q)}function B(q){return q===null||markdownLineEnding(q)?j(q):U(q)}}const blockQuote={continuation:{tokenize:tokenizeBlockQuoteContinuation},exit,name:"blockQuote",tokenize:tokenizeBlockQuoteStart};function tokenizeBlockQuoteStart(V,j,U){const F=this;return B;function B(z){if(z===62){const G=F.containerState;return G.open||(V.enter("blockQuote",{_container:!0}),G.open=!0),V.enter("blockQuotePrefix"),V.enter("blockQuoteMarker"),V.consume(z),V.exit("blockQuoteMarker"),q}return U(z)}function q(z){return markdownSpace(z)?(V.enter("blockQuotePrefixWhitespace"),V.consume(z),V.exit("blockQuotePrefixWhitespace"),V.exit("blockQuotePrefix"),j):(V.exit("blockQuotePrefix"),j(z))}}function tokenizeBlockQuoteContinuation(V,j,U){const F=this;return B;function B(z){return markdownSpace(z)?factorySpace(V,q,"linePrefix",F.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(z):q(z)}function q(z){return V.attempt(blockQuote,j,U)(z)}}function exit(V){V.exit("blockQuote")}const characterEscape={name:"characterEscape",tokenize:tokenizeCharacterEscape};function tokenizeCharacterEscape(V,j,U){return F;function F(q){return V.enter("characterEscape"),V.enter("escapeMarker"),V.consume(q),V.exit("escapeMarker"),B}function B(q){return asciiPunctuation(q)?(V.enter("characterEscapeValue"),V.consume(q),V.exit("characterEscapeValue"),V.exit("characterEscape"),j):U(q)}}const characterReference={name:"characterReference",tokenize:tokenizeCharacterReference};function tokenizeCharacterReference(V,j,U){const F=this;let B=0,q,z;return G;function G(Z){return V.enter("characterReference"),V.enter("characterReferenceMarker"),V.consume(Z),V.exit("characterReferenceMarker"),Y}function Y(Z){return Z===35?(V.enter("characterReferenceMarkerNumeric"),V.consume(Z),V.exit("characterReferenceMarkerNumeric"),Q):(V.enter("characterReferenceValue"),q=31,z=asciiAlphanumeric,W(Z))}function Q(Z){return Z===88||Z===120?(V.enter("characterReferenceMarkerHexadecimal"),V.consume(Z),V.exit("characterReferenceMarkerHexadecimal"),V.enter("characterReferenceValue"),q=6,z=asciiHexDigit,W):(V.enter("characterReferenceValue"),q=7,z=asciiDigit,W(Z))}function W(Z){if(Z===59&&B){const ee=V.exit("characterReferenceValue");return z===asciiAlphanumeric&&!decodeNamedCharacterReference(F.sliceSerialize(ee))?U(Z):(V.enter("characterReferenceMarker"),V.consume(Z),V.exit("characterReferenceMarker"),V.exit("characterReference"),j)}return z(Z)&&B++<q?(V.consume(Z),W):U(Z)}}const nonLazyContinuation={partial:!0,tokenize:tokenizeNonLazyContinuation},codeFenced={concrete:!0,name:"codeFenced",tokenize:tokenizeCodeFenced};function tokenizeCodeFenced(V,j,U){const F=this,B={partial:!0,tokenize:fe};let q=0,z=0,G;return Y;function Y(pe){return Q(pe)}function Q(pe){const xe=F.events[F.events.length-1];return q=xe&&xe[1].type==="linePrefix"?xe[2].sliceSerialize(xe[1],!0).length:0,G=pe,V.enter("codeFenced"),V.enter("codeFencedFence"),V.enter("codeFencedFenceSequence"),W(pe)}function W(pe){return pe===G?(z++,V.consume(pe),W):z<3?U(pe):(V.exit("codeFencedFenceSequence"),markdownSpace(pe)?factorySpace(V,Z,"whitespace")(pe):Z(pe))}function Z(pe){return pe===null||markdownLineEnding(pe)?(V.exit("codeFencedFence"),F.interrupt?j(pe):V.check(nonLazyContinuation,se,ye)(pe)):(V.enter("codeFencedFenceInfo"),V.enter("chunkString",{contentType:"string"}),ee(pe))}function ee(pe){return pe===null||markdownLineEnding(pe)?(V.exit("chunkString"),V.exit("codeFencedFenceInfo"),Z(pe)):markdownSpace(pe)?(V.exit("chunkString"),V.exit("codeFencedFenceInfo"),factorySpace(V,ne,"whitespace")(pe)):pe===96&&pe===G?U(pe):(V.consume(pe),ee)}function ne(pe){return pe===null||markdownLineEnding(pe)?Z(pe):(V.enter("codeFencedFenceMeta"),V.enter("chunkString",{contentType:"string"}),ae(pe))}function ae(pe){return pe===null||markdownLineEnding(pe)?(V.exit("chunkString"),V.exit("codeFencedFenceMeta"),Z(pe)):pe===96&&pe===G?U(pe):(V.consume(pe),ae)}function se(pe){return V.attempt(B,ye,de)(pe)}function de(pe){return V.enter("lineEnding"),V.consume(pe),V.exit("lineEnding"),oe}function oe(pe){return q>0&&markdownSpace(pe)?factorySpace(V,ue,"linePrefix",q+1)(pe):ue(pe)}function ue(pe){return pe===null||markdownLineEnding(pe)?V.check(nonLazyContinuation,se,ye)(pe):(V.enter("codeFlowValue"),he(pe))}function he(pe){return pe===null||markdownLineEnding(pe)?(V.exit("codeFlowValue"),ue(pe)):(V.consume(pe),he)}function ye(pe){return V.exit("codeFenced"),j(pe)}function fe(pe,xe,Ee){let ke=0;return Ae;function Ae(Ve){return pe.enter("lineEnding"),pe.consume(Ve),pe.exit("lineEnding"),be}function be(Ve){return pe.enter("codeFencedFence"),markdownSpace(Ve)?factorySpace(pe,Le,"linePrefix",F.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Ve):Le(Ve)}function Le(Ve){return Ve===G?(pe.enter("codeFencedFenceSequence"),Fe(Ve)):Ee(Ve)}function Fe(Ve){return Ve===G?(ke++,pe.consume(Ve),Fe):ke>=z?(pe.exit("codeFencedFenceSequence"),markdownSpace(Ve)?factorySpace(pe,Ne,"whitespace")(Ve):Ne(Ve)):Ee(Ve)}function Ne(Ve){return Ve===null||markdownLineEnding(Ve)?(pe.exit("codeFencedFence"),xe(Ve)):Ee(Ve)}}}function tokenizeNonLazyContinuation(V,j,U){const F=this;return B;function B(z){return z===null?U(z):(V.enter("lineEnding"),V.consume(z),V.exit("lineEnding"),q)}function q(z){return F.parser.lazy[F.now().line]?U(z):j(z)}}const codeIndented={name:"codeIndented",tokenize:tokenizeCodeIndented},furtherStart={partial:!0,tokenize:tokenizeFurtherStart};function tokenizeCodeIndented(V,j,U){const F=this;return B;function B(Q){return V.enter("codeIndented"),factorySpace(V,q,"linePrefix",5)(Q)}function q(Q){const W=F.events[F.events.length-1];return W&&W[1].type==="linePrefix"&&W[2].sliceSerialize(W[1],!0).length>=4?z(Q):U(Q)}function z(Q){return Q===null?Y(Q):markdownLineEnding(Q)?V.attempt(furtherStart,z,Y)(Q):(V.enter("codeFlowValue"),G(Q))}function G(Q){return Q===null||markdownLineEnding(Q)?(V.exit("codeFlowValue"),z(Q)):(V.consume(Q),G)}function Y(Q){return V.exit("codeIndented"),j(Q)}}function tokenizeFurtherStart(V,j,U){const F=this;return B;function B(z){return F.parser.lazy[F.now().line]?U(z):markdownLineEnding(z)?(V.enter("lineEnding"),V.consume(z),V.exit("lineEnding"),B):factorySpace(V,q,"linePrefix",5)(z)}function q(z){const G=F.events[F.events.length-1];return G&&G[1].type==="linePrefix"&&G[2].sliceSerialize(G[1],!0).length>=4?j(z):markdownLineEnding(z)?B(z):U(z)}}const codeText={name:"codeText",previous,resolve:resolveCodeText,tokenize:tokenizeCodeText};function resolveCodeText(V){let j=V.length-4,U=3,F,B;if((V[U][1].type==="lineEnding"||V[U][1].type==="space")&&(V[j][1].type==="lineEnding"||V[j][1].type==="space")){for(F=U;++F<j;)if(V[F][1].type==="codeTextData"){V[U][1].type="codeTextPadding",V[j][1].type="codeTextPadding",U+=2,j-=2;break}}for(F=U-1,j++;++F<=j;)B===void 0?F!==j&&V[F][1].type!=="lineEnding"&&(B=F):(F===j||V[F][1].type==="lineEnding")&&(V[B][1].type="codeTextData",F!==B+2&&(V[B][1].end=V[F-1][1].end,V.splice(B+2,F-B-2),j-=F-B-2,F=B+2),B=void 0);return V}function previous(V){return V!==96||this.events[this.events.length-1][1].type==="characterEscape"}function tokenizeCodeText(V,j,U){let F=0,B,q;return z;function z(Z){return V.enter("codeText"),V.enter("codeTextSequence"),G(Z)}function G(Z){return Z===96?(V.consume(Z),F++,G):(V.exit("codeTextSequence"),Y(Z))}function Y(Z){return Z===null?U(Z):Z===32?(V.enter("space"),V.consume(Z),V.exit("space"),Y):Z===96?(q=V.enter("codeTextSequence"),B=0,W(Z)):markdownLineEnding(Z)?(V.enter("lineEnding"),V.consume(Z),V.exit("lineEnding"),Y):(V.enter("codeTextData"),Q(Z))}function Q(Z){return Z===null||Z===32||Z===96||markdownLineEnding(Z)?(V.exit("codeTextData"),Y(Z)):(V.consume(Z),Q)}function W(Z){return Z===96?(V.consume(Z),B++,W):B===F?(V.exit("codeTextSequence"),V.exit("codeText"),j(Z)):(q.type="codeTextData",Q(Z))}}class SpliceBuffer{constructor(j){this.left=j?[...j]:[],this.right=[]}get(j){if(j<0||j>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+j+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return j<this.left.length?this.left[j]:this.right[this.right.length-j+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(j,U){const F=U??Number.POSITIVE_INFINITY;return F<this.left.length?this.left.slice(j,F):j>this.left.length?this.right.slice(this.right.length-F+this.left.length,this.right.length-j+this.left.length).reverse():this.left.slice(j).concat(this.right.slice(this.right.length-F+this.left.length).reverse())}splice(j,U,F){const B=U||0;this.setCursor(Math.trunc(j));const q=this.right.splice(this.right.length-B,Number.POSITIVE_INFINITY);return F&&chunkedPush(this.left,F),q.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(j){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(j)}pushMany(j){this.setCursor(Number.POSITIVE_INFINITY),chunkedPush(this.left,j)}unshift(j){this.setCursor(0),this.right.push(j)}unshiftMany(j){this.setCursor(0),chunkedPush(this.right,j.reverse())}setCursor(j){if(!(j===this.left.length||j>this.left.length&&this.right.length===0||j<0&&this.left.length===0))if(j<this.left.length){const U=this.left.splice(j,Number.POSITIVE_INFINITY);chunkedPush(this.right,U.reverse())}else{const U=this.right.splice(this.left.length+this.right.length-j,Number.POSITIVE_INFINITY);chunkedPush(this.left,U.reverse())}}}function chunkedPush(V,j){let U=0;if(j.length<1e4)V.push(...j);else for(;U<j.length;)V.push(...j.slice(U,U+1e4)),U+=1e4}function subtokenize(V){const j={};let U=-1,F,B,q,z,G,Y,Q;const W=new SpliceBuffer(V);for(;++U<W.length;){for(;U in j;)U=j[U];if(F=W.get(U),U&&F[1].type==="chunkFlow"&&W.get(U-1)[1].type==="listItemPrefix"&&(Y=F[1]._tokenizer.events,q=0,q<Y.length&&Y[q][1].type==="lineEndingBlank"&&(q+=2),q<Y.length&&Y[q][1].type==="content"))for(;++q<Y.length&&Y[q][1].type!=="content";)Y[q][1].type==="chunkText"&&(Y[q][1]._isInFirstContentOfListItem=!0,q++);if(F[0]==="enter")F[1].contentType&&(Object.assign(j,subcontent(W,U)),U=j[U],Q=!0);else if(F[1]._container){for(q=U,B=void 0;q--;)if(z=W.get(q),z[1].type==="lineEnding"||z[1].type==="lineEndingBlank")z[0]==="enter"&&(B&&(W.get(B)[1].type="lineEndingBlank"),z[1].type="lineEnding",B=q);else if(!(z[1].type==="linePrefix"||z[1].type==="listItemIndent"))break;B&&(F[1].end={...W.get(B)[1].start},G=W.slice(B,U),G.unshift(F),W.splice(B,U-B+1,G))}}return splice$1(V,0,Number.POSITIVE_INFINITY,W.slice(0)),!Q}function subcontent(V,j){const U=V.get(j)[1],F=V.get(j)[2];let B=j-1;const q=[];let z=U._tokenizer;z||(z=F.parser[U.contentType](U.start),U._contentTypeTextTrailing&&(z._contentTypeTextTrailing=!0));const G=z.events,Y=[],Q={};let W,Z,ee=-1,ne=U,ae=0,se=0;const de=[se];for(;ne;){for(;V.get(++B)[1]!==ne;);q.push(B),ne._tokenizer||(W=F.sliceStream(ne),ne.next||W.push(null),Z&&z.defineSkip(ne.start),ne._isInFirstContentOfListItem&&(z._gfmTasklistFirstContentOfListItem=!0),z.write(W),ne._isInFirstContentOfListItem&&(z._gfmTasklistFirstContentOfListItem=void 0)),Z=ne,ne=ne.next}for(ne=U;++ee<G.length;)G[ee][0]==="exit"&&G[ee-1][0]==="enter"&&G[ee][1].type===G[ee-1][1].type&&G[ee][1].start.line!==G[ee][1].end.line&&(se=ee+1,de.push(se),ne._tokenizer=void 0,ne.previous=void 0,ne=ne.next);for(z.events=[],ne?(ne._tokenizer=void 0,ne.previous=void 0):de.pop(),ee=de.length;ee--;){const oe=G.slice(de[ee],de[ee+1]),ue=q.pop();Y.push([ue,ue+oe.length-1]),V.splice(ue,2,oe)}for(Y.reverse(),ee=-1;++ee<Y.length;)Q[ae+Y[ee][0]]=ae+Y[ee][1],ae+=Y[ee][1]-Y[ee][0]-1;return Q}const content={resolve:resolveContent,tokenize:tokenizeContent},continuationConstruct={partial:!0,tokenize:tokenizeContinuation};function resolveContent(V){return subtokenize(V),V}function tokenizeContent(V,j){let U;return F;function F(G){return V.enter("content"),U=V.enter("chunkContent",{contentType:"content"}),B(G)}function B(G){return G===null?q(G):markdownLineEnding(G)?V.check(continuationConstruct,z,q)(G):(V.consume(G),B)}function q(G){return V.exit("chunkContent"),V.exit("content"),j(G)}function z(G){return V.consume(G),V.exit("chunkContent"),U.next=V.enter("chunkContent",{contentType:"content",previous:U}),U=U.next,B}}function tokenizeContinuation(V,j,U){const F=this;return B;function B(z){return V.exit("chunkContent"),V.enter("lineEnding"),V.consume(z),V.exit("lineEnding"),factorySpace(V,q,"linePrefix")}function q(z){if(z===null||markdownLineEnding(z))return U(z);const G=F.events[F.events.length-1];return!F.parser.constructs.disable.null.includes("codeIndented")&&G&&G[1].type==="linePrefix"&&G[2].sliceSerialize(G[1],!0).length>=4?j(z):V.interrupt(F.parser.constructs.flow,U,j)(z)}}function factoryDestination(V,j,U,F,B,q,z,G,Y){const Q=Y||Number.POSITIVE_INFINITY;let W=0;return Z;function Z(oe){return oe===60?(V.enter(F),V.enter(B),V.enter(q),V.consume(oe),V.exit(q),ee):oe===null||oe===32||oe===41||asciiControl(oe)?U(oe):(V.enter(F),V.enter(z),V.enter(G),V.enter("chunkString",{contentType:"string"}),se(oe))}function ee(oe){return oe===62?(V.enter(q),V.consume(oe),V.exit(q),V.exit(B),V.exit(F),j):(V.enter(G),V.enter("chunkString",{contentType:"string"}),ne(oe))}function ne(oe){return oe===62?(V.exit("chunkString"),V.exit(G),ee(oe)):oe===null||oe===60||markdownLineEnding(oe)?U(oe):(V.consume(oe),oe===92?ae:ne)}function ae(oe){return oe===60||oe===62||oe===92?(V.consume(oe),ne):ne(oe)}function se(oe){return!W&&(oe===null||oe===41||markdownLineEndingOrSpace(oe))?(V.exit("chunkString"),V.exit(G),V.exit(z),V.exit(F),j(oe)):W<Q&&oe===40?(V.consume(oe),W++,se):oe===41?(V.consume(oe),W--,se):oe===null||oe===32||oe===40||asciiControl(oe)?U(oe):(V.consume(oe),oe===92?de:se)}function de(oe){return oe===40||oe===41||oe===92?(V.consume(oe),se):se(oe)}}function factoryLabel(V,j,U,F,B,q){const z=this;let G=0,Y;return Q;function Q(ne){return V.enter(F),V.enter(B),V.consume(ne),V.exit(B),V.enter(q),W}function W(ne){return G>999||ne===null||ne===91||ne===93&&!Y||ne===94&&!G&&"_hiddenFootnoteSupport"in z.parser.constructs?U(ne):ne===93?(V.exit(q),V.enter(B),V.consume(ne),V.exit(B),V.exit(F),j):markdownLineEnding(ne)?(V.enter("lineEnding"),V.consume(ne),V.exit("lineEnding"),W):(V.enter("chunkString",{contentType:"string"}),Z(ne))}function Z(ne){return ne===null||ne===91||ne===93||markdownLineEnding(ne)||G++>999?(V.exit("chunkString"),W(ne)):(V.consume(ne),Y||(Y=!markdownSpace(ne)),ne===92?ee:Z)}function ee(ne){return ne===91||ne===92||ne===93?(V.consume(ne),G++,Z):Z(ne)}}function factoryTitle(V,j,U,F,B,q){let z;return G;function G(ee){return ee===34||ee===39||ee===40?(V.enter(F),V.enter(B),V.consume(ee),V.exit(B),z=ee===40?41:ee,Y):U(ee)}function Y(ee){return ee===z?(V.enter(B),V.consume(ee),V.exit(B),V.exit(F),j):(V.enter(q),Q(ee))}function Q(ee){return ee===z?(V.exit(q),Y(z)):ee===null?U(ee):markdownLineEnding(ee)?(V.enter("lineEnding"),V.consume(ee),V.exit("lineEnding"),factorySpace(V,Q,"linePrefix")):(V.enter("chunkString",{contentType:"string"}),W(ee))}function W(ee){return ee===z||ee===null||markdownLineEnding(ee)?(V.exit("chunkString"),Q(ee)):(V.consume(ee),ee===92?Z:W)}function Z(ee){return ee===z||ee===92?(V.consume(ee),W):W(ee)}}function factoryWhitespace(V,j){let U;return F;function F(B){return markdownLineEnding(B)?(V.enter("lineEnding"),V.consume(B),V.exit("lineEnding"),U=!0,F):markdownSpace(B)?factorySpace(V,F,U?"linePrefix":"lineSuffix")(B):j(B)}}const definition={name:"definition",tokenize:tokenizeDefinition},titleBefore={partial:!0,tokenize:tokenizeTitleBefore};function tokenizeDefinition(V,j,U){const F=this;let B;return q;function q(ne){return V.enter("definition"),z(ne)}function z(ne){return factoryLabel.call(F,V,G,U,"definitionLabel","definitionLabelMarker","definitionLabelString")(ne)}function G(ne){return B=normalizeIdentifier(F.sliceSerialize(F.events[F.events.length-1][1]).slice(1,-1)),ne===58?(V.enter("definitionMarker"),V.consume(ne),V.exit("definitionMarker"),Y):U(ne)}function Y(ne){return markdownLineEndingOrSpace(ne)?factoryWhitespace(V,Q)(ne):Q(ne)}function Q(ne){return factoryDestination(V,W,U,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(ne)}function W(ne){return V.attempt(titleBefore,Z,Z)(ne)}function Z(ne){return markdownSpace(ne)?factorySpace(V,ee,"whitespace")(ne):ee(ne)}function ee(ne){return ne===null||markdownLineEnding(ne)?(V.exit("definition"),F.parser.defined.push(B),j(ne)):U(ne)}}function tokenizeTitleBefore(V,j,U){return F;function F(G){return markdownLineEndingOrSpace(G)?factoryWhitespace(V,B)(G):U(G)}function B(G){return factoryTitle(V,q,U,"definitionTitle","definitionTitleMarker","definitionTitleString")(G)}function q(G){return markdownSpace(G)?factorySpace(V,z,"whitespace")(G):z(G)}function z(G){return G===null||markdownLineEnding(G)?j(G):U(G)}}const hardBreakEscape={name:"hardBreakEscape",tokenize:tokenizeHardBreakEscape};function tokenizeHardBreakEscape(V,j,U){return F;function F(q){return V.enter("hardBreakEscape"),V.consume(q),B}function B(q){return markdownLineEnding(q)?(V.exit("hardBreakEscape"),j(q)):U(q)}}const headingAtx={name:"headingAtx",resolve:resolveHeadingAtx,tokenize:tokenizeHeadingAtx};function resolveHeadingAtx(V,j){let U=V.length-2,F=3,B,q;return V[F][1].type==="whitespace"&&(F+=2),U-2>F&&V[U][1].type==="whitespace"&&(U-=2),V[U][1].type==="atxHeadingSequence"&&(F===U-1||U-4>F&&V[U-2][1].type==="whitespace")&&(U-=F+1===U?2:4),U>F&&(B={type:"atxHeadingText",start:V[F][1].start,end:V[U][1].end},q={type:"chunkText",start:V[F][1].start,end:V[U][1].end,contentType:"text"},splice$1(V,F,U-F+1,[["enter",B,j],["enter",q,j],["exit",q,j],["exit",B,j]])),V}function tokenizeHeadingAtx(V,j,U){let F=0;return B;function B(W){return V.enter("atxHeading"),q(W)}function q(W){return V.enter("atxHeadingSequence"),z(W)}function z(W){return W===35&&F++<6?(V.consume(W),z):W===null||markdownLineEndingOrSpace(W)?(V.exit("atxHeadingSequence"),G(W)):U(W)}function G(W){return W===35?(V.enter("atxHeadingSequence"),Y(W)):W===null||markdownLineEnding(W)?(V.exit("atxHeading"),j(W)):markdownSpace(W)?factorySpace(V,G,"whitespace")(W):(V.enter("atxHeadingText"),Q(W))}function Y(W){return W===35?(V.consume(W),Y):(V.exit("atxHeadingSequence"),G(W))}function Q(W){return W===null||W===35||markdownLineEndingOrSpace(W)?(V.exit("atxHeadingText"),G(W)):(V.consume(W),Q)}}const htmlBlockNames=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],htmlRawNames=["pre","script","style","textarea"],htmlFlow={concrete:!0,name:"htmlFlow",resolveTo:resolveToHtmlFlow,tokenize:tokenizeHtmlFlow},blankLineBefore={partial:!0,tokenize:tokenizeBlankLineBefore},nonLazyContinuationStart={partial:!0,tokenize:tokenizeNonLazyContinuationStart};function resolveToHtmlFlow(V){let j=V.length;for(;j--&&!(V[j][0]==="enter"&&V[j][1].type==="htmlFlow"););return j>1&&V[j-2][1].type==="linePrefix"&&(V[j][1].start=V[j-2][1].start,V[j+1][1].start=V[j-2][1].start,V.splice(j-2,2)),V}function tokenizeHtmlFlow(V,j,U){const F=this;let B,q,z,G,Y;return Q;function Q(ge){return W(ge)}function W(ge){return V.enter("htmlFlow"),V.enter("htmlFlowData"),V.consume(ge),Z}function Z(ge){return ge===33?(V.consume(ge),ee):ge===47?(V.consume(ge),q=!0,se):ge===63?(V.consume(ge),B=3,F.interrupt?j:le):asciiAlpha(ge)?(V.consume(ge),z=String.fromCharCode(ge),de):U(ge)}function ee(ge){return ge===45?(V.consume(ge),B=2,ne):ge===91?(V.consume(ge),B=5,G=0,ae):asciiAlpha(ge)?(V.consume(ge),B=4,F.interrupt?j:le):U(ge)}function ne(ge){return ge===45?(V.consume(ge),F.interrupt?j:le):U(ge)}function ae(ge){const We="CDATA[";return ge===We.charCodeAt(G++)?(V.consume(ge),G===We.length?F.interrupt?j:Le:ae):U(ge)}function se(ge){return asciiAlpha(ge)?(V.consume(ge),z=String.fromCharCode(ge),de):U(ge)}function de(ge){if(ge===null||ge===47||ge===62||markdownLineEndingOrSpace(ge)){const We=ge===47,at=z.toLowerCase();return!We&&!q&&htmlRawNames.includes(at)?(B=1,F.interrupt?j(ge):Le(ge)):htmlBlockNames.includes(z.toLowerCase())?(B=6,We?(V.consume(ge),oe):F.interrupt?j(ge):Le(ge)):(B=7,F.interrupt&&!F.parser.lazy[F.now().line]?U(ge):q?ue(ge):he(ge))}return ge===45||asciiAlphanumeric(ge)?(V.consume(ge),z+=String.fromCharCode(ge),de):U(ge)}function oe(ge){return ge===62?(V.consume(ge),F.interrupt?j:Le):U(ge)}function ue(ge){return markdownSpace(ge)?(V.consume(ge),ue):Ae(ge)}function he(ge){return ge===47?(V.consume(ge),Ae):ge===58||ge===95||asciiAlpha(ge)?(V.consume(ge),ye):markdownSpace(ge)?(V.consume(ge),he):Ae(ge)}function ye(ge){return ge===45||ge===46||ge===58||ge===95||asciiAlphanumeric(ge)?(V.consume(ge),ye):fe(ge)}function fe(ge){return ge===61?(V.consume(ge),pe):markdownSpace(ge)?(V.consume(ge),fe):he(ge)}function pe(ge){return ge===null||ge===60||ge===61||ge===62||ge===96?U(ge):ge===34||ge===39?(V.consume(ge),Y=ge,xe):markdownSpace(ge)?(V.consume(ge),pe):Ee(ge)}function xe(ge){return ge===Y?(V.consume(ge),Y=null,ke):ge===null||markdownLineEnding(ge)?U(ge):(V.consume(ge),xe)}function Ee(ge){return ge===null||ge===34||ge===39||ge===47||ge===60||ge===61||ge===62||ge===96||markdownLineEndingOrSpace(ge)?fe(ge):(V.consume(ge),Ee)}function ke(ge){return ge===47||ge===62||markdownSpace(ge)?he(ge):U(ge)}function Ae(ge){return ge===62?(V.consume(ge),be):U(ge)}function be(ge){return ge===null||markdownLineEnding(ge)?Le(ge):markdownSpace(ge)?(V.consume(ge),be):U(ge)}function Le(ge){return ge===45&&B===2?(V.consume(ge),Te):ge===60&&B===1?(V.consume(ge),Oe):ge===62&&B===4?(V.consume(ge),we):ge===63&&B===3?(V.consume(ge),le):ge===93&&B===5?(V.consume(ge),Ye):markdownLineEnding(ge)&&(B===6||B===7)?(V.exit("htmlFlowData"),V.check(blankLineBefore,He,Fe)(ge)):ge===null||markdownLineEnding(ge)?(V.exit("htmlFlowData"),Fe(ge)):(V.consume(ge),Le)}function Fe(ge){return V.check(nonLazyContinuationStart,Ne,He)(ge)}function Ne(ge){return V.enter("lineEnding"),V.consume(ge),V.exit("lineEnding"),Ve}function Ve(ge){return ge===null||markdownLineEnding(ge)?Fe(ge):(V.enter("htmlFlowData"),Le(ge))}function Te(ge){return ge===45?(V.consume(ge),le):Le(ge)}function Oe(ge){return ge===47?(V.consume(ge),z="",Ue):Le(ge)}function Ue(ge){if(ge===62){const We=z.toLowerCase();return htmlRawNames.includes(We)?(V.consume(ge),we):Le(ge)}return asciiAlpha(ge)&&z.length<8?(V.consume(ge),z+=String.fromCharCode(ge),Ue):Le(ge)}function Ye(ge){return ge===93?(V.consume(ge),le):Le(ge)}function le(ge){return ge===62?(V.consume(ge),we):ge===45&&B===2?(V.consume(ge),le):Le(ge)}function we(ge){return ge===null||markdownLineEnding(ge)?(V.exit("htmlFlowData"),He(ge)):(V.consume(ge),we)}function He(ge){return V.exit("htmlFlow"),j(ge)}}function tokenizeNonLazyContinuationStart(V,j,U){const F=this;return B;function B(z){return markdownLineEnding(z)?(V.enter("lineEnding"),V.consume(z),V.exit("lineEnding"),q):U(z)}function q(z){return F.parser.lazy[F.now().line]?U(z):j(z)}}function tokenizeBlankLineBefore(V,j,U){return F;function F(B){return V.enter("lineEnding"),V.consume(B),V.exit("lineEnding"),V.attempt(blankLine,j,U)}}const htmlText={name:"htmlText",tokenize:tokenizeHtmlText};function tokenizeHtmlText(V,j,U){const F=this;let B,q,z;return G;function G(le){return V.enter("htmlText"),V.enter("htmlTextData"),V.consume(le),Y}function Y(le){return le===33?(V.consume(le),Q):le===47?(V.consume(le),fe):le===63?(V.consume(le),he):asciiAlpha(le)?(V.consume(le),Ee):U(le)}function Q(le){return le===45?(V.consume(le),W):le===91?(V.consume(le),q=0,ae):asciiAlpha(le)?(V.consume(le),ue):U(le)}function W(le){return le===45?(V.consume(le),ne):U(le)}function Z(le){return le===null?U(le):le===45?(V.consume(le),ee):markdownLineEnding(le)?(z=Z,Oe(le)):(V.consume(le),Z)}function ee(le){return le===45?(V.consume(le),ne):Z(le)}function ne(le){return le===62?Te(le):le===45?ee(le):Z(le)}function ae(le){const we="CDATA[";return le===we.charCodeAt(q++)?(V.consume(le),q===we.length?se:ae):U(le)}function se(le){return le===null?U(le):le===93?(V.consume(le),de):markdownLineEnding(le)?(z=se,Oe(le)):(V.consume(le),se)}function de(le){return le===93?(V.consume(le),oe):se(le)}function oe(le){return le===62?Te(le):le===93?(V.consume(le),oe):se(le)}function ue(le){return le===null||le===62?Te(le):markdownLineEnding(le)?(z=ue,Oe(le)):(V.consume(le),ue)}function he(le){return le===null?U(le):le===63?(V.consume(le),ye):markdownLineEnding(le)?(z=he,Oe(le)):(V.consume(le),he)}function ye(le){return le===62?Te(le):he(le)}function fe(le){return asciiAlpha(le)?(V.consume(le),pe):U(le)}function pe(le){return le===45||asciiAlphanumeric(le)?(V.consume(le),pe):xe(le)}function xe(le){return markdownLineEnding(le)?(z=xe,Oe(le)):markdownSpace(le)?(V.consume(le),xe):Te(le)}function Ee(le){return le===45||asciiAlphanumeric(le)?(V.consume(le),Ee):le===47||le===62||markdownLineEndingOrSpace(le)?ke(le):U(le)}function ke(le){return le===47?(V.consume(le),Te):le===58||le===95||asciiAlpha(le)?(V.consume(le),Ae):markdownLineEnding(le)?(z=ke,Oe(le)):markdownSpace(le)?(V.consume(le),ke):Te(le)}function Ae(le){return le===45||le===46||le===58||le===95||asciiAlphanumeric(le)?(V.consume(le),Ae):be(le)}function be(le){return le===61?(V.consume(le),Le):markdownLineEnding(le)?(z=be,Oe(le)):markdownSpace(le)?(V.consume(le),be):ke(le)}function Le(le){return le===null||le===60||le===61||le===62||le===96?U(le):le===34||le===39?(V.consume(le),B=le,Fe):markdownLineEnding(le)?(z=Le,Oe(le)):markdownSpace(le)?(V.consume(le),Le):(V.consume(le),Ne)}function Fe(le){return le===B?(V.consume(le),B=void 0,Ve):le===null?U(le):markdownLineEnding(le)?(z=Fe,Oe(le)):(V.consume(le),Fe)}function Ne(le){return le===null||le===34||le===39||le===60||le===61||le===96?U(le):le===47||le===62||markdownLineEndingOrSpace(le)?ke(le):(V.consume(le),Ne)}function Ve(le){return le===47||le===62||markdownLineEndingOrSpace(le)?ke(le):U(le)}function Te(le){return le===62?(V.consume(le),V.exit("htmlTextData"),V.exit("htmlText"),j):U(le)}function Oe(le){return V.exit("htmlTextData"),V.enter("lineEnding"),V.consume(le),V.exit("lineEnding"),Ue}function Ue(le){return markdownSpace(le)?factorySpace(V,Ye,"linePrefix",F.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(le):Ye(le)}function Ye(le){return V.enter("htmlTextData"),z(le)}}const labelEnd={name:"labelEnd",resolveAll:resolveAllLabelEnd,resolveTo:resolveToLabelEnd,tokenize:tokenizeLabelEnd},resourceConstruct={tokenize:tokenizeResource},referenceFullConstruct={tokenize:tokenizeReferenceFull},referenceCollapsedConstruct={tokenize:tokenizeReferenceCollapsed};function resolveAllLabelEnd(V){let j=-1;const U=[];for(;++j<V.length;){const F=V[j][1];if(U.push(V[j]),F.type==="labelImage"||F.type==="labelLink"||F.type==="labelEnd"){const B=F.type==="labelImage"?4:2;F.type="data",j+=B}}return V.length!==U.length&&splice$1(V,0,V.length,U),V}function resolveToLabelEnd(V,j){let U=V.length,F=0,B,q,z,G;for(;U--;)if(B=V[U][1],q){if(B.type==="link"||B.type==="labelLink"&&B._inactive)break;V[U][0]==="enter"&&B.type==="labelLink"&&(B._inactive=!0)}else if(z){if(V[U][0]==="enter"&&(B.type==="labelImage"||B.type==="labelLink")&&!B._balanced&&(q=U,B.type!=="labelLink")){F=2;break}}else B.type==="labelEnd"&&(z=U);const Y={type:V[q][1].type==="labelLink"?"link":"image",start:{...V[q][1].start},end:{...V[V.length-1][1].end}},Q={type:"label",start:{...V[q][1].start},end:{...V[z][1].end}},W={type:"labelText",start:{...V[q+F+2][1].end},end:{...V[z-2][1].start}};return G=[["enter",Y,j],["enter",Q,j]],G=push(G,V.slice(q+1,q+F+3)),G=push(G,[["enter",W,j]]),G=push(G,resolveAll(j.parser.constructs.insideSpan.null,V.slice(q+F+4,z-3),j)),G=push(G,[["exit",W,j],V[z-2],V[z-1],["exit",Q,j]]),G=push(G,V.slice(z+1)),G=push(G,[["exit",Y,j]]),splice$1(V,q,V.length,G),V}function tokenizeLabelEnd(V,j,U){const F=this;let B=F.events.length,q,z;for(;B--;)if((F.events[B][1].type==="labelImage"||F.events[B][1].type==="labelLink")&&!F.events[B][1]._balanced){q=F.events[B][1];break}return G;function G(ee){return q?q._inactive?Z(ee):(z=F.parser.defined.includes(normalizeIdentifier(F.sliceSerialize({start:q.end,end:F.now()}))),V.enter("labelEnd"),V.enter("labelMarker"),V.consume(ee),V.exit("labelMarker"),V.exit("labelEnd"),Y):U(ee)}function Y(ee){return ee===40?V.attempt(resourceConstruct,W,z?W:Z)(ee):ee===91?V.attempt(referenceFullConstruct,W,z?Q:Z)(ee):z?W(ee):Z(ee)}function Q(ee){return V.attempt(referenceCollapsedConstruct,W,Z)(ee)}function W(ee){return j(ee)}function Z(ee){return q._balanced=!0,U(ee)}}function tokenizeResource(V,j,U){return F;function F(Z){return V.enter("resource"),V.enter("resourceMarker"),V.consume(Z),V.exit("resourceMarker"),B}function B(Z){return markdownLineEndingOrSpace(Z)?factoryWhitespace(V,q)(Z):q(Z)}function q(Z){return Z===41?W(Z):factoryDestination(V,z,G,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(Z)}function z(Z){return markdownLineEndingOrSpace(Z)?factoryWhitespace(V,Y)(Z):W(Z)}function G(Z){return U(Z)}function Y(Z){return Z===34||Z===39||Z===40?factoryTitle(V,Q,U,"resourceTitle","resourceTitleMarker","resourceTitleString")(Z):W(Z)}function Q(Z){return markdownLineEndingOrSpace(Z)?factoryWhitespace(V,W)(Z):W(Z)}function W(Z){return Z===41?(V.enter("resourceMarker"),V.consume(Z),V.exit("resourceMarker"),V.exit("resource"),j):U(Z)}}function tokenizeReferenceFull(V,j,U){const F=this;return B;function B(G){return factoryLabel.call(F,V,q,z,"reference","referenceMarker","referenceString")(G)}function q(G){return F.parser.defined.includes(normalizeIdentifier(F.sliceSerialize(F.events[F.events.length-1][1]).slice(1,-1)))?j(G):U(G)}function z(G){return U(G)}}function tokenizeReferenceCollapsed(V,j,U){return F;function F(q){return V.enter("reference"),V.enter("referenceMarker"),V.consume(q),V.exit("referenceMarker"),B}function B(q){return q===93?(V.enter("referenceMarker"),V.consume(q),V.exit("referenceMarker"),V.exit("reference"),j):U(q)}}const labelStartImage={name:"labelStartImage",resolveAll:labelEnd.resolveAll,tokenize:tokenizeLabelStartImage};function tokenizeLabelStartImage(V,j,U){const F=this;return B;function B(G){return V.enter("labelImage"),V.enter("labelImageMarker"),V.consume(G),V.exit("labelImageMarker"),q}function q(G){return G===91?(V.enter("labelMarker"),V.consume(G),V.exit("labelMarker"),V.exit("labelImage"),z):U(G)}function z(G){return G===94&&"_hiddenFootnoteSupport"in F.parser.constructs?U(G):j(G)}}const labelStartLink={name:"labelStartLink",resolveAll:labelEnd.resolveAll,tokenize:tokenizeLabelStartLink};function tokenizeLabelStartLink(V,j,U){const F=this;return B;function B(z){return V.enter("labelLink"),V.enter("labelMarker"),V.consume(z),V.exit("labelMarker"),V.exit("labelLink"),q}function q(z){return z===94&&"_hiddenFootnoteSupport"in F.parser.constructs?U(z):j(z)}}const lineEnding={name:"lineEnding",tokenize:tokenizeLineEnding};function tokenizeLineEnding(V,j){return U;function U(F){return V.enter("lineEnding"),V.consume(F),V.exit("lineEnding"),factorySpace(V,j,"linePrefix")}}const thematicBreak$1={name:"thematicBreak",tokenize:tokenizeThematicBreak};function tokenizeThematicBreak(V,j,U){let F=0,B;return q;function q(Q){return V.enter("thematicBreak"),z(Q)}function z(Q){return B=Q,G(Q)}function G(Q){return Q===B?(V.enter("thematicBreakSequence"),Y(Q)):F>=3&&(Q===null||markdownLineEnding(Q))?(V.exit("thematicBreak"),j(Q)):U(Q)}function Y(Q){return Q===B?(V.consume(Q),F++,Y):(V.exit("thematicBreakSequence"),markdownSpace(Q)?factorySpace(V,G,"whitespace")(Q):G(Q))}}const list$1={continuation:{tokenize:tokenizeListContinuation},exit:tokenizeListEnd,name:"list",tokenize:tokenizeListStart},listItemPrefixWhitespaceConstruct={partial:!0,tokenize:tokenizeListItemPrefixWhitespace},indentConstruct={partial:!0,tokenize:tokenizeIndent};function tokenizeListStart(V,j,U){const F=this,B=F.events[F.events.length-1];let q=B&&B[1].type==="linePrefix"?B[2].sliceSerialize(B[1],!0).length:0,z=0;return G;function G(ne){const ae=F.containerState.type||(ne===42||ne===43||ne===45?"listUnordered":"listOrdered");if(ae==="listUnordered"?!F.containerState.marker||ne===F.containerState.marker:asciiDigit(ne)){if(F.containerState.type||(F.containerState.type=ae,V.enter(ae,{_container:!0})),ae==="listUnordered")return V.enter("listItemPrefix"),ne===42||ne===45?V.check(thematicBreak$1,U,Q)(ne):Q(ne);if(!F.interrupt||ne===49)return V.enter("listItemPrefix"),V.enter("listItemValue"),Y(ne)}return U(ne)}function Y(ne){return asciiDigit(ne)&&++z<10?(V.consume(ne),Y):(!F.interrupt||z<2)&&(F.containerState.marker?ne===F.containerState.marker:ne===41||ne===46)?(V.exit("listItemValue"),Q(ne)):U(ne)}function Q(ne){return V.enter("listItemMarker"),V.consume(ne),V.exit("listItemMarker"),F.containerState.marker=F.containerState.marker||ne,V.check(blankLine,F.interrupt?U:W,V.attempt(listItemPrefixWhitespaceConstruct,ee,Z))}function W(ne){return F.containerState.initialBlankLine=!0,q++,ee(ne)}function Z(ne){return markdownSpace(ne)?(V.enter("listItemPrefixWhitespace"),V.consume(ne),V.exit("listItemPrefixWhitespace"),ee):U(ne)}function ee(ne){return F.containerState.size=q+F.sliceSerialize(V.exit("listItemPrefix"),!0).length,j(ne)}}function tokenizeListContinuation(V,j,U){const F=this;return F.containerState._closeFlow=void 0,V.check(blankLine,B,q);function B(G){return F.containerState.furtherBlankLines=F.containerState.furtherBlankLines||F.containerState.initialBlankLine,factorySpace(V,j,"listItemIndent",F.containerState.size+1)(G)}function q(G){return F.containerState.furtherBlankLines||!markdownSpace(G)?(F.containerState.furtherBlankLines=void 0,F.containerState.initialBlankLine=void 0,z(G)):(F.containerState.furtherBlankLines=void 0,F.containerState.initialBlankLine=void 0,V.attempt(indentConstruct,j,z)(G))}function z(G){return F.containerState._closeFlow=!0,F.interrupt=void 0,factorySpace(V,V.attempt(list$1,j,U),"linePrefix",F.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G)}}function tokenizeIndent(V,j,U){const F=this;return factorySpace(V,B,"listItemIndent",F.containerState.size+1);function B(q){const z=F.events[F.events.length-1];return z&&z[1].type==="listItemIndent"&&z[2].sliceSerialize(z[1],!0).length===F.containerState.size?j(q):U(q)}}function tokenizeListEnd(V){V.exit(this.containerState.type)}function tokenizeListItemPrefixWhitespace(V,j,U){const F=this;return factorySpace(V,B,"listItemPrefixWhitespace",F.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function B(q){const z=F.events[F.events.length-1];return!markdownSpace(q)&&z&&z[1].type==="listItemPrefixWhitespace"?j(q):U(q)}}const setextUnderline={name:"setextUnderline",resolveTo:resolveToSetextUnderline,tokenize:tokenizeSetextUnderline};function resolveToSetextUnderline(V,j){let U=V.length,F,B,q;for(;U--;)if(V[U][0]==="enter"){if(V[U][1].type==="content"){F=U;break}V[U][1].type==="paragraph"&&(B=U)}else V[U][1].type==="content"&&V.splice(U,1),!q&&V[U][1].type==="definition"&&(q=U);const z={type:"setextHeading",start:{...V[F][1].start},end:{...V[V.length-1][1].end}};return V[B][1].type="setextHeadingText",q?(V.splice(B,0,["enter",z,j]),V.splice(q+1,0,["exit",V[F][1],j]),V[F][1].end={...V[q][1].end}):V[F][1]=z,V.push(["exit",z,j]),V}function tokenizeSetextUnderline(V,j,U){const F=this;let B;return q;function q(Q){let W=F.events.length,Z;for(;W--;)if(F.events[W][1].type!=="lineEnding"&&F.events[W][1].type!=="linePrefix"&&F.events[W][1].type!=="content"){Z=F.events[W][1].type==="paragraph";break}return!F.parser.lazy[F.now().line]&&(F.interrupt||Z)?(V.enter("setextHeadingLine"),B=Q,z(Q)):U(Q)}function z(Q){return V.enter("setextHeadingLineSequence"),G(Q)}function G(Q){return Q===B?(V.consume(Q),G):(V.exit("setextHeadingLineSequence"),markdownSpace(Q)?factorySpace(V,Y,"lineSuffix")(Q):Y(Q))}function Y(Q){return Q===null||markdownLineEnding(Q)?(V.exit("setextHeadingLine"),j(Q)):U(Q)}}const flow$1={tokenize:initializeFlow};function initializeFlow(V){const j=this,U=V.attempt(blankLine,F,V.attempt(this.parser.constructs.flowInitial,B,factorySpace(V,V.attempt(this.parser.constructs.flow,B,V.attempt(content,B)),"linePrefix")));return U;function F(q){if(q===null){V.consume(q);return}return V.enter("lineEndingBlank"),V.consume(q),V.exit("lineEndingBlank"),j.currentConstruct=void 0,U}function B(q){if(q===null){V.consume(q);return}return V.enter("lineEnding"),V.consume(q),V.exit("lineEnding"),j.currentConstruct=void 0,U}}const resolver={resolveAll:createResolver()},string$2=initializeFactory("string"),text$2=initializeFactory("text");function initializeFactory(V){return{resolveAll:createResolver(V==="text"?resolveAllLineSuffixes:void 0),tokenize:j};function j(U){const F=this,B=this.parser.constructs[V],q=U.attempt(B,z,G);return z;function z(W){return Q(W)?q(W):G(W)}function G(W){if(W===null){U.consume(W);return}return U.enter("data"),U.consume(W),Y}function Y(W){return Q(W)?(U.exit("data"),q(W)):(U.consume(W),Y)}function Q(W){if(W===null)return!0;const Z=B[W];let ee=-1;if(Z)for(;++ee<Z.length;){const ne=Z[ee];if(!ne.previous||ne.previous.call(F,F.previous))return!0}return!1}}}function createResolver(V){return j;function j(U,F){let B=-1,q;for(;++B<=U.length;)q===void 0?U[B]&&U[B][1].type==="data"&&(q=B,B++):(!U[B]||U[B][1].type!=="data")&&(B!==q+2&&(U[q][1].end=U[B-1][1].end,U.splice(q+2,B-q-2),B=q+2),q=void 0);return V?V(U,F):U}}function resolveAllLineSuffixes(V,j){let U=0;for(;++U<=V.length;)if((U===V.length||V[U][1].type==="lineEnding")&&V[U-1][1].type==="data"){const F=V[U-1][1],B=j.sliceStream(F);let q=B.length,z=-1,G=0,Y;for(;q--;){const Q=B[q];if(typeof Q=="string"){for(z=Q.length;Q.charCodeAt(z-1)===32;)G++,z--;if(z)break;z=-1}else if(Q===-2)Y=!0,G++;else if(Q!==-1){q++;break}}if(j._contentTypeTextTrailing&&U===V.length&&(G=0),G){const Q={type:U===V.length||Y||G<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:q?z:F.start._bufferIndex+z,_index:F.start._index+q,line:F.end.line,column:F.end.column-G,offset:F.end.offset-G},end:{...F.end}};F.end={...Q.start},F.start.offset===F.end.offset?Object.assign(F,Q):(V.splice(U,0,["enter",Q,j],["exit",Q,j]),U+=2)}U++}return V}const document$1={42:list$1,43:list$1,45:list$1,48:list$1,49:list$1,50:list$1,51:list$1,52:list$1,53:list$1,54:list$1,55:list$1,56:list$1,57:list$1,62:blockQuote},contentInitial={91:definition},flowInitial={[-2]:codeIndented,[-1]:codeIndented,32:codeIndented},flow={35:headingAtx,42:thematicBreak$1,45:[setextUnderline,thematicBreak$1],60:htmlFlow,61:setextUnderline,95:thematicBreak$1,96:codeFenced,126:codeFenced},string$1={38:characterReference,92:characterEscape},text$1={[-5]:lineEnding,[-4]:lineEnding,[-3]:lineEnding,33:labelStartImage,38:characterReference,42:attention,60:[autolink,htmlText],91:labelStartLink,92:[hardBreakEscape,characterEscape],93:labelEnd,95:attention,96:codeText},insideSpan={null:[attention,resolver]},attentionMarkers={null:[42,95]},disable={null:[]},defaultConstructs=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers,contentInitial,disable,document:document$1,flow,flowInitial,insideSpan,string:string$1,text:text$1},Symbol.toStringTag,{value:"Module"}));function createTokenizer(V,j,U){let F={_bufferIndex:-1,_index:0,line:U&&U.line||1,column:U&&U.column||1,offset:U&&U.offset||0};const B={},q=[];let z=[],G=[];const Y={attempt:xe(fe),check:xe(pe),consume:ue,enter:he,exit:ye,interrupt:xe(pe,{interrupt:!0})},Q={code:null,containerState:{},defineSkip:se,events:[],now:ae,parser:V,previous:null,sliceSerialize:ee,sliceStream:ne,write:Z};let W=j.tokenize.call(Q,Y);return j.resolveAll&&q.push(j),Q;function Z(be){return z=push(z,be),de(),z[z.length-1]!==null?[]:(Ee(j,0),Q.events=resolveAll(q,Q.events,Q),Q.events)}function ee(be,Le){return serializeChunks(ne(be),Le)}function ne(be){return sliceChunks(z,be)}function ae(){const{_bufferIndex:be,_index:Le,line:Fe,column:Ne,offset:Ve}=F;return{_bufferIndex:be,_index:Le,line:Fe,column:Ne,offset:Ve}}function se(be){B[be.line]=be.column,Ae()}function de(){let be;for(;F._index<z.length;){const Le=z[F._index];if(typeof Le=="string")for(be=F._index,F._bufferIndex<0&&(F._bufferIndex=0);F._index===be&&F._bufferIndex<Le.length;)oe(Le.charCodeAt(F._bufferIndex));else oe(Le)}}function oe(be){W=W(be)}function ue(be){markdownLineEnding(be)?(F.line++,F.column=1,F.offset+=be===-3?2:1,Ae()):be!==-1&&(F.column++,F.offset++),F._bufferIndex<0?F._index++:(F._bufferIndex++,F._bufferIndex===z[F._index].length&&(F._bufferIndex=-1,F._index++)),Q.previous=be}function he(be,Le){const Fe=Le||{};return Fe.type=be,Fe.start=ae(),Q.events.push(["enter",Fe,Q]),G.push(Fe),Fe}function ye(be){const Le=G.pop();return Le.end=ae(),Q.events.push(["exit",Le,Q]),Le}function fe(be,Le){Ee(be,Le.from)}function pe(be,Le){Le.restore()}function xe(be,Le){return Fe;function Fe(Ne,Ve,Te){let Oe,Ue,Ye,le;return Array.isArray(Ne)?He(Ne):"tokenize"in Ne?He([Ne]):we(Ne);function we($e){return ht;function ht(ut){const ft=ut!==null&&$e[ut],$t=ut!==null&&$e.null,Mt=[...Array.isArray(ft)?ft:ft?[ft]:[],...Array.isArray($t)?$t:$t?[$t]:[]];return He(Mt)(ut)}}function He($e){return Oe=$e,Ue=0,$e.length===0?Te:ge($e[Ue])}function ge($e){return ht;function ht(ut){return le=ke(),Ye=$e,$e.partial||(Q.currentConstruct=$e),$e.name&&Q.parser.constructs.disable.null.includes($e.name)?at():$e.tokenize.call(Le?Object.assign(Object.create(Q),Le):Q,Y,We,at)(ut)}}function We($e){return be(Ye,le),Ve}function at($e){return le.restore(),++Ue<Oe.length?ge(Oe[Ue]):Te}}}function Ee(be,Le){be.resolveAll&&!q.includes(be)&&q.push(be),be.resolve&&splice$1(Q.events,Le,Q.events.length-Le,be.resolve(Q.events.slice(Le),Q)),be.resolveTo&&(Q.events=be.resolveTo(Q.events,Q))}function ke(){const be=ae(),Le=Q.previous,Fe=Q.currentConstruct,Ne=Q.events.length,Ve=Array.from(G);return{from:Ne,restore:Te};function Te(){F=be,Q.previous=Le,Q.currentConstruct=Fe,Q.events.length=Ne,G=Ve,Ae()}}function Ae(){F.line in B&&F.column<2&&(F.column=B[F.line],F.offset+=B[F.line]-1)}}function sliceChunks(V,j){const U=j.start._index,F=j.start._bufferIndex,B=j.end._index,q=j.end._bufferIndex;let z;if(U===B)z=[V[U].slice(F,q)];else{if(z=V.slice(U,B),F>-1){const G=z[0];typeof G=="string"?z[0]=G.slice(F):z.shift()}q>0&&z.push(V[B].slice(0,q))}return z}function serializeChunks(V,j){let U=-1;const F=[];let B;for(;++U<V.length;){const q=V[U];let z;if(typeof q=="string")z=q;else switch(q){case-5:{z="\r";break}case-4:{z=`
`;break}case-3:{z=`\r
`;break}case-2:{z=j?" ":"	";break}case-1:{if(!j&&B)continue;z=" ";break}default:z=String.fromCharCode(q)}B=q===-2,F.push(z)}return F.join("")}function parse(V){const F={constructs:combineExtensions([defaultConstructs,...(V||{}).extensions||[]]),content:B(content$1),defined:[],document:B(document$2),flow:B(flow$1),lazy:{},string:B(string$2),text:B(text$2)};return F;function B(q){return z;function z(G){return createTokenizer(F,q,G)}}}function postprocess(V){for(;!subtokenize(V););return V}const search=/[\0\t\n\r]/g;function preprocess(){let V=1,j="",U=!0,F;return B;function B(q,z,G){const Y=[];let Q,W,Z,ee,ne;for(q=j+(typeof q=="string"?q.toString():new TextDecoder(z||void 0).decode(q)),Z=0,j="",U&&(q.charCodeAt(0)===65279&&Z++,U=void 0);Z<q.length;){if(search.lastIndex=Z,Q=search.exec(q),ee=Q&&Q.index!==void 0?Q.index:q.length,ne=q.charCodeAt(ee),!Q){j=q.slice(Z);break}if(ne===10&&Z===ee&&F)Y.push(-3),F=void 0;else switch(F&&(Y.push(-5),F=void 0),Z<ee&&(Y.push(q.slice(Z,ee)),V+=ee-Z),ne){case 0:{Y.push(65533),V++;break}case 9:{for(W=Math.ceil(V/4)*4,Y.push(-2);V++<W;)Y.push(-1);break}case 10:{Y.push(-4),V=1;break}default:F=!0,V=1}Z=ee+1}return G&&(F&&Y.push(-5),j&&Y.push(j),Y.push(null)),Y}}const characterEscapeOrReference=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function decodeString(V){return V.replace(characterEscapeOrReference,decode)}function decode(V,j,U){if(j)return j;if(U.charCodeAt(0)===35){const B=U.charCodeAt(1),q=B===120||B===88;return decodeNumericCharacterReference(U.slice(q?2:1),q?16:10)}return decodeNamedCharacterReference(U)||V}const own$2={}.hasOwnProperty;function fromMarkdown(V,j,U){return typeof j!="string"&&(U=j,j=void 0),compiler(U)(postprocess(parse(U).document().write(preprocess()(V,j,!0))))}function compiler(V){const j={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:q(At),autolinkProtocol:ke,autolinkEmail:ke,atxHeading:q(Gt),blockQuote:q($t),characterEscape:ke,characterReference:ke,codeFenced:q(Mt),codeFencedFenceInfo:z,codeFencedFenceMeta:z,codeIndented:q(Mt,z),codeText:q(Nn,z),codeTextData:ke,data:ke,codeFlowValue:ke,definition:q(Qt),definitionDestinationString:z,definitionLabelString:z,definitionTitleString:z,emphasis:q(tn),hardBreakEscape:q(cn),hardBreakTrailing:q(cn),htmlFlow:q(bt,z),htmlFlowData:ke,htmlText:q(bt,z),htmlTextData:ke,image:q(dn),label:z,link:q(At),listItem:q(nn),listItemValue:ee,listOrdered:q(Wt,Z),listUnordered:q(Wt),paragraph:q(De),reference:ge,referenceString:z,resourceDestinationString:z,resourceTitleString:z,setextHeading:q(Gt),strong:q(Xe),thematicBreak:q(tt)},exit:{atxHeading:Y(),atxHeadingSequence:fe,autolink:Y(),autolinkEmail:ft,autolinkProtocol:ut,blockQuote:Y(),characterEscapeValue:Ae,characterReferenceMarkerHexadecimal:at,characterReferenceMarkerNumeric:at,characterReferenceValue:$e,characterReference:ht,codeFenced:Y(de),codeFencedFence:se,codeFencedFenceInfo:ne,codeFencedFenceMeta:ae,codeFlowValue:Ae,codeIndented:Y(oe),codeText:Y(Ve),codeTextData:Ae,data:Ae,definition:Y(),definitionDestinationString:ye,definitionLabelString:ue,definitionTitleString:he,emphasis:Y(),hardBreakEscape:Y(Le),hardBreakTrailing:Y(Le),htmlFlow:Y(Fe),htmlFlowData:Ae,htmlText:Y(Ne),htmlTextData:Ae,image:Y(Oe),label:Ye,labelText:Ue,lineEnding:be,link:Y(Te),listItem:Y(),listOrdered:Y(),listUnordered:Y(),paragraph:Y(),referenceString:We,resourceDestinationString:le,resourceTitleString:we,resource:He,setextHeading:Y(Ee),setextHeadingLineSequence:xe,setextHeadingText:pe,strong:Y(),thematicBreak:Y()}};configure(j,(V||{}).mdastExtensions||[]);const U={};return F;function F(_e){let je={type:"root",children:[]};const nt={stack:[je],tokenStack:[],config:j,enter:G,exit:Q,buffer:z,resume:W,data:U},it=[];let pt=-1;for(;++pt<_e.length;)if(_e[pt][1].type==="listOrdered"||_e[pt][1].type==="listUnordered")if(_e[pt][0]==="enter")it.push(pt);else{const Vt=it.pop();pt=B(_e,Vt,pt)}for(pt=-1;++pt<_e.length;){const Vt=j[_e[pt][0]];own$2.call(Vt,_e[pt][1].type)&&Vt[_e[pt][1].type].call(Object.assign({sliceSerialize:_e[pt][2].sliceSerialize},nt),_e[pt][1])}if(nt.tokenStack.length>0){const Vt=nt.tokenStack[nt.tokenStack.length-1];(Vt[1]||defaultOnError).call(nt,void 0,Vt[0])}for(je.position={start:point(_e.length>0?_e[0][1].start:{line:1,column:1,offset:0}),end:point(_e.length>0?_e[_e.length-2][1].end:{line:1,column:1,offset:0})},pt=-1;++pt<j.transforms.length;)je=j.transforms[pt](je)||je;return je}function B(_e,je,nt){let it=je-1,pt=-1,Vt=!1,yn,xt,ze,Be;for(;++it<=nt;){const Ge=_e[it];switch(Ge[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ge[0]==="enter"?pt++:pt--,Be=void 0;break}case"lineEndingBlank":{Ge[0]==="enter"&&(yn&&!Be&&!pt&&!ze&&(ze=it),Be=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Be=void 0}if(!pt&&Ge[0]==="enter"&&Ge[1].type==="listItemPrefix"||pt===-1&&Ge[0]==="exit"&&(Ge[1].type==="listUnordered"||Ge[1].type==="listOrdered")){if(yn){let Je=it;for(xt=void 0;Je--;){const Ze=_e[Je];if(Ze[1].type==="lineEnding"||Ze[1].type==="lineEndingBlank"){if(Ze[0]==="exit")continue;xt&&(_e[xt][1].type="lineEndingBlank",Vt=!0),Ze[1].type="lineEnding",xt=Je}else if(!(Ze[1].type==="linePrefix"||Ze[1].type==="blockQuotePrefix"||Ze[1].type==="blockQuotePrefixWhitespace"||Ze[1].type==="blockQuoteMarker"||Ze[1].type==="listItemIndent"))break}ze&&(!xt||ze<xt)&&(yn._spread=!0),yn.end=Object.assign({},xt?_e[xt][1].start:Ge[1].end),_e.splice(xt||it,0,["exit",yn,Ge[2]]),it++,nt++}if(Ge[1].type==="listItemPrefix"){const Je={type:"listItem",_spread:!1,start:Object.assign({},Ge[1].start),end:void 0};yn=Je,_e.splice(it,0,["enter",Je,Ge[2]]),it++,nt++,ze=void 0,Be=!0}}}return _e[je][1]._spread=Vt,nt}function q(_e,je){return nt;function nt(it){G.call(this,_e(it),it),je&&je.call(this,it)}}function z(){this.stack.push({type:"fragment",children:[]})}function G(_e,je,nt){this.stack[this.stack.length-1].children.push(_e),this.stack.push(_e),this.tokenStack.push([je,nt||void 0]),_e.position={start:point(je.start),end:void 0}}function Y(_e){return je;function je(nt){_e&&_e.call(this,nt),Q.call(this,nt)}}function Q(_e,je){const nt=this.stack.pop(),it=this.tokenStack.pop();if(it)it[0].type!==_e.type&&(je?je.call(this,_e,it[0]):(it[1]||defaultOnError).call(this,_e,it[0]));else throw new Error("Cannot close `"+_e.type+"` ("+stringifyPosition({start:_e.start,end:_e.end})+"): its not open");nt.position.end=point(_e.end)}function W(){return toString$3(this.stack.pop())}function Z(){this.data.expectingFirstListItemValue=!0}function ee(_e){if(this.data.expectingFirstListItemValue){const je=this.stack[this.stack.length-2];je.start=Number.parseInt(this.sliceSerialize(_e),10),this.data.expectingFirstListItemValue=void 0}}function ne(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.lang=_e}function ae(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.meta=_e}function se(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function de(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.value=_e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function oe(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.value=_e.replace(/(\r?\n|\r)$/g,"")}function ue(_e){const je=this.resume(),nt=this.stack[this.stack.length-1];nt.label=je,nt.identifier=normalizeIdentifier(this.sliceSerialize(_e)).toLowerCase()}function he(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.title=_e}function ye(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.url=_e}function fe(_e){const je=this.stack[this.stack.length-1];if(!je.depth){const nt=this.sliceSerialize(_e).length;je.depth=nt}}function pe(){this.data.setextHeadingSlurpLineEnding=!0}function xe(_e){const je=this.stack[this.stack.length-1];je.depth=this.sliceSerialize(_e).codePointAt(0)===61?1:2}function Ee(){this.data.setextHeadingSlurpLineEnding=void 0}function ke(_e){const nt=this.stack[this.stack.length-1].children;let it=nt[nt.length-1];(!it||it.type!=="text")&&(it=et(),it.position={start:point(_e.start),end:void 0},nt.push(it)),this.stack.push(it)}function Ae(_e){const je=this.stack.pop();je.value+=this.sliceSerialize(_e),je.position.end=point(_e.end)}function be(_e){const je=this.stack[this.stack.length-1];if(this.data.atHardBreak){const nt=je.children[je.children.length-1];nt.position.end=point(_e.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&j.canContainEols.includes(je.type)&&(ke.call(this,_e),Ae.call(this,_e))}function Le(){this.data.atHardBreak=!0}function Fe(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.value=_e}function Ne(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.value=_e}function Ve(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.value=_e}function Te(){const _e=this.stack[this.stack.length-1];if(this.data.inReference){const je=this.data.referenceType||"shortcut";_e.type+="Reference",_e.referenceType=je,delete _e.url,delete _e.title}else delete _e.identifier,delete _e.label;this.data.referenceType=void 0}function Oe(){const _e=this.stack[this.stack.length-1];if(this.data.inReference){const je=this.data.referenceType||"shortcut";_e.type+="Reference",_e.referenceType=je,delete _e.url,delete _e.title}else delete _e.identifier,delete _e.label;this.data.referenceType=void 0}function Ue(_e){const je=this.sliceSerialize(_e),nt=this.stack[this.stack.length-2];nt.label=decodeString(je),nt.identifier=normalizeIdentifier(je).toLowerCase()}function Ye(){const _e=this.stack[this.stack.length-1],je=this.resume(),nt=this.stack[this.stack.length-1];if(this.data.inReference=!0,nt.type==="link"){const it=_e.children;nt.children=it}else nt.alt=je}function le(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.url=_e}function we(){const _e=this.resume(),je=this.stack[this.stack.length-1];je.title=_e}function He(){this.data.inReference=void 0}function ge(){this.data.referenceType="collapsed"}function We(_e){const je=this.resume(),nt=this.stack[this.stack.length-1];nt.label=je,nt.identifier=normalizeIdentifier(this.sliceSerialize(_e)).toLowerCase(),this.data.referenceType="full"}function at(_e){this.data.characterReferenceType=_e.type}function $e(_e){const je=this.sliceSerialize(_e),nt=this.data.characterReferenceType;let it;nt?(it=decodeNumericCharacterReference(je,nt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):it=decodeNamedCharacterReference(je);const pt=this.stack[this.stack.length-1];pt.value+=it}function ht(_e){const je=this.stack.pop();je.position.end=point(_e.end)}function ut(_e){Ae.call(this,_e);const je=this.stack[this.stack.length-1];je.url=this.sliceSerialize(_e)}function ft(_e){Ae.call(this,_e);const je=this.stack[this.stack.length-1];je.url="mailto:"+this.sliceSerialize(_e)}function $t(){return{type:"blockquote",children:[]}}function Mt(){return{type:"code",lang:null,meta:null,value:""}}function Nn(){return{type:"inlineCode",value:""}}function Qt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function tn(){return{type:"emphasis",children:[]}}function Gt(){return{type:"heading",depth:0,children:[]}}function cn(){return{type:"break"}}function bt(){return{type:"html",value:""}}function dn(){return{type:"image",title:null,url:"",alt:null}}function At(){return{type:"link",title:null,url:"",children:[]}}function Wt(_e){return{type:"list",ordered:_e.type==="listOrdered",start:null,spread:_e._spread,children:[]}}function nn(_e){return{type:"listItem",spread:_e._spread,checked:null,children:[]}}function De(){return{type:"paragraph",children:[]}}function Xe(){return{type:"strong",children:[]}}function et(){return{type:"text",value:""}}function tt(){return{type:"thematicBreak"}}}function point(V){return{line:V.line,column:V.column,offset:V.offset}}function configure(V,j){let U=-1;for(;++U<j.length;){const F=j[U];Array.isArray(F)?configure(V,F):extension(V,F)}}function extension(V,j){let U;for(U in j)if(own$2.call(j,U))switch(U){case"canContainEols":{const F=j[U];F&&V[U].push(...F);break}case"transforms":{const F=j[U];F&&V[U].push(...F);break}case"enter":case"exit":{const F=j[U];F&&Object.assign(V[U],F);break}}}function defaultOnError(V,j){throw V?new Error("Cannot close `"+V.type+"` ("+stringifyPosition({start:V.start,end:V.end})+"): a different token (`"+j.type+"`, "+stringifyPosition({start:j.start,end:j.end})+") is open"):new Error("Cannot close document, a token (`"+j.type+"`, "+stringifyPosition({start:j.start,end:j.end})+") is still open")}function remarkParse(V){const j=this;j.parser=U;function U(F){return fromMarkdown(F,{...j.data("settings"),...V,extensions:j.data("micromarkExtensions")||[],mdastExtensions:j.data("fromMarkdownExtensions")||[]})}}function blockquote(V,j){const U={type:"element",tagName:"blockquote",properties:{},children:V.wrap(V.all(j),!0)};return V.patch(j,U),V.applyData(j,U)}function hardBreak(V,j){const U={type:"element",tagName:"br",properties:{},children:[]};return V.patch(j,U),[V.applyData(j,U),{type:"text",value:`
`}]}function code(V,j){const U=j.value?j.value+`
`:"",F={};j.lang&&(F.className=["language-"+j.lang]);let B={type:"element",tagName:"code",properties:F,children:[{type:"text",value:U}]};return j.meta&&(B.data={meta:j.meta}),V.patch(j,B),B=V.applyData(j,B),B={type:"element",tagName:"pre",properties:{},children:[B]},V.patch(j,B),B}function strikethrough(V,j){const U={type:"element",tagName:"del",properties:{},children:V.all(j)};return V.patch(j,U),V.applyData(j,U)}function emphasis(V,j){const U={type:"element",tagName:"em",properties:{},children:V.all(j)};return V.patch(j,U),V.applyData(j,U)}function footnoteReference(V,j){const U=typeof V.options.clobberPrefix=="string"?V.options.clobberPrefix:"user-content-",F=String(j.identifier).toUpperCase(),B=normalizeUri(F.toLowerCase()),q=V.footnoteOrder.indexOf(F);let z,G=V.footnoteCounts.get(F);G===void 0?(G=0,V.footnoteOrder.push(F),z=V.footnoteOrder.length):z=q+1,G+=1,V.footnoteCounts.set(F,G);const Y={type:"element",tagName:"a",properties:{href:"#"+U+"fn-"+B,id:U+"fnref-"+B+(G>1?"-"+G:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(z)}]};V.patch(j,Y);const Q={type:"element",tagName:"sup",properties:{},children:[Y]};return V.patch(j,Q),V.applyData(j,Q)}function heading(V,j){const U={type:"element",tagName:"h"+j.depth,properties:{},children:V.all(j)};return V.patch(j,U),V.applyData(j,U)}function html(V,j){if(V.options.allowDangerousHtml){const U={type:"raw",value:j.value};return V.patch(j,U),V.applyData(j,U)}}function revert(V,j){const U=j.referenceType;let F="]";if(U==="collapsed"?F+="[]":U==="full"&&(F+="["+(j.label||j.identifier)+"]"),j.type==="imageReference")return[{type:"text",value:"!["+j.alt+F}];const B=V.all(j),q=B[0];q&&q.type==="text"?q.value="["+q.value:B.unshift({type:"text",value:"["});const z=B[B.length-1];return z&&z.type==="text"?z.value+=F:B.push({type:"text",value:F}),B}function imageReference(V,j){const U=String(j.identifier).toUpperCase(),F=V.definitionById.get(U);if(!F)return revert(V,j);const B={src:normalizeUri(F.url||""),alt:j.alt};F.title!==null&&F.title!==void 0&&(B.title=F.title);const q={type:"element",tagName:"img",properties:B,children:[]};return V.patch(j,q),V.applyData(j,q)}function image(V,j){const U={src:normalizeUri(j.url)};j.alt!==null&&j.alt!==void 0&&(U.alt=j.alt),j.title!==null&&j.title!==void 0&&(U.title=j.title);const F={type:"element",tagName:"img",properties:U,children:[]};return V.patch(j,F),V.applyData(j,F)}function inlineCode(V,j){const U={type:"text",value:j.value.replace(/\r?\n|\r/g," ")};V.patch(j,U);const F={type:"element",tagName:"code",properties:{},children:[U]};return V.patch(j,F),V.applyData(j,F)}function linkReference(V,j){const U=String(j.identifier).toUpperCase(),F=V.definitionById.get(U);if(!F)return revert(V,j);const B={href:normalizeUri(F.url||"")};F.title!==null&&F.title!==void 0&&(B.title=F.title);const q={type:"element",tagName:"a",properties:B,children:V.all(j)};return V.patch(j,q),V.applyData(j,q)}function link(V,j){const U={href:normalizeUri(j.url)};j.title!==null&&j.title!==void 0&&(U.title=j.title);const F={type:"element",tagName:"a",properties:U,children:V.all(j)};return V.patch(j,F),V.applyData(j,F)}function listItem(V,j,U){const F=V.all(j),B=U?listLoose(U):listItemLoose(j),q={},z=[];if(typeof j.checked=="boolean"){const W=F[0];let Z;W&&W.type==="element"&&W.tagName==="p"?Z=W:(Z={type:"element",tagName:"p",properties:{},children:[]},F.unshift(Z)),Z.children.length>0&&Z.children.unshift({type:"text",value:" "}),Z.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:j.checked,disabled:!0},children:[]}),q.className=["task-list-item"]}let G=-1;for(;++G<F.length;){const W=F[G];(B||G!==0||W.type!=="element"||W.tagName!=="p")&&z.push({type:"text",value:`
`}),W.type==="element"&&W.tagName==="p"&&!B?z.push(...W.children):z.push(W)}const Y=F[F.length-1];Y&&(B||Y.type!=="element"||Y.tagName!=="p")&&z.push({type:"text",value:`
`});const Q={type:"element",tagName:"li",properties:q,children:z};return V.patch(j,Q),V.applyData(j,Q)}function listLoose(V){let j=!1;if(V.type==="list"){j=V.spread||!1;const U=V.children;let F=-1;for(;!j&&++F<U.length;)j=listItemLoose(U[F])}return j}function listItemLoose(V){const j=V.spread;return j??V.children.length>1}function list(V,j){const U={},F=V.all(j);let B=-1;for(typeof j.start=="number"&&j.start!==1&&(U.start=j.start);++B<F.length;){const z=F[B];if(z.type==="element"&&z.tagName==="li"&&z.properties&&Array.isArray(z.properties.className)&&z.properties.className.includes("task-list-item")){U.className=["contains-task-list"];break}}const q={type:"element",tagName:j.ordered?"ol":"ul",properties:U,children:V.wrap(F,!0)};return V.patch(j,q),V.applyData(j,q)}function paragraph(V,j){const U={type:"element",tagName:"p",properties:{},children:V.all(j)};return V.patch(j,U),V.applyData(j,U)}function root$1(V,j){const U={type:"root",children:V.wrap(V.all(j))};return V.patch(j,U),V.applyData(j,U)}function strong(V,j){const U={type:"element",tagName:"strong",properties:{},children:V.all(j)};return V.patch(j,U),V.applyData(j,U)}function table(V,j){const U=V.all(j),F=U.shift(),B=[];if(F){const z={type:"element",tagName:"thead",properties:{},children:V.wrap([F],!0)};V.patch(j.children[0],z),B.push(z)}if(U.length>0){const z={type:"element",tagName:"tbody",properties:{},children:V.wrap(U,!0)},G=pointStart(j.children[1]),Y=pointEnd(j.children[j.children.length-1]);G&&Y&&(z.position={start:G,end:Y}),B.push(z)}const q={type:"element",tagName:"table",properties:{},children:V.wrap(B,!0)};return V.patch(j,q),V.applyData(j,q)}function tableRow(V,j,U){const F=U?U.children:void 0,q=(F?F.indexOf(j):1)===0?"th":"td",z=U&&U.type==="table"?U.align:void 0,G=z?z.length:j.children.length;let Y=-1;const Q=[];for(;++Y<G;){const Z=j.children[Y],ee={},ne=z?z[Y]:void 0;ne&&(ee.align=ne);let ae={type:"element",tagName:q,properties:ee,children:[]};Z&&(ae.children=V.all(Z),V.patch(Z,ae),ae=V.applyData(Z,ae)),Q.push(ae)}const W={type:"element",tagName:"tr",properties:{},children:V.wrap(Q,!0)};return V.patch(j,W),V.applyData(j,W)}function tableCell(V,j){const U={type:"element",tagName:"td",properties:{},children:V.all(j)};return V.patch(j,U),V.applyData(j,U)}const tab=9,space=32;function trimLines(V){const j=String(V),U=/\r?\n|\r/g;let F=U.exec(j),B=0;const q=[];for(;F;)q.push(trimLine(j.slice(B,F.index),B>0,!0),F[0]),B=F.index+F[0].length,F=U.exec(j);return q.push(trimLine(j.slice(B),B>0,!1)),q.join("")}function trimLine(V,j,U){let F=0,B=V.length;if(j){let q=V.codePointAt(F);for(;q===tab||q===space;)F++,q=V.codePointAt(F)}if(U){let q=V.codePointAt(B-1);for(;q===tab||q===space;)B--,q=V.codePointAt(B-1)}return B>F?V.slice(F,B):""}function text(V,j){const U={type:"text",value:trimLines(String(j.value))};return V.patch(j,U),V.applyData(j,U)}function thematicBreak(V,j){const U={type:"element",tagName:"hr",properties:{},children:[]};return V.patch(j,U),V.applyData(j,U)}const handlers={blockquote,break:hardBreak,code,delete:strikethrough,emphasis,footnoteReference,heading,html,imageReference,image,inlineCode,linkReference,link,listItem,list,paragraph,root:root$1,strong,table,tableCell,tableRow,text,thematicBreak,toml:ignore,yaml:ignore,definition:ignore,footnoteDefinition:ignore};function ignore(){}const VOID=-1,PRIMITIVE=0,ARRAY=1,OBJECT=2,DATE=3,REGEXP=4,MAP=5,SET=6,ERROR=7,BIGINT=8,env=typeof self=="object"?self:globalThis,deserializer=(V,j)=>{const U=(B,q)=>(V.set(q,B),B),F=B=>{if(V.has(B))return V.get(B);const[q,z]=j[B];switch(q){case PRIMITIVE:case VOID:return U(z,B);case ARRAY:{const G=U([],B);for(const Y of z)G.push(F(Y));return G}case OBJECT:{const G=U({},B);for(const[Y,Q]of z)G[F(Y)]=F(Q);return G}case DATE:return U(new Date(z),B);case REGEXP:{const{source:G,flags:Y}=z;return U(new RegExp(G,Y),B)}case MAP:{const G=U(new Map,B);for(const[Y,Q]of z)G.set(F(Y),F(Q));return G}case SET:{const G=U(new Set,B);for(const Y of z)G.add(F(Y));return G}case ERROR:{const{name:G,message:Y}=z;return U(new env[G](Y),B)}case BIGINT:return U(BigInt(z),B);case"BigInt":return U(Object(BigInt(z)),B);case"ArrayBuffer":return U(new Uint8Array(z).buffer,z);case"DataView":{const{buffer:G}=new Uint8Array(z);return U(new DataView(G),z)}}return U(new env[q](z),B)};return F},deserialize=V=>deserializer(new Map,V)(0),EMPTY="",{toString:toString$2}={},{keys:keys$1}=Object,typeOf=V=>{const j=typeof V;if(j!=="object"||!V)return[PRIMITIVE,j];const U=toString$2.call(V).slice(8,-1);switch(U){case"Array":return[ARRAY,EMPTY];case"Object":return[OBJECT,EMPTY];case"Date":return[DATE,EMPTY];case"RegExp":return[REGEXP,EMPTY];case"Map":return[MAP,EMPTY];case"Set":return[SET,EMPTY];case"DataView":return[ARRAY,U]}return U.includes("Array")?[ARRAY,U]:U.includes("Error")?[ERROR,U]:[OBJECT,U]},shouldSkip=([V,j])=>V===PRIMITIVE&&(j==="function"||j==="symbol"),serializer=(V,j,U,F)=>{const B=(z,G)=>{const Y=F.push(z)-1;return U.set(G,Y),Y},q=z=>{if(U.has(z))return U.get(z);let[G,Y]=typeOf(z);switch(G){case PRIMITIVE:{let W=z;switch(Y){case"bigint":G=BIGINT,W=z.toString();break;case"function":case"symbol":if(V)throw new TypeError("unable to serialize "+Y);W=null;break;case"undefined":return B([VOID],z)}return B([G,W],z)}case ARRAY:{if(Y){let ee=z;return Y==="DataView"?ee=new Uint8Array(z.buffer):Y==="ArrayBuffer"&&(ee=new Uint8Array(z)),B([Y,[...ee]],z)}const W=[],Z=B([G,W],z);for(const ee of z)W.push(q(ee));return Z}case OBJECT:{if(Y)switch(Y){case"BigInt":return B([Y,z.toString()],z);case"Boolean":case"Number":case"String":return B([Y,z.valueOf()],z)}if(j&&"toJSON"in z)return q(z.toJSON());const W=[],Z=B([G,W],z);for(const ee of keys$1(z))(V||!shouldSkip(typeOf(z[ee])))&&W.push([q(ee),q(z[ee])]);return Z}case DATE:return B([G,z.toISOString()],z);case REGEXP:{const{source:W,flags:Z}=z;return B([G,{source:W,flags:Z}],z)}case MAP:{const W=[],Z=B([G,W],z);for(const[ee,ne]of z)(V||!(shouldSkip(typeOf(ee))||shouldSkip(typeOf(ne))))&&W.push([q(ee),q(ne)]);return Z}case SET:{const W=[],Z=B([G,W],z);for(const ee of z)(V||!shouldSkip(typeOf(ee)))&&W.push(q(ee));return Z}}const{message:Q}=z;return B([G,{name:Y,message:Q}],z)};return q},serialize=(V,{json:j,lossy:U}={})=>{const F=[];return serializer(!(j||U),!!j,new Map,F)(V),F},structuredClone$1=typeof structuredClone=="function"?(V,j)=>j&&("json"in j||"lossy"in j)?deserialize(serialize(V,j)):structuredClone(V):(V,j)=>deserialize(serialize(V,j));function defaultFootnoteBackContent(V,j){const U=[{type:"text",value:""}];return j>1&&U.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(j)}]}),U}function defaultFootnoteBackLabel(V,j){return"Back to reference "+(V+1)+(j>1?"-"+j:"")}function footer(V){const j=typeof V.options.clobberPrefix=="string"?V.options.clobberPrefix:"user-content-",U=V.options.footnoteBackContent||defaultFootnoteBackContent,F=V.options.footnoteBackLabel||defaultFootnoteBackLabel,B=V.options.footnoteLabel||"Footnotes",q=V.options.footnoteLabelTagName||"h2",z=V.options.footnoteLabelProperties||{className:["sr-only"]},G=[];let Y=-1;for(;++Y<V.footnoteOrder.length;){const Q=V.footnoteById.get(V.footnoteOrder[Y]);if(!Q)continue;const W=V.all(Q),Z=String(Q.identifier).toUpperCase(),ee=normalizeUri(Z.toLowerCase());let ne=0;const ae=[],se=V.footnoteCounts.get(Z);for(;se!==void 0&&++ne<=se;){ae.length>0&&ae.push({type:"text",value:" "});let ue=typeof U=="string"?U:U(Y,ne);typeof ue=="string"&&(ue={type:"text",value:ue}),ae.push({type:"element",tagName:"a",properties:{href:"#"+j+"fnref-"+ee+(ne>1?"-"+ne:""),dataFootnoteBackref:"",ariaLabel:typeof F=="string"?F:F(Y,ne),className:["data-footnote-backref"]},children:Array.isArray(ue)?ue:[ue]})}const de=W[W.length-1];if(de&&de.type==="element"&&de.tagName==="p"){const ue=de.children[de.children.length-1];ue&&ue.type==="text"?ue.value+=" ":de.children.push({type:"text",value:" "}),de.children.push(...ae)}else W.push(...ae);const oe={type:"element",tagName:"li",properties:{id:j+"fn-"+ee},children:V.wrap(W,!0)};V.patch(Q,oe),G.push(oe)}if(G.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:q,properties:{...structuredClone$1(z),id:"footnote-label"},children:[{type:"text",value:B}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:V.wrap(G,!0)},{type:"text",value:`
`}]}}const convert=(function(V){if(V==null)return ok;if(typeof V=="function")return castFactory(V);if(typeof V=="object")return Array.isArray(V)?anyFactory(V):propsFactory(V);if(typeof V=="string")return typeFactory(V);throw new Error("Expected function, string, or object as test")});function anyFactory(V){const j=[];let U=-1;for(;++U<V.length;)j[U]=convert(V[U]);return castFactory(F);function F(...B){let q=-1;for(;++q<j.length;)if(j[q].apply(this,B))return!0;return!1}}function propsFactory(V){const j=V;return castFactory(U);function U(F){const B=F;let q;for(q in V)if(B[q]!==j[q])return!1;return!0}}function typeFactory(V){return castFactory(j);function j(U){return U&&U.type===V}}function castFactory(V){return j;function j(U,F,B){return!!(looksLikeANode(U)&&V.call(this,U,typeof F=="number"?F:void 0,B||void 0))}}function ok(){return!0}function looksLikeANode(V){return V!==null&&typeof V=="object"&&"type"in V}function color(V){return V}const empty=[],CONTINUE=!0,EXIT=!1,SKIP="skip";function visitParents(V,j,U,F){let B;typeof j=="function"&&typeof U!="function"?(F=U,U=j):B=j;const q=convert(B),z=F?-1:1;G(V,void 0,[])();function G(Y,Q,W){const Z=Y&&typeof Y=="object"?Y:{};if(typeof Z.type=="string"){const ne=typeof Z.tagName=="string"?Z.tagName:typeof Z.name=="string"?Z.name:void 0;Object.defineProperty(ee,"name",{value:"node ("+(Y.type+(ne?"<"+ne+">":""))+")"})}return ee;function ee(){let ne=empty,ae,se,de;if((!j||q(Y,Q,W[W.length-1]||void 0))&&(ne=toResult(U(Y,W)),ne[0]===EXIT))return ne;if("children"in Y&&Y.children){const oe=Y;if(oe.children&&ne[0]!==SKIP)for(se=(F?oe.children.length:-1)+z,de=W.concat(oe);se>-1&&se<oe.children.length;){const ue=oe.children[se];if(ae=G(ue,se,de)(),ae[0]===EXIT)return ae;se=typeof ae[1]=="number"?ae[1]:se+z}}return ne}}}function toResult(V){return Array.isArray(V)?V:typeof V=="number"?[CONTINUE,V]:V==null?empty:[V]}function visit(V,j,U,F){let B,q,z;typeof j=="function"&&typeof U!="function"?(q=void 0,z=j,B=U):(q=j,z=U,B=F),visitParents(V,q,G,B);function G(Y,Q){const W=Q[Q.length-1],Z=W?W.children.indexOf(Y):void 0;return z(Y,Z,W)}}const own$1={}.hasOwnProperty,emptyOptions={};function createState(V,j){const U=j||emptyOptions,F=new Map,B=new Map,q=new Map,z={...handlers,...U.handlers},G={all:Q,applyData,definitionById:F,footnoteById:B,footnoteCounts:q,footnoteOrder:[],handlers:z,one:Y,options:U,patch,wrap:wrap$1};return visit(V,function(W){if(W.type==="definition"||W.type==="footnoteDefinition"){const Z=W.type==="definition"?F:B,ee=String(W.identifier).toUpperCase();Z.has(ee)||Z.set(ee,W)}}),G;function Y(W,Z){const ee=W.type,ne=G.handlers[ee];if(own$1.call(G.handlers,ee)&&ne)return ne(G,W,Z);if(G.options.passThrough&&G.options.passThrough.includes(ee)){if("children"in W){const{children:se,...de}=W,oe=structuredClone$1(de);return oe.children=G.all(W),oe}return structuredClone$1(W)}return(G.options.unknownHandler||defaultUnknownHandler)(G,W,Z)}function Q(W){const Z=[];if("children"in W){const ee=W.children;let ne=-1;for(;++ne<ee.length;){const ae=G.one(ee[ne],W);if(ae){if(ne&&ee[ne-1].type==="break"&&(!Array.isArray(ae)&&ae.type==="text"&&(ae.value=trimMarkdownSpaceStart(ae.value)),!Array.isArray(ae)&&ae.type==="element")){const se=ae.children[0];se&&se.type==="text"&&(se.value=trimMarkdownSpaceStart(se.value))}Array.isArray(ae)?Z.push(...ae):Z.push(ae)}}}return Z}}function patch(V,j){V.position&&(j.position=position$1(V))}function applyData(V,j){let U=j;if(V&&V.data){const F=V.data.hName,B=V.data.hChildren,q=V.data.hProperties;if(typeof F=="string")if(U.type==="element")U.tagName=F;else{const z="children"in U?U.children:[U];U={type:"element",tagName:F,properties:{},children:z}}U.type==="element"&&q&&Object.assign(U.properties,structuredClone$1(q)),"children"in U&&U.children&&B!==null&&B!==void 0&&(U.children=B)}return U}function defaultUnknownHandler(V,j){const U=j.data||{},F="value"in j&&!(own$1.call(U,"hProperties")||own$1.call(U,"hChildren"))?{type:"text",value:j.value}:{type:"element",tagName:"div",properties:{},children:V.all(j)};return V.patch(j,F),V.applyData(j,F)}function wrap$1(V,j){const U=[];let F=-1;for(j&&U.push({type:"text",value:`
`});++F<V.length;)F&&U.push({type:"text",value:`
`}),U.push(V[F]);return j&&V.length>0&&U.push({type:"text",value:`
`}),U}function trimMarkdownSpaceStart(V){let j=0,U=V.charCodeAt(j);for(;U===9||U===32;)j++,U=V.charCodeAt(j);return V.slice(j)}function toHast(V,j){const U=createState(V,j),F=U.one(V,void 0),B=footer(U),q=Array.isArray(F)?{type:"root",children:F}:F||{type:"root",children:[]};return B&&q.children.push({type:"text",value:`
`},B),q}function remarkRehype(V,j){return V&&"run"in V?async function(U,F){const B=toHast(U,{file:F,...j});await V.run(B,F)}:function(U,F){return toHast(U,{file:F,...V||j})}}function bail(V){if(V)throw V}var extend$1,hasRequiredExtend;function requireExtend(){if(hasRequiredExtend)return extend$1;hasRequiredExtend=1;var V=Object.prototype.hasOwnProperty,j=Object.prototype.toString,U=Object.defineProperty,F=Object.getOwnPropertyDescriptor,B=function(Q){return typeof Array.isArray=="function"?Array.isArray(Q):j.call(Q)==="[object Array]"},q=function(Q){if(!Q||j.call(Q)!=="[object Object]")return!1;var W=V.call(Q,"constructor"),Z=Q.constructor&&Q.constructor.prototype&&V.call(Q.constructor.prototype,"isPrototypeOf");if(Q.constructor&&!W&&!Z)return!1;var ee;for(ee in Q);return typeof ee>"u"||V.call(Q,ee)},z=function(Q,W){U&&W.name==="__proto__"?U(Q,W.name,{enumerable:!0,configurable:!0,value:W.newValue,writable:!0}):Q[W.name]=W.newValue},G=function(Q,W){if(W==="__proto__")if(V.call(Q,W)){if(F)return F(Q,W).value}else return;return Q[W]};return extend$1=function Y(){var Q,W,Z,ee,ne,ae,se=arguments[0],de=1,oe=arguments.length,ue=!1;for(typeof se=="boolean"&&(ue=se,se=arguments[1]||{},de=2),(se==null||typeof se!="object"&&typeof se!="function")&&(se={});de<oe;++de)if(Q=arguments[de],Q!=null)for(W in Q)Z=G(se,W),ee=G(Q,W),se!==ee&&(ue&&ee&&(q(ee)||(ne=B(ee)))?(ne?(ne=!1,ae=Z&&B(Z)?Z:[]):ae=Z&&q(Z)?Z:{},z(se,{name:W,newValue:Y(ue,ae,ee)})):typeof ee<"u"&&z(se,{name:W,newValue:ee}));return se},extend$1}var extendExports=requireExtend();const extend=getDefaultExportFromCjs$1(extendExports);function isPlainObject$1(V){if(typeof V!="object"||V===null)return!1;const j=Object.getPrototypeOf(V);return(j===null||j===Object.prototype||Object.getPrototypeOf(j)===null)&&!(Symbol.toStringTag in V)&&!(Symbol.iterator in V)}function trough(){const V=[],j={run:U,use:F};return j;function U(...B){let q=-1;const z=B.pop();if(typeof z!="function")throw new TypeError("Expected function as last argument, not "+z);G(null,...B);function G(Y,...Q){const W=V[++q];let Z=-1;if(Y){z(Y);return}for(;++Z<B.length;)(Q[Z]===null||Q[Z]===void 0)&&(Q[Z]=B[Z]);B=Q,W?wrap(W,G)(...Q):z(null,...Q)}}function F(B){if(typeof B!="function")throw new TypeError("Expected `middelware` to be a function, not "+B);return V.push(B),j}}function wrap(V,j){let U;return F;function F(...z){const G=V.length>z.length;let Y;G&&z.push(B);try{Y=V.apply(this,z)}catch(Q){const W=Q;if(G&&U)throw W;return B(W)}G||(Y&&Y.then&&typeof Y.then=="function"?Y.then(q,B):Y instanceof Error?B(Y):q(Y))}function B(z,...G){U||(U=!0,j(z,...G))}function q(z){B(null,z)}}const minpath={basename,dirname,extname,join,sep:"/"};function basename(V,j){if(j!==void 0&&typeof j!="string")throw new TypeError('"ext" argument must be a string');assertPath$1(V);let U=0,F=-1,B=V.length,q;if(j===void 0||j.length===0||j.length>V.length){for(;B--;)if(V.codePointAt(B)===47){if(q){U=B+1;break}}else F<0&&(q=!0,F=B+1);return F<0?"":V.slice(U,F)}if(j===V)return"";let z=-1,G=j.length-1;for(;B--;)if(V.codePointAt(B)===47){if(q){U=B+1;break}}else z<0&&(q=!0,z=B+1),G>-1&&(V.codePointAt(B)===j.codePointAt(G--)?G<0&&(F=B):(G=-1,F=z));return U===F?F=z:F<0&&(F=V.length),V.slice(U,F)}function dirname(V){if(assertPath$1(V),V.length===0)return".";let j=-1,U=V.length,F;for(;--U;)if(V.codePointAt(U)===47){if(F){j=U;break}}else F||(F=!0);return j<0?V.codePointAt(0)===47?"/":".":j===1&&V.codePointAt(0)===47?"//":V.slice(0,j)}function extname(V){assertPath$1(V);let j=V.length,U=-1,F=0,B=-1,q=0,z;for(;j--;){const G=V.codePointAt(j);if(G===47){if(z){F=j+1;break}continue}U<0&&(z=!0,U=j+1),G===46?B<0?B=j:q!==1&&(q=1):B>-1&&(q=-1)}return B<0||U<0||q===0||q===1&&B===U-1&&B===F+1?"":V.slice(B,U)}function join(...V){let j=-1,U;for(;++j<V.length;)assertPath$1(V[j]),V[j]&&(U=U===void 0?V[j]:U+"/"+V[j]);return U===void 0?".":normalize(U)}function normalize(V){assertPath$1(V);const j=V.codePointAt(0)===47;let U=normalizeString(V,!j);return U.length===0&&!j&&(U="."),U.length>0&&V.codePointAt(V.length-1)===47&&(U+="/"),j?"/"+U:U}function normalizeString(V,j){let U="",F=0,B=-1,q=0,z=-1,G,Y;for(;++z<=V.length;){if(z<V.length)G=V.codePointAt(z);else{if(G===47)break;G=47}if(G===47){if(!(B===z-1||q===1))if(B!==z-1&&q===2){if(U.length<2||F!==2||U.codePointAt(U.length-1)!==46||U.codePointAt(U.length-2)!==46){if(U.length>2){if(Y=U.lastIndexOf("/"),Y!==U.length-1){Y<0?(U="",F=0):(U=U.slice(0,Y),F=U.length-1-U.lastIndexOf("/")),B=z,q=0;continue}}else if(U.length>0){U="",F=0,B=z,q=0;continue}}j&&(U=U.length>0?U+"/..":"..",F=2)}else U.length>0?U+="/"+V.slice(B+1,z):U=V.slice(B+1,z),F=z-B-1;B=z,q=0}else G===46&&q>-1?q++:q=-1}return U}function assertPath$1(V){if(typeof V!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(V))}const minproc={cwd};function cwd(){return"/"}function isUrl(V){return!!(V!==null&&typeof V=="object"&&"href"in V&&V.href&&"protocol"in V&&V.protocol&&V.auth===void 0)}function urlToPath(V){if(typeof V=="string")V=new URL(V);else if(!isUrl(V)){const j=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+V+"`");throw j.code="ERR_INVALID_ARG_TYPE",j}if(V.protocol!=="file:"){const j=new TypeError("The URL must be of scheme file");throw j.code="ERR_INVALID_URL_SCHEME",j}return getPathFromURLPosix(V)}function getPathFromURLPosix(V){if(V.hostname!==""){const F=new TypeError('File URL host must be "localhost" or empty on darwin');throw F.code="ERR_INVALID_FILE_URL_HOST",F}const j=V.pathname;let U=-1;for(;++U<j.length;)if(j.codePointAt(U)===37&&j.codePointAt(U+1)===50){const F=j.codePointAt(U+2);if(F===70||F===102){const B=new TypeError("File URL path must not include encoded / characters");throw B.code="ERR_INVALID_FILE_URL_PATH",B}}return decodeURIComponent(j)}const order=["history","path","basename","stem","extname","dirname"];class VFile{constructor(j){let U;j?isUrl(j)?U={path:j}:typeof j=="string"||isUint8Array$1(j)?U={value:j}:U=j:U={},this.cwd="cwd"in U?"":minproc.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let F=-1;for(;++F<order.length;){const q=order[F];q in U&&U[q]!==void 0&&U[q]!==null&&(this[q]=q==="history"?[...U[q]]:U[q])}let B;for(B in U)order.includes(B)||(this[B]=U[B])}get basename(){return typeof this.path=="string"?minpath.basename(this.path):void 0}set basename(j){assertNonEmpty(j,"basename"),assertPart(j,"basename"),this.path=minpath.join(this.dirname||"",j)}get dirname(){return typeof this.path=="string"?minpath.dirname(this.path):void 0}set dirname(j){assertPath(this.basename,"dirname"),this.path=minpath.join(j||"",this.basename)}get extname(){return typeof this.path=="string"?minpath.extname(this.path):void 0}set extname(j){if(assertPart(j,"extname"),assertPath(this.dirname,"extname"),j){if(j.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(j.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=minpath.join(this.dirname,this.stem+(j||""))}get path(){return this.history[this.history.length-1]}set path(j){isUrl(j)&&(j=urlToPath(j)),assertNonEmpty(j,"path"),this.path!==j&&this.history.push(j)}get stem(){return typeof this.path=="string"?minpath.basename(this.path,this.extname):void 0}set stem(j){assertNonEmpty(j,"stem"),assertPart(j,"stem"),this.path=minpath.join(this.dirname||"",j+(this.extname||""))}fail(j,U,F){const B=this.message(j,U,F);throw B.fatal=!0,B}info(j,U,F){const B=this.message(j,U,F);return B.fatal=void 0,B}message(j,U,F){const B=new VFileMessage(j,U,F);return this.path&&(B.name=this.path+":"+B.name,B.file=this.path),B.fatal=!1,this.messages.push(B),B}toString(j){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(j||void 0).decode(this.value)}}function assertPart(V,j){if(V&&V.includes(minpath.sep))throw new Error("`"+j+"` cannot be a path: did not expect `"+minpath.sep+"`")}function assertNonEmpty(V,j){if(!V)throw new Error("`"+j+"` cannot be empty")}function assertPath(V,j){if(!V)throw new Error("Setting `"+j+"` requires `path` to be set too")}function isUint8Array$1(V){return!!(V&&typeof V=="object"&&"byteLength"in V&&"byteOffset"in V)}const CallableInstance=(function(V){const F=this.constructor.prototype,B=F[V],q=function(){return B.apply(q,arguments)};return Object.setPrototypeOf(q,F),q}),own={}.hasOwnProperty;class Processor extends CallableInstance{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=trough()}copy(){const j=new Processor;let U=-1;for(;++U<this.attachers.length;){const F=this.attachers[U];j.use(...F)}return j.data(extend(!0,{},this.namespace)),j}data(j,U){return typeof j=="string"?arguments.length===2?(assertUnfrozen("data",this.frozen),this.namespace[j]=U,this):own.call(this.namespace,j)&&this.namespace[j]||void 0:j?(assertUnfrozen("data",this.frozen),this.namespace=j,this):this.namespace}freeze(){if(this.frozen)return this;const j=this;for(;++this.freezeIndex<this.attachers.length;){const[U,...F]=this.attachers[this.freezeIndex];if(F[0]===!1)continue;F[0]===!0&&(F[0]=void 0);const B=U.call(j,...F);typeof B=="function"&&this.transformers.use(B)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(j){this.freeze();const U=vfile(j),F=this.parser||this.Parser;return assertParser("parse",F),F(String(U),U)}process(j,U){const F=this;return this.freeze(),assertParser("process",this.parser||this.Parser),assertCompiler("process",this.compiler||this.Compiler),U?B(void 0,U):new Promise(B);function B(q,z){const G=vfile(j),Y=F.parse(G);F.run(Y,G,function(W,Z,ee){if(W||!Z||!ee)return Q(W);const ne=Z,ae=F.stringify(ne,ee);looksLikeAValue(ae)?ee.value=ae:ee.result=ae,Q(W,ee)});function Q(W,Z){W||!Z?z(W):q?q(Z):U(void 0,Z)}}}processSync(j){let U=!1,F;return this.freeze(),assertParser("processSync",this.parser||this.Parser),assertCompiler("processSync",this.compiler||this.Compiler),this.process(j,B),assertDone("processSync","process",U),F;function B(q,z){U=!0,bail(q),F=z}}run(j,U,F){assertNode(j),this.freeze();const B=this.transformers;return!F&&typeof U=="function"&&(F=U,U=void 0),F?q(void 0,F):new Promise(q);function q(z,G){const Y=vfile(U);B.run(j,Y,Q);function Q(W,Z,ee){const ne=Z||j;W?G(W):z?z(ne):F(void 0,ne,ee)}}}runSync(j,U){let F=!1,B;return this.run(j,U,q),assertDone("runSync","run",F),B;function q(z,G){bail(z),B=G,F=!0}}stringify(j,U){this.freeze();const F=vfile(U),B=this.compiler||this.Compiler;return assertCompiler("stringify",B),assertNode(j),B(j,F)}use(j,...U){const F=this.attachers,B=this.namespace;if(assertUnfrozen("use",this.frozen),j!=null)if(typeof j=="function")Y(j,U);else if(typeof j=="object")Array.isArray(j)?G(j):z(j);else throw new TypeError("Expected usable value, not `"+j+"`");return this;function q(Q){if(typeof Q=="function")Y(Q,[]);else if(typeof Q=="object")if(Array.isArray(Q)){const[W,...Z]=Q;Y(W,Z)}else z(Q);else throw new TypeError("Expected usable value, not `"+Q+"`")}function z(Q){if(!("plugins"in Q)&&!("settings"in Q))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");G(Q.plugins),Q.settings&&(B.settings=extend(!0,B.settings,Q.settings))}function G(Q){let W=-1;if(Q!=null)if(Array.isArray(Q))for(;++W<Q.length;){const Z=Q[W];q(Z)}else throw new TypeError("Expected a list of plugins, not `"+Q+"`")}function Y(Q,W){let Z=-1,ee=-1;for(;++Z<F.length;)if(F[Z][0]===Q){ee=Z;break}if(ee===-1)F.push([Q,...W]);else if(W.length>0){let[ne,...ae]=W;const se=F[ee][1];isPlainObject$1(se)&&isPlainObject$1(ne)&&(ne=extend(!0,se,ne)),F[ee]=[Q,ne,...ae]}}}}const unified=new Processor().freeze();function assertParser(V,j){if(typeof j!="function")throw new TypeError("Cannot `"+V+"` without `parser`")}function assertCompiler(V,j){if(typeof j!="function")throw new TypeError("Cannot `"+V+"` without `compiler`")}function assertUnfrozen(V,j){if(j)throw new Error("Cannot call `"+V+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function assertNode(V){if(!isPlainObject$1(V)||typeof V.type!="string")throw new TypeError("Expected node, got `"+V+"`")}function assertDone(V,j,U){if(!U)throw new Error("`"+V+"` finished async. Use `"+j+"` instead")}function vfile(V){return looksLikeAVFile(V)?V:new VFile(V)}function looksLikeAVFile(V){return!!(V&&typeof V=="object"&&"message"in V&&"messages"in V)}function looksLikeAValue(V){return typeof V=="string"||isUint8Array(V)}function isUint8Array(V){return!!(V&&typeof V=="object"&&"byteLength"in V&&"byteOffset"in V)}const changelog="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",emptyPlugins=[],emptyRemarkRehypeOptions={allowDangerousHtml:!0},safeProtocol=/^(https?|ircs?|mailto|xmpp)$/i,deprecations=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Markdown(V){const j=createProcessor(V),U=createFile(V);return post(j.runSync(j.parse(U),U),V)}function createProcessor(V){const j=V.rehypePlugins||emptyPlugins,U=V.remarkPlugins||emptyPlugins,F=V.remarkRehypeOptions?{...V.remarkRehypeOptions,...emptyRemarkRehypeOptions}:emptyRemarkRehypeOptions;return unified().use(remarkParse).use(U).use(remarkRehype,F).use(j)}function createFile(V){const j=V.children||"",U=new VFile;return typeof j=="string"&&(U.value=j),U}function post(V,j){const U=j.allowedElements,F=j.allowElement,B=j.components,q=j.disallowedElements,z=j.skipHtml,G=j.unwrapDisallowed,Y=j.urlTransform||defaultUrlTransform;for(const W of deprecations)Object.hasOwn(j,W.from)&&(""+W.from+(W.to?"use `"+W.to+"` instead":"remove it")+changelog+W.id,void 0);return visit(V,Q),toJsxRuntime(V,{Fragment:jsxRuntimeExports.Fragment,components:B,ignoreInvalidStyle:!0,jsx:jsxRuntimeExports.jsx,jsxs:jsxRuntimeExports.jsxs,passKeys:!0,passNode:!0});function Q(W,Z,ee){if(W.type==="raw"&&ee&&typeof Z=="number")return z?ee.children.splice(Z,1):ee.children[Z]={type:"text",value:W.value},Z;if(W.type==="element"){let ne;for(ne in urlAttributes)if(Object.hasOwn(urlAttributes,ne)&&Object.hasOwn(W.properties,ne)){const ae=W.properties[ne],se=urlAttributes[ne];(se===null||se.includes(W.tagName))&&(W.properties[ne]=Y(String(ae||""),ne,W))}}if(W.type==="element"){let ne=U?!U.includes(W.tagName):q?q.includes(W.tagName):!1;if(!ne&&F&&typeof Z=="number"&&(ne=!F(W,Z,ee)),ne&&ee&&typeof Z=="number")return G&&W.children?ee.children.splice(Z,1,...W.children):ee.children.splice(Z,1),Z}}}function defaultUrlTransform(V){const j=V.indexOf(":"),U=V.indexOf("?"),F=V.indexOf("#"),B=V.indexOf("/");return j===-1||B!==-1&&j>B||U!==-1&&j>U||F!==-1&&j>F||safeProtocol.test(V.slice(0,j))?V:""}const ChatInterface=({messages:V,setMessages:j,apiUrl:U,sessionId:F,assistant:B,widgetMode:q,setMode:z,setWidgetMode:G})=>{const[Y,Q]=reactExports.useState(""),[W,Z]=reactExports.useState(!1),ee=reactExports.useRef(null),ne=()=>{ee.current?.scrollIntoView({behavior:"smooth"})};reactExports.useEffect(()=>{ne()},[V]);const ae=async()=>{if(!Y.trim())return;Z(!0);const de={id:Date.now().toString(),content:Y.trim(),type:"text",isUser:!0,time:new Date};j(oe=>[...oe,de]),Q("");try{const oe=await sendConversationTextMessage(U,F,de.content);if(!oe.data){console.error("Error sending message to backend");return}const ue={id:(Date.now()+1).toString(),content:oe.data,type:"text",isUser:!1,time:new Date};j(he=>[...he,ue]),Z(!1)}catch(oe){console.error("Message send failed:",oe),Z(!1)}},se=de=>{de.key==="Enter"&&!de.shiftKey&&(de.preventDefault(),ae())};return jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},className:"exthalpy-w-[320px] exthalpy-h-[480px] exthalpy-rounded-2xl exthalpy-bg-white exthalpy-border exthalpy-border-gray-200 exthalpy-shadow-xl exthalpy-flex exthalpy-flex-col exthalpy-overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-justify-between exthalpy-p-3 exthalpy-border-b exthalpy-border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx("img",{src:B?.selectedAvatar?.preview_image_url||"https://exthalpy-public-bucket.blr1.cdn.digitaloceanspaces.com/nerd.png",alt:B?.title||"Assistant",className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-object-cover"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-sm exthalpy-font-semibold exthalpy-text-gray-900",children:B?.title||"Exthalpy Assistant"}),jsxRuntimeExports.jsx("div",{className:"exthalpy-text-xs exthalpy-text-gray-500",children:B?.objective||"24x7 Sales Assistant"})]})]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-flex exthalpy-items-center",children:B.assistantType[0]==="VOICE"?jsxRuntimeExports.jsx(motion.button,{onClick:()=>{G(q),z("voice")},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-border exthalpy-p-2 exthalpy-border-black/20 exthalpy-border-solid exthalpy-rounded-full exthalpy-flex exthalpy-bg-transparent exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black","aria-label":"Expand Widget",children:jsxRuntimeExports.jsx(PhoneCall,{size:20,className:"exthalpy-text-black"})}):jsxRuntimeExports.jsx(motion.button,{onClick:()=>{G(q),z("video")},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-border exthalpy-p-2 exthalpy-border-black/20 exthalpy-border-solid exthalpy-rounded-full exthalpy-flex exthalpy-bg-transparent exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black","aria-label":"Expand Widget",children:jsxRuntimeExports.jsx(Video,{size:16,className:"exthalpy-text-black"})})})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex-1 exthalpy-overflow-y-auto exthalpy-p-4 exthalpy-space-y-3 exthalpy-bg-slate-100",children:[jsxRuntimeExports.jsx(AnimatePresence,{children:V.length>0?V.map(de=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.3},className:`exthalpy-flex ${de.isUser?"exthalpy-justify-end":" exthalpy-justify-start"}`,children:jsxRuntimeExports.jsx("div",{className:`exthalpy-px-4 exthalpy-text-sm exthalpy-rounded-lg exthalpy-max-w-[75%] exthalpy-p-2 ${de.isUser?"exthalpy-bg-black exthalpy-text-white exthalpy-rounded-br-none":"exthalpy-bg-gray-200 exthalpy-text-gray-800 exthalpy-rounded-bl-none"}`,children:jsxRuntimeExports.jsx(Markdown,{children:de.content})})},de.id)):jsxRuntimeExports.jsx("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-h-full exthalpy-text-center exthalpy-text-gray-400 exthalpy-text-sm",children:"Say hello  Im your AI assistant."})}),W&&jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-1 exthalpy-text-xs exthalpy-text-gray-500",children:[jsxRuntimeExports.jsx(motion.span,{animate:{opacity:[.4,1,.4]},transition:{duration:1,repeat:1/0},children:""}),jsxRuntimeExports.jsx(motion.span,{animate:{opacity:[.4,1,.4]},transition:{duration:1,repeat:1/0,delay:.2},children:""}),jsxRuntimeExports.jsx(motion.span,{animate:{opacity:[.4,1,.4]},transition:{duration:1,repeat:1/0,delay:.4},children:""}),jsxRuntimeExports.jsx("span",{children:"AI is typing..."})]}),jsxRuntimeExports.jsx("div",{ref:ee})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-border-t exthalpy-border-gray-200 exthalpy-p-2 exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-bg-white",children:[jsxRuntimeExports.jsx("input",{type:"text",value:Y,onChange:de=>Q(de.target.value),onKeyPress:se,placeholder:"Type your message here...",className:"exthalpy-flex-1 exthalpy-px-3 exthalpy-py-2 exthalpy-text-sm exthalpy-rounded-full exthalpy-border exthalpy-border-black focus:exthalpy-outline-none focus:exthalpy-ring-1 focus:exthalpy-ring-black/20"}),jsxRuntimeExports.jsx("button",{onClick:ae,className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center hover:exthalpy-opacity-90",children:jsxRuntimeExports.jsx(Send,{size:18,className:"exthalpy-text-white"})})]})]})},VoiceAgent=({messages:V,setMessages:j,assistant:U,apiUrl:F,onAiSpeakingChange:B,toggleTimer:q,endCallRequested:z,onEndCallHandled:G,sessionId:Y})=>{const Q=reactExports.useRef(null),W=reactExports.useRef(null),Z=reactExports.useRef(null),ee=reactExports.useRef(null),ne=reactExports.useRef(null),ae=reactExports.useRef(null),se=reactExports.useRef(""),[de,oe]=reactExports.useState(null),[ue,he]=reactExports.useState(!1),[ye,fe]=reactExports.useState(!0),[pe,xe]=reactExports.useState("excellent"),Ee=reactExports.useRef(""),[ke,Ae]=reactExports.useState(!1),[be,Le]=reactExports.useState(""),[Fe,Ne]=reactExports.useState(null),[Ve,Te]=reactExports.useState(300);reactExports.useEffect(()=>{const ge=document.createElement("style");return ge.innerHTML=`
      @keyframes voice-pulse {
        0%, 100% { transform: scaleY(0.3); opacity: 0.3; }
        50%      { transform: scaleY(1);   opacity: 1;   }
      }
    `,document.head.appendChild(ge),()=>{document.head.removeChild(ge)}},[]),reactExports.useEffect(()=>{B(de)},[de,B]);function Oe(ge){const We=new Date(ge);if(isNaN(We.getTime()))throw new Error(`Invalid date string: ${ge}`);return We.toISOString()}function Ue(ge,We=30){const at=new Date(ge);if(isNaN(at.getTime()))throw new Error(`Invalid start time: ${ge}`);return new Date(at.getTime()+We*6e4).toISOString()}async function Ye({prefill:ge}){return new Promise(We=>{Le(ge||""),Ae(!0),Ne(()=>We)})}const le=async()=>{oe(!1),console.log("End call Start"),W.current?.getSenders().forEach(We=>We.track?.stop()),W.current?.close(),W.current=null,Q.current?.readyState==="open"&&Q.current.close(),Z.current?.getTracks().forEach(We=>We.stop()),Z.current=null,ee.current&&(ee.current.pause(),ee.current.currentTime=0,ee.current.srcObject=null),ae.current?.disconnect(),ae.current=null,await ne.current?.close(),ne.current=null;const ge=await storeVoiceCallMessages(F,Y,V);console.log(ge),q(),he(!1),console.log("End call End"),Te(300)},we=async ge=>{try{console.log("Start call Start",U);const{client_secret:We}=await getVoiceCallTokenForAudioAgent(F,U.audioAgentVoice.name),at=We.value,{adminCalendarPermissions:$e}=await checkAdminCalendarPermission(F,U.ownerId);q();const ht=new RTCPeerConnection;W.current=ht,Z.current=await navigator.mediaDevices.getUserMedia({audio:!0});const[ut]=Z.current.getTracks();ht.addTrack(ut);const ft=ht.createDataChannel("oai-events");Q.current=ft,ft.onopen=()=>{let Qt=ge||"";$e?Qt+=`

 You are also a helpful voice assistant who supports scheduling Google Meet calls between users and an admin.

Your role is to collect the **necessary information from the user** to book a meeting with the admin.

You already have the **admin's details**. 

Ask the user for:
1. First ask the user for their email , to do this use the "get_user_email" tool. The tool opens a pop up modal for the user to enter their email. Suggest the user to enter their email in the Box below to book a google meet call. This avoids spell check errors and ensures the correct email is entered.
2. Then proceed to ask the **purpose or title** of the meeting.
3. The **preferred date and time** for the meeting.
4. (Optional) The **duration** of the meeting, or confirm the default (30 minutes).
5. After this step call the "book_meeting" tool.

 **Important**:  
Always ask the user to provide a **specific and complete date**, such as **"July 18th at 3 PM"**, instead of vague expressions like "today", "tomorrow", or "day after".  
This helps prevent confusion and ensures accurate scheduling. Politely guide the user to give **clear and calendar-specific** dates and times.

The timezone is always set to **"Asia/Kolkata" (UTC+5:30)**.

Once all required information is collected, use the "book_meeting" tool to schedule the call between the user and the admin.  
After the "book_meeting" tool is called THIS STEP IS **VERY IMPORTANT**, you must always use the exact output string returned in the book_meeting response as your complete spoken response, as it will suggest if the meeting was successfully scheduled or not. 
Note that setting a meeting is a two step process behind the scenes , first we check if the meeting was available or not during the specified time and later if available then only we schedule it. So **dont automatically assume success** after "book_meeting" is called.
Again DO NOT ASSUME that meeting has been set successfully.

**Before calling the tool:**
- The assistant **must repeat and confirm** all collected details with the user  including the meeting title, exact date and time, duration and the email entered by the user.
- If the user uses vague phrases like **"today"** or **"tomorrow"**, **do not proceed** until the user rephrases with a proper date and time (e.g., "July 19th, 2:00 PM").
- You must always **interpret the date as belonging to the year 2025**, even if the user doesn't mention the year. **YEAR 2025 IS IMPORTANT**

If the user wishes to end the interaction at any point, you can also call the "end_call" tool directly with a friendly closing message.

You must always:
- Speak clearly and naturally.
- Confirm the meeting details with the user before proceeding.
- Avoid performing any unrelated tasks. You are a focused meeting assistant designed solely for scheduling.`:Qt+=`
If the user asks to set up a Google Meet, say:  
**"The admin hasnt given permission to access Google Calendar yet. Kindly ask them to connect their calendar to enable meeting scheduling."**`;const tn={type:"session.update",session:{instructions:Qt,input_audio_transcription:{model:"whisper-1"},tools:[{type:"function",name:"get_user_email",description:"Opens a UI modal asking the user to enter their email address, the user's email will be used in the book_meeting function to add user as participant",parameters:{type:"object",properties:{user_email:{type:"string",description:"Prefill if known"}},required:["user_email"]}},{type:"function",name:"book_meeting",description:"Schedule a Google Meet call with the user.",parameters:{type:"object",properties:{meeting_title:{type:"string",description:"Title or subject of the Google Meet"},booking_time:{type:"string",description:"Time of the meeting (in ISO 8601)"},duration_minutes:{type:"number",default:30},timezone:{type:"string",default:"Asia/Kolkata"}},required:["meeting_title","booking_time"]}}],tool_choice:"auto"}};ft.send(JSON.stringify(tn));const Gt=U.personalityData?.greetingMessage||"Hi there! How can I help you today?";ft.send(JSON.stringify({type:"response.create",response:{modalities:["text","audio"],instructions:"Greet the users with this greeting message "+Gt}}))},ft.onmessage=async Qt=>{const tn=JSON.parse(Qt.data),{type:Gt,transcript:cn,text:bt,delta:dn,name:At,arguments:Wt,call_id:nn}=tn;if(Gt==="conversation.item.input_audio_transcription.completed"){const De=cn||bt;if(De){const Xe={id:Date.now().toString(),userId:localStorage.getItem("userId"),content:De,type:"text",isUser:!0,time:new Date};j(et=>[...et,Xe])}}if(Gt==="response.audio_transcript.delta"&&(se.current+=dn),Gt==="response.audio_transcript.done"){const De=se.current.trim();if(De){const Xe={id:(Date.now()+1).toString(),userId:localStorage.getItem("userId"),content:De,type:"text",isUser:!1,time:new Date};j(et=>[...et,Xe]),Te(300)}se.current=""}if(Gt==="response.function_call_arguments.done"){console.log("Function called:",At);const De=At,Xe=JSON.parse(Wt);if(De==="get_user_email"){const et=await Ye({prefill:Xe.user_email});Ee.current=et,ft.send(JSON.stringify({type:"conversation.item.create",item:{type:"function_call_output",call_id:nn,output:et}})),ft.send(JSON.stringify({type:"response.create",response:{modalities:["text","audio"],instructions:"Thanks! I've got your email. What's the title of the meeting?"}}));return}if(De==="book_meeting"){const{meeting_title:et,booking_time:tt,duration_minutes:_e=30}=Xe;if(!Ee.current){console.warn("No email found  requesting get_user_email again..."),ft.send(JSON.stringify({type:"response.create",response:{modalities:["text","audio"],instructions:"I need your email before booking. Please enter it in the box that just opened."}})),ft.send(JSON.stringify({type:"response.create",response:{instructions:'Call the "get_user_email" tool with { "user_email": "" }'}}));return}console.log("T testing sending to webHook ",{meeting_title:et,participant_name:"Tryambak",email:Ee.current,start_time:Oe(tt),end_time:Ue(tt,_e),admin_email:"sanjeevkumar@exthalpy.com"});try{const je=await bookGoogleMeetForAudioCall(F,{meeting_title:et,participant_name:"Tryambak",email:Ee.current,start_time:Oe(tt),end_time:Ue(tt,_e),admin_email:"sanjeevkumar@exthalpy.com"});console.log("Webhook response:",je);const it=JSON.parse(je).status;console.log("T testing Booking Status:",it);const pt=it==="success"?" Your booking was successful and has been submitted to Google Calendar.":"Unfortunately, the time is not available. Please suggest a different Time to try again";console.log("T testing response ",pt);const Vt={type:"conversation.item.create",item:{type:"function_call_output",call_id:nn,output:pt}};ft.send(JSON.stringify(Vt)),ft.send(JSON.stringify({type:"response.create",response:{modalities:["text","audio"],instructions:`Inform the user: ${pt}. Be concise and friendly.`}}))}catch(je){console.error("Error booking installation:",je)}}}},ht.ontrack=Qt=>{const tn=Qt.streams[0];if(ee.current){ee.current.srcObject=tn,ee.current.volume=1;const Wt=ee.current.play();Wt!==void 0&&Wt.catch(nn=>{console.error("Audio playback error:",nn),ne.current?.state==="suspended"&&ne.current.resume()})}const Gt=new AudioContext;ne.current=Gt;const cn=Gt.createMediaStreamSource(tn);ae.current=cn;const bt=Gt.createAnalyser();bt.fftSize=512,cn.connect(bt);const dn=new Uint8Array(bt.frequencyBinCount),At=setInterval(()=>{bt.getByteFrequencyData(dn);const Wt=dn.reduce((nn,De)=>nn+De,0)/dn.length;oe(Wt>10)},300);tn.getTracks().forEach(Wt=>Wt.addEventListener("ended",()=>{clearInterval(At),oe(!1)}))};const $t=await ht.createOffer();await ht.setLocalDescription($t);const Nn={type:"answer",sdp:await(await fetch("https://api.openai.com/v1/realtime?model=gpt-4o-realtime-preview-2024-12-17",{method:"POST",body:$t.sdp,headers:{Authorization:`Bearer ${at}`,"Content-Type":"application/sdp"}})).text()};await ht.setRemoteDescription(Nn),he(!0)}catch(We){console.error("Start call error:",We),await le()}},He=()=>{const ge=Z.current;if(!ge)return;const We=ge.getAudioTracks()[0];We.enabled=!We.enabled,fe(We.enabled)};return reactExports.useEffect(()=>(we(U.prompt),xe("excellent"),()=>{console.log("Unmounting Voice"),le(),xe("poor"),Te(300)}),[U.prompt]),reactExports.useEffect(()=>{z&&le().then(()=>{G?.()})},[z]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-w-full exthalpy-h-full ",children:jsxRuntimeExports.jsx("button",{onClick:()=>He(),className:"exthalpy-border-0 exthalpy-bg-transparent",children:ye?jsxRuntimeExports.jsx(Mic,{className:"exthalpy-text-black"}):jsxRuntimeExports.jsx(MicOff,{className:"exthalpy-text-black"})})}),jsxRuntimeExports.jsx("audio",{ref:ee,autoPlay:!0,playsInline:!0,controls:!1,style:{display:"none"}})]})};var isMergeableObject=function V(j){return isNonNullObject(j)&&!isSpecial(j)};function isNonNullObject(V){return!!V&&typeof V=="object"}function isSpecial(V){var j=Object.prototype.toString.call(V);return j==="[object RegExp]"||j==="[object Date]"||isReactElement(V)}var canUseSymbol=typeof Symbol=="function"&&Symbol.for,REACT_ELEMENT_TYPE=canUseSymbol?Symbol.for("react.element"):60103;function isReactElement(V){return V.$$typeof===REACT_ELEMENT_TYPE}function emptyTarget(V){return Array.isArray(V)?[]:{}}function cloneUnlessOtherwiseSpecified(V,j){return j.clone!==!1&&j.isMergeableObject(V)?deepmerge(emptyTarget(V),V,j):V}function defaultArrayMerge(V,j,U){return V.concat(j).map(function(F){return cloneUnlessOtherwiseSpecified(F,U)})}function mergeObject(V,j,U){var F={};return U.isMergeableObject(V)&&Object.keys(V).forEach(function(B){F[B]=cloneUnlessOtherwiseSpecified(V[B],U)}),Object.keys(j).forEach(function(B){!U.isMergeableObject(j[B])||!V[B]?F[B]=cloneUnlessOtherwiseSpecified(j[B],U):F[B]=deepmerge(V[B],j[B],U)}),F}function deepmerge(V,j,U){U=U||{},U.arrayMerge=U.arrayMerge||defaultArrayMerge,U.isMergeableObject=U.isMergeableObject||isMergeableObject;var F=Array.isArray(j),B=Array.isArray(V),q=F===B;return q?F?U.arrayMerge(V,j,U):mergeObject(V,j,U):cloneUnlessOtherwiseSpecified(j,U)}deepmerge.all=function V(j,U){if(!Array.isArray(j))throw new Error("first argument should be an array");return j.reduce(function(F,B){return deepmerge(F,B,U)},{})};var deepmerge_1=deepmerge,freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$d=Object.prototype,hasOwnProperty$a=objectProto$d.hasOwnProperty,nativeObjectToString$1=objectProto$d.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(V){var j=hasOwnProperty$a.call(V,symToStringTag$1),U=V[symToStringTag$1];try{V[symToStringTag$1]=void 0;var F=!0}catch{}var B=nativeObjectToString$1.call(V);return F&&(j?V[symToStringTag$1]=U:delete V[symToStringTag$1]),B}var objectProto$c=Object.prototype,nativeObjectToString=objectProto$c.toString;function objectToString(V){return nativeObjectToString.call(V)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(V){return V==null?V===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(V)?getRawTag(V):objectToString(V)}function overArg(V,j){return function(U){return V(j(U))}}var getPrototype=overArg(Object.getPrototypeOf,Object);function isObjectLike(V){return V!=null&&typeof V=="object"}var objectTag$3="[object Object]",funcProto$2=Function.prototype,objectProto$b=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$9=objectProto$b.hasOwnProperty,objectCtorString=funcToString$2.call(Object);function isPlainObject(V){if(!isObjectLike(V)||baseGetTag(V)!=objectTag$3)return!1;var j=getPrototype(V);if(j===null)return!0;var U=hasOwnProperty$9.call(j,"constructor")&&j.constructor;return typeof U=="function"&&U instanceof U&&funcToString$2.call(U)==objectCtorString}function listCacheClear(){this.__data__=[],this.size=0}function eq(V,j){return V===j||V!==V&&j!==j}function assocIndexOf(V,j){for(var U=V.length;U--;)if(eq(V[U][0],j))return U;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(V){var j=this.__data__,U=assocIndexOf(j,V);if(U<0)return!1;var F=j.length-1;return U==F?j.pop():splice.call(j,U,1),--this.size,!0}function listCacheGet(V){var j=this.__data__,U=assocIndexOf(j,V);return U<0?void 0:j[U][1]}function listCacheHas(V){return assocIndexOf(this.__data__,V)>-1}function listCacheSet(V,j){var U=this.__data__,F=assocIndexOf(U,V);return F<0?(++this.size,U.push([V,j])):U[F][1]=j,this}function ListCache(V){var j=-1,U=V==null?0:V.length;for(this.clear();++j<U;){var F=V[j];this.set(F[0],F[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(V){var j=this.__data__,U=j.delete(V);return this.size=j.size,U}function stackGet(V){return this.__data__.get(V)}function stackHas(V){return this.__data__.has(V)}function isObject$2(V){var j=typeof V;return V!=null&&(j=="object"||j=="function")}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(V){if(!isObject$2(V))return!1;var j=baseGetTag(V);return j==funcTag$2||j==genTag$1||j==asyncTag||j==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=(function(){var V=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return V?"Symbol(src)_1."+V:""})();function isMasked(V){return!!maskSrcKey&&maskSrcKey in V}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(V){if(V!=null){try{return funcToString$1.call(V)}catch{}try{return V+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$a=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$8=objectProto$a.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$8).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(V){if(!isObject$2(V)||isMasked(V))return!1;var j=isFunction$1(V)?reIsNative:reIsHostCtor;return j.test(toSource(V))}function getValue(V,j){return V?.[j]}function getNative(V,j){var U=getValue(V,j);return baseIsNative(U)?U:void 0}var Map$1=getNative(root,"Map"),nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(V){var j=this.has(V)&&delete this.__data__[V];return this.size-=j?1:0,j}var HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty;function hashGet(V){var j=this.__data__;if(nativeCreate){var U=j[V];return U===HASH_UNDEFINED$1?void 0:U}return hasOwnProperty$7.call(j,V)?j[V]:void 0}var objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function hashHas(V){var j=this.__data__;return nativeCreate?j[V]!==void 0:hasOwnProperty$6.call(j,V)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(V,j){var U=this.__data__;return this.size+=this.has(V)?0:1,U[V]=nativeCreate&&j===void 0?HASH_UNDEFINED:j,this}function Hash(V){var j=-1,U=V==null?0:V.length;for(this.clear();++j<U;){var F=V[j];this.set(F[0],F[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(V){var j=typeof V;return j=="string"||j=="number"||j=="symbol"||j=="boolean"?V!=="__proto__":V===null}function getMapData(V,j){var U=V.__data__;return isKeyable(j)?U[typeof j=="string"?"string":"hash"]:U.map}function mapCacheDelete(V){var j=getMapData(this,V).delete(V);return this.size-=j?1:0,j}function mapCacheGet(V){return getMapData(this,V).get(V)}function mapCacheHas(V){return getMapData(this,V).has(V)}function mapCacheSet(V,j){var U=getMapData(this,V),F=U.size;return U.set(V,j),this.size+=U.size==F?0:1,this}function MapCache(V){var j=-1,U=V==null?0:V.length;for(this.clear();++j<U;){var F=V[j];this.set(F[0],F[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var LARGE_ARRAY_SIZE=200;function stackSet(V,j){var U=this.__data__;if(U instanceof ListCache){var F=U.__data__;if(!Map$1||F.length<LARGE_ARRAY_SIZE-1)return F.push([V,j]),this.size=++U.size,this;U=this.__data__=new MapCache(F)}return U.set(V,j),this.size=U.size,this}function Stack(V){var j=this.__data__=new ListCache(V);this.size=j.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;function arrayEach(V,j){for(var U=-1,F=V==null?0:V.length;++U<F&&j(V[U],U,V)!==!1;);return V}var defineProperty=(function(){try{var V=getNative(Object,"defineProperty");return V({},"",{}),V}catch{}})();function baseAssignValue(V,j,U){j=="__proto__"&&defineProperty?defineProperty(V,j,{configurable:!0,enumerable:!0,value:U,writable:!0}):V[j]=U}var objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function assignValue(V,j,U){var F=V[j];(!(hasOwnProperty$5.call(V,j)&&eq(F,U))||U===void 0&&!(j in V))&&baseAssignValue(V,j,U)}function copyObject(V,j,U,F){var B=!U;U||(U={});for(var q=-1,z=j.length;++q<z;){var G=j[q],Y=void 0;Y===void 0&&(Y=V[G]),B?baseAssignValue(U,G,Y):assignValue(U,G,Y)}return U}function baseTimes(V,j){for(var U=-1,F=Array(V);++U<V;)F[U]=j(U);return F}var argsTag$2="[object Arguments]";function baseIsArguments(V){return isObjectLike(V)&&baseGetTag(V)==argsTag$2}var objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty,propertyIsEnumerable$1=objectProto$6.propertyIsEnumerable,isArguments=baseIsArguments((function(){return arguments})())?baseIsArguments:function(V){return isObjectLike(V)&&hasOwnProperty$4.call(V,"callee")&&!propertyIsEnumerable$1.call(V,"callee")},isArray=Array.isArray;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(V,j){var U=typeof V;return j=j??MAX_SAFE_INTEGER$1,!!j&&(U=="number"||U!="symbol"&&reIsUint.test(V))&&V>-1&&V%1==0&&V<j}var MAX_SAFE_INTEGER=9007199254740991;function isLength(V){return typeof V=="number"&&V>-1&&V%1==0&&V<=MAX_SAFE_INTEGER}var argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$1="[object Function]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$2]=typedArrayTags[boolTag$2]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$2]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$4]=typedArrayTags[numberTag$2]=typedArrayTags[objectTag$2]=typedArrayTags[regexpTag$2]=typedArrayTags[setTag$4]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(V){return isObjectLike(V)&&isLength(V.length)&&!!typedArrayTags[baseGetTag(V)]}function baseUnary(V){return function(j){return V(j)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=(function(){try{var V=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return V||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}})(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$5=Object.prototype,hasOwnProperty$3=objectProto$5.hasOwnProperty;function arrayLikeKeys(V,j){var U=isArray(V),F=!U&&isArguments(V),B=!U&&!F&&isBuffer(V),q=!U&&!F&&!B&&isTypedArray(V),z=U||F||B||q,G=z?baseTimes(V.length,String):[],Y=G.length;for(var Q in V)(j||hasOwnProperty$3.call(V,Q))&&!(z&&(Q=="length"||B&&(Q=="offset"||Q=="parent")||q&&(Q=="buffer"||Q=="byteLength"||Q=="byteOffset")||isIndex(Q,Y)))&&G.push(Q);return G}var objectProto$4=Object.prototype;function isPrototype(V){var j=V&&V.constructor,U=typeof j=="function"&&j.prototype||objectProto$4;return V===U}var nativeKeys=overArg(Object.keys,Object),objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function baseKeys(V){if(!isPrototype(V))return nativeKeys(V);var j=[];for(var U in Object(V))hasOwnProperty$2.call(V,U)&&U!="constructor"&&j.push(U);return j}function isArrayLike(V){return V!=null&&isLength(V.length)&&!isFunction$1(V)}function keys(V){return isArrayLike(V)?arrayLikeKeys(V):baseKeys(V)}function baseAssign(V,j){return V&&copyObject(j,keys(j),V)}function nativeKeysIn(V){var j=[];if(V!=null)for(var U in Object(V))j.push(U);return j}var objectProto$2=Object.prototype,hasOwnProperty$1=objectProto$2.hasOwnProperty;function baseKeysIn(V){if(!isObject$2(V))return nativeKeysIn(V);var j=isPrototype(V),U=[];for(var F in V)F=="constructor"&&(j||!hasOwnProperty$1.call(V,F))||U.push(F);return U}function keysIn(V){return isArrayLike(V)?arrayLikeKeys(V,!0):baseKeysIn(V)}function baseAssignIn(V,j){return V&&copyObject(j,keysIn(j),V)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(V,j){if(j)return V.slice();var U=V.length,F=allocUnsafe?allocUnsafe(U):new V.constructor(U);return V.copy(F),F}function copyArray(V,j){var U=-1,F=V.length;for(j||(j=Array(F));++U<F;)j[U]=V[U];return j}function arrayFilter(V,j){for(var U=-1,F=V==null?0:V.length,B=0,q=[];++U<F;){var z=V[U];j(z,U,V)&&(q[B++]=z)}return q}function stubArray(){return[]}var objectProto$1=Object.prototype,propertyIsEnumerable=objectProto$1.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(V){return V==null?[]:(V=Object(V),arrayFilter(nativeGetSymbols$1(V),function(j){return propertyIsEnumerable.call(V,j)}))}:stubArray;function copySymbols(V,j){return copyObject(V,getSymbols(V),j)}function arrayPush(V,j){for(var U=-1,F=j.length,B=V.length;++U<F;)V[B+U]=j[U];return V}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(V){for(var j=[];V;)arrayPush(j,getSymbols(V)),V=getPrototype(V);return j}:stubArray;function copySymbolsIn(V,j){return copyObject(V,getSymbolsIn(V),j)}function baseGetAllKeys(V,j,U){var F=j(V);return isArray(V)?F:arrayPush(F,U(V))}function getAllKeys(V){return baseGetAllKeys(V,keys,getSymbols)}function getAllKeysIn(V){return baseGetAllKeys(V,keysIn,getSymbolsIn)}var DataView$1=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),WeakMap$1=getNative(root,"WeakMap"),mapTag$3="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$3="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$2||Map$1&&getTag(new Map$1)!=mapTag$3||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$3||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(V){var j=baseGetTag(V),U=j==objectTag$1?V.constructor:void 0,F=U?toSource(U):"";if(F)switch(F){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$3;case promiseCtorString:return promiseTag;case setCtorString:return setTag$3;case weakMapCtorString:return weakMapTag$1}return j});var objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function initCloneArray(V){var j=V.length,U=new V.constructor(j);return j&&typeof V[0]=="string"&&hasOwnProperty.call(V,"index")&&(U.index=V.index,U.input=V.input),U}var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(V){var j=new V.constructor(V.byteLength);return new Uint8Array$1(j).set(new Uint8Array$1(V)),j}function cloneDataView(V,j){var U=j?cloneArrayBuffer(V.buffer):V.buffer;return new V.constructor(U,V.byteOffset,V.byteLength)}var reFlags=/\w*$/;function cloneRegExp(V){var j=new V.constructor(V.source,reFlags.exec(V));return j.lastIndex=V.lastIndex,j}var symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(V){return symbolValueOf?Object(symbolValueOf.call(V)):{}}function cloneTypedArray(V,j){var U=j?cloneArrayBuffer(V.buffer):V.buffer;return new V.constructor(U,V.byteOffset,V.length)}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(V,j,U){var F=V.constructor;switch(j){case arrayBufferTag$1:return cloneArrayBuffer(V);case boolTag$1:case dateTag$1:return new F(+V);case dataViewTag$1:return cloneDataView(V,U);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(V,U);case mapTag$2:return new F;case numberTag$1:case stringTag$1:return new F(V);case regexpTag$1:return cloneRegExp(V);case setTag$2:return new F;case symbolTag$2:return cloneSymbol(V)}}var objectCreate=Object.create,baseCreate=(function(){function V(){}return function(j){if(!isObject$2(j))return{};if(objectCreate)return objectCreate(j);V.prototype=j;var U=new V;return V.prototype=void 0,U}})();function initCloneObject(V){return typeof V.constructor=="function"&&!isPrototype(V)?baseCreate(getPrototype(V)):{}}var mapTag$1="[object Map]";function baseIsMap(V){return isObjectLike(V)&&getTag(V)==mapTag$1}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$1="[object Set]";function baseIsSet(V){return isObjectLike(V)&&getTag(V)==setTag$1}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(V,j,U,F,B,q){var z,G=j&CLONE_DEEP_FLAG$1,Y=j&CLONE_FLAT_FLAG,Q=j&CLONE_SYMBOLS_FLAG$2;if(z!==void 0)return z;if(!isObject$2(V))return V;var W=isArray(V);if(W){if(z=initCloneArray(V),!G)return copyArray(V,z)}else{var Z=getTag(V),ee=Z==funcTag||Z==genTag;if(isBuffer(V))return cloneBuffer(V,G);if(Z==objectTag||Z==argsTag||ee&&!B){if(z=Y||ee?{}:initCloneObject(V),!G)return Y?copySymbolsIn(V,baseAssignIn(z,V)):copySymbols(V,baseAssign(z,V))}else{if(!cloneableTags[Z])return B?V:{};z=initCloneByTag(V,Z,G)}}q||(q=new Stack);var ne=q.get(V);if(ne)return ne;q.set(V,z),isSet(V)?V.forEach(function(de){z.add(baseClone(de,j,U,de,V,q))}):isMap(V)&&V.forEach(function(de,oe){z.set(oe,baseClone(de,j,U,oe,V,q))});var ae=Q?Y?getAllKeysIn:getAllKeys:Y?keysIn:keys,se=W?void 0:ae(V);return arrayEach(se||V,function(de,oe){se&&(oe=de,de=V[oe]),assignValue(z,oe,baseClone(de,j,U,oe,V,q))}),z}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(V){return baseClone(V,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG$1)}var reactFastCompare,hasRequiredReactFastCompare;function requireReactFastCompare(){if(hasRequiredReactFastCompare)return reactFastCompare;hasRequiredReactFastCompare=1;var V=Array.isArray,j=Object.keys,U=Object.prototype.hasOwnProperty,F=typeof Element<"u";function B(q,z){if(q===z)return!0;if(q&&z&&typeof q=="object"&&typeof z=="object"){var G=V(q),Y=V(z),Q,W,Z;if(G&&Y){if(W=q.length,W!=z.length)return!1;for(Q=W;Q--!==0;)if(!B(q[Q],z[Q]))return!1;return!0}if(G!=Y)return!1;var ee=q instanceof Date,ne=z instanceof Date;if(ee!=ne)return!1;if(ee&&ne)return q.getTime()==z.getTime();var ae=q instanceof RegExp,se=z instanceof RegExp;if(ae!=se)return!1;if(ae&&se)return q.toString()==z.toString();var de=j(q);if(W=de.length,W!==j(z).length)return!1;for(Q=W;Q--!==0;)if(!U.call(z,de[Q]))return!1;if(F&&q instanceof Element&&z instanceof Element)return q===z;for(Q=W;Q--!==0;)if(Z=de[Q],!(Z==="_owner"&&q.$$typeof)&&!B(q[Z],z[Z]))return!1;return!0}return q!==q&&z!==z}return reactFastCompare=function(z,G){try{return B(z,G)}catch(Y){if(Y.message&&Y.message.match(/stack|recursion/i)||Y.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",Y.name,Y.message),!1;throw Y}},reactFastCompare}var reactFastCompareExports=requireReactFastCompare();const isEqual=getDefaultExportFromCjs$1(reactFastCompareExports);var CLONE_SYMBOLS_FLAG=4;function clone$1(V){return baseClone(V,CLONE_SYMBOLS_FLAG)}function arrayMap(V,j){for(var U=-1,F=V==null?0:V.length,B=Array(F);++U<F;)B[U]=j(V[U],U,V);return B}var symbolTag="[object Symbol]";function isSymbol(V){return typeof V=="symbol"||isObjectLike(V)&&baseGetTag(V)==symbolTag}var FUNC_ERROR_TEXT="Expected a function";function memoize(V,j){if(typeof V!="function"||j!=null&&typeof j!="function")throw new TypeError(FUNC_ERROR_TEXT);var U=function(){var F=arguments,B=j?j.apply(this,F):F[0],q=U.cache;if(q.has(B))return q.get(B);var z=V.apply(this,F);return U.cache=q.set(B,z)||q,z};return U.cache=new(memoize.Cache||MapCache),U}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(V){var j=memoize(V,function(F){return U.size===MAX_MEMOIZE_SIZE&&U.clear(),F}),U=j.cache;return j}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(V){var j=[];return V.charCodeAt(0)===46&&j.push(""),V.replace(rePropName,function(U,F,B,q){j.push(B?q.replace(reEscapeChar,"$1"):F||U)}),j});function toKey(V){if(typeof V=="string"||isSymbol(V))return V;var j=V+"";return j=="0"&&1/V==-1/0?"-0":j}var symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolToString$1=symbolProto?symbolProto.toString:void 0;function baseToString(V){if(typeof V=="string")return V;if(isArray(V))return arrayMap(V,baseToString)+"";if(isSymbol(V))return symbolToString$1?symbolToString$1.call(V):"";var j=V+"";return j=="0"&&1/V==-1/0?"-0":j}function toString$1(V){return V==null?"":baseToString(V)}function toPath(V){return isArray(V)?arrayMap(V,toKey):isSymbol(V)?[V]:copyArray(stringToPath(toString$1(V)))}var reactIs={exports:{}},reactIs_production_min={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactIs_production_min;function requireReactIs_production_min(){if(hasRequiredReactIs_production_min)return reactIs_production_min;hasRequiredReactIs_production_min=1;var V=typeof Symbol=="function"&&Symbol.for,j=V?Symbol.for("react.element"):60103,U=V?Symbol.for("react.portal"):60106,F=V?Symbol.for("react.fragment"):60107,B=V?Symbol.for("react.strict_mode"):60108,q=V?Symbol.for("react.profiler"):60114,z=V?Symbol.for("react.provider"):60109,G=V?Symbol.for("react.context"):60110,Y=V?Symbol.for("react.async_mode"):60111,Q=V?Symbol.for("react.concurrent_mode"):60111,W=V?Symbol.for("react.forward_ref"):60112,Z=V?Symbol.for("react.suspense"):60113,ee=V?Symbol.for("react.suspense_list"):60120,ne=V?Symbol.for("react.memo"):60115,ae=V?Symbol.for("react.lazy"):60116,se=V?Symbol.for("react.block"):60121,de=V?Symbol.for("react.fundamental"):60117,oe=V?Symbol.for("react.responder"):60118,ue=V?Symbol.for("react.scope"):60119;function he(fe){if(typeof fe=="object"&&fe!==null){var pe=fe.$$typeof;switch(pe){case j:switch(fe=fe.type,fe){case Y:case Q:case F:case q:case B:case Z:return fe;default:switch(fe=fe&&fe.$$typeof,fe){case G:case W:case ae:case ne:case z:return fe;default:return pe}}case U:return pe}}}function ye(fe){return he(fe)===Q}return reactIs_production_min.AsyncMode=Y,reactIs_production_min.ConcurrentMode=Q,reactIs_production_min.ContextConsumer=G,reactIs_production_min.ContextProvider=z,reactIs_production_min.Element=j,reactIs_production_min.ForwardRef=W,reactIs_production_min.Fragment=F,reactIs_production_min.Lazy=ae,reactIs_production_min.Memo=ne,reactIs_production_min.Portal=U,reactIs_production_min.Profiler=q,reactIs_production_min.StrictMode=B,reactIs_production_min.Suspense=Z,reactIs_production_min.isAsyncMode=function(fe){return ye(fe)||he(fe)===Y},reactIs_production_min.isConcurrentMode=ye,reactIs_production_min.isContextConsumer=function(fe){return he(fe)===G},reactIs_production_min.isContextProvider=function(fe){return he(fe)===z},reactIs_production_min.isElement=function(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===j},reactIs_production_min.isForwardRef=function(fe){return he(fe)===W},reactIs_production_min.isFragment=function(fe){return he(fe)===F},reactIs_production_min.isLazy=function(fe){return he(fe)===ae},reactIs_production_min.isMemo=function(fe){return he(fe)===ne},reactIs_production_min.isPortal=function(fe){return he(fe)===U},reactIs_production_min.isProfiler=function(fe){return he(fe)===q},reactIs_production_min.isStrictMode=function(fe){return he(fe)===B},reactIs_production_min.isSuspense=function(fe){return he(fe)===Z},reactIs_production_min.isValidElementType=function(fe){return typeof fe=="string"||typeof fe=="function"||fe===F||fe===Q||fe===q||fe===B||fe===Z||fe===ee||typeof fe=="object"&&fe!==null&&(fe.$$typeof===ae||fe.$$typeof===ne||fe.$$typeof===z||fe.$$typeof===G||fe.$$typeof===W||fe.$$typeof===de||fe.$$typeof===oe||fe.$$typeof===ue||fe.$$typeof===se)},reactIs_production_min.typeOf=he,reactIs_production_min}var hasRequiredReactIs;function requireReactIs(){return hasRequiredReactIs||(hasRequiredReactIs=1,reactIs.exports=requireReactIs_production_min()),reactIs.exports}var hoistNonReactStatics_cjs,hasRequiredHoistNonReactStatics_cjs;function requireHoistNonReactStatics_cjs(){if(hasRequiredHoistNonReactStatics_cjs)return hoistNonReactStatics_cjs;hasRequiredHoistNonReactStatics_cjs=1;var V=requireReactIs(),j={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},U={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},F={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},B={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},q={};q[V.ForwardRef]=F,q[V.Memo]=B;function z(ae){return V.isMemo(ae)?B:q[ae.$$typeof]||j}var G=Object.defineProperty,Y=Object.getOwnPropertyNames,Q=Object.getOwnPropertySymbols,W=Object.getOwnPropertyDescriptor,Z=Object.getPrototypeOf,ee=Object.prototype;function ne(ae,se,de){if(typeof se!="string"){if(ee){var oe=Z(se);oe&&oe!==ee&&ne(ae,oe,de)}var ue=Y(se);Q&&(ue=ue.concat(Q(se)));for(var he=z(ae),ye=z(se),fe=0;fe<ue.length;++fe){var pe=ue[fe];if(!U[pe]&&!(de&&de[pe])&&!(ye&&ye[pe])&&!(he&&he[pe])){var xe=W(se,pe);try{G(ae,pe,xe)}catch{}}}}return ae}return hoistNonReactStatics_cjs=ne,hoistNonReactStatics_cjs}requireHoistNonReactStatics_cjs();function _extends(){return _extends=Object.assign||function(V){for(var j=1;j<arguments.length;j++){var U=arguments[j];for(var F in U)Object.prototype.hasOwnProperty.call(U,F)&&(V[F]=U[F])}return V},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(V,j){if(V==null)return{};var U={},F=Object.keys(V),B,q;for(q=0;q<F.length;q++)B=F[q],!(j.indexOf(B)>=0)&&(U[B]=V[B]);return U}var FormikContext=reactExports.createContext(void 0);FormikContext.displayName="FormikContext",FormikContext.Provider,FormikContext.Consumer;function useFormikContext(){var V=reactExports.useContext(FormikContext);return V}var isFunction=function V(j){return typeof j=="function"},isObject$1=function V(j){return j!==null&&typeof j=="object"},isInteger=function V(j){return String(Math.floor(Number(j)))===j},isString=function V(j){return Object.prototype.toString.call(j)==="[object String]"},isPromise=function V(j){return isObject$1(j)&&isFunction(j.then)};function getIn$1(V,j,U,F){F===void 0&&(F=0);for(var B=toPath(j);V&&F<B.length;)V=V[B[F++]];return F!==B.length&&!V||V===void 0?U:V}function setIn(V,j,U){for(var F=clone$1(V),B=F,q=0,z=toPath(j);q<z.length-1;q++){var G=z[q],Y=getIn$1(V,z.slice(0,q+1));if(Y&&(isObject$1(Y)||Array.isArray(Y)))B=B[G]=clone$1(Y);else{var Q=z[q+1];B=B[G]=isInteger(Q)&&Number(Q)>=0?[]:{}}}return(q===0?V:B)[z[q]]===U?V:(U===void 0?delete B[z[q]]:B[z[q]]=U,q===0&&U===void 0&&delete F[z[q]],F)}function setNestedObjectValues(V,j,U,F){U===void 0&&(U=new WeakMap),F===void 0&&(F={});for(var B=0,q=Object.keys(V);B<q.length;B++){var z=q[B],G=V[z];isObject$1(G)?U.get(G)||(U.set(G,!0),F[z]=Array.isArray(G)?[]:{},setNestedObjectValues(G,j,U,F[z])):F[z]=j}return F}function formikReducer(V,j){switch(j.type){case"SET_VALUES":return _extends({},V,{values:j.payload});case"SET_TOUCHED":return _extends({},V,{touched:j.payload});case"SET_ERRORS":return isEqual(V.errors,j.payload)?V:_extends({},V,{errors:j.payload});case"SET_STATUS":return _extends({},V,{status:j.payload});case"SET_ISSUBMITTING":return _extends({},V,{isSubmitting:j.payload});case"SET_ISVALIDATING":return _extends({},V,{isValidating:j.payload});case"SET_FIELD_VALUE":return _extends({},V,{values:setIn(V.values,j.payload.field,j.payload.value)});case"SET_FIELD_TOUCHED":return _extends({},V,{touched:setIn(V.touched,j.payload.field,j.payload.value)});case"SET_FIELD_ERROR":return _extends({},V,{errors:setIn(V.errors,j.payload.field,j.payload.value)});case"RESET_FORM":return _extends({},V,j.payload);case"SET_FORMIK_STATE":return j.payload(V);case"SUBMIT_ATTEMPT":return _extends({},V,{touched:setNestedObjectValues(V.values,!0),isSubmitting:!0,submitCount:V.submitCount+1});case"SUBMIT_FAILURE":return _extends({},V,{isSubmitting:!1});case"SUBMIT_SUCCESS":return _extends({},V,{isSubmitting:!1});default:return V}}var emptyErrors={},emptyTouched={};function useFormik(V){var j=V.validateOnChange,U=j===void 0?!0:j,F=V.validateOnBlur,B=F===void 0?!0:F,q=V.validateOnMount,z=q===void 0?!1:q,G=V.isInitialValid,Y=V.enableReinitialize,Q=Y===void 0?!1:Y,W=V.onSubmit,Z=_objectWithoutPropertiesLoose(V,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),ee=_extends({validateOnChange:U,validateOnBlur:B,validateOnMount:z,onSubmit:W},Z),ne=reactExports.useRef(ee.initialValues),ae=reactExports.useRef(ee.initialErrors||emptyErrors),se=reactExports.useRef(ee.initialTouched||emptyTouched),de=reactExports.useRef(ee.initialStatus),oe=reactExports.useRef(!1),ue=reactExports.useRef({});reactExports.useEffect(function(){return oe.current=!0,function(){oe.current=!1}},[]);var he=reactExports.useState(0),ye=he[1],fe=reactExports.useRef({values:cloneDeep(ee.initialValues),errors:cloneDeep(ee.initialErrors)||emptyErrors,touched:cloneDeep(ee.initialTouched)||emptyTouched,status:cloneDeep(ee.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),pe=fe.current,xe=reactExports.useCallback(function(De){var Xe=fe.current;fe.current=formikReducer(Xe,De),Xe!==fe.current&&ye(function(et){return et+1})},[]),Ee=reactExports.useCallback(function(De,Xe){return new Promise(function(et,tt){var _e=ee.validate(De,Xe);_e==null?et(emptyErrors):isPromise(_e)?_e.then(function(je){et(je||emptyErrors)},function(je){tt(je)}):et(_e)})},[ee.validate]),ke=reactExports.useCallback(function(De,Xe){var et=ee.validationSchema,tt=isFunction(et)?et(Xe):et,_e=Xe&&tt.validateAt?tt.validateAt(Xe,De):validateYupSchema(De,tt);return new Promise(function(je,nt){_e.then(function(){je(emptyErrors)},function(it){it.name==="ValidationError"?je(yupToFormErrors(it)):nt(it)})})},[ee.validationSchema]),Ae=reactExports.useCallback(function(De,Xe){return new Promise(function(et){return et(ue.current[De].validate(Xe))})},[]),be=reactExports.useCallback(function(De){var Xe=Object.keys(ue.current).filter(function(tt){return isFunction(ue.current[tt].validate)}),et=Xe.length>0?Xe.map(function(tt){return Ae(tt,getIn$1(De,tt))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(et).then(function(tt){return tt.reduce(function(_e,je,nt){return je==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||je&&(_e=setIn(_e,Xe[nt],je)),_e},{})})},[Ae]),Le=reactExports.useCallback(function(De){return Promise.all([be(De),ee.validationSchema?ke(De):{},ee.validate?Ee(De):{}]).then(function(Xe){var et=Xe[0],tt=Xe[1],_e=Xe[2],je=deepmerge_1.all([et,tt,_e],{arrayMerge});return je})},[ee.validate,ee.validationSchema,be,Ee,ke]),Fe=useEventCallback(function(De){return De===void 0&&(De=pe.values),xe({type:"SET_ISVALIDATING",payload:!0}),Le(De).then(function(Xe){return oe.current&&(xe({type:"SET_ISVALIDATING",payload:!1}),xe({type:"SET_ERRORS",payload:Xe})),Xe})});reactExports.useEffect(function(){z&&oe.current===!0&&isEqual(ne.current,ee.initialValues)&&Fe(ne.current)},[z,Fe]);var Ne=reactExports.useCallback(function(De){var Xe=De&&De.values?De.values:ne.current,et=De&&De.errors?De.errors:ae.current?ae.current:ee.initialErrors||{},tt=De&&De.touched?De.touched:se.current?se.current:ee.initialTouched||{},_e=De&&De.status?De.status:de.current?de.current:ee.initialStatus;ne.current=Xe,ae.current=et,se.current=tt,de.current=_e;var je=function(){xe({type:"RESET_FORM",payload:{isSubmitting:!!De&&!!De.isSubmitting,errors:et,touched:tt,status:_e,values:Xe,isValidating:!!De&&!!De.isValidating,submitCount:De&&De.submitCount&&typeof De.submitCount=="number"?De.submitCount:0}})};if(ee.onReset){var nt=ee.onReset(pe.values,Qt);isPromise(nt)?nt.then(je):je()}else je()},[ee.initialErrors,ee.initialStatus,ee.initialTouched,ee.onReset]);reactExports.useEffect(function(){oe.current===!0&&!isEqual(ne.current,ee.initialValues)&&Q&&(ne.current=ee.initialValues,Ne(),z&&Fe(ne.current))},[Q,ee.initialValues,Ne,z,Fe]),reactExports.useEffect(function(){Q&&oe.current===!0&&!isEqual(ae.current,ee.initialErrors)&&(ae.current=ee.initialErrors||emptyErrors,xe({type:"SET_ERRORS",payload:ee.initialErrors||emptyErrors}))},[Q,ee.initialErrors]),reactExports.useEffect(function(){Q&&oe.current===!0&&!isEqual(se.current,ee.initialTouched)&&(se.current=ee.initialTouched||emptyTouched,xe({type:"SET_TOUCHED",payload:ee.initialTouched||emptyTouched}))},[Q,ee.initialTouched]),reactExports.useEffect(function(){Q&&oe.current===!0&&!isEqual(de.current,ee.initialStatus)&&(de.current=ee.initialStatus,xe({type:"SET_STATUS",payload:ee.initialStatus}))},[Q,ee.initialStatus,ee.initialTouched]);var Ve=useEventCallback(function(De){if(ue.current[De]&&isFunction(ue.current[De].validate)){var Xe=getIn$1(pe.values,De),et=ue.current[De].validate(Xe);return isPromise(et)?(xe({type:"SET_ISVALIDATING",payload:!0}),et.then(function(tt){return tt}).then(function(tt){xe({type:"SET_FIELD_ERROR",payload:{field:De,value:tt}}),xe({type:"SET_ISVALIDATING",payload:!1})})):(xe({type:"SET_FIELD_ERROR",payload:{field:De,value:et}}),Promise.resolve(et))}else if(ee.validationSchema)return xe({type:"SET_ISVALIDATING",payload:!0}),ke(pe.values,De).then(function(tt){return tt}).then(function(tt){xe({type:"SET_FIELD_ERROR",payload:{field:De,value:getIn$1(tt,De)}}),xe({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),Te=reactExports.useCallback(function(De,Xe){var et=Xe.validate;ue.current[De]={validate:et}},[]),Oe=reactExports.useCallback(function(De){delete ue.current[De]},[]),Ue=useEventCallback(function(De,Xe){xe({type:"SET_TOUCHED",payload:De});var et=Xe===void 0?B:Xe;return et?Fe(pe.values):Promise.resolve()}),Ye=reactExports.useCallback(function(De){xe({type:"SET_ERRORS",payload:De})},[]),le=useEventCallback(function(De,Xe){var et=isFunction(De)?De(pe.values):De;xe({type:"SET_VALUES",payload:et});var tt=Xe===void 0?U:Xe;return tt?Fe(et):Promise.resolve()}),we=reactExports.useCallback(function(De,Xe){xe({type:"SET_FIELD_ERROR",payload:{field:De,value:Xe}})},[]),He=useEventCallback(function(De,Xe,et){xe({type:"SET_FIELD_VALUE",payload:{field:De,value:Xe}});var tt=et===void 0?U:et;return tt?Fe(setIn(pe.values,De,Xe)):Promise.resolve()}),ge=reactExports.useCallback(function(De,Xe){var et=Xe,tt=De,_e;if(!isString(De)){De.persist&&De.persist();var je=De.target?De.target:De.currentTarget,nt=je.type,it=je.name,pt=je.id,Vt=je.value,yn=je.checked;je.outerHTML;var xt=je.options,ze=je.multiple;et=Xe||it||pt,tt=/number|range/.test(nt)?(_e=parseFloat(Vt),isNaN(_e)?"":_e):/checkbox/.test(nt)?getValueForCheckbox(getIn$1(pe.values,et),yn,Vt):xt&&ze?getSelectedValues(xt):Vt}et&&He(et,tt)},[He,pe.values]),We=useEventCallback(function(De){if(isString(De))return function(Xe){return ge(Xe,De)};ge(De)}),at=useEventCallback(function(De,Xe,et){Xe===void 0&&(Xe=!0),xe({type:"SET_FIELD_TOUCHED",payload:{field:De,value:Xe}});var tt=et===void 0?B:et;return tt?Fe(pe.values):Promise.resolve()}),$e=reactExports.useCallback(function(De,Xe){De.persist&&De.persist();var et=De.target,tt=et.name,_e=et.id;et.outerHTML;var je=Xe||tt||_e;at(je,!0)},[at]),ht=useEventCallback(function(De){if(isString(De))return function(Xe){return $e(Xe,De)};$e(De)}),ut=reactExports.useCallback(function(De){isFunction(De)?xe({type:"SET_FORMIK_STATE",payload:De}):xe({type:"SET_FORMIK_STATE",payload:function(){return De}})},[]),ft=reactExports.useCallback(function(De){xe({type:"SET_STATUS",payload:De})},[]),$t=reactExports.useCallback(function(De){xe({type:"SET_ISSUBMITTING",payload:De})},[]),Mt=useEventCallback(function(){return xe({type:"SUBMIT_ATTEMPT"}),Fe().then(function(De){var Xe=De instanceof Error,et=!Xe&&Object.keys(De).length===0;if(et){var tt;try{if(tt=tn(),tt===void 0)return}catch(_e){throw _e}return Promise.resolve(tt).then(function(_e){return oe.current&&xe({type:"SUBMIT_SUCCESS"}),_e}).catch(function(_e){if(oe.current)throw xe({type:"SUBMIT_FAILURE"}),_e})}else if(oe.current&&(xe({type:"SUBMIT_FAILURE"}),Xe))throw De})}),Nn=useEventCallback(function(De){De&&De.preventDefault&&isFunction(De.preventDefault)&&De.preventDefault(),De&&De.stopPropagation&&isFunction(De.stopPropagation)&&De.stopPropagation(),Mt().catch(function(Xe){console.warn("Warning: An unhandled error was caught from submitForm()",Xe)})}),Qt={resetForm:Ne,validateForm:Fe,validateField:Ve,setErrors:Ye,setFieldError:we,setFieldTouched:at,setFieldValue:He,setStatus:ft,setSubmitting:$t,setTouched:Ue,setValues:le,setFormikState:ut,submitForm:Mt},tn=useEventCallback(function(){return W(pe.values,Qt)}),Gt=useEventCallback(function(De){De&&De.preventDefault&&isFunction(De.preventDefault)&&De.preventDefault(),De&&De.stopPropagation&&isFunction(De.stopPropagation)&&De.stopPropagation(),Ne()}),cn=reactExports.useCallback(function(De){return{value:getIn$1(pe.values,De),error:getIn$1(pe.errors,De),touched:!!getIn$1(pe.touched,De),initialValue:getIn$1(ne.current,De),initialTouched:!!getIn$1(se.current,De),initialError:getIn$1(ae.current,De)}},[pe.errors,pe.touched,pe.values]),bt=reactExports.useCallback(function(De){return{setValue:function(et,tt){return He(De,et,tt)},setTouched:function(et,tt){return at(De,et,tt)},setError:function(et){return we(De,et)}}},[He,at,we]),dn=reactExports.useCallback(function(De){var Xe=isObject$1(De),et=Xe?De.name:De,tt=getIn$1(pe.values,et),_e={name:et,value:tt,onChange:We,onBlur:ht};if(Xe){var je=De.type,nt=De.value,it=De.as,pt=De.multiple;je==="checkbox"?nt===void 0?_e.checked=!!tt:(_e.checked=!!(Array.isArray(tt)&&~tt.indexOf(nt)),_e.value=nt):je==="radio"?(_e.checked=tt===nt,_e.value=nt):it==="select"&&pt&&(_e.value=_e.value||[],_e.multiple=!0)}return _e},[ht,We,pe.values]),At=reactExports.useMemo(function(){return!isEqual(ne.current,pe.values)},[ne.current,pe.values]),Wt=reactExports.useMemo(function(){return typeof G<"u"?At?pe.errors&&Object.keys(pe.errors).length===0:G!==!1&&isFunction(G)?G(ee):G:pe.errors&&Object.keys(pe.errors).length===0},[G,At,pe.errors,ee]),nn=_extends({},pe,{initialValues:ne.current,initialErrors:ae.current,initialTouched:se.current,initialStatus:de.current,handleBlur:ht,handleChange:We,handleReset:Gt,handleSubmit:Nn,resetForm:Ne,setErrors:Ye,setFormikState:ut,setFieldTouched:at,setFieldValue:He,setFieldError:we,setStatus:ft,setSubmitting:$t,setTouched:Ue,setValues:le,submitForm:Mt,validateForm:Fe,validateField:Ve,isValid:Wt,dirty:At,unregisterField:Oe,registerField:Te,getFieldProps:dn,getFieldMeta:cn,getFieldHelpers:bt,validateOnBlur:B,validateOnChange:U,validateOnMount:z});return nn}function yupToFormErrors(V){var j={};if(V.inner){if(V.inner.length===0)return setIn(j,V.path,V.message);for(var B=V.inner,U=Array.isArray(B),F=0,B=U?B:B[Symbol.iterator]();;){var q;if(U){if(F>=B.length)break;q=B[F++]}else{if(F=B.next(),F.done)break;q=F.value}var z=q;getIn$1(j,z.path)||(j=setIn(j,z.path,z.message))}}return j}function validateYupSchema(V,j,U,F){U===void 0&&(U=!1);var B=prepareDataForValidation(V);return j[U?"validateSync":"validate"](B,{abortEarly:!1,context:B})}function prepareDataForValidation(V){var j=Array.isArray(V)?[]:{};for(var U in V)if(Object.prototype.hasOwnProperty.call(V,U)){var F=String(U);Array.isArray(V[F])===!0?j[F]=V[F].map(function(B){return Array.isArray(B)===!0||isPlainObject(B)?prepareDataForValidation(B):B!==""?B:void 0}):isPlainObject(V[F])?j[F]=prepareDataForValidation(V[F]):j[F]=V[F]!==""?V[F]:void 0}return j}function arrayMerge(V,j,U){var F=V.slice();return j.forEach(function(q,z){if(typeof F[z]>"u"){var G=U.clone!==!1,Y=G&&U.isMergeableObject(q);F[z]=Y?deepmerge_1(Array.isArray(q)?[]:{},q,U):q}else U.isMergeableObject(q)?F[z]=deepmerge_1(V[z],q,U):V.indexOf(q)===-1&&F.push(q)}),F}function getSelectedValues(V){return Array.from(V).filter(function(j){return j.selected}).map(function(j){return j.value})}function getValueForCheckbox(V,j,U){if(typeof V=="boolean")return!!j;var F=[],B=!1,q=-1;if(Array.isArray(V))F=V,q=V.indexOf(U),B=q>=0;else if(!U||U=="true"||U=="false")return!!j;return j&&U&&!B?F.concat(U):B?F.slice(0,q).concat(F.slice(q+1)):F}var useIsomorphicLayoutEffect=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function useEventCallback(V){var j=reactExports.useRef(V);return useIsomorphicLayoutEffect(function(){j.current=V}),reactExports.useCallback(function(){for(var U=arguments.length,F=new Array(U),B=0;B<U;B++)F[B]=arguments[B];return j.current.apply(void 0,F)},[])}var Form=reactExports.forwardRef(function(V,j){var U=V.action,F=_objectWithoutPropertiesLoose(V,["action"]),B=U??"#",q=useFormikContext(),z=q.handleReset,G=q.handleSubmit;return reactExports.createElement("form",_extends({onSubmit:G,ref:j,onReset:z,action:B},F))});Form.displayName="Form";var propertyExpr,hasRequiredPropertyExpr;function requirePropertyExpr(){if(hasRequiredPropertyExpr)return propertyExpr;hasRequiredPropertyExpr=1;function V(oe){this._maxSize=oe,this.clear()}V.prototype.clear=function(){this._size=0,this._values=Object.create(null)},V.prototype.get=function(oe){return this._values[oe]},V.prototype.set=function(oe,ue){return this._size>=this._maxSize&&this.clear(),oe in this._values||this._size++,this._values[oe]=ue};var j=/[^.^\]^[]+|(?=\[\]|\.\.)/g,U=/^\d+$/,F=/^\d/,B=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,q=/^\s*(['"]?)(.*?)(\1)\s*$/,z=512,G=new V(z),Y=new V(z),Q=new V(z);propertyExpr={Cache:V,split:Z,normalizePath:W,setter:function(oe){var ue=W(oe);return Y.get(oe)||Y.set(oe,function(ye,fe){for(var pe=0,xe=ue.length,Ee=ye;pe<xe-1;){var ke=ue[pe];if(ke==="__proto__"||ke==="constructor"||ke==="prototype")return ye;Ee=Ee[ue[pe++]]}Ee[ue[pe]]=fe})},getter:function(oe,ue){var he=W(oe);return Q.get(oe)||Q.set(oe,function(fe){for(var pe=0,xe=he.length;pe<xe;)if(fe!=null||!ue)fe=fe[he[pe++]];else return;return fe})},join:function(oe){return oe.reduce(function(ue,he){return ue+(ne(he)||U.test(he)?"["+he+"]":(ue?".":"")+he)},"")},forEach:function(oe,ue,he){ee(Array.isArray(oe)?oe:Z(oe),ue,he)}};function W(oe){return G.get(oe)||G.set(oe,Z(oe).map(function(ue){return ue.replace(q,"$2")}))}function Z(oe){return oe.match(j)||[""]}function ee(oe,ue,he){var ye=oe.length,fe,pe,xe,Ee;for(pe=0;pe<ye;pe++)fe=oe[pe],fe&&(de(fe)&&(fe='"'+fe+'"'),Ee=ne(fe),xe=!Ee&&/^\d+$/.test(fe),ue.call(he,fe,Ee,xe,pe,oe))}function ne(oe){return typeof oe=="string"&&oe&&["'",'"'].indexOf(oe.charAt(0))!==-1}function ae(oe){return oe.match(F)&&!oe.match(U)}function se(oe){return B.test(oe)}function de(oe){return!ne(oe)&&(ae(oe)||se(oe))}return propertyExpr}var propertyExprExports=requirePropertyExpr(),tinyCase,hasRequiredTinyCase;function requireTinyCase(){if(hasRequiredTinyCase)return tinyCase;hasRequiredTinyCase=1;const V=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,j=W=>W.match(V)||[],U=W=>W[0].toUpperCase()+W.slice(1),F=(W,Z)=>j(W).join(Z).toLowerCase(),B=W=>j(W).reduce((Z,ee)=>`${Z}${Z?ee[0].toUpperCase()+ee.slice(1).toLowerCase():ee.toLowerCase()}`,"");return tinyCase={words:j,upperFirst:U,camelCase:B,pascalCase:W=>U(B(W)),snakeCase:W=>F(W,"_"),kebabCase:W=>F(W,"-"),sentenceCase:W=>U(F(W," ")),titleCase:W=>j(W).map(U).join(" ")},tinyCase}var tinyCaseExports=requireTinyCase(),toposort$1={exports:{}},hasRequiredToposort;function requireToposort(){if(hasRequiredToposort)return toposort$1.exports;hasRequiredToposort=1,toposort$1.exports=function(B){return V(j(B),B)},toposort$1.exports.array=V;function V(B,q){var z=B.length,G=new Array(z),Y={},Q=z,W=U(q),Z=F(B);for(q.forEach(function(ne){if(!Z.has(ne[0])||!Z.has(ne[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});Q--;)Y[Q]||ee(B[Q],Q,new Set);return G;function ee(ne,ae,se){if(se.has(ne)){var de;try{de=", node was:"+JSON.stringify(ne)}catch{de=""}throw new Error("Cyclic dependency"+de)}if(!Z.has(ne))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(ne));if(!Y[ae]){Y[ae]=!0;var oe=W.get(ne)||new Set;if(oe=Array.from(oe),ae=oe.length){se.add(ne);do{var ue=oe[--ae];ee(ue,Z.get(ue),se)}while(ae);se.delete(ne)}G[--z]=ne}}}function j(B){for(var q=new Set,z=0,G=B.length;z<G;z++){var Y=B[z];q.add(Y[0]),q.add(Y[1])}return Array.from(q)}function U(B){for(var q=new Map,z=0,G=B.length;z<G;z++){var Y=B[z];q.has(Y[0])||q.set(Y[0],new Set),q.has(Y[1])||q.set(Y[1],new Set),q.get(Y[0]).add(Y[1])}return q}function F(B){for(var q=new Map,z=0,G=B.length;z<G;z++)q.set(B[z],z);return q}return toposort$1.exports}var toposortExports=requireToposort();const toposort=getDefaultExportFromCjs$1(toposortExports),toString=Object.prototype.toString,errorToString=Error.prototype.toString,regExpToString=RegExp.prototype.toString,symbolToString=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",SYMBOL_REGEXP=/^Symbol\((.*)\)(.*)$/;function printNumber(V){return V!=+V?"NaN":V===0&&1/V<0?"-0":""+V}function printSimpleValue(V,j=!1){if(V==null||V===!0||V===!1)return""+V;const U=typeof V;if(U==="number")return printNumber(V);if(U==="string")return j?`"${V}"`:V;if(U==="function")return"[Function "+(V.name||"anonymous")+"]";if(U==="symbol")return symbolToString.call(V).replace(SYMBOL_REGEXP,"Symbol($1)");const F=toString.call(V).slice(8,-1);return F==="Date"?isNaN(V.getTime())?""+V:V.toISOString(V):F==="Error"||V instanceof Error?"["+errorToString.call(V)+"]":F==="RegExp"?regExpToString.call(V):null}function printValue(V,j){let U=printSimpleValue(V,j);return U!==null?U:JSON.stringify(V,function(F,B){let q=printSimpleValue(this[F],j);return q!==null?q:B},2)}function toArray(V){return V==null?[]:[].concat(V)}let _Symbol$toStringTag,_Symbol$hasInstance,_Symbol$toStringTag2,strReg=/\$\{\s*(\w+)\s*\}/g;_Symbol$toStringTag=Symbol.toStringTag;class ValidationErrorNoStack{constructor(j,U,F,B){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[_Symbol$toStringTag]="Error",this.name="ValidationError",this.value=U,this.path=F,this.type=B,this.errors=[],this.inner=[],toArray(j).forEach(q=>{if(ValidationError.isError(q)){this.errors.push(...q.errors);const z=q.inner.length?q.inner:[q];this.inner.push(...z)}else this.errors.push(q)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}_Symbol$hasInstance=Symbol.hasInstance,_Symbol$toStringTag2=Symbol.toStringTag;class ValidationError extends Error{static formatError(j,U){const F=U.label||U.path||"this";return U=Object.assign({},U,{path:F,originalPath:U.path}),typeof j=="string"?j.replace(strReg,(B,q)=>printValue(U[q])):typeof j=="function"?j(U):j}static isError(j){return j&&j.name==="ValidationError"}constructor(j,U,F,B,q){const z=new ValidationErrorNoStack(j,U,F,B);if(q)return z;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[_Symbol$toStringTag2]="Error",this.name=z.name,this.message=z.message,this.type=z.type,this.value=z.value,this.path=z.path,this.errors=z.errors,this.inner=z.inner,Error.captureStackTrace&&Error.captureStackTrace(this,ValidationError)}static[_Symbol$hasInstance](j){return ValidationErrorNoStack[Symbol.hasInstance](j)||super[Symbol.hasInstance](j)}}let mixed={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:V,type:j,value:U,originalValue:F})=>{const B=F!=null&&F!==U?` (cast from the value \`${printValue(F,!0)}\`).`:".";return j!=="mixed"?`${V} must be a \`${j}\` type, but the final value was: \`${printValue(U,!0)}\``+B:`${V} must match the configured type. The validated value was: \`${printValue(U,!0)}\``+B}},string={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},number={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},date={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},boolean={isValue:"${path} field must be ${value}"},object={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},array={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},tuple={notType:V=>{const{path:j,value:U,spec:F}=V,B=F.types.length;if(Array.isArray(U)){if(U.length<B)return`${j} tuple value has too few items, expected a length of ${B} but got ${U.length} for value: \`${printValue(U,!0)}\``;if(U.length>B)return`${j} tuple value has too many items, expected a length of ${B} but got ${U.length} for value: \`${printValue(U,!0)}\``}return ValidationError.formatError(mixed.notType,V)}};Object.assign(Object.create(null),{mixed,string,number,date,object,array,boolean,tuple});const isSchema=V=>V&&V.__isYupSchema__;class Condition{static fromOptions(j,U){if(!U.then&&!U.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:F,then:B,otherwise:q}=U,z=typeof F=="function"?F:(...G)=>G.every(Y=>Y===F);return new Condition(j,(G,Y)=>{var Q;let W=z(...G)?B:q;return(Q=W?.(Y))!=null?Q:Y})}constructor(j,U){this.fn=void 0,this.refs=j,this.refs=j,this.fn=U}resolve(j,U){let F=this.refs.map(q=>q.getValue(U?.value,U?.parent,U?.context)),B=this.fn(F,j,U);if(B===void 0||B===j)return j;if(!isSchema(B))throw new TypeError("conditions must return a schema object");return B.resolve(U)}}const prefixes={context:"$",value:"."};class Reference{constructor(j,U={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof j!="string")throw new TypeError("ref must be a string, got: "+j);if(this.key=j.trim(),j==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===prefixes.context,this.isValue=this.key[0]===prefixes.value,this.isSibling=!this.isContext&&!this.isValue;let F=this.isContext?prefixes.context:this.isValue?prefixes.value:"";this.path=this.key.slice(F.length),this.getter=this.path&&propertyExprExports.getter(this.path,!0),this.map=U.map}getValue(j,U,F){let B=this.isContext?F:this.isValue?j:U;return this.getter&&(B=this.getter(B||{})),this.map&&(B=this.map(B)),B}cast(j,U){return this.getValue(j,U?.parent,U?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(j){return j&&j.__isYupRef}}Reference.prototype.__isYupRef=!0;const isAbsent=V=>V==null;function createValidation(V){function j({value:U,path:F="",options:B,originalValue:q,schema:z},G,Y){const{name:Q,test:W,params:Z,message:ee,skipAbsent:ne}=V;let{parent:ae,context:se,abortEarly:de=z.spec.abortEarly,disableStackTrace:oe=z.spec.disableStackTrace}=B;const ue={value:U,parent:ae,context:se};function he(be={}){const Le=resolveParams(Object.assign({value:U,originalValue:q,label:z.spec.label,path:be.path||F,spec:z.spec,disableStackTrace:be.disableStackTrace||oe},Z,be.params),ue),Fe=new ValidationError(ValidationError.formatError(be.message||ee,Le),U,Le.path,be.type||Q,Le.disableStackTrace);return Fe.params=Le,Fe}const ye=de?G:Y;let fe={path:F,parent:ae,type:Q,from:B.from,createError:he,resolve(be){return resolveMaybeRef(be,ue)},options:B,originalValue:q,schema:z};const pe=be=>{ValidationError.isError(be)?ye(be):be?Y(null):ye(he())},xe=be=>{ValidationError.isError(be)?ye(be):G(be)};if(ne&&isAbsent(U))return pe(!0);let ke;try{var Ae;if(ke=W.call(fe,U,fe),typeof((Ae=ke)==null?void 0:Ae.then)=="function"){if(B.sync)throw new Error(`Validation test of type: "${fe.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(ke).then(pe,xe)}}catch(be){xe(be);return}pe(ke)}return j.OPTIONS=V,j}function resolveParams(V,j){if(!V)return V;for(const U of Object.keys(V))V[U]=resolveMaybeRef(V[U],j);return V}function resolveMaybeRef(V,j){return Reference.isRef(V)?V.getValue(j.value,j.parent,j.context):V}function getIn(V,j,U,F=U){let B,q,z;return j?(propertyExprExports.forEach(j,(G,Y,Q)=>{let W=Y?G.slice(1,G.length-1):G;V=V.resolve({context:F,parent:B,value:U});let Z=V.type==="tuple",ee=Q?parseInt(W,10):0;if(V.innerType||Z){if(Z&&!Q)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${z}" must contain an index to the tuple element, e.g. "${z}[0]"`);if(U&&ee>=U.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${G}, in the path: ${j}. because there is no value at that index. `);B=U,U=U&&U[ee],V=Z?V.spec.types[ee]:V.innerType}if(!Q){if(!V.fields||!V.fields[W])throw new Error(`The schema does not contain the path: ${j}. (failed at: ${z} which is a type: "${V.type}")`);B=U,U=U&&U[W],V=V.fields[W]}q=W,z=Y?"["+G+"]":"."+G}),{schema:V,parent:B,parentPath:q}):{parent:B,parentPath:j,schema:V}}class ReferenceSet extends Set{describe(){const j=[];for(const U of this.values())j.push(Reference.isRef(U)?U.describe():U);return j}resolveAll(j){let U=[];for(const F of this.values())U.push(j(F));return U}clone(){return new ReferenceSet(this.values())}merge(j,U){const F=this.clone();return j.forEach(B=>F.add(B)),U.forEach(B=>F.delete(B)),F}}function clone(V,j=new Map){if(isSchema(V)||!V||typeof V!="object")return V;if(j.has(V))return j.get(V);let U;if(V instanceof Date)U=new Date(V.getTime()),j.set(V,U);else if(V instanceof RegExp)U=new RegExp(V),j.set(V,U);else if(Array.isArray(V)){U=new Array(V.length),j.set(V,U);for(let F=0;F<V.length;F++)U[F]=clone(V[F],j)}else if(V instanceof Map){U=new Map,j.set(V,U);for(const[F,B]of V.entries())U.set(F,clone(B,j))}else if(V instanceof Set){U=new Set,j.set(V,U);for(const F of V)U.add(clone(F,j))}else if(V instanceof Object){U={},j.set(V,U);for(const[F,B]of Object.entries(V))U[F]=clone(B,j)}else throw Error(`Unable to clone ${V}`);return U}function createStandardPath(V){if(!(V!=null&&V.length))return;const j=[];let U="",F=!1,B=!1;for(let q=0;q<V.length;q++){const z=V[q];if(z==="["&&!B){U&&(j.push(...U.split(".").filter(Boolean)),U=""),F=!0;continue}if(z==="]"&&!B){U&&(/^\d+$/.test(U)?j.push(U):j.push(U.replace(/^"|"$/g,"")),U=""),F=!1;continue}if(z==='"'){B=!B;continue}if(z==="."&&!F&&!B){U&&(j.push(U),U="");continue}U+=z}return U&&j.push(...U.split(".").filter(Boolean)),j}function createStandardIssues(V,j){const U=j?`${j}.${V.path}`:V.path;return V.errors.map(F=>({message:F,path:createStandardPath(U)}))}function issuesFromValidationError(V,j){var U;if(!((U=V.inner)!=null&&U.length)&&V.errors.length)return createStandardIssues(V,j);const F=j?`${j}.${V.path}`:V.path;return V.inner.flatMap(B=>issuesFromValidationError(B,F))}class Schema{constructor(j){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new ReferenceSet,this._blacklist=new ReferenceSet,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(mixed.notType)}),this.type=j.type,this._typeCheck=j.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},j?.spec),this.withMutation(U=>{U.nonNullable()})}get _type(){return this.type}clone(j){if(this._mutate)return j&&Object.assign(this.spec,j),this;const U=Object.create(Object.getPrototypeOf(this));return U.type=this.type,U._typeCheck=this._typeCheck,U._whitelist=this._whitelist.clone(),U._blacklist=this._blacklist.clone(),U.internalTests=Object.assign({},this.internalTests),U.exclusiveTests=Object.assign({},this.exclusiveTests),U.deps=[...this.deps],U.conditions=[...this.conditions],U.tests=[...this.tests],U.transforms=[...this.transforms],U.spec=clone(Object.assign({},this.spec,j)),U}label(j){let U=this.clone();return U.spec.label=j,U}meta(...j){if(j.length===0)return this.spec.meta;let U=this.clone();return U.spec.meta=Object.assign(U.spec.meta||{},j[0]),U}withMutation(j){let U=this._mutate;this._mutate=!0;let F=j(this);return this._mutate=U,F}concat(j){if(!j||j===this)return this;if(j.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${j.type}`);let U=this,F=j.clone();const B=Object.assign({},U.spec,F.spec);return F.spec=B,F.internalTests=Object.assign({},U.internalTests,F.internalTests),F._whitelist=U._whitelist.merge(j._whitelist,j._blacklist),F._blacklist=U._blacklist.merge(j._blacklist,j._whitelist),F.tests=U.tests,F.exclusiveTests=U.exclusiveTests,F.withMutation(q=>{j.tests.forEach(z=>{q.test(z.OPTIONS)})}),F.transforms=[...U.transforms,...F.transforms],F}isType(j){return j==null?!!(this.spec.nullable&&j===null||this.spec.optional&&j===void 0):this._typeCheck(j)}resolve(j){let U=this;if(U.conditions.length){let F=U.conditions;U=U.clone(),U.conditions=[],U=F.reduce((B,q)=>q.resolve(B,j),U),U=U.resolve(j)}return U}resolveOptions(j){var U,F,B,q;return Object.assign({},j,{from:j.from||[],strict:(U=j.strict)!=null?U:this.spec.strict,abortEarly:(F=j.abortEarly)!=null?F:this.spec.abortEarly,recursive:(B=j.recursive)!=null?B:this.spec.recursive,disableStackTrace:(q=j.disableStackTrace)!=null?q:this.spec.disableStackTrace})}cast(j,U={}){let F=this.resolve(Object.assign({value:j},U)),B=U.assert==="ignore-optionality",q=F._cast(j,U);if(U.assert!==!1&&!F.isType(q)){if(B&&isAbsent(q))return q;let z=printValue(j),G=printValue(q);throw new TypeError(`The value of ${U.path||"field"} could not be cast to a value that satisfies the schema type: "${F.type}". 

attempted value: ${z} 
`+(G!==z?`result of cast: ${G}`:""))}return q}_cast(j,U){let F=j===void 0?j:this.transforms.reduce((B,q)=>q.call(this,B,j,this),j);return F===void 0&&(F=this.getDefault(U)),F}_validate(j,U={},F,B){let{path:q,originalValue:z=j,strict:G=this.spec.strict}=U,Y=j;G||(Y=this._cast(Y,Object.assign({assert:!1},U)));let Q=[];for(let W of Object.values(this.internalTests))W&&Q.push(W);this.runTests({path:q,value:Y,originalValue:z,options:U,tests:Q},F,W=>{if(W.length)return B(W,Y);this.runTests({path:q,value:Y,originalValue:z,options:U,tests:this.tests},F,B)})}runTests(j,U,F){let B=!1,{tests:q,value:z,originalValue:G,path:Y,options:Q}=j,W=se=>{B||(B=!0,U(se,z))},Z=se=>{B||(B=!0,F(se,z))},ee=q.length,ne=[];if(!ee)return Z([]);let ae={value:z,originalValue:G,path:Y,options:Q,schema:this};for(let se=0;se<q.length;se++){const de=q[se];de(ae,W,function(ue){ue&&(Array.isArray(ue)?ne.push(...ue):ne.push(ue)),--ee<=0&&Z(ne)})}}asNestedTest({key:j,index:U,parent:F,parentPath:B,originalParent:q,options:z}){const G=j??U;if(G==null)throw TypeError("Must include `key` or `index` for nested validations");const Y=typeof G=="number";let Q=F[G];const W=Object.assign({},z,{strict:!0,parent:F,value:Q,originalValue:q[G],key:void 0,[Y?"index":"key"]:G,path:Y||G.includes(".")?`${B||""}[${Y?G:`"${G}"`}]`:(B?`${B}.`:"")+j});return(Z,ee,ne)=>this.resolve(W)._validate(Q,W,ee,ne)}validate(j,U){var F;let B=this.resolve(Object.assign({},U,{value:j})),q=(F=U?.disableStackTrace)!=null?F:B.spec.disableStackTrace;return new Promise((z,G)=>B._validate(j,U,(Y,Q)=>{ValidationError.isError(Y)&&(Y.value=Q),G(Y)},(Y,Q)=>{Y.length?G(new ValidationError(Y,Q,void 0,void 0,q)):z(Q)}))}validateSync(j,U){var F;let B=this.resolve(Object.assign({},U,{value:j})),q,z=(F=U?.disableStackTrace)!=null?F:B.spec.disableStackTrace;return B._validate(j,Object.assign({},U,{sync:!0}),(G,Y)=>{throw ValidationError.isError(G)&&(G.value=Y),G},(G,Y)=>{if(G.length)throw new ValidationError(G,j,void 0,void 0,z);q=Y}),q}isValid(j,U){return this.validate(j,U).then(()=>!0,F=>{if(ValidationError.isError(F))return!1;throw F})}isValidSync(j,U){try{return this.validateSync(j,U),!0}catch(F){if(ValidationError.isError(F))return!1;throw F}}_getDefault(j){let U=this.spec.default;return U==null?U:typeof U=="function"?U.call(this,j):clone(U)}getDefault(j){return this.resolve(j||{})._getDefault(j)}default(j){return arguments.length===0?this._getDefault():this.clone({default:j})}strict(j=!0){return this.clone({strict:j})}nullability(j,U){const F=this.clone({nullable:j});return F.internalTests.nullable=createValidation({message:U,name:"nullable",test(B){return B===null?this.schema.spec.nullable:!0}}),F}optionality(j,U){const F=this.clone({optional:j});return F.internalTests.optionality=createValidation({message:U,name:"optionality",test(B){return B===void 0?this.schema.spec.optional:!0}}),F}optional(){return this.optionality(!0)}defined(j=mixed.defined){return this.optionality(!1,j)}nullable(){return this.nullability(!0)}nonNullable(j=mixed.notNull){return this.nullability(!1,j)}required(j=mixed.required){return this.clone().withMutation(U=>U.nonNullable(j).defined(j))}notRequired(){return this.clone().withMutation(j=>j.nullable().optional())}transform(j){let U=this.clone();return U.transforms.push(j),U}test(...j){let U;if(j.length===1?typeof j[0]=="function"?U={test:j[0]}:U=j[0]:j.length===2?U={name:j[0],test:j[1]}:U={name:j[0],message:j[1],test:j[2]},U.message===void 0&&(U.message=mixed.default),typeof U.test!="function")throw new TypeError("`test` is a required parameters");let F=this.clone(),B=createValidation(U),q=U.exclusive||U.name&&F.exclusiveTests[U.name]===!0;if(U.exclusive&&!U.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return U.name&&(F.exclusiveTests[U.name]=!!U.exclusive),F.tests=F.tests.filter(z=>!(z.OPTIONS.name===U.name&&(q||z.OPTIONS.test===B.OPTIONS.test))),F.tests.push(B),F}when(j,U){!Array.isArray(j)&&typeof j!="string"&&(U=j,j=".");let F=this.clone(),B=toArray(j).map(q=>new Reference(q));return B.forEach(q=>{q.isSibling&&F.deps.push(q.key)}),F.conditions.push(typeof U=="function"?new Condition(B,U):Condition.fromOptions(B,U)),F}typeError(j){let U=this.clone();return U.internalTests.typeError=createValidation({message:j,name:"typeError",skipAbsent:!0,test(F){return this.schema._typeCheck(F)?!0:this.createError({params:{type:this.schema.type}})}}),U}oneOf(j,U=mixed.oneOf){let F=this.clone();return j.forEach(B=>{F._whitelist.add(B),F._blacklist.delete(B)}),F.internalTests.whiteList=createValidation({message:U,name:"oneOf",skipAbsent:!0,test(B){let q=this.schema._whitelist,z=q.resolveAll(this.resolve);return z.includes(B)?!0:this.createError({params:{values:Array.from(q).join(", "),resolved:z}})}}),F}notOneOf(j,U=mixed.notOneOf){let F=this.clone();return j.forEach(B=>{F._blacklist.add(B),F._whitelist.delete(B)}),F.internalTests.blacklist=createValidation({message:U,name:"notOneOf",test(B){let q=this.schema._blacklist,z=q.resolveAll(this.resolve);return z.includes(B)?this.createError({params:{values:Array.from(q).join(", "),resolved:z}}):!0}}),F}strip(j=!0){let U=this.clone();return U.spec.strip=j,U}describe(j){const U=(j?this.resolve(j):this).clone(),{label:F,meta:B,optional:q,nullable:z}=U.spec;return{meta:B,label:F,optional:q,nullable:z,default:U.getDefault(j),type:U.type,oneOf:U._whitelist.describe(),notOneOf:U._blacklist.describe(),tests:U.tests.filter((Y,Q,W)=>W.findIndex(Z=>Z.OPTIONS.name===Y.OPTIONS.name)===Q).map(Y=>{const Q=Y.OPTIONS.params&&j?resolveParams(Object.assign({},Y.OPTIONS.params),j):Y.OPTIONS.params;return{name:Y.OPTIONS.name,params:Q}})}}get"~standard"(){const j=this;return{version:1,vendor:"yup",async validate(F){try{return{value:await j.validate(F,{abortEarly:!1})}}catch(B){if(B instanceof ValidationError)return{issues:issuesFromValidationError(B)};throw B}}}}}Schema.prototype.__isYupSchema__=!0;for(const V of["validate","validateSync"])Schema.prototype[`${V}At`]=function(j,U,F={}){const{parent:B,parentPath:q,schema:z}=getIn(this,j,U,F.context);return z[V](B&&B[q],Object.assign({},F,{parent:B,path:j}))};for(const V of["equals","is"])Schema.prototype[V]=Schema.prototype.oneOf;for(const V of["not","nope"])Schema.prototype[V]=Schema.prototype.notOneOf;const isoReg=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function parseIsoDate(V){const j=parseDateStruct(V);if(!j)return Date.parse?Date.parse(V):Number.NaN;if(j.z===void 0&&j.plusMinus===void 0)return new Date(j.year,j.month,j.day,j.hour,j.minute,j.second,j.millisecond).valueOf();let U=0;return j.z!=="Z"&&j.plusMinus!==void 0&&(U=j.hourOffset*60+j.minuteOffset,j.plusMinus==="+"&&(U=0-U)),Date.UTC(j.year,j.month,j.day,j.hour,j.minute+U,j.second,j.millisecond)}function parseDateStruct(V){var j,U;const F=isoReg.exec(V);return F?{year:toNumber(F[1]),month:toNumber(F[2],1)-1,day:toNumber(F[3],1),hour:toNumber(F[4]),minute:toNumber(F[5]),second:toNumber(F[6]),millisecond:F[7]?toNumber(F[7].substring(0,3)):0,precision:(j=(U=F[7])==null?void 0:U.length)!=null?j:void 0,z:F[8]||void 0,plusMinus:F[9]||void 0,hourOffset:toNumber(F[10]),minuteOffset:toNumber(F[11])}:null}function toNumber(V,j=0){return Number(V)||j}let rEmail=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,rUrl=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,rUUID=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,yearMonthDay="^\\d{4}-\\d{2}-\\d{2}",hourMinuteSecond="\\d{2}:\\d{2}:\\d{2}",zOrOffset="(([+-]\\d{2}(:?\\d{2})?)|Z)",rIsoDateTime=new RegExp(`${yearMonthDay}T${hourMinuteSecond}(\\.\\d+)?${zOrOffset}$`),isTrimmed=V=>isAbsent(V)||V===V.trim(),objStringTag={}.toString();function create$6(){return new StringSchema}class StringSchema extends Schema{constructor(){super({type:"string",check(j){return j instanceof String&&(j=j.valueOf()),typeof j=="string"}}),this.withMutation(()=>{this.transform((j,U,F)=>{if(!F.spec.coerce||F.isType(j)||Array.isArray(j))return j;const B=j!=null&&j.toString?j.toString():j;return B===objStringTag?j:B})})}required(j){return super.required(j).withMutation(U=>U.test({message:j||mixed.required,name:"required",skipAbsent:!0,test:F=>!!F.length}))}notRequired(){return super.notRequired().withMutation(j=>(j.tests=j.tests.filter(U=>U.OPTIONS.name!=="required"),j))}length(j,U=string.length){return this.test({message:U,name:"length",exclusive:!0,params:{length:j},skipAbsent:!0,test(F){return F.length===this.resolve(j)}})}min(j,U=string.min){return this.test({message:U,name:"min",exclusive:!0,params:{min:j},skipAbsent:!0,test(F){return F.length>=this.resolve(j)}})}max(j,U=string.max){return this.test({name:"max",exclusive:!0,message:U,params:{max:j},skipAbsent:!0,test(F){return F.length<=this.resolve(j)}})}matches(j,U){let F=!1,B,q;return U&&(typeof U=="object"?{excludeEmptyString:F=!1,message:B,name:q}=U:B=U),this.test({name:q||"matches",message:B||string.matches,params:{regex:j},skipAbsent:!0,test:z=>z===""&&F||z.search(j)!==-1})}email(j=string.email){return this.matches(rEmail,{name:"email",message:j,excludeEmptyString:!0})}url(j=string.url){return this.matches(rUrl,{name:"url",message:j,excludeEmptyString:!0})}uuid(j=string.uuid){return this.matches(rUUID,{name:"uuid",message:j,excludeEmptyString:!1})}datetime(j){let U="",F,B;return j&&(typeof j=="object"?{message:U="",allowOffset:F=!1,precision:B=void 0}=j:U=j),this.matches(rIsoDateTime,{name:"datetime",message:U||string.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:U||string.datetime_offset,params:{allowOffset:F},skipAbsent:!0,test:q=>{if(!q||F)return!0;const z=parseDateStruct(q);return z?!!z.z:!1}}).test({name:"datetime_precision",message:U||string.datetime_precision,params:{precision:B},skipAbsent:!0,test:q=>{if(!q||B==null)return!0;const z=parseDateStruct(q);return z?z.precision===B:!1}})}ensure(){return this.default("").transform(j=>j===null?"":j)}trim(j=string.trim){return this.transform(U=>U!=null?U.trim():U).test({message:j,name:"trim",test:isTrimmed})}lowercase(j=string.lowercase){return this.transform(U=>isAbsent(U)?U:U.toLowerCase()).test({message:j,name:"string_case",exclusive:!0,skipAbsent:!0,test:U=>isAbsent(U)||U===U.toLowerCase()})}uppercase(j=string.uppercase){return this.transform(U=>isAbsent(U)?U:U.toUpperCase()).test({message:j,name:"string_case",exclusive:!0,skipAbsent:!0,test:U=>isAbsent(U)||U===U.toUpperCase()})}}create$6.prototype=StringSchema.prototype;let invalidDate=new Date(""),isDate=V=>Object.prototype.toString.call(V)==="[object Date]";class DateSchema extends Schema{constructor(){super({type:"date",check(j){return isDate(j)&&!isNaN(j.getTime())}}),this.withMutation(()=>{this.transform((j,U,F)=>!F.spec.coerce||F.isType(j)||j===null?j:(j=parseIsoDate(j),isNaN(j)?DateSchema.INVALID_DATE:new Date(j)))})}prepareParam(j,U){let F;if(Reference.isRef(j))F=j;else{let B=this.cast(j);if(!this._typeCheck(B))throw new TypeError(`\`${U}\` must be a Date or a value that can be \`cast()\` to a Date`);F=B}return F}min(j,U=date.min){let F=this.prepareParam(j,"min");return this.test({message:U,name:"min",exclusive:!0,params:{min:j},skipAbsent:!0,test(B){return B>=this.resolve(F)}})}max(j,U=date.max){let F=this.prepareParam(j,"max");return this.test({message:U,name:"max",exclusive:!0,params:{max:j},skipAbsent:!0,test(B){return B<=this.resolve(F)}})}}DateSchema.INVALID_DATE=invalidDate;function sortFields(V,j=[]){let U=[],F=new Set,B=new Set(j.map(([z,G])=>`${z}-${G}`));function q(z,G){let Y=propertyExprExports.split(z)[0];F.add(Y),B.has(`${G}-${Y}`)||U.push([G,Y])}for(const z of Object.keys(V)){let G=V[z];F.add(z),Reference.isRef(G)&&G.isSibling?q(G.path,z):isSchema(G)&&"deps"in G&&G.deps.forEach(Y=>q(Y,z))}return toposort.array(Array.from(F),U).reverse()}function findIndex(V,j){let U=1/0;return V.some((F,B)=>{var q;if((q=j.path)!=null&&q.includes(F))return U=B,!0}),U}function sortByKeyOrder(V){return(j,U)=>findIndex(V,j)-findIndex(V,U)}const parseJson=(V,j,U)=>{if(typeof V!="string")return V;let F=V;try{F=JSON.parse(V)}catch{}return U.isType(F)?F:V};function deepPartial(V){if("fields"in V){const j={};for(const[U,F]of Object.entries(V.fields))j[U]=deepPartial(F);return V.setFields(j)}if(V.type==="array"){const j=V.optional();return j.innerType&&(j.innerType=deepPartial(j.innerType)),j}return V.type==="tuple"?V.optional().clone({types:V.spec.types.map(deepPartial)}):"optional"in V?V.optional():V}const deepHas=(V,j)=>{const U=[...propertyExprExports.normalizePath(j)];if(U.length===1)return U[0]in V;let F=U.pop(),B=propertyExprExports.getter(propertyExprExports.join(U),!0)(V);return!!(B&&F in B)};let isObject=V=>Object.prototype.toString.call(V)==="[object Object]";function unknown(V,j){let U=Object.keys(V.fields);return Object.keys(j).filter(F=>U.indexOf(F)===-1)}const defaultSort=sortByKeyOrder([]);function create$3(V){return new ObjectSchema(V)}class ObjectSchema extends Schema{constructor(j){super({type:"object",check(U){return isObject(U)||typeof U=="function"}}),this.fields=Object.create(null),this._sortErrors=defaultSort,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{j&&this.shape(j)})}_cast(j,U={}){var F;let B=super._cast(j,U);if(B===void 0)return this.getDefault(U);if(!this._typeCheck(B))return B;let q=this.fields,z=(F=U.stripUnknown)!=null?F:this.spec.noUnknown,G=[].concat(this._nodes,Object.keys(B).filter(Z=>!this._nodes.includes(Z))),Y={},Q=Object.assign({},U,{parent:Y,__validating:U.__validating||!1}),W=!1;for(const Z of G){let ee=q[Z],ne=Z in B;if(ee){let ae,se=B[Z];Q.path=(U.path?`${U.path}.`:"")+Z,ee=ee.resolve({value:se,context:U.context,parent:Y});let de=ee instanceof Schema?ee.spec:void 0,oe=de?.strict;if(de!=null&&de.strip){W=W||Z in B;continue}ae=!U.__validating||!oe?ee.cast(B[Z],Q):B[Z],ae!==void 0&&(Y[Z]=ae)}else ne&&!z&&(Y[Z]=B[Z]);(ne!==Z in Y||Y[Z]!==B[Z])&&(W=!0)}return W?Y:B}_validate(j,U={},F,B){let{from:q=[],originalValue:z=j,recursive:G=this.spec.recursive}=U;U.from=[{schema:this,value:z},...q],U.__validating=!0,U.originalValue=z,super._validate(j,U,F,(Y,Q)=>{if(!G||!isObject(Q)){B(Y,Q);return}z=z||Q;let W=[];for(let Z of this._nodes){let ee=this.fields[Z];!ee||Reference.isRef(ee)||W.push(ee.asNestedTest({options:U,key:Z,parent:Q,parentPath:U.path,originalParent:z}))}this.runTests({tests:W,value:Q,originalValue:z,options:U},F,Z=>{B(Z.sort(this._sortErrors).concat(Y),Q)})})}clone(j){const U=super.clone(j);return U.fields=Object.assign({},this.fields),U._nodes=this._nodes,U._excludedEdges=this._excludedEdges,U._sortErrors=this._sortErrors,U}concat(j){let U=super.concat(j),F=U.fields;for(let[B,q]of Object.entries(this.fields)){const z=F[B];F[B]=z===void 0?q:z}return U.withMutation(B=>B.setFields(F,[...this._excludedEdges,...j._excludedEdges]))}_getDefault(j){if("default"in this.spec)return super._getDefault(j);if(!this._nodes.length)return;let U={};return this._nodes.forEach(F=>{var B;const q=this.fields[F];let z=j;(B=z)!=null&&B.value&&(z=Object.assign({},z,{parent:z.value,value:z.value[F]})),U[F]=q&&"getDefault"in q?q.getDefault(z):void 0}),U}setFields(j,U){let F=this.clone();return F.fields=j,F._nodes=sortFields(j,U),F._sortErrors=sortByKeyOrder(Object.keys(j)),U&&(F._excludedEdges=U),F}shape(j,U=[]){return this.clone().withMutation(F=>{let B=F._excludedEdges;return U.length&&(Array.isArray(U[0])||(U=[U]),B=[...F._excludedEdges,...U]),F.setFields(Object.assign(F.fields,j),B)})}partial(){const j={};for(const[U,F]of Object.entries(this.fields))j[U]="optional"in F&&F.optional instanceof Function?F.optional():F;return this.setFields(j)}deepPartial(){return deepPartial(this)}pick(j){const U={};for(const F of j)this.fields[F]&&(U[F]=this.fields[F]);return this.setFields(U,this._excludedEdges.filter(([F,B])=>j.includes(F)&&j.includes(B)))}omit(j){const U=[];for(const F of Object.keys(this.fields))j.includes(F)||U.push(F);return this.pick(U)}from(j,U,F){let B=propertyExprExports.getter(j,!0);return this.transform(q=>{if(!q)return q;let z=q;return deepHas(q,j)&&(z=Object.assign({},q),F||delete z[j],z[U]=B(q)),z})}json(){return this.transform(parseJson)}exact(j){return this.test({name:"exact",exclusive:!0,message:j||object.exact,test(U){if(U==null)return!0;const F=unknown(this.schema,U);return F.length===0||this.createError({params:{properties:F.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(j=!0,U=object.noUnknown){typeof j!="boolean"&&(U=j,j=!0);let F=this.test({name:"noUnknown",exclusive:!0,message:U,test(B){if(B==null)return!0;const q=unknown(this.schema,B);return!j||q.length===0||this.createError({params:{unknown:q.join(", ")}})}});return F.spec.noUnknown=j,F}unknown(j=!0,U=object.noUnknown){return this.noUnknown(!j,U)}transformKeys(j){return this.transform(U=>{if(!U)return U;const F={};for(const B of Object.keys(U))F[j(B)]=U[B];return F})}camelCase(){return this.transformKeys(tinyCaseExports.camelCase)}snakeCase(){return this.transformKeys(tinyCaseExports.snakeCase)}constantCase(){return this.transformKeys(j=>tinyCaseExports.snakeCase(j).toUpperCase())}describe(j){const U=(j?this.resolve(j):this).clone(),F=super.describe(j);F.fields={};for(const[q,z]of Object.entries(U.fields)){var B;let G=j;(B=G)!=null&&B.value&&(G=Object.assign({},G,{parent:G.value,value:G.value[q]})),F.fields[q]=z.describe(G)}return F}}create$3.prototype=ObjectSchema.prototype;const SupportInterface=({onClose:V,onSubmit:j,apiUrl:U,sessionId:F,assistant:B})=>{const[q,z]=reactExports.useState(""),[G,Y]=reactExports.useState(!1),[Q,W]=reactExports.useState(!0),[Z,ee]=reactExports.useState("idle");reactExports.useEffect(()=>{(async()=>{try{const de=await fetch(`${U}/sessions/summarizeSession/${F}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:F})});if(de.ok){const oe=await de.json();z(oe.data||"")}else z(" Failed to load summary, you can still edit it manually.")}catch{z(" Network error while fetching summary.")}})()},[F,U]);const ne=create$3({connectVia:create$6().oneOf(["email","phone"]).required(),phone:create$6().when("connectVia",{is:"phone",then:se=>se.matches(/^[0-9]{10}$/,"Enter a valid 10-digit number").required("Phone is required"),otherwise:se=>se.test("optional-10-digit","Enter a valid 10-digit number",de=>de?/^[0-9]{10}$/.test(de):!0)}),email:create$6().when("connectVia",{is:"email",then:se=>se.email("Enter a valid email").required("Email is required"),otherwise:se=>se.email("Enter a valid email").notRequired()})}),ae=useFormik({initialValues:{phone:"",email:"",connectVia:"phone",sendTranscript:!0},validationSchema:ne,validateOnBlur:!0,validateOnChange:!0,onSubmit:async(se,{resetForm:de})=>{ee("submitting");const oe={connectVia:se.connectVia,email:se.email,phone:se.phone,query:Q?q:"",ownerId:B?.ownerId,sessionId:F};try{const ue=await fetch(`${U}/assistant/createTicket`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(!ue.ok)throw new Error("Failed");await ue.json(),j?.(se),ee("success"),de()}catch(ue){console.error(" Error submitting ticket:",ue),ee("error")}}});return Z==="success"||Z==="error"?jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"exthalpy-w-[320px] exthalpy-rounded-2xl exthalpy-bg-white exthalpy-border exthalpy-border-gray-200 exthalpy-shadow-xl exthalpy-flex exthalpy-flex-col exthalpy-items-center exthalpy-justify-center exthalpy-gap-4 exthalpy-p-6",children:[Z==="success"?jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-flex-col exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{size:64,className:"exthalpy-text-green-500"}),jsxRuntimeExports.jsx("p",{className:"exthalpy-text-sm exthalpy-text-gray-700 exthalpy-font-medium",children:"Submitted Successfully!"})]}):jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-flex-col exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx(CircleX,{size:64,className:"exthalpy-text-red-500"}),jsxRuntimeExports.jsx("p",{className:"exthalpy-text-sm exthalpy-text-red-600 exthalpy-font-medium",children:"Failed to Submit"})]}),jsxRuntimeExports.jsx("button",{onClick:V,className:"exthalpy-mt-2 exthalpy-px-4 exthalpy-py-2 exthalpy-rounded-lg exthalpy-bg-black exthalpy-text-white exthalpy-text-sm exthalpy-font-medium hover:exthalpy-bg-gray-900",children:"Close"})]}):jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},className:"exthalpy-w-[320px] exthalpy-rounded-2xl exthalpy-bg-white exthalpy-border exthalpy-border-gray-200 exthalpy-shadow-xl exthalpy-flex exthalpy-flex-col exthalpy-overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-px-4 exthalpy-py-3 exthalpy-border-b exthalpy-border-gray-200 exthalpy-border-solid",children:[jsxRuntimeExports.jsx("h2",{className:"exthalpy-text-sm exthalpy-font-semibold exthalpy-text-gray-900 exthalpy-text-center",children:"Connect to team via a support ticket"}),G?jsxRuntimeExports.jsx("textarea",{value:q,onChange:se=>z(se.target.value),className:"exthalpy-w-full exthalpy-text-xs exthalpy-bg-gray-200 exthalpy-rounded-lg exthalpy-px-2  exthalpy-text-gray-700 exthalpy-border exthalpy-border-gray-200 focus:exthalpy-outline-none focus:exthalpy-ring-1 focus:exthalpy-ring-black exthalpy-overflow-y-auto exthalpy-resize-y",rows:3}):jsxRuntimeExports.jsx("div",{className:"exthalpy-mt-2 exthalpy-text-xs exthalpy-h-[60px] exthalpy-bg-gray-200 exthalpy-rounded-lg exthalpy-px-2 exthalpy-py-1 exthalpy-text-gray-700 exthalpy-border exthalpy-border-gray-200 exthalpy-overflow-y-auto exthalpy-max-h-24",children:jsxRuntimeExports.jsx(Markdown,{children:q})}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-justify-end exthalpy-gap-2 exthalpy-mt-2 exthalpy-text-xs exthalpy-text-gray-500",children:[jsxRuntimeExports.jsxs("span",{onClick:()=>Y(!G),className:"exthalpy-flex exthalpy-gap-1 exthalpy-cursor-pointer hover:exthalpy-underline",children:[jsxRuntimeExports.jsx(Pen,{size:14})," ",G?"Save":"Edit"]}),jsxRuntimeExports.jsx("span",{children:"|"}),jsxRuntimeExports.jsx("span",{children:"Summarised by AI"})]})]}),jsxRuntimeExports.jsxs("form",{onSubmit:ae.handleSubmit,className:"exthalpy-flex-1 exthalpy-p-3 exthalpy-flex exthalpy-flex-col exthalpy-gap-4 exthalpy-text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"exthalpy-block exthalpy-mb-1 exthalpy-text-sm exthalpy-font-medium exthalpy-text-gray-700",children:"Connect via :"}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-gap-2",children:[jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>{ae.setFieldValue("connectVia","email")},className:`exthalpy-flex-1 exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-gap-1 exthalpy-border exthalpy-rounded-lg exthalpy-py-2 exthalpy-px-1 exthalpy-text-sm ${ae.values.connectVia==="email"?"exthalpy-border-black exthalpy-bg-black exthalpy-text-white":"exthalpy-border-gray-500 exthalpy-text-gray-700"}`,children:[jsxRuntimeExports.jsx(Mail,{size:14})," Email"]}),jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>{ae.setFieldValue("connectVia","phone")},className:`exthalpy-flex-1 exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-gap-1 exthalpy-border exthalpy-rounded-lg exthalpy-2 exthalpy-px-1 exthalpy-text-sm ${ae.values.connectVia==="phone"?"exthalpy-border-black exthalpy-bg-black exthalpy-border-solid exthalpy-text-white":"exthalpy-border-gray-500 exthalpy-text-gray-700 exthalpy-border-solid"}`,children:[jsxRuntimeExports.jsx(Phone,{size:14})," Phone Call"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-flex-col exthalpy-gap-4",children:[jsxRuntimeExports.jsxs("div",{className:ae.values.connectVia==="phone"?"order-first":"order-last",children:[jsxRuntimeExports.jsxs("label",{className:"exthalpy-block exthalpy-mb-1 exthalpy-text-sm exthalpy-font-medium exthalpy-text-gray-700",children:["Phone Number"," ",ae.values.connectVia==="phone"?jsxRuntimeExports.jsx("span",{className:"exthalpy-text-red-400",children:"*"}):jsxRuntimeExports.jsx("span",{className:"exthalpy-text-gray-400",children:"(optional)"})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-w-[250px]",children:[jsxRuntimeExports.jsx("span",{className:"exthalpy-px-3 exthalpy-flex exthalpy-items-center exthalpy-border exthalpy-border-r-0 exthalpy-border-gray-500 exthalpy-border-solid exthalpy-rounded-l-md exthalpy-bg-gray-50 exthalpy-text-gray-700 exthalpy-text-sm",children:"+91"}),jsxRuntimeExports.jsx("input",{type:"text",name:"phone",value:ae.values.phone,onChange:ae.handleChange,onBlur:ae.handleBlur,placeholder:"91 XXXX XXXX",className:" exthalpy-flex-1 exthalpy-px-3 exthalpy-py-2 exthalpy-text-sm exthalpy-border exthalpy-border-gray-500 exthalpy-border-solid exthalpy-rounded-r-md focus:exthalpy-outline-none focus:exthalpy-ring-1 focus:exthalpy-ring-/60"})]}),ae.touched.phone&&ae.errors.phone&&jsxRuntimeExports.jsx("p",{className:"exthalpy-mt-1 exthalpy-text-xs exthalpy-text-red-500",children:ae.errors.phone})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-3",children:[jsxRuntimeExports.jsx("span",{className:"exthalpy-h-px exthalpy-flex-1 exthalpy-bg-gray-300"}),jsxRuntimeExports.jsx("span",{className:"exthalpy-text-xs exthalpy-uppercase exthalpy-tracking-wider exthalpy-text-gray-500",children:"OR"}),jsxRuntimeExports.jsx("span",{className:"exthalpy-h-px exthalpy-flex-1 exthalpy-bg-gray-300"})]}),jsxRuntimeExports.jsxs("div",{className:ae.values.connectVia==="email"?"order-first":"order-last",children:[jsxRuntimeExports.jsxs("label",{className:"exthalpy-block exthalpy-mb-1 exthalpy-text-sm exthalpy-font-medium exthalpy-text-gray-700",children:["Email Address"," ",ae.values.connectVia==="email"?jsxRuntimeExports.jsx("span",{className:"exthalpy-text-red-400",children:"*"}):jsxRuntimeExports.jsx("span",{className:"exthalpy-text-gray-400",children:"(optional)"})]}),jsxRuntimeExports.jsx("input",{type:"email",name:"email",value:ae.values.email,onChange:ae.handleChange,onBlur:ae.handleBlur,placeholder:"email@example.com",className:"exthalpy-w-[250px] exthalpy-px-3 exthalpy-py-2 exthalpy-text-sm exthalpy-border exthalpy-border-gray-500 exthalpy-rounded-md focus:exthalpy-outline-none focus:exthalpy-ring-1 focus:exthalpy-ring-black"}),ae.touched.email&&ae.errors.email&&jsxRuntimeExports.jsx("p",{className:"exthalpy-mt-1 exthalpy-text-xs exthalpy-text-red-500",children:ae.errors.email})]})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx("input",{id:"includeTranscript",type:"checkbox",checked:Q,onChange:()=>W(!Q),className:"exthalpy-w-4 exthalpy-h-4 exthalpy-text-black exthalpy-border-gray-500 exthalpy-rounded focus:exthalpy-ring-black"}),jsxRuntimeExports.jsx("label",{htmlFor:"includeTranscript",className:"exthalpy-text-sm exthalpy-text-gray-700",children:"Include transcript in ticket"})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:Z==="submitting"||!ae.isValid||!ae.dirty,className:"exthalpy-mt-auto exthalpy-w-full exthalpy-py-2 exthalpy-px-4 exthalpy-rounded-lg exthalpy-bg-black exthalpy-text-white exthalpy-text-sm exthalpy-font-medium hover:exthalpy-bg-gray-900 focus:exthalpy-outline-none focus:exthalpy-ring-2 focus:exthalpy-ring-offset-1 focus:exthalpy-ring-black disabled:exthalpy-opacity-60 disabled:exthalpy-cursor-not-allowed",children:Z==="submitting"?"Submitting...":"Connect to Human"})]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-px-4 exthalpy-py-1 exthalpy-border-t exthalpy-border-gray-200 exthalpy-text-xs exthalpy-text-gray-500",children:"Note: It may take a few hours for the team to get back to you"})]})},Timer=({isCallActive:V})=>{const[j,U]=reactExports.useState(0),F=reactExports.useRef(null);reactExports.useEffect(()=>(V?F.current=setInterval(()=>{U(q=>q+1)},1e3):(F.current&&(clearInterval(F.current),F.current=null),U(0)),()=>{F.current&&clearInterval(F.current)}),[V]);const B=q=>{const z=Math.floor(q/60),G=q%60;return`${String(z).padStart(2,"0")}:${String(G).padStart(2,"0")}`};return jsxRuntimeExports.jsx("div",{className:"exthalpy-text-sm exthalpy-text-black/80",children:B(j)})},YbugToggle=()=>{const[V,j]=reactExports.useState(!1),U=()=>{F(),window.ybug_settings={id:"558bjd6bn6hbxvsthjj6"};const q=document.createElement("script");q.type="text/javascript",q.async=!0,q.src=`https://widget.ybug.io/button/${window.ybug_settings.id}.js?ts=${Date.now()}`,q.onload=()=>{window.Ybug&&window.Ybug.open()},document.body.appendChild(q),j(!0)},F=()=>{if(window.Ybug)try{window.Ybug.close()}catch{}document.querySelectorAll("script[src*='ybug.io']").forEach(G=>G.parentNode?.removeChild(G)),document.querySelectorAll("#ybug-button, .ybug-widget, [id*='ybug']").forEach(G=>G.parentNode?.removeChild(G)),delete window.Ybug,delete window.ybug,delete window.ybug_settings,j(!1)},B=()=>{V?F():U()};return reactExports.useEffect(()=>()=>{F()},[]),jsxRuntimeExports.jsxs("button",{onClick:B,className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(CircleAlert,{size:16})," Report an Issue"]})},API_URL="https://exthalpy-production-server-3hh3d.ondigitalocean.app/exthalpy-service";function App({clientKey:V="68a81f5a4654aefc1b715d83"}){const[j,U]=reactExports.useState(void 0),[F,B]=reactExports.useState(!1),[q,z]=reactExports.useState(j?.widgetView||"full"),[G,Y]=reactExports.useState(!0),[Q,W]=reactExports.useState(j?.assistantType[0].toLowerCase()||"video"),[Z,ee]=reactExports.useState(null),[ne,ae]=reactExports.useState([]),[se,de]=reactExports.useState(!1),[oe,ue]=reactExports.useState(!1),[he,ye]=reactExports.useState(!1),[fe,pe]=reactExports.useState(!1),[xe,Ee]=reactExports.useState(!1),[ke,Ae]=reactExports.useState(null);reactExports.useEffect(()=>{console.log(ke,"------------------->")},[ke]);const[be,Le]=reactExports.useState(!1),Fe=reactExports.useRef(null);reactExports.useEffect(()=>{(async()=>{try{const le=await getOrStartConversation(API_URL,V),we=await getAssistantById(API_URL,V);U(we.assistant),ee(le),console.log(j?.widgetView,"--------------->"),z(we?.assistant?.widgetView.toString()),W(we?.assistant?.assistantType[0].toLowerCase()),ae([{id:"12",userId:localStorage.getItem("userId"),content:j?.personalityData?.greetingMessage||"Hello, how can I help you today?",type:"text",isUser:!1,time:new Date}])}catch(le){console.error("Error initializing session:",le)}})()},[V]);const Ne=()=>B(!0);reactExports.useEffect(()=>{if(!sessionStorage.getItem("greetingShown")){const le=setTimeout(()=>{ue(!0),sessionStorage.setItem("greetingShown","true");const we=setTimeout(()=>{ue(!1)},5e3),He=()=>{ue(!1)};return window.addEventListener("click",He),window.addEventListener("touchstart",He),()=>{clearTimeout(we),window.removeEventListener("click",He),window.removeEventListener("touchstart",He)}},3e3);return()=>clearTimeout(le)}},[]);const Ve=()=>{if(sessionStorage.getItem("callMeLaterShown"))return;ye(!0),sessionStorage.setItem("callMeLaterShown","true");const le=()=>{Fe.current&&clearTimeout(Fe.current)};Fe.current=setTimeout(()=>{ye(!1),le()},2e3)},Te=()=>{Ee(Ye=>!Ye)},Oe=()=>{Ae(Ye=>!Ye)},Ue=Ye=>{Ae(Ye)};return reactExports.useEffect(()=>()=>{Fe.current&&clearTimeout(Fe.current)},[]),jsxRuntimeExports.jsxs("div",{className:" exthalpy-fixed exthalpy-bottom-5 exthalpy-right-[24px] exthalpy-z-50 exthalpy-rounded-2xl exthalpy-overflow-hidden exthalpy-p-4",children:[jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:F?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Q=="voice"&&q=="sleep"&&jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},exit:{opacity:0,scale:.9},className:"exthalpy-relative exthalpy-mt-30",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-bg-white exthalpy-rounded-2xl exthalpy-p-4 exthalpy-flex exthalpy-items-center exthalpy-gap-4 exthalpy-w-[300px] exthalpy-mx-auto exthalpy-overflow-hidden exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)]",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-z-10",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-semibold exthalpy-truncate",children:"Connected"}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider exthalpy-ease-in-out exthalpy-min-w-[80px]",children:ke===null?"Loading...":ke?"AI is speaking":"Listening"}),jsxRuntimeExports.jsx(Timer,{isCallActive:xe})]})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-z-10",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-white exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2 exthalpy-rounded-full",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Mute Mic",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2 exthalpy-rounded-full",children:jsxRuntimeExports.jsx(VoiceAgent,{messages:ne,assistant:j,setMessages:ae,apiUrl:API_URL,sessionId:Z,onAiSpeakingChange:Ue,toggleTimer:Te,endCallRequested:be,onEndCallHandled:()=>Le(!1)})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full  exthalpy-border exthalpy-border-white/30 exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{B(!1),de(!1),z("simple"),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"End Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:22,className:"exthalpy-text-white"})})})]})]}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-bottom-16  -exthalpy-left-24 exthalpy-bg-white exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-border exthalpy-border-gray-200 exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-1/2 exthalpy-translate-x-1/2 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{W("chat"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{W("support"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]},"voice-interface"),Q=="voice"&&q=="full"&&jsxRuntimeExports.jsx("div",{className:`exthalpy-relative exthalpy-bottom-0 exthalpy-right-0 exthalpy-flex exthalpy-flex-col  exthalpy-pt-30 ${q==="full"?"exthalpy-pb-10":"exthalpy-pb-0"}`,children:jsxRuntimeExports.jsxs("div",{className:"exthalpy-relative exthalpy-w-[320px] exthalpy-h-[200px] exthalpy-rounded-2xl exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute exthalpy-inset-0 exthalpy-w-full exthalpy-h-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-rounded-2xl exthalpy-bg-black",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-border exthalpy-rounded-full exthalpy-p-2 exthalpy-pt-4 exthalpy-pb-4",style:{boxShadow:`
              0 0 4px 1px rgba(255, 255, 255, 0.3),
              0 0 8px 2px rgba(255, 255, 255, 0.2),
              0 0 12px 4px rgba(255, 255, 255, 0.05)
            `,border:"1px solid rgba(255, 255, 255, 0.8)"},children:ke?jsxRuntimeExports.jsx("div",{dangerouslySetInnerHTML:{__html:`<svg width="66" height="49" viewBox="0 0 96 79" fill="none" xmlns="http://www.w3.org/2000/svg">
  <style>
    .bar {
      transform-origin: bottom;
      animation: bounce 1.4s ease-in-out infinite;
    }
    .bar1 { animation-delay: 0s; }
    .bar2 { animation-delay: 0.2s; }
    .bar3 { animation-delay: 0.4s; }
    .bar4 { animation-delay: 0.1s; }
    .bar5 { animation-delay: 0.3s; }
    .bar6 { animation-delay: 0.5s; }
    .bar7 { animation-delay: 0.2s; }
    .bar8 { animation-delay: 0.4s; }
    .bar9 { animation-delay: 0.6s; }

    @keyframes bounce {
      0%, 100% { transform: scaleY(0.7); }
      50%     { transform: scaleY(1.2); }
    }
  </style>

  <!-- Center bars -->
  <path d="M60 40V20" class="bar bar1" stroke="url(#paint0_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M48 40V8" class="bar bar2" stroke="url(#paint0_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M36 40V28" class="bar bar3" stroke="url(#paint0_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>

  <!-- Left bars -->
  <path d="M36 47V27" class="bar bar4" stroke="url(#paint1_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M24 47V15" class="bar bar5" stroke="url(#paint1_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M12 47V35" class="bar bar6" stroke="url(#paint1_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>

  <!-- Right bars -->
  <path d="M84 49V29" class="bar bar7" stroke="url(#paint2_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M72 49V17" class="bar bar8" stroke="url(#paint2_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M60 49V37" class="bar bar9" stroke="url(#paint2_linear_36_572)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>

  <!-- Static white middle return bars (optional animation) -->
  <path d="M36 39V59" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M48 39V71" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
  <path d="M60 39L60 51" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>

  <defs>
    <linearGradient id="paint0_linear_36_572" x1="48" y1="8" x2="48" y2="40" gradientUnits="userSpaceOnUse">
      <stop stop-color="#A9ECFF"/>
      <stop offset="1" stop-color="#FBFEFF"/>
    </linearGradient>
    <linearGradient id="paint1_linear_36_572" x1="24" y1="15" x2="24" y2="47" gradientUnits="userSpaceOnUse">
      <stop stop-color="#FF9AF5"/>
      <stop offset="1" stop-color="#D9D9D9"/>
    </linearGradient>
    <linearGradient id="paint2_linear_36_572" x1="72" y1="17" x2="72" y2="49" gradientUnits="userSpaceOnUse">
      <stop stop-color="#BEF4FF"/>
      <stop offset="1" stop-color="#FF8E8E"/>
    </linearGradient>
  </defs>
</svg>            
`}}):jsxRuntimeExports.jsxs("svg",{width:"66",height:"49",viewBox:"0 0 96 79",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M60 40V20M48 40V8M36 40V28",stroke:"url(#paint0_linear_36_572)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M36 47V27M24 47V15M12 47V35",stroke:"url(#paint1_linear_36_572)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M84 49V29M72 49V17M60 49V37",stroke:"url(#paint2_linear_36_572)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M36 39V59M48 39V71M60 39L60 51",stroke:"white",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsxs("defs",{children:[jsxRuntimeExports.jsxs("linearGradient",{id:"paint0_linear_36_572",x1:"48",y1:"8",x2:"48",y2:"40",gradientUnits:"userSpaceOnUse",children:[jsxRuntimeExports.jsx("stop",{stopColor:"#A9ECFF"}),jsxRuntimeExports.jsx("stop",{offset:"1",stopColor:"#FBFEFF"})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"paint1_linear_36_572",x1:"24",y1:"15",x2:"24",y2:"47",gradientUnits:"userSpaceOnUse",children:[jsxRuntimeExports.jsx("stop",{stopColor:"#FF9AF5"}),jsxRuntimeExports.jsx("stop",{offset:"1",stopColor:"#D9D9D9"})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"paint2_linear_36_572",x1:"72",y1:"17",x2:"72",y2:"49",gradientUnits:"userSpaceOnUse",children:[jsxRuntimeExports.jsx("stop",{stopColor:"#BEF4FF"}),jsxRuntimeExports.jsx("stop",{offset:"1",stopColor:"#FF8E8E"})]})]})]})})}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-absolute -exthalpy-bottom-10 exthalpy-w-[320px] exthalpy-rounded-xl exthalpy-flex exthalpy-items-center exthalpy-justify-between exthalpy-bg-white exthalpy-px-3 exthalpy-py-2 exthalpy-backdrop-blur-md exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)]",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-z-10",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-semibold exthalpy-truncate",children:"Connected"}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider exthalpy-ease-in-out exthalpy-min-w-[80px]",children:ke===null?"Loading...":ke?"AI is speaking":"Listening"}),jsxRuntimeExports.jsx(Timer,{isCallActive:xe})]})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-z-10",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-white exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2 exthalpy-rounded-full",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Mute Mic",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2",children:jsxRuntimeExports.jsx(VoiceAgent,{messages:ne,assistant:j,setMessages:ae,apiUrl:API_URL,sessionId:Z,onAiSpeakingChange:Ue,toggleTimer:Te,endCallRequested:be,onEndCallHandled:()=>Le(!1)})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full  exthalpy-border exthalpy-border-white/30 exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{B(!1),de(!1),z("simple"),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"End Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:22,className:"exthalpy-text-white"})})})]})]}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-bottom-7  exthalpy-left-20 exthalpy-bg-white exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-border exthalpy-border-gray-200 exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-1/2 exthalpy-translate-x-1/2 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{W("chat"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{W("support"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]})}),Q==="video"&&jsxRuntimeExports.jsxs("div",{className:"exthalpy-relative exthalpy-w-[320px] exthalpy-h-[250px] exthalpy-rounded-2xl exthalpy-flex exthalpy-items-center exthalpy-justify-center  ",children:[jsxRuntimeExports.jsx(VideoAgent,{isVideoMode:!0,assistant:j,setMessages:ae,toggleTimer:Te,onAiSpeakingChange:Oe,apiUrl:API_URL,sessionId:Z||void 0,audioEnabled:G,setAudioEnabled:Y,requestEnd:fe,onEnded:()=>{pe(!1)}}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-absolute exthalpy-bottom-0  exthalpy-w-[320px] exthalpy-rounded-xl exthalpy-flex exthalpy-items-center exthalpy-justify-between exthalpy-bg-white exthalpy-px-3 exthalpy-py-2 exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)] exthalpy-z-50",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-z-10",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-semibold exthalpy-truncate",children:"Connected"}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-justify-between",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider exthalpy-ease-in-out exthalpy-min-w-[80px]",children:ke===null?"Loading...":ke?"AI is speaking":"Listening"}),jsxRuntimeExports.jsx("div",{className:"exthalpy-pr-2",children:jsxRuntimeExports.jsx(Timer,{isCallActive:xe})})]})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-z-10",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:[jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-white exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-bottom-16  -exthalpy-left-24 exthalpy-bg-white exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-border exthalpy-border-gray-200 exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-1/2 exthalpy-translate-x-1/2 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("chat"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("support"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>Y(Ye=>!Ye),className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent exthalpy-cursor-pointer exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-text-white exthalpy-transition-all","aria-label":"Toggle Mic",children:G?jsxRuntimeExports.jsx(Mic,{size:25,className:"exthalpy-text-black"}):jsxRuntimeExports.jsx(MicOff,{size:25,className:"exthalpy-text-black"})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-black exthalpy-p-1 exthalpy-border exthalpy-border-white/30 exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{pe(!0),W("video"),z("simple"),B(!1),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"Decline Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:25,className:"exthalpy-text-white"})})})]})]})]}),Q=="chat"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},className:"exthalpy-w-[320px] exthalpy-h-[480px] exthalpy-rounded-2xl exthalpy-bg-white exthalpy-border exthalpy-border-gray-200 exthalpy-shadow-xl exthalpy-flex exthalpy-flex-col exthalpy-overflow-hidden",children:jsxRuntimeExports.jsx(ChatInterface,{messages:ne,setMessages:ae,clientKey:V,apiUrl:API_URL,assistant:j,sessionId:Z||"",mode:Q,widgetMode:q,setMode:W,setWidgetMode:z})}),jsxRuntimeExports.jsx("div",{className:"exthalpy-flex exthalpy-justify-end exthalpy-items-center exthalpy-mt-2",children:jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:0},animate:{opacity:1,scale:1},transition:{duration:.3},className:"exthalpy-rounded-2xl exthalpy-w-15 exthalpy-h-15 exthalpy-bg-white exthalpy-shadow-lg exthalpy-p-2 exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z(j?.widgetView),W(j?.assistantType[0].toLowerCase()),B(!1)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-p-2 exthalpy-rounded-full exthalpy-border exthalpy-border-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-text-black ","aria-label":"Expand Video Widget",children:jsxRuntimeExports.jsx(ChevronDown,{size:25,className:"exthalpy-text-black"})})})})]}),Q=="support"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.3,ease:"easeOut"},className:"exthalpy-w-[320px] exthalpy-h-[600px] exthalpy-rounded-2xl exthalpy-flex exthalpy-flex-col exthalpy-item-end exthalpy-overflow-hidden ",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-mt-auto"}),jsxRuntimeExports.jsx(SupportInterface,{onClose:()=>{W(j?.assistantType[0].toLowerCase()||"video"),B(!1),z(j?.widgetView)},apiUrl:API_URL,sessionId:Z||"",assistant:j})]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-flex exthalpy-justify-end exthalpy-items-center exthalpy-mt-2 exthalpy-pb-5",children:jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:0},animate:{opacity:1,scale:1},transition:{duration:.3},className:"exthalpy-rounded-2xl exthalpy-bg-white exthalpy-w-15 exthalpy-h-15 exthalpy-shadow-lg exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-p-2",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z(j?.widgetView),W(j?.assistantType[0].toLowerCase()),B(!1)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-p-2 exthalpy-rounded-full exthalpy-border exthalpy-border-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-text-black ","aria-label":"Expand Video Widget",children:jsxRuntimeExports.jsx(ChevronDown,{size:25,className:"exthalpy-text-black"})})})})]})]}):jsxRuntimeExports.jsxs("div",{className:` exthalpy-relative exthalpy-bottom-0 exthalpy-right-0 exthalpy-flex exthalpy-flex-col exthalpy-pt-32 ${q==="full"?"exthalpy-pb-10":" exthalpy-pb-0"}`,children:[q==="full"&&Q==="voice"&&jsxRuntimeExports.jsxs("div",{className:"exthalpy-relative exthalpy-w-[320px] exthalpy-h-[200px] exthalpy-rounded-2xl exthalpy-flex exthalpy-items-center exthalpy-justify-center ",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute exthalpy-inset-0 exthalpy-w-full exthalpy-h-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-rounded-2xl exthalpy-bg-black",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-border exthalpy-rounded-full exthalpy-p-2 exthalpy-pt-4 exthalpy-pb-3",style:{boxShadow:`
              0 0 4px 1px rgba(255, 255, 255, 0.3),
              0 0 8px 2px rgba(255, 255, 255, 0.2),
              0 0 12px 4px rgba(255, 255, 255, 0.05)
            `,border:"1px solid rgba(255, 255, 255, 0.8)"},children:jsxRuntimeExports.jsxs("svg",{width:"66",height:"49",viewBox:"0 0 96 79",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M60 40V20M48 40V8M36 40V28",stroke:"url(#paint0_linear_36_572)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M36 47V27M24 47V15M12 47V35",stroke:"url(#paint1_linear_36_572)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M84 49V29M72 49V17M60 49V37",stroke:"url(#paint2_linear_36_572)",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M36 39V59M48 39V71M60 39L60 51",stroke:"white",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsxs("defs",{children:[jsxRuntimeExports.jsxs("linearGradient",{id:"paint0_linear_36_572",x1:"48",y1:"8",x2:"48",y2:"40",gradientUnits:"userSpaceOnUse",children:[jsxRuntimeExports.jsx("stop",{stopColor:"#A9ECFF"}),jsxRuntimeExports.jsx("stop",{offset:"1",stopColor:"#FBFEFF"})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"paint1_linear_36_572",x1:"24",y1:"15",x2:"24",y2:"47",gradientUnits:"userSpaceOnUse",children:[jsxRuntimeExports.jsx("stop",{stopColor:"#FF9AF5"}),jsxRuntimeExports.jsx("stop",{offset:"1",stopColor:"#D9D9D9"})]}),jsxRuntimeExports.jsxs("linearGradient",{id:"paint2_linear_36_572",x1:"72",y1:"17",x2:"72",y2:"49",gradientUnits:"userSpaceOnUse",children:[jsxRuntimeExports.jsx("stop",{stopColor:"#BEF4FF"}),jsxRuntimeExports.jsx("stop",{offset:"1",stopColor:"#FF8E8E"})]})]})]})})}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-absolute -exthalpy-bottom-10 exthalpy-w-[320px] exthalpy-rounded-xl exthalpy-flex exthalpy-items-center exthalpy-justify-between exthalpy-bg-white exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)] exthalpy-px-3 exthalpy-py-2 exthalpy-z-50",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-z-10",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-medium exthalpy-truncate exthalpy-max-w-[16ch]",children:[j?.title," ",j?.objective&&`From ${j.objective}`]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider",children:"Incoming Voice Call"})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-z-10",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-white exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2 exthalpy-rounded-full",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{id:"accept-btn",onClick:()=>{W("voice"),Ne()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Start Voice Call",children:jsxRuntimeExports.jsx(PhoneCall,{size:25,className:"exthalpy-text-black"})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full  exthalpy-border exthalpy-border-white/30 exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z("simple"),B(!1),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"Decline Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:22,className:"exthalpy-text-white"})})})]}),oe&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-text-white exthalpy-bottom-64 exthalpy-right-2 exthalpy-translate-x-18 exthalpy-bg-black exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-w-[250px] exthalpy-py-2 exthalpy-z-50 exthalpy-p-2",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-right-4 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-black exthalpy-rotate-45"}),jsxRuntimeExports.jsx("p",{className:" exthalpy-text-xs",children:j?.personalityData?.greetingMessage})]})]}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-bottom-7  exthalpy-left-20 exthalpy-bg-white exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-border exthalpy-border-gray-200 exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-1/2 exthalpy-translate-x-1/2 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("chat"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("support"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]}),q=="sleep"&&Q=="voice"&&jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{scale:1,opacity:1,y:[0,-12,0,-6,0],transition:{duration:3,repeat:0,ease:"easeInOut"}},exit:{opacity:0,scale:.9},className:"exthalpy-w-full exthalpy-max-w-4xl",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-relative exthalpy-bg-white exthalpy-rounded-2xl exthalpy-p-4 exthalpy-flex exthalpy-items-center exthalpy-gap-4 exthalpy-min-w-xs exthalpy-max-w-sm exthalpy-mx-auto exthalpy-overflow-hidden exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)]",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-z-10",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-medium exthalpy-truncate exthalpy-max-w-[16ch]",children:[j?.title," ",j?.objective&&`From ${j.objective}`]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider",children:"Incoming Voice Call"})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-z-10",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-white exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2 exthalpy-rounded-full",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{id:"accept-btn",onClick:()=>{W("voice"),Ne()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Start Voice Call",children:jsxRuntimeExports.jsx(PhoneCall,{size:25,className:"exthalpy-text-black"})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full  exthalpy-border exthalpy-border-white/30 exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z("simple"),B(!1),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"Decline Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:22,className:"exthalpy-text-white"})})})]})]}),oe&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-text-white exthalpy-bottom-24 exthalpy-right-2 exthalpy-bg-black exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-w-[250px] exthalpy-py-2 exthalpy-z-50 exthalpy-px-4",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-right-4 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-black exthalpy-rotate-45"}),jsxRuntimeExports.jsx("p",{className:" exthalpy-text-xs",children:j?.personalityData?.greetingMessage})]}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"b-none exthalpy-absolute exthalpy-bottom-20 exthalpy-left-20 exthalpy-bg-white exthalpy-rounded-lg exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:" exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-20 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("chat"),de(!1),pe(!0)},className:`exthalpy-border-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300 exthalpy-bg-white 
                 border border-transparent hover:border-gray-200
                 focus:outline-none focus:ring-0 focus:shadow-none
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-200 focus-visible:ring-offset-0`,children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("support"),de(!1),pe(!0)},className:`exthalpy-border-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300 
                 border border-transparent hover:border-gray-200
                 focus:outline-none focus:ring-0 focus:shadow-none
                 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-200 focus-visible:ring-offset-0 exthalpy-bg-white`,children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]},"voice-interface"),q==="simple"&&Q==="voice"&&jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{scale:1,opacity:1,y:[0,-16,0,-8,0]},transition:{duration:5,times:[0,.2,.5,.7,1],ease:"easeInOut",repeat:0},className:"exthalpy-rounded-2xl exthalpy-w-60 exthalpy-flex exthalpy-items-center exthalpy-justify-end exthalpy-pb-5",children:[jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z(j?.widgetView),B(!1)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-15 exthalpy-h-15 exthalpy-rounded-2xl exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-bg-white exthalpy-border exthalpy-border-black exthalpy-border-solid exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)] exthalpy-p-2","aria-label":"Expand Widget",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-border exthalpy-p-2 exthalpy-border-black/20 exthalpy-border-solid exthalpy-rounded-full",children:jsxRuntimeExports.jsx(PhoneCall,{size:25,className:"exthalpy-text-black"})})}),he&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-text-white exthalpy-bottom-24 exthalpy-left-10 exthalpy-translate-x-18 exthalpy-bg-black exthalpy-rounded-lg exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-px-2 exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-right-4 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-black exthalpy-rotate-45"}),jsxRuntimeExports.jsx("p",{className:" exthalpy-text-xs",children:"Use this icon to call me later"})]})]}),q==="full"&&Q==="video"&&jsxRuntimeExports.jsxs("div",{className:"exthalpy-relative exthalpy-w-[320px] exthalpy-h-[200px] exthalpy-rounded-2xl exthalpy-flex exthalpy-items-center exthalpy-justify-center ",children:[j?.selectedAvatar?.preview_image_url?jsxRuntimeExports.jsx("img",{src:j.selectedAvatar.preview_image_url,alt:"background",className:"exthalpy-absolute exthalpy-inset-0 exthalpy-w-full exthalpy-h-full exthalpy-object-cover exthalpy-rounded-2xl exthalpy-filter exthalpy-blur-[2px]"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("img",{src:"https://exthalpy-public-bucket.blr1.cdn.digitaloceanspaces.com/assistant1.png",alt:"background",className:"exthalpy-absolute exthalpy-inset-0 exthalpy-w-full exthalpy-h-full exthalpy-object-contain exthalpy-rounded-2xl exthalpy-filter exthalpy-blur-[2px]"}),jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute exthalpy-inset-0 exthalpy-bg-black/20 exthalpy-rounded-2xl"})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-absolute -exthalpy-bottom-10 exthalpy-w-[320px] exthalpy-rounded-xl exthalpy-flex exthalpy-items-center exthalpy-justify-between exthalpy-bg-white exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)] exthalpy-px-3 exthalpy-py-2 exthalpy-z-50",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-text-left",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-medium exthalpy-truncate exthalpy-max-w-[16ch]",children:[j?.title," ",j?.objective&&`From ${j.objective}`]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider",children:"Incoming Video Call"})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-white exthalpy-border exthalpy-border-black/70 exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-rounded-full exthalpy-p-2",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})})})}),jsxRuntimeExports.jsx(motion.button,{onClick:()=>{W("video"),B(!0),Ne()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg exthalpy-border exthalpy-border-black/70 exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Accept Video Call",children:jsxRuntimeExports.jsx(Video,{size:22,className:"exthalpy-text-black"})}),jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z("simple"),B(!1),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"Decline Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:22,className:"exthalpy-text-white"})}),oe&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-text-white exthalpy-bottom-64 exthalpy-right-2 exthalpy-bg-black exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-w-60 exthalpy-py-2 exthalpy-z-50 exthalpy-p-2",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-right-4 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-black exthalpy-rotate-45"}),jsxRuntimeExports.jsx("p",{className:" exthalpy-text-xs",children:j?.personalityData?.greetingMessage})]}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-bottom-16  exthalpy-left-20 exthalpy-bg-white exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-border exthalpy-border-gray-200 exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-1/2 exthalpy-translate-x-1/2 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("chat"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("support"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]})]})]}),q==="sleep"&&Q==="video"&&jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{scale:1,opacity:1,y:[0,-12,0,-6,0],transition:{duration:3,repeat:0,ease:"easeInOut"}},exit:{opacity:0,scale:.9},className:"exthalpy-w-full exthalpy-max-w-4xl",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-relative exthalpy-bg-white exthalpy-rounded-2xl exthalpy-p-4 exthalpy-flex exthalpy-items-center exthalpy-gap-4 exthalpy-min-w-xs exthalpy-max-w-sm exthalpy-mx-auto exthalpy-overflow-hidden exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)]",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-flex-1 exthalpy-z-10",children:[jsxRuntimeExports.jsxs("div",{className:"exthalpy-text-black exthalpy-text-sm exthalpy-font-medium exthalpy-truncate exthalpy-max-w-[16ch]",children:[j?.title," ",j?.objective&&`From ${j.objective}`]}),jsxRuntimeExports.jsx("div",{className:"exthalpy-text-gray-500 exthalpy-text-xs exthalpy-font-light exthalpy-tracking-wider",children:"Incoming Video Call"})]}),jsxRuntimeExports.jsxs("div",{className:"exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-z-10",children:[jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"exthalpy-rounded-full exthalpy-bg-white exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{de(Ye=>!Ye)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Options",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-p-2 exthalpy-rounded-full",children:jsxRuntimeExports.jsx(EllipsisVertical,{size:25,className:"exthalpy-text-black"})})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{id:"accept-btn",onClick:()=>{W("video"),Ne()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-border exthalpy-border-black/70   exthalpy-border-solid exthalpy-bg-transparent","aria-label":"Start Voice Call",children:jsxRuntimeExports.jsx(Video,{size:25,className:"exthalpy-text-black"})})}),jsxRuntimeExports.jsx(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{opacity:1,y:0},transition:{delay:.7,duration:.4},className:"exthalpy-rounded-full exthalpy-p-1  exthalpy-flex exthalpy-items-center exthalpy-justify-center",children:jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z("simple"),B(!1),Ve()},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-10 exthalpy-h-10 exthalpy-rounded-full exthalpy-bg-black exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-shadow-lg","aria-label":"Decline Call",children:jsxRuntimeExports.jsx(PhoneOff,{size:22,className:"exthalpy-text-white"})})})]})]}),oe&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-text-white exthalpy-bottom-24 exthalpy-right-2  exthalpy-bg-black exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-w-60 exthalpy-py-2 exthalpy-z-50 exthalpy-p-2",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-right-4 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-black exthalpy-rotate-45"}),jsxRuntimeExports.jsx("p",{className:" exthalpy-text-xs",children:j?.personalityData?.greetingMessage})]}),se&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-bottom-24  exthalpy-left-14 exthalpy-bg-white exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-border exthalpy-border-gray-200 exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-scale-[0.9]",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-left-1/2 exthalpy-translate-x-1/2 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-white exthalpy-border-gray-200 exthalpy-rotate-45"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("chat"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(MessageSquare,{size:16})," Switch to Text"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{B(!0),W("support"),de(!1),pe(!0)},className:"b-none exthalpy-flex exthalpy-items-center exthalpy-gap-2 exthalpy-w-full exthalpy-px-4 exthalpy-py-2 exthalpy-text-sm exthalpy-text-gray-700 hover:exthalpy-bg-gray-300",children:[jsxRuntimeExports.jsx(User,{size:16})," Connect to Human"]}),jsxRuntimeExports.jsx(YbugToggle,{})]})]},"voice-interface"),q==="simple"&&Q==="video"&&jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.9,opacity:1,y:0},animate:{scale:1,opacity:1,y:[0,-16,0,-8,0]},transition:{duration:5,times:[0,.2,.5,.7,1],ease:"easeInOut",repeat:0},className:"exthalpy-rounded-2xl exthalpy-w-60 exthalpy-flex exthalpy-items-center exthalpy-justify-end exthalpy-pb-5",children:[jsxRuntimeExports.jsx(motion.button,{onClick:()=>{z(j?.widgetView),B(!1)},whileHover:{scale:1.1},whileTap:{scale:.95},className:"exthalpy-w-15 exthalpy-h-15 exthalpy-p-2 exthalpy-rounded-2xl exthalpy-flex exthalpy-items-center exthalpy-justify-center exthalpy-bg-white exthalpy-border exthalpy-border-black/70  exthalpy-transition-all exthalpy-duration-200 exthalpy-text-black exthalpy-shadow-[inset_-1px_-9px_21px_-7px_rgba(0,_0,_0,_0.1)]","aria-label":"Expand Video Widget",children:jsxRuntimeExports.jsx("div",{className:"exthalpy-border exthalpy-p-2 exthalpy-border-black/20 exthalpy-border-solid exthalpy-rounded-full",children:jsxRuntimeExports.jsx(Video,{size:25,className:"exthalpy-text-black"})})}),he&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"exthalpy-absolute exthalpy-text-white exthalpy-bottom-24 -exthalpy-left-30 exthalpy-translate-x-18 exthalpy-bg-black exthalpy-rounded-lg exthalpy-shadow-xl exthalpy-w-48 exthalpy-py-2 exthalpy-z-50 exthalpy-px-2",children:[jsxRuntimeExports.jsx("div",{className:"exthalpy-absolute -exthalpy-bottom-2 exthalpy-right-4 exthalpy-w-4 exthalpy-h-4 exthalpy-bg-black exthalpy-rotate-45"}),jsxRuntimeExports.jsx("p",{className:" exthalpy-text-xs",children:"Use this icon to call me later"})]})]})]})}),q!=="simple"&&Q!=="support"&&jsxRuntimeExports.jsx("p",{className:"exthalpy-text-[10px]  exthalpy-text-center exthalpy-text-black/30 exthalpy-pt-1",children:"Powered by Exthalpy"})]})}function isShadowDOMSupported(){return typeof Element<"u"&&typeof Element.prototype.attachShadow=="function"}function createShadowRoot(V){const{container:j,styles:U="",className:F="exthalpy-shadow-wrapper"}=V;return isShadowDOMSupported()?createShadowDOMRoot(j,U,F):createFallbackRoot(j,U,F)}function createShadowDOMRoot(V,j,U){const F=V.attachShadow({mode:"open"}),B=document.createElement("link");B.rel="stylesheet",B.href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap",F.appendChild(B);const q=document.createElement("style");q.textContent=`
    .${U} {
      all: initial;
      font-family: "Poppins", sans-serif;
      display: block;
      position: fixed;
      bottom: 20px;
      right: 24px;
      z-index: 2147483647;
    }

    .${U}, .${U} * {
      box-sizing: border-box;
      font-family: "Poppins", sans-serif !important;
    }

    ${j}
  `,F.appendChild(q);const z=document.createElement("div");return z.className=U,F.appendChild(z),z}function createFallbackRoot(V,j,U){const F=document.createElement("style");F.textContent=`
    .${U} {
      all: initial !important;
      font-family: "Poppins", sans-serif !important;
      position: fixed !important;
      bottom: 20px !important;
      right: 24px !important;
      z-index: 2147483647 !important;
      isolation: isolate !important;
    }

    .${U}, .${U} * {
      box-sizing: border-box;
      font-family: "Poppins", sans-serif !important;
    }

    ${j}
  `,document.head.appendChild(F);const B=document.createElement("div");return B.className=U,V.appendChild(B),B}function mount(V,j){console.log("Mount called with clientKey:",j.clientKey),console.log("Widget CSS:",widgetCSS);const U=createShadowRoot({container:V,styles:widgetCSS,className:"exthalpy-shadow-wrapper"});console.log("Shadow wrapper created: <div.exthalpy-shadow-wrapper>");const F=clientExports.createRoot(U);return F.render(jsxRuntimeExports.jsx("div",{className:"exthalpy-scope",children:jsxRuntimeExports.jsx(App,{clientKey:j.clientKey})})),{destroy:()=>{F.unmount(),V.parentNode&&V.parentNode.removeChild(V)}}}function autoMountFromScriptTag(){const j=(document.currentScript||Array.from(document.querySelectorAll("script")).reverse().find(F=>F.dataset?.clientKey))?.dataset?.clientKey;if(console.log("Auto-mounting with clientKey:",j),!j)return;const U=()=>{const F=document.createElement("div");document.body.appendChild(F),mount(F,{clientKey:j})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",U):U()}window.ChatBotWidget={mount};try{autoMountFromScriptTag()}catch(V){console.error("ChatBotWidget auto-mount failed:",V)}})();
